<!DOCTYPE html>
<html lang=zh-CN data-theme="light">
	
<script src="/js/plugins/toggleTheme.js"></script>

	<script>
		setTheme();
	</script>
	<head>
		
<title>Hexo-Quiet 主题魔改笔记 | Zi-Zi's Journey</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/images/icon/favicon.ico">
<link href="/css/plugins/print.css" media="print" rel="stylesheet" />

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="CSS,Hexo,EJS,Javascript,HTML,">
<meta name="description" content="面向 GPT 编程。">



<script src="/js/plugins/jquery.min.js"></script>


<script src="/js/plugins/hljs.min.js"></script>


<script src="/js/plugins/init.js"></script>


<script src="/js/plugins/hide.js"></script>


<script src="/js/plugins/tabs.js"></script>



    



    
<script src="/js/plugins/alert-title.js"></script>

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-base.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-dark-class.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-light.css">






    

	<meta name="generator" content="Hexo 6.1.0"></head>

	<body>
		<header class="sticky-header">
	<nav>
		<div class="nav-left">
			<a href="/" class="logo">
				<img no-lazy src="/images/headers_icon/logo.webp" alt="Quieter">
			</a>
			<ul class="breadcrumb" id="breadcrumb"></ul>
		</div>
		<div class="nav-right">
			<ul>
				
					<li>
						<a href="/">
						  主页
						</a>
					</li>
				
					<li>
						<a href="/categories">
						  类别
						</a>
					</li>
				
					<li>
						<a href="/tags">
						  标签
						</a>
					</li>
				
					<li>
						<a href="/archives">
						  归档
						</a>
					</li>
				
					<li>
						<a href="/galleries">
						  相册
						</a>
					</li>
				
					<li>
						<a href="/links">
						  链接
						</a>
					</li>
				
					<li>
						<a href="/about">
						  关于
						</a>
					</li>
								  
			</ul>
		</div>
		<div class="nav-right-close">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
				<path fill="none" d="M0 0h24v24H0z" />
				<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
			</svg>
		</div>

		<div class="sidebar">
    <div class="topo">
        <p>Zi-Zi's Journey</p>
    </div>
    <ul>
        
        <li>
            <a href="/">
                主页
            </a>
        </li>
        
        <li>
            <a href="/categories">
                类别
            </a>
        </li>
        
        <li>
            <a href="/tags">
                标签
            </a>
        </li>
        
        <li>
            <a href="/archives">
                归档
            </a>
        </li>
        
        <li>
            <a href="/galleries">
                相册
            </a>
        </li>
        
        <li>
            <a href="/links">
                链接
            </a>
        </li>
        
        <li>
            <a href="/about">
                关于
            </a>
        </li>
        
    </ul>
    <div class="sidebar-footer">
        
        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
        </a>
        
    </div>
</div>
<div class='shelter'>
    <script>
        $(function() {
            $('.nav-right-close > svg').click(function() {
                $('.sidebar').animate({
                    right: "0"
                }, 500);
                $('.shelter').fadeIn("slow");
            
                var element = $('.topo');
                element.addClass('custom-style');
            
                var links = null;
                if ("") {
                    links = "".split(',');
                } else {
                    links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
                }
            
                var randomLink = links[Math.floor(Math.random() * links.length)];
                element.css('background-image', "url('" + randomLink + "')");
            });
          
            $('.shelter').click(function(e) {
                $('.sidebar').animate({
                    right: "-100%"
                }, 500);
                $('.shelter').fadeOut("slow");
            });
        });      
    </script>
</div>
	</nav>

	
		<div class="header-background"></div>
	

	<script>
		const name = 'post';
		const ul = document.querySelectorAll('.nav-right ul')[0];
		const lis = ul.querySelectorAll('li');

		if (name == 'home') {
			lis[0].classList.add('select');
		} else {
			for (let i = 0; i < lis.length; i++) {
				const li = lis[i];
				const a = li.querySelector('a');
				if (name === a.href.split('/')[3]) {
					li.classList.add('select');
				}
			}
		}
	</script>
	
	<script>
		var element = document.querySelector('.header-background');
		if(element) {
			element.classList.add('custom-style');
			var links = null;
			if("")
			{
				links = "".split(',');
			} else
			{
				links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
			}
			var randomLink = links[Math.floor(Math.random() * links.length)];
			element.style.backgroundImage = "url('" + randomLink + "')";
		}
	</script>

	
<script src="/js/plugins/breadcrumb.js"></script>

	<script>
		var menus_title = [];
		
			menus_title.push({home: '主页'});
		
			menus_title.push({categories: '类别'});
		
			menus_title.push({tags: '标签'});
		
			menus_title.push({archives: '归档'});
		
			menus_title.push({galleries: '相册'});
		
			menus_title.push({links: '链接'});
		
			menus_title.push({about: '关于'});
		
		
			
				postsBreadcrumb(
					document.getElementById('breadcrumb'),
					"类别",
					"/categories",
					"学习",
					"/categories/学习",
					1
				);
			
		
	</script>
</header>

<div class="main-wrapper">
    <main class="post">
        <header class="main-header">
	
		
			
				
<link rel="stylesheet" href="/css/plugins/fancybox.css">

				
<script src="/js/plugins/fancybox.umd.js"></script>

				
<script src="/js/plugins/fancybox.js"></script>

			
			<div class="post-header-background-content">
				<ul class="post-header-tag">
					
						
							<li><a href="/tags/CSS"><span>CSS</span></a></li>
						
							<li><a href="/tags/Hexo"><span>Hexo</span></a></li>
						
							<li><a href="/tags/EJS"><span>EJS</span></a></li>
						
							<li><a href="/tags/Javascript"><span>Javascript</span></a></li>
						
							<li><a href="/tags/HTML"><span>HTML</span></a></li>
						
					
				</ul>
				
				<h1>Hexo-Quiet 主题魔改笔记</h1>
		
				
					<div class="post-header-desc">
						<svg t="1714702231661" class="icon" viewBox="0 0 1024 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="1154" xmlns:xlink="http://www.w3.org/1999/xlink"
						width="20" height="20">
						<path
							d="M778.24 117.76A46.08 46.08 0 0 1 824.32 163.84v430.08c0 8.4992-4.13696 16.01536-10.50624 20.6848l-0.24576 0.2048L587.5712 846.09024a35.84 35.84 0 0 1-61.48096-25.06752v-220.9792a46.08 46.08 0 0 1 46.08-46.08l200.94976-0.02048V168.96h-522.24v686.08H389.12c13.25056 0 24.1664 10.07616 25.47712 22.97856l0.12288 2.62144c0 14.1312-11.4688 25.6-25.6 25.6h-143.36A46.08 46.08 0 0 1 199.68 860.16V163.84A46.08 46.08 0 0 1 245.76 117.76h532.48z m-26.78784 487.38304h-174.16192v178.176l174.16192-178.176z m-45.19936-169.94304a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z m0-122.88a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z"
							fill="#ffffff" p-id="1155"></path>
						</svg>
						<p>面向 GPT 编程。</p>
					</div>
				
		
				<div class="post-header-info">
					<svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
					xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
						<path
							d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
							p-id="2902" fill="#ffffff"></path>
					</svg>
					<div class="post-header-info-author">
						<a href="/about">Zi-Zi</a>
					</div>
					
						<div class="post-header-info-categories">
							
								<a href="/categories/学习">学习</a>
							
						</div>
					
					<time>2023/12/28 16:34:00</time>
				</div>
		
				
					<div class="post-header-stat">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
						viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve" width="20" height="20">
							<path fill="#FFFFFF" d="M187.2,165.6c0,2.6-2.1,4.7-4.7,4.7H17.5c-2.6,0-4.7-2.1-4.7-4.7s2.1-4.7,4.7-4.7h165.1
								C185.2,160.9,187.2,163,187.2,165.6z"/>
							<path fill="#FFFFFF" d="M17.5,29.7c2.6,0,4.7,2.1,4.7,4.7v131.2c0,2.6-2.1,4.7-4.7,4.7s-4.7-2.1-4.7-4.7V34.4
								C12.8,31.8,14.9,29.7,17.5,29.7z M77.9,91.5c1.8,1.8,1.8,4.8,0,6.6l-39.8,39.8c-1.9,1.8-4.9,1.7-6.6-0.2c-1.7-1.8-1.7-4.6,0-6.4
								l39.8-39.8C73.1,89.6,76,89.6,77.9,91.5z M169.9,70.2c1.6,2.1,1.1,5-0.9,6.5c0,0,0,0,0,0l-64.2,48.2c-2.1,1.5-5,1.1-6.6-0.9
								c-1.6-2.1-1.1-5,0.9-6.5c0,0,0,0,0,0l64.2-48.2C165.4,67.7,168.3,68.1,169.9,70.2L169.9,70.2z"/>
							<path fill="#FFFFFF" d="M104.6,124.5c-1.8,1.8-4.8,1.8-6.6,0L71.6,98.1c-1.8-1.8-1.8-4.8,0-6.6c1.8-1.8,4.8-1.8,6.6,0l26.3,26.3
								C106.4,119.6,106.4,122.6,104.6,124.5C104.6,124.4,104.6,124.4,104.6,124.5z"/>
						</svg>
		
						
							
<script src="/js/plugins/wordCount.js"></script>

							<p class="post-count">文字数：---</p>
						
		
						
							<p id="busuanzi_container_page_pv" style='display:none;'>阅读数：<span id="busuanzi_value_page_pv"></span></p>
						
					</div>
				
			</div>
		
	
</header>
        <div class="post-content article-container">
            <article class="post-content-info">
                <h1 id="%E5%89%8D%E8%A8%80" tabindex="-1">前言</h1>
<p>​    这个 <a target="_blank" rel="noopener" href="https://github.com/79e/hexo-theme-quiet">Quiet</a> 主题的布局个人是很喜欢的，风格简洁且小众。可惜它相比于主流的 <a target="_blank" rel="noopener" href="https://theme-next.iissnan.com/">NexT</a>、<a target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/">Butterfly</a> 和 <a target="_blank" rel="noopener" href="https://github.com/fluid-dev/hexo-theme-fluid">Fluid</a> 等的功能还是太少了😇，于是决定魔改一下它。</p>
<p>​    这篇博客记录了给这个主题添加的各种功能。</p>
<h1 id="%E6%AD%A3%E6%96%87" tabindex="-1">正文</h1>
<h2 id="%E7%AB%99%E5%86%85%E6%90%9C%E7%B4%A2" tabindex="-1" id="站内搜索">站内搜索</h2>
<blockquote>
<p>​    博客里 bb 了太多东西，考虑加一个站内搜索方便检索一下之前的文章。</p>
</blockquote>
<h3 id="hexo-generator-search" tabindex="-1" id="hexo-generator-search">hexo-generator-search</h3>
<p>​    安装完 <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search">hexo-generator-search</a> 插件后，<code>hexo g</code> 就会在 <code>public</code> 文件夹下创建 <code>./search.xml</code>，这会把所有博客的文章内容整合进去。</p>
<p><img src="01.png" alt="png"></p>
<h3 id="%E5%90%8E%E7%AB%AF%EF%BC%88%E7%AE%97%E6%98%AF%E5%90%A7%EF%BC%89" tabindex="-1" id="后端（算是吧）">后端（算是吧）</h3>
<p>​    接下来就是靠 JS 如何检索文章。Butterfly 已经有自带检索文章的功能了，研究了一会儿没研究出怎么把代码偷下来……找到了一个从零配置搜索功能的文章：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://yansheng836.github.io/article/915f21c1.html">hexo+yilia 集成本地搜索 | 荷塘月色的博客 (yansheng836.github.io)</a></li>
</ul>
<p>​    核心就是下面这个 <code>search.js</code> 了，魔改一下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// search.js</span><br><span class="hljs-comment">// A local search script with the help of hexo-generator-search</span><br><span class="hljs-comment">// Copyright (C) 2015 </span><br><span class="hljs-comment">// Joseph Pan &lt;http://github.com/wzpan&gt;</span><br><span class="hljs-comment">// Shuhao Mao &lt;http://github.com/maoshuhao&gt;</span><br><span class="hljs-comment">// This library is free software; you can redistribute it and/or modify</span><br><span class="hljs-comment">// it under the terms of the GNU Lesser General Public License as</span><br><span class="hljs-comment">// published by the Free Software Foundation; either version 2.1 of the</span><br><span class="hljs-comment">// License, or (at your option) any later version.</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// This library is distributed in the hope that it will be useful, but</span><br><span class="hljs-comment">// WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="hljs-comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span><br><span class="hljs-comment">// Lesser General Public License for more details.</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// You should have received a copy of the GNU Lesser General Public</span><br><span class="hljs-comment">// License along with this library; if not, write to the Free Software</span><br><span class="hljs-comment">// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span><br><span class="hljs-comment">// 02110-1301 USA</span><br><br><span class="hljs-keyword">var</span> searchFunc = <span class="hljs-keyword">function</span> (<span class="hljs-params">path, search_id, content_id, match_count_id</span>) &#123;<br>    $.<span class="hljs-title function_">ajax</span>(&#123;<br>        <span class="hljs-attr">url</span>: path,<br>        <span class="hljs-attr">dataType</span>: <span class="hljs-string">&quot;xml&quot;</span>,<br>        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">xmlResponse</span>) &#123;<br>            <span class="hljs-comment">// get the contents from search data</span><br>            <span class="hljs-keyword">var</span> datas = $(<span class="hljs-string">&quot;entry&quot;</span>, xmlResponse).<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-keyword">return</span> &#123;<br>                    <span class="hljs-attr">title</span>: $(<span class="hljs-string">&quot;title&quot;</span>, <span class="hljs-variable language_">this</span>).<span class="hljs-title function_">text</span>(),<br>                    <span class="hljs-attr">content</span>: $(<span class="hljs-string">&quot;content&quot;</span>, <span class="hljs-variable language_">this</span>).<span class="hljs-title function_">text</span>(),<br>                    <span class="hljs-attr">url</span>: $(<span class="hljs-string">&quot;url&quot;</span>, <span class="hljs-variable language_">this</span>).<span class="hljs-title function_">text</span>()<br>                &#125;;<br>            &#125;).<span class="hljs-title function_">get</span>();<br>            <span class="hljs-keyword">var</span> $input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(search_id);<br>            <span class="hljs-keyword">var</span> $resultContent = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(content_id);<br>            $input.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;input&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;&lt;ul class=\&quot;search-result-list\&quot;&gt;&#x27;</span>;<br>                <span class="hljs-keyword">var</span> keywords = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/[\s\-]+/</span>);  <span class="hljs-comment">// .toLowerCase().split(/[\s\-]+/);</span><br>                $resultContent.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;&quot;</span>;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> &lt;= <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(match_count_id).<span class="hljs-property">textContent</span> = <span class="hljs-string">&quot;&quot;</span>;<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br>                <span class="hljs-comment">// perform local searching</span><br>                datas.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>                    <span class="hljs-keyword">var</span> isMatch = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-keyword">if</span> (!data.<span class="hljs-property">title</span> || data.<span class="hljs-property">title</span>.<span class="hljs-title function_">trim</span>() === <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>                        data.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;Untitled&quot;</span>;<br>                    &#125;<br>                    <span class="hljs-keyword">var</span> data_title = data.<span class="hljs-property">title</span>.<span class="hljs-title function_">trim</span>();<span class="hljs-comment">//.toLowerCase();</span><br>                    <span class="hljs-keyword">var</span> data_content = data.<span class="hljs-property">content</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;[^&gt;]+&gt;/g</span>, <span class="hljs-string">&quot;&quot;</span>);<span class="hljs-comment">//.toLowerCase();</span><br>                    <span class="hljs-keyword">var</span> data_url = data.<span class="hljs-property">url</span>;<br>                    <span class="hljs-keyword">var</span> index_title = -<span class="hljs-number">1</span>;<br>                    <span class="hljs-keyword">var</span> index_content = -<span class="hljs-number">1</span>;<br>                    <span class="hljs-keyword">var</span> first_occur = -<span class="hljs-number">1</span>;<br>                    <span class="hljs-comment">// only match artiles with not empty contents</span><br>                    <span class="hljs-keyword">if</span> (data_content !== <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>                        keywords.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">keyword, i</span>) &#123;<br>                            index_title = data_title.<span class="hljs-title function_">indexOf</span>(keyword);<br>                            index_content = data_content.<span class="hljs-title function_">indexOf</span>(keyword);<br><br>                            <span class="hljs-keyword">if</span> (index_title &lt; <span class="hljs-number">0</span> &amp;&amp; index_content &lt; <span class="hljs-number">0</span>) &#123;<br>                                isMatch = <span class="hljs-literal">false</span>;<br>                            &#125; <span class="hljs-keyword">else</span> &#123;<br>                                <span class="hljs-keyword">if</span> (index_content &lt; <span class="hljs-number">0</span>) &#123;<br>                                    index_content = <span class="hljs-number">0</span>;<br>                                &#125;<br>                                <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>) &#123;<br>                                    first_occur = index_content;<br>                                &#125;<br>                                <span class="hljs-comment">// content_index.push(&#123;index_content:index_content, keyword_len:keyword_len&#125;);</span><br>                            &#125;<br>                        &#125;);<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        isMatch = <span class="hljs-literal">false</span>;<br>                    &#125;<br>                    <span class="hljs-comment">// show search results</span><br>                    <span class="hljs-keyword">if</span> (isMatch) &#123;<br>                        str += <span class="hljs-string">&quot;&lt;li&gt;&lt;a href=&#x27;&quot;</span> + data_url +<br>                            <span class="hljs-string">&quot;&#x27; class=&#x27;search-result-title&#x27;&gt;&quot;</span> + data_title + <span class="hljs-string">&quot;&lt;/a&gt;&quot;</span>;<br>                        <span class="hljs-keyword">var</span> content = data.<span class="hljs-property">content</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;[^&gt;]+&gt;/g</span>, <span class="hljs-string">&quot;&quot;</span>);<br>                        <span class="hljs-keyword">if</span> (first_occur &gt;= <span class="hljs-number">0</span>) &#123;<br>                            <span class="hljs-comment">// cut out 100 characters</span><br>                            <span class="hljs-keyword">var</span> start = first_occur - <span class="hljs-number">20</span>;<br>                            <span class="hljs-keyword">var</span> end = first_occur + <span class="hljs-number">80</span>;<br>                            <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span>) &#123;<br>                                start = <span class="hljs-number">0</span>;<br>                            &#125;<br>                            <span class="hljs-keyword">if</span> (start == <span class="hljs-number">0</span>) &#123;<br>                                end = <span class="hljs-number">100</span>;<br>                            &#125;<br>                            <span class="hljs-keyword">if</span> (end &gt; content.<span class="hljs-property">length</span>) &#123;<br>                                end = content.<span class="hljs-property">length</span>;<br>                            &#125;<br>                            <span class="hljs-keyword">var</span> match_content = content.<span class="hljs-title function_">substr</span>(start, end);<br>                            <span class="hljs-comment">// highlight all keywords</span><br>                            keywords.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">keyword</span>) &#123;<br>                                <span class="hljs-keyword">var</span> regS = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(keyword, <span class="hljs-string">&quot;gi&quot;</span>);<br>                                match_content = match_content.<span class="hljs-title function_">replace</span>(regS,<br>                                    <span class="hljs-string">&quot;&lt;em class=\&quot;search-keyword\&quot;&gt;&quot;</span> +<br>                                    keyword + <span class="hljs-string">&quot;&lt;/em&gt;&quot;</span>);<br>                            &#125;);<br>                            str += <span class="hljs-string">&quot;&lt;p class=\&quot;search-result\&quot;&gt;&quot;</span> + match_content +<br>                                <span class="hljs-string">&quot;...&lt;/p&gt;&quot;</span><br>                        &#125;<br>                        str += <span class="hljs-string">&quot;&lt;/li&gt;&quot;</span>;<br>                    &#125;<br>                &#125;);<br>                str += <span class="hljs-string">&quot;&lt;/ul&gt;&quot;</span>;<br>                <span class="hljs-keyword">if</span> (str.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;&lt;li&gt;&#x27;</span>) === -<span class="hljs-number">1</span>) &#123;<br>                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(match_count_id).<span class="hljs-property">textContent</span> = <span class="hljs-string">&quot;&quot;</span>;<br>                    <span class="hljs-keyword">return</span> $resultContent.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;&lt;ul&gt;&lt;span class=&#x27;local-search-empty&#x27;&gt;没有找到内容，更换下搜索词试试吧~&lt;span&gt;&lt;/ul&gt;&quot;</span>;<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(match_count_id).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;匹配到 &lt;b&gt;&lt;font size=\&quot;5px\&quot;&gt;&lt;font color=\&quot;#424242\&quot;&gt;&quot;</span> + str.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/&lt;li&gt;/g</span>).<span class="hljs-property">length</span> + <span class="hljs-string">&quot;&lt;/font&gt;&lt;/font&gt;&lt;/b&gt; 个结果。&quot;</span>;<br>                &#125;<br>                $resultContent.<span class="hljs-property">innerHTML</span> = str;<br>            &#125;);<br>        &#125;<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​    大致意思就是读取输入框 <code>search_id</code> 里的内容，从 <code>path</code>（<code>./search.xml</code>）检索内容，将检索到的内容和计数分别以列表形式追加到 <code>content_id</code> 和 <code>match_count_id</code> 中。</p>
<h3 id="%E5%89%8D%E7%AB%AF" tabindex="-1" id="前端">前端</h3>
<h4 id="search.ejs" tabindex="-1" id="search-ejs">search.ejs</h4>
<p>​    OK，后端就是这样，接下来写前端 <code>search.ejs</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;div class=&quot;page-header&quot;&gt;<br>  &lt;div class=&quot;search-dialog&quot;&gt;<br>    &lt;span id=&quot;local-search&quot; class=&quot;local-search local-search-plugin&quot;&gt;<br>      &lt;h2&gt;站内搜索&lt;/h2&gt;<br>      &lt;div class=&quot;local-search-input-box&quot;&gt;<br>        &lt;img class=&quot;search_icon&quot; src=&quot;&lt;%- theme.icon.search %&gt;&quot; /&gt;<br>        &lt;input type=&quot;search&quot; placeholder=&quot;输入关键字以搜索……&quot; id=&quot;local-search-input&quot; class=&quot;local-search-input-cls&quot; /&gt;<br>      &lt;/div&gt;<br>      &lt;div id=&quot;local-search-result&quot; class=&quot;local-search-result-cls&quot;&gt;&lt;/div&gt;<br>      &lt;hr&gt;&lt;/hr&gt;<br>      &lt;p id=&quot;local-search-match-count&quot; class=&quot;local-search-match-count&quot;&gt;&lt;/p&gt;<br>    &lt;/span&gt;<br>  &lt;/div&gt;<br>  &lt;script&gt;<br>    if ($(&#x27;.local-search&#x27;).size()) &#123;<br>      $.getScript(&#x27;/js/search.js&#x27;, function () &#123;<br>        searchFunc(&#x27;/search.xml&#x27;, &#x27;local-search-input&#x27;, &#x27;local-search-result&#x27;, &#x27;local-search-match-count&#x27;)<br>      &#125;)<br>    &#125;<br>  &lt;/script&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure>
<h4 id="search.css" tabindex="-1" id="search-css">search.css</h4>
<p>​    <code>search.css</code> 设计一下布局：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.page-header</span>&#123;<br>    <span class="hljs-attribute">display</span>: flex;<br>    <span class="hljs-attribute">align-items</span>: center; <span class="hljs-comment">/* 在垂直方向上居中对齐子元素 */</span><br>&#125;<br><span class="hljs-selector-class">.local-search</span> &#123;<br>    <span class="hljs-attribute">position</span>: relative;<br>    <span class="hljs-attribute">text-align</span>: left;<br>    <span class="hljs-attribute">display</span>: grid;<br>&#125;<br><span class="hljs-selector-class">.local-search-input-box</span> &#123;<br>    <span class="hljs-attribute">display</span>: flex; <br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">24px</span>;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> <span class="hljs-number">10px</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">4px</span> <span class="hljs-number">12px</span>;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">20px</span>;<br>    <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#898fa0</span>;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#666</span>;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;<br>    <span class="hljs-attribute">align-items</span>: center; <span class="hljs-comment">/* 在垂直方向上居中对齐子元素 */</span><br>&#125;<br><span class="hljs-selector-class">.local-search-input-cls</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-comment">/* margin: 10px 0; */</span><br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#12183A</span>;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;<br>    <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">0.6em</span>;<br>    <span class="hljs-attribute">border</span>: none;<br>    <span class="hljs-attribute">outline</span>:none;<br>&#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.search-result-title</span> &#123;<br>    <span class="hljs-attribute">display</span>: flow <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">width</span>: auto <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">height</span>: auto <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-class">.local-search-result-cls</span> &#123;<br>    <span class="hljs-attribute">overflow-y</span>: overlay;<br>    <span class="hljs-attribute">max-height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">80vh</span> - <span class="hljs-number">200px</span>);<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>) &#123;<br>    <span class="hljs-selector-class">.local-search-result-cls</span> &#123;<br>        <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> <span class="hljs-number">10px</span>;<br>    &#125;<br>&#125;<br><span class="hljs-selector-class">.local-search-empty</span> &#123;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#888</span>;<br>    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">44px</span>;<br>    <span class="hljs-attribute">text-align</span>: center;<br>    <span class="hljs-attribute">display</span>: block;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;<br>    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;<br>&#125;<br><span class="hljs-selector-class">.local-search-result-cls</span> <span class="hljs-selector-tag">ul</span> &#123;<br>    <span class="hljs-attribute">min-width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">max-width</span>: <span class="hljs-number">900px</span>;<br>    <span class="hljs-attribute">max-height</span>: <span class="hljs-number">600px</span>;<br>    <span class="hljs-attribute">min-height</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">height</span>: auto;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">15px</span> <span class="hljs-number">5px</span> <span class="hljs-number">15px</span> <span class="hljs-number">20px</span>;<br>    <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">30px</span>;<br>&#125;<br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>) &#123;<br>    <span class="hljs-selector-class">.local-search-result-cls</span> <span class="hljs-selector-tag">ul</span> &#123;<br>        <span class="hljs-attribute">min-width</span>: auto;<br>        <span class="hljs-attribute">max-width</span>: max-content;<br>        <span class="hljs-attribute">max-height</span>: <span class="hljs-number">70vh</span>;<br>        <span class="hljs-attribute">min-height</span>: auto;<br>        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">10px</span> <span class="hljs-number">10px</span> <span class="hljs-number">10px</span>;<br>    &#125;<br>&#125;<br><span class="hljs-selector-class">.local-search-result-cls</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> &#123;<br>    <span class="hljs-attribute">text-align</span>: left;<br>    <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#bdb7b7</span>;<br>    <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;<br>    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">30px</span>;<br>    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;<br>&#125;<br><span class="hljs-selector-class">.local-search-result-cls</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:last-child</span> &#123;<br>    <span class="hljs-attribute">border-bottom</span>: none;<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-selector-class">.local-search-result-cls</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-tag">a</span> &#123;<br>    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">20px</span>;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;<br>    <span class="hljs-attribute">text-decoration</span>: none;<br>    <span class="hljs-attribute">transition</span>: all .<span class="hljs-number">3s</span>;<br>    <span class="hljs-attribute">font-weight</span>: bold;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#12183A</span>;<br>&#125;<br><span class="hljs-selector-class">.local-search-result-cls</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> &#123;<br>    <span class="hljs-attribute">text-decoration</span>:underline;<br>&#125;<br><span class="hljs-selector-class">.local-search-result-cls</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-tag">p</span> &#123;<br>    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;<br>    <span class="hljs-attribute">max-height</span>: <span class="hljs-number">124px</span>;<br>    <span class="hljs-attribute">overflow</span>: hidden;<br>&#125;<br><span class="hljs-selector-class">.local-search-result-cls</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-tag">em</span><span class="hljs-selector-class">.search-keyword</span> &#123;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#00F</span>;<br>    <span class="hljs-attribute">font-weight</span>:bold;<br>    <span class="hljs-attribute">font-style</span>: normal;<br>&#125;<br><br><span class="hljs-selector-class">.search_icon</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">14px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">14px</span>;<br>&#125;<br><span class="hljs-selector-class">.search-dialog</span> &#123;<br>    <span class="hljs-attribute">display</span>: block;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">64px</span> <span class="hljs-number">80px</span> <span class="hljs-number">20px</span> <span class="hljs-number">80px</span>;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-attribute">align-items</span>: center; <span class="hljs-comment">/* 在垂直方向上居中对齐子元素 */</span><br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;<br>&#125;<br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>) &#123;<br>    <span class="hljs-selector-class">.search-dialog</span> &#123;<br>      <span class="hljs-attribute">box-sizing</span>: border-box;<br>      <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;<br>      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">padding</span>: <span class="hljs-number">50px</span> <span class="hljs-number">15px</span> <span class="hljs-number">20px</span> <span class="hljs-number">15px</span>;<br>    &#125;<br>&#125;<br><span class="hljs-selector-class">.local-search-match-count</span>&#123;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span> <span class="hljs-number">20px</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#12183A</span>;<br>&#125;<br><span class="hljs-selector-class">.search-dialog</span> <span class="hljs-selector-tag">h2</span>&#123;<br>    <span class="hljs-attribute">display</span>: inline-block;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#424242</span>;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.7rem</span>;<br>&#125;<br><span class="hljs-selector-class">.search-close-button</span><span class="hljs-selector-pseudo">:hover</span> &#123;<br>    <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">brightness</span>(<span class="hljs-number">120%</span>);<br>&#125;<br><span class="hljs-selector-id">#local-search</span> <span class="hljs-selector-class">.search-dialog</span> <span class="hljs-selector-class">.local-search-box</span> &#123;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;<br>    <span class="hljs-attribute">max-width</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>&#125;<br><span class="hljs-selector-class">.custom-hr</span>, <span class="hljs-selector-class">.search-dialog</span> hr &#123;<br>    <span class="hljs-attribute">position</span>: relative;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;<br>    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> dashed <span class="hljs-number">#bdb7b7</span>;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">4px</span>);<br>&#125;<br><span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[type=<span class="hljs-string">&quot;search&quot;</span>]</span>::-webkit-search-cancel-button &#123;<br>    -webkit-<span class="hljs-attribute">appearance</span>: none;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">/images/close.png</span>) no-repeat;<br>    <span class="hljs-attribute">background-size</span>: contain;<br>&#125;<br><span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[type=<span class="hljs-string">&quot;search&quot;</span>]</span>::-webkit-search-cancel-button:hover &#123;<br>    <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">brightness</span>(<span class="hljs-number">120%</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="%E9%83%A8%E7%BD%B2" tabindex="-1" id="部署">部署</h4>
<p><code>index.less</code> 导入 css：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-keyword">@import</span> <span class="hljs-string">&quot;./plugin/search.css&quot;</span>;<br></code></pre></td></tr></table></figure>
<p>​    我把这个搜索模块放到了统计页面下 <code>grouping</code> 前，看起来还不错，然后设置一个开关控制这个功能是否启用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;% if(theme.search &amp;&amp; is_archive()) &#123; %&gt;<br>    &lt;%- partial(&#x27;_widget/search&#x27;) %&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure>
<h3 id="%E6%BC%94%E7%A4%BA" tabindex="-1" id="演示">演示</h3>
<p>​    本地是秒出结果的，部署上去的话会比较卡，乱输的话还会崩溃 emmm 手机试了下没加载成功……果然还是 bb 太多了。</p>
<p><img src="02.png" alt="png"></p>
<h2 id="%E7%BF%BB%E9%A1%B5%E5%8A%9F%E8%83%BD%E6%94%B9%E8%BF%9B" tabindex="-1" id="翻页功能改进">翻页功能改进</h2>
<blockquote>
<p>​    这个主题只能提供上一页和下一页两个翻页功能，一页一页地翻效率太低了，不适合这个目前 bb 了 28 页的的博客，修改一下。</p>
</blockquote>
<h3 id="%E6%96%B9%E6%B3%95%E8%AE%BA" tabindex="-1" id="方法论">方法论</h3>
<p>​    hexo 渲染博客会根据文章数量进行分页。查一下 API：<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/variables.html">变量 | Hexo</a>：</p>
<table>
<thead>
<tr>
<th style="text-align:left">变量</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>page.per_page</code></td>
<td style="text-align:left">每页显示的文章数量</td>
<td style="text-align:left"><code>number</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.total</code></td>
<td style="text-align:left">总页数</td>
<td style="text-align:left"><code>number</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.current</code></td>
<td style="text-align:left">目前页数</td>
<td style="text-align:left"><code>number</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.current_url</code></td>
<td style="text-align:left">目前分页的网址</td>
<td style="text-align:left"><code>string</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.posts</code></td>
<td style="text-align:left">本页文章 (<a target="_blank" rel="noopener" href="https://hexojs.github.io/warehouse/">Data Model</a>)</td>
<td style="text-align:left"><code>object</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.prev</code></td>
<td style="text-align:left">上一页的页数。如果此页是第一页的话则为 <code>0</code>。</td>
<td style="text-align:left"><code>number</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.prev_link</code></td>
<td style="text-align:left">上一页的网址。如果此页是第一页的话则为 <code>''</code>。</td>
<td style="text-align:left"><code>string</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.next</code></td>
<td style="text-align:left">下一页的页数。如果此页是最后一页的话则为 <code>0</code>。</td>
<td style="text-align:left"><code>number</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.next_link</code></td>
<td style="text-align:left">下一页的网址。如果此页是最后一页的话则为 <code>''</code>。</td>
<td style="text-align:left"><code>string</code></td>
</tr>
<tr>
<td style="text-align:left"><code>page.path</code></td>
<td style="text-align:left">当前页面的路径（不含根目录）。我们通常在主题中使用 <code>url_for(page.path)</code>。</td>
<td style="text-align:left"><code>string</code></td>
</tr>
</tbody>
</table>
<p>​    对于首页（<code>index</code>），有 <code>page.prev_link</code> 和 <code>page.next_link</code> 两个变量可以使用，所以实现上一页和下一页的功能是比较容易的。</p>
<p>​    但要是想翻到其它页，得使用其它变量了。</p>
<p>​    观察网站的网址。除了第 1 页的网址是 <code>/</code>，其他都是 <code>/page/X</code>。</p>
<p>​    所以根据 <code>page.current</code> 和 <code>page.total</code> 足以写出翻页逻辑了，设置一个变量 <code>pagination</code> 控制左右显示的页数。</p>
<h3 id="%E4%BB%A3%E7%A0%81" tabindex="-1" id="代码">代码</h3>
<h4 id="home.ejs" tabindex="-1" id="home-ejs">home.ejs</h4>
<p>​    修改 <code>home.ejs</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;div class=&quot;change-page&quot;&gt;<br>    &lt;div class=&quot;change-page&quot;&gt;<br>        &lt;% if(page.prev !==0 &amp;&amp; theme.pagination !== 1)&#123; // 前一页 %&gt;<br>            &lt;div class=&quot;page&quot;&gt;<br>                &lt;a href=&quot;&lt;%- url_for(page.prev_link) %&gt;&quot;&gt;<br>                    &lt;div class=&quot;box&quot;&gt;<br>                        &amp;#60;<br>                    &lt;/div&gt;<br>                &lt;/a&gt;<br>            &lt;/div&gt;<br>        &lt;% &#125; %&gt;<br>        &lt;% if (page.current &gt; theme.pagination + 1) &#123; %&gt;<br>            &lt;div class=&quot;page&quot;&gt;<br>              &lt;a href=&quot;&lt;%- url_for(&#x27;/&#x27;) %&gt;&quot;&gt;<br>                &lt;div class=&quot;box&quot;&gt;1<br>                &lt;/div&gt;<br>              &lt;/a&gt;<br>            &lt;/div&gt;<br>            &lt;div class=&quot;page&quot;&gt;<br>                &lt;div class=&quot;ellipsis&quot;&gt;<br>                    &lt;div class=&quot;box&quot;&gt;...&lt;/div&gt;<br>                &lt;/div&gt;<br>            &lt;/div&gt;<br>        &lt;% &#125; %&gt;<br>        &lt;% for(var i = page.current - theme.pagination; i &lt;= page.current + theme.pagination; i++)&#123; %&gt;<br>          &lt;% if(i &gt;= 1 &amp;&amp; i &lt;= page.total)&#123; %&gt;<br>            &lt;% if(i === page.current)&#123; %&gt;<br>                &lt;div class=&quot;page&quot;&gt;<br>                    &lt;div class=&quot;box&quot;&gt;<br>                       &lt;%= i %&gt;<br>                    &lt;/div&gt;<br>                &lt;/div&gt;<br>            &lt;% &#125; else &#123; %&gt;<br>              &lt;div class=&quot;page&quot;&gt;<br>                &lt;a href=&quot;&lt;%- i=== 1 ? &#x27;/&#x27; : url_for(&#x27;/page/&#x27; + i + &#x27;/&#x27;) %&gt;&quot;&gt;<br>                  &lt;div class=&quot;box&quot;&gt;<br>                    &lt;%= i %&gt;<br>                  &lt;/div&gt;<br>                &lt;/a&gt;<br>              &lt;/div&gt;<br>            &lt;% &#125; %&gt;<br>          &lt;% &#125; %&gt;<br>        &lt;% &#125; %&gt;<br>        &lt;% if (page.total - page.current &gt; theme.pagination) &#123; %&gt;<br>            &lt;div class=&quot;page&quot;&gt;<br>                &lt;div class=&quot;ellipsis&quot;&gt;<br>                    &lt;div class=&quot;box&quot;&gt;...&lt;/div&gt;<br>                &lt;/div&gt;<br>              &lt;/div&gt;<br>            &lt;div class=&quot;page&quot;&gt;<br>              &lt;a href=&quot;&lt;%- page.total === 1 ? &#x27;/&#x27; : url_for(&#x27;/page/&#x27; + page.total + &#x27;/&#x27;) %&gt; %&gt;&quot;&gt;<br>                &lt;div class=&quot;box&quot;&gt;<br>                    &lt;%= page.total %&gt;<br>                &lt;/div&gt;<br>              &lt;/a&gt;<br>            &lt;/div&gt;<br>        &lt;% &#125; %&gt;<br>        &lt;% if(page.next !==0 &amp;&amp; theme.pagination !== 1)&#123; %&gt;<br>            &lt;div class=&quot;page&quot;&gt;<br>                &lt;a href=&quot;&lt;%- url_for(page.next_link) %&gt;&quot;&gt;<br>                    &lt;div class=&quot;box&quot;&gt;<br>                        &amp;#62;<br>                    &lt;/div&gt;<br>                &lt;/a&gt;<br>            &lt;/div&gt;<br>        &lt;% &#125; %&gt;<br>      &lt;/div&gt;		  <br>&lt;/div&gt;<br></code></pre></td></tr></table></figure>
<h4 id="home.less" tabindex="-1" id="home-less">home.less</h4>
<p>​    再调整 <code>home.less</code>：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.change-page</span> &#123;<br>    <span class="hljs-attribute">display</span>: inline;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#FFF</span>;<br>    <span class="hljs-selector-class">.box</span> &#123;<br>        <span class="hljs-attribute">background</span>: <span class="hljs-number">#006AFF</span>;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>;<br>        <span class="hljs-attribute">line-height</span>: <span class="hljs-number">40px</span>;<br>        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;<br>        <span class="hljs-attribute">margin</span>: <span class="hljs-number">8px</span>;<br>        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">40px</span> <span class="hljs-number">0</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>,<span class="hljs-number">50</span>,<span class="hljs-number">0.1</span>);<br>    &#125;<br>    <span class="hljs-selector-class">.ellipsis</span><br>    &#123;<br>        <span class="hljs-selector-class">.box</span> &#123;<br>            <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;<br>            <span class="hljs-attribute">color</span>: <span class="hljs-number">#898FA0</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-selector-class">.page</span> &#123;<br>        <span class="hljs-attribute">display</span>: inline-block;<br>        <span class="hljs-selector-tag">a</span> &#123;<br>            <span class="hljs-attribute">color</span>: @textColorTheme;<br>            <span class="hljs-attribute">text-decoration</span>: none;<br>            <span class="hljs-selector-class">.box</span> &#123;<br>                <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;<br>                <span class="hljs-attribute">color</span>: <span class="hljs-number">#898FA0</span>;<br>            &#125;<br>            <span class="hljs-selector-class">.box</span><span class="hljs-selector-pseudo">:hover</span> &#123;<br>                <span class="hljs-attribute">margin-top</span>: -<span class="hljs-number">15px</span>;<br>                <span class="hljs-attribute">cursor</span>: pointer;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="%E6%BC%94%E7%A4%BA-1" tabindex="-1" id="演示-2">演示</h3>
<p><img src="03.png" alt="png"></p>
<p>​    现在翻页不仅可以翻到上一页和下一页，还可以翻到首页、尾页以及周围的页数。如果周围的页数与首页和尾页不连续，添加省略号。</p>
<h2 id="%E9%A6%96%E9%A1%B5%E6%98%BE%E7%A4%BA-description" tabindex="-1" id="首页显示-description">首页显示 description</h2>
<blockquote>
<p>​    在主页文章的 description 以更好地展示这篇文章在大致在 bb 什么。</p>
</blockquote>
<p>​    这对加密的文档，<code>post.excerpt</code> 会一律显示“这里有东西被加密了，需要输入密码查看哦。”，大概是 <a target="_blank" rel="noopener" href="https://github.com/D0n9X1n/hexo-blog-encrypt?tab=readme-ov-file#encrypt-theme">hexo-blog-encrypt</a> 把 <code>post.excerpt</code> 给强行替换了，我想目前的解决的办法是换一个变量名称？所以按 Buteerfly 的样式将关键词改成了 description。</p>
<h3 id="%E4%BB%A3%E7%A0%81-1" tabindex="-1" id="代码-2">代码</h3>
<h4 id="home.ejs-1" tabindex="-1" id="home-ejs-2">home.ejs</h4>
<p>​    <code>home.ejs</code> 中找到 <code>post-block-content-info</code>，加上显示 <code>post.description</code> 的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;span class=&quot;post-block-content-info-description&quot;&gt;<br>    &lt;%= post.description %&gt;<br>&lt;/span&gt;<br></code></pre></td></tr></table></figure>
<h4 id="home.less-1" tabindex="-1" id="home-less-2">home.less</h4>
<p>​    <code>home.less</code> 修改样式：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-class">.post-card-description</span> &#123;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">16px</span>;<br>    <span class="hljs-attribute">text-align</span>: right;<br>    <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">1</span>;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;<br>    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;<br>    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">36px</span>;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="%E6%BC%94%E7%A4%BA-2" tabindex="-1" id="演示-3">演示</h3>
<p>​    最终演示：</p>
<p><img src="04.png" alt="png"></p>
<h2 id="%E4%BB%A3%E7%A0%81%E5%9D%97%E8%BE%85%E5%8A%A9" tabindex="-1" id="代码块辅助">代码块辅助</h2>
<blockquote>
<p>​    对于又臭又长的代码，设计复制代码按钮、显示代码语言和隐藏代码块三个实用功能。（借鉴自 Butterfly）</p>
</blockquote>
<h3 id="%E6%96%B9%E6%B3%95%E8%AE%BA-1" tabindex="-1" id="方法论-2">方法论</h3>
<p>​    这个主题在渲染 markdown 的代码块语句时，会把它渲染成下图所示的形式：</p>
<p><img src="05.png" alt="png"></p>
<h3 id="%E4%BB%A3%E7%A0%81-2" tabindex="-1" id="代码-3">代码</h3>
<h4 id="highlight_tools.ejs" tabindex="-1" id="highlight-tools-ejs">highlight_tools.ejs</h4>
<p>​    <code>highlight_tools.ejs</code> 把 <code>&lt;pre&gt;</code> 元素获取了，再把相关参数一并送给 <code>highlight_tools.js</code>：</p>
<blockquote>
<p>感觉这么写代码有点不规范，先这样吧！</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;%- js(&#x27;js/widget/highlight_tools.js&#x27;) %&gt;<br>&lt;script&gt;<br>    var codeBlocks = document.querySelectorAll(&#x27;pre&#x27;);<br>    createHighlightTools(codeBlocks, &quot;&lt;%= theme.icon.copy %&gt;&quot;, &quot;&lt;%= theme.icon.close_code_block %&gt;&quot;, &quot;&lt;%= page.highlight_shrink %&gt;&quot;, &quot;&lt;%= page.highlight_height_limit %&gt;&quot;); // 调用函数并传递参数<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<h4 id="highlight_tools.js" tabindex="-1" id="highlight-tools-js">highlight_tools.js</h4>
<h5 id="function-createhighlighttools()" tabindex="-1" id="function-createHighlightTools">function createHighlightTools()</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createHighlightTools</span>(<span class="hljs-params">codeBlocks, copyIcon, closeCodeBlockIcon, highlightShrink, HighlightHeightLimit</span>) &#123;<br>    codeBlocks.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">codeBlock</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!codeBlock.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;code&#x27;</span>))<br>            <span class="hljs-keyword">return</span>;<br>        <span class="hljs-keyword">var</span> container = <span class="hljs-title function_">createContainer</span>(codeBlock);<br>        <span class="hljs-title function_">createCopyButton</span>(container, codeBlock, copyIcon);<br>        <span class="hljs-title function_">createCodeLangText</span>(container, codeBlock);<br>        <span class="hljs-title function_">createCloseCodeBlockButton</span>(container, codeBlock, closeCodeBlockIcon, highlightShrink);<br>        <span class="hljs-title function_">setHighlightHeightLimit</span>(codeBlock, <span class="hljs-title class_">HighlightHeightLimit</span>);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​    先找找这个 <code>&lt;pre&gt;</code> 有没有 <code>&lt;code&gt;</code> 这个子元素，防止误判。</p>
<ul>
<li><code>createContainer()</code> 给代码块顶端包一层，用于放置 UI。</li>
</ul>
<p>​    然后依次实现三个功能：</p>
<ul>
<li><code>createCopyButton()</code>：创建复制按钮</li>
<li><code>createCodeLangText()</code>：代码语言提示文本</li>
<li><code>createCloseCodeBlockButton()</code>：关闭代码块功能</li>
</ul>
<h5 id="function-createcontainer()" tabindex="-1" id="function-createContainer">function createContainer()</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createContainer</span>(<span class="hljs-params">codeBlock</span>) &#123;<br>    <span class="hljs-comment">// 创建包裹代码块和按钮的容器元素</span><br>    <span class="hljs-keyword">var</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br>    container.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;hightlight-tools&#x27;</span>;<br>    <span class="hljs-comment">// 将容器元素插入到代码块之前</span><br>    codeBlock.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">insertBefore</span>(container, codeBlock);<br>    <span class="hljs-keyword">return</span> container;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​    这样，在代码块上方就会多一个 <code>&lt;div class=&quot;highlight_tools&quot;&gt;</code>。</p>
<p><img src="06.png" alt="png"></p>
<h5 id="function-createcopybutton()" tabindex="-1" id="function-createCopyButton">function createCopyButton()</h5>
<p>​    之前找的大都要我去引用一个叫 <code>clipboard.js</code> 的东西，结果下载下来引用报错，找了一个不需要插件的代码：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2316793">添加 CopyCode（复制代码）功能-腾讯云开发者社区-腾讯云 (tencent.com)</a></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createCopyButton</span>(<span class="hljs-params">container, codeBlock, icon</span>) &#123;<br>    <span class="hljs-keyword">var</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br>    button.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;copy-button&#x27;</span>;<br>    button.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;button&#x27;</span>;<br>    button.<span class="hljs-property">title</span> = <span class="hljs-string">&#x27;copy-button&#x27;</span>;<br>    button.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundImage</span> = <span class="hljs-string">&#x27;url(&quot;&#x27;</span> + icon + <span class="hljs-string">&#x27;&quot;)&#x27;</span>;<br>    <span class="hljs-comment">// 将按钮添加到容器元素内</span><br>    container.<span class="hljs-title function_">appendChild</span>(button);<br>    <span class="hljs-comment">// 创建提示文字</span><br>    <span class="hljs-comment">// 创建 &lt;span&gt; 元素</span><br>    <span class="hljs-keyword">var</span> span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;span&#x27;</span>);<br>    span.<span class="hljs-property">textContent</span> = <span class="hljs-string">&quot;已复制&quot;</span>;<br>    <span class="hljs-comment">// 添加类名</span><br>    span.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;copy-notice&#x27;</span>;<br>    <span class="hljs-comment">// 将文字添加到容器元素内</span><br>    container.<span class="hljs-title function_">appendChild</span>(span);<br><br>    button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// 获取代码块的文本内容，包括换行符</span><br>        <span class="hljs-keyword">var</span> code = codeBlock.<span class="hljs-property">innerText</span>;<br>        <span class="hljs-comment">// 创建一个临时的 textarea 元素，并将代码块的内容设置为其值</span><br>        <span class="hljs-keyword">var</span> textarea = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;textarea&#x27;</span>);<br>        textarea.<span class="hljs-property">value</span> = code;<br>        <span class="hljs-comment">// 将 textarea 元素追加到 body 中</span><br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(textarea);<br>        <span class="hljs-comment">// 选中 textarea 中的文本</span><br>        textarea.<span class="hljs-title function_">select</span>();<br>        <span class="hljs-comment">// 执行复制操作</span><br>        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class="hljs-string">&#x27;copy&#x27;</span>);<br>        <span class="hljs-comment">// 移除临时的 textarea 元素</span><br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(textarea);<br>        <span class="hljs-comment">// 已复制</span><br>        span.<span class="hljs-property">style</span>.<span class="hljs-property">opacity</span> = <span class="hljs-number">1</span>;<br>        <span class="hljs-comment">// 2 秒后将目标元素的透明度设置为 0</span><br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            span.<span class="hljs-property">style</span>.<span class="hljs-property">opacity</span> = <span class="hljs-number">0</span>;<br>        &#125;, <span class="hljs-number">1000</span>);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​    原文中获取代码内容的代码为 <code>var code = codeBlock.textContent;</code> 这么做会舍弃换行符，应改为 <code>var code = codeBlock.innerText;</code>。</p>
<p>​    同时加上”已复制“的提示文本。</p>
<h5 id="function-createcodelangtext()" tabindex="-1" id="function-createCodeLangText">function createCodeLangText()</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createCodeLangText</span>(<span class="hljs-params">container, codeBlock</span>) &#123;<br>    <span class="hljs-comment">// 创建提示文字</span><br>    <span class="hljs-comment">// 创建 &lt;span&gt; 元素</span><br>    <span class="hljs-keyword">var</span> span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;span&#x27;</span>);<br>    span.<span class="hljs-property">textContent</span> = codeBlock.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.hljs&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;hljs &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-title function_">toUpperCase</span>();  <span class="hljs-comment">// 代码语言</span><br>    <span class="hljs-keyword">if</span> (span.<span class="hljs-property">textContent</span> === <span class="hljs-string">&#x27;EBNF&#x27;</span>)<br>        span.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-comment">// 添加类名</span><br>    span.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;code-lang&#x27;</span>;<br>    <span class="hljs-comment">// 将文字添加到容器元素内</span><br>    container.<span class="hljs-title function_">appendChild</span>(span);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​    获取 <code>hljs</code> 类中另一个类的名称，即为代码语言。如果 markdown 中没有设置代码语言，会渲染成 <code>ebnf</code> 类，把它替换为空。</p>
<h5 id="function-createclosecodeblockbutton()" tabindex="-1" id="function-createCloseCodeBlockButton">function createCloseCodeBlockButton()</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createCloseCodeBlockButton</span>(<span class="hljs-params">container, codeBlock, icon, highlight_shrink</span>)<br>&#123;<br>    <span class="hljs-keyword">var</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br>    button.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;close-code-block-button&#x27;</span>;<br>    button.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;button&#x27;</span>;<br>    button.<span class="hljs-property">title</span> = <span class="hljs-string">&#x27;close-code-block-button&#x27;</span>;<br>    button.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundImage</span> = <span class="hljs-string">&#x27;url(&quot;&#x27;</span> + icon + <span class="hljs-string">&#x27;&quot;)&#x27;</span>;<br>    <span class="hljs-comment">// 将按钮添加到容器元素内</span><br>    container.<span class="hljs-title function_">appendChild</span>(button);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Boolean</span>(highlight_shrink))<br>    &#123;<br>        <span class="hljs-keyword">var</span> hljs = codeBlock.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.hljs&#x27;</span>);<br>        button.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">&quot;rotate(-90deg)&quot;</span>;<br>        hljs.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&quot;closed&quot;</span>);<br>    &#125;<br>    button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> hljs = codeBlock.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.hljs&#x27;</span>);<br>        <span class="hljs-keyword">if</span> (!hljs.<span class="hljs-property">classList</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">&#x27;closed&#x27;</span>)) &#123;<br>            button.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">&quot;rotate(-90deg)&quot;</span>;<br>            hljs.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&quot;closed&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            button.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">&quot;rotate(0deg)&quot;</span>;<br>            hljs.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&quot;closed&quot;</span>);<br>        &#125;<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​    获取 <code>hljs</code>类，给它加一个 <code>closed</code>类，剩余的逻辑交给 css 吧。</p>
<p>​    文章新增参数 <code>highlight_shrink</code>，如果为 true，默认代码块就是关闭的。</p>
<h5 id="function-sethighlightheightlimit()" tabindex="-1" id="function-setHighlightHeightLimit">function setHighlightHeightLimit()</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setHighlightHeightLimit</span>(<span class="hljs-params">codeBlock, HighlightHeightLimit</span>)<br>&#123;<br>    <span class="hljs-comment">// 限制代码块最大长度</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">HighlightHeightLimit</span> != <span class="hljs-string">&quot;&quot;</span>)<br>    &#123;<br>        <span class="hljs-keyword">var</span> hljs = codeBlock.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.hljs&#x27;</span>);<br>        hljs.<span class="hljs-property">style</span>.<span class="hljs-property">maxHeight</span> = <span class="hljs-title class_">HighlightHeightLimit</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​    控制代码块最大长度。这个值由 <code>page.highlight_height_limit</code> 控制。</p>
<h4 id="highlight_tools.css" tabindex="-1" id="highlight-tools-css">highlight_tools.css</h4>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.hightlight-tools</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-number">#e6ebf1</span>;<br>    <span class="hljs-attribute">position</span>: relative;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">32px</span>;<br><br>    <span class="hljs-selector-class">.copy-notice</span> &#123;<br>        <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;<br>        <span class="hljs-attribute">position</span>: absolute;<br>        <span class="hljs-attribute">right</span>: <span class="hljs-number">30px</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;<br>        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">transition</span>: opacity <span class="hljs-number">0.4s</span>;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#b3b3b3</span>;<br>        -webkit-user-<span class="hljs-selector-tag">select</span>: none; <span class="hljs-comment">/* Safari */</span><br>        -moz-user-<span class="hljs-selector-tag">select</span>: none; <span class="hljs-comment">/* Firefox */</span><br>        -ms-user-<span class="hljs-selector-tag">select</span>: none; <span class="hljs-comment">/* IE 10+ */</span><br>        user-<span class="hljs-selector-tag">select</span>: none;<br>    &#125;<br><br>    <span class="hljs-selector-class">.copy-button</span> &#123;<br>        <span class="hljs-attribute">position</span>: absolute;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">18px</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">18px</span>;<br>        <span class="hljs-attribute">right</span>: <span class="hljs-number">6px</span>;<br>        <span class="hljs-attribute">border</span>: none;<br>        <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>        <span class="hljs-attribute">background-size</span>: cover;<br>        <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;<br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);<br>    &#125;<br><br>    <span class="hljs-selector-class">.copy-button</span><span class="hljs-selector-pseudo">:hover</span><br>    &#123;<br>        <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">brightness</span>(<span class="hljs-number">120%</span>);<br>    &#125;<br><br>    <span class="hljs-selector-class">.code-lang</span> &#123;<br>        <span class="hljs-attribute">font-weight</span>: bold;<br>        <span class="hljs-attribute">position</span>: absolute;<br>        <span class="hljs-attribute">left</span>: <span class="hljs-number">30px</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#b3b3b3</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.close-code-block-button</span> &#123;<br>        <span class="hljs-attribute">position</span>: absolute;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">16px</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">16px</span>;<br>        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">8px</span>;<br>        <span class="hljs-attribute">left</span>: <span class="hljs-number">6px</span>;<br>        <span class="hljs-attribute">border</span>: none;<br>        <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>        <span class="hljs-attribute">background-size</span>: cover;<br>        <span class="hljs-attribute">transition</span>: transform <span class="hljs-number">0.4s</span>;<br>    &#125;<br>&#125;<br><br>pre &#123;<br>    <span class="hljs-selector-class">.closed</span> &#123;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;<br>        <span class="hljs-attribute">overflow-y</span>: hidden;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="%E5%8F%B3%E8%BE%B9%E6%A0%8F%E5%8F%8A%E7%9B%AE%E5%BD%95" tabindex="-1" id="右边栏及目录">右边栏及目录</h2>
<blockquote>
<p>​    这个主题自带 toc 功能，用的是 hexo 自带的 toc 功能，但是啥布局也没写……就一直没用。</p>
<p>​    之前的目录一直用的是 <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2065866">hexo-toc</a> 插件，但是这只能放到文章的一个大片段里，不能随着阅读跟随，体验不太好。</p>
<p>​    决定重新设计一个目录架构，放到文章右侧并实时跟随。</p>
</blockquote>
<p>​    hexo-toc 插件跟 自带的 toc 冲突了，把它卸了。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm uninstall hexo-toc<br></code></pre></td></tr></table></figure>
<h3 id="%E6%96%B9%E6%B3%95%E8%AE%BA-2" tabindex="-1" id="方法论-3">方法论</h3>
<p>​    参考默认的 toc：<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/helpers.html#toc">辅助函数（Helpers）| Hexo</a></p>
<p>​    使用 <code>&lt;%- toc(page.content,&#123;list_number:false&#125;) %&gt;</code> 语句就会一阵输出目录的内容：</p>
<p><img src="07.png" alt="png"></p>
<p>​    对于 hexo 自带的 toc 功能，它会给所有标题添加 ID，ID 内容为标题的内容，同时生成连接 <code>#XXX</code>，使其可以跳转到目标位置。</p>
<p>​    对于放到网址会有歧义的字符，会用 <code>-</code> 替代（<code>hexo-toc</code> 直接删掉这个字符，我想这是这个插件跟默认的 toc 冲突的原因）。</p>
<p>​    对于重名的标题，会在后面追加 <code>-X</code> 作为区分。</p>
<p>​    <strong>但是这个自带的 toc 似乎有 bug，某些结构的目录并不会把所有的</strong> <code>&lt;li&gt;</code> <strong>都放在</strong>  <code>&lt;ol class=&quot;toc-child&quot;&gt;&lt;/ol&gt;</code> <strong>中，而且碰 hexo-blog-encrypt 就废了，所以我打算根据它默认生成的目录结构重写一份生成目录的逻辑。</strong></p>
<h3 id="%E4%BB%A3%E7%A0%81-3" tabindex="-1" id="代码-4">代码</h3>
<h4 id="rightside.ejs" tabindex="-1" id="rightside-ejs">rightside.ejs</h4>
<p>​    暂时把主题原来的 <code>goTop.ejs</code> 取代了换成侧边栏：<code>rightside.ejs</code>：</p>
<ul>
<li><code>hidden</code> 会让目录及其按钮隐藏起来，这是加密插件的存在而设计。</li>
<li><code>toc.js</code> 控制着目录生成的逻辑。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;%- js(&#x27;js/goto_position.js&#x27;) %&gt;<br>&lt;style&gt;<br>	.rightside-button-icon<br>	&#123;<br>		width: 18px;<br>		height: 18px;<br>		-webkit-user-select: none; /* Chrome, Safari, Opera */<br>        -moz-user-select: none; /* Firefox */<br>        -ms-user-select: none; /* Internet Explorer/Edge */<br>        user-select: none; /* Non-prefixed version, supported by most modern browsers */<br>	&#125;<br>&lt;/style&gt;<br><br>&lt;div style=&quot;z-index: 3; position: fixed; bottom: 10px; right: 20px; transition: all 0.5s ease-out;&quot; id=&quot;rightside&quot;&gt;<br>	&lt;% if(page.toc) &#123; %&gt;<br>		&lt;div class=&quot;post-toc hidden&quot; id=&quot;post-toc&quot;&gt;<br>			&lt;span class=&quot;post-toc-title&quot;&gt;导航&lt;/span&gt;<br>			&lt;ol class=&quot;toc&quot;&gt;&lt;/ol&gt;<br>		&lt;/div&gt;<br>		&lt;div class=&quot;rightside-button hidden&quot; id=&quot;js-toc&quot;&gt;<br>			&lt;span&gt;<br>				&lt;img src=&quot;&lt;%- theme.icon.toc %&gt;&quot; class=&quot;rightside-button-icon&quot; alt=&quot;Icon&quot;&gt;<br>			&lt;/span&gt;<br>		&lt;/div&gt;<br>		&lt;%- js(&#x27;js/toc.js&#x27;);%&gt;<br>		&lt;script&gt;<br>			initToc();<br>		&lt;/script&gt;<br>	&lt;% &#125; %&gt;<br>	&lt;div class=&quot;rightside-button&quot; id=&quot;js-go_top&quot;&gt;<br>		&lt;span&gt;<br>			&lt;img src=&quot;&lt;%- theme.icon.go_top %&gt;&quot; class=&quot;rightside-button-icon&quot; alt=&quot;Icon&quot;&gt;<br>		&lt;/span&gt;<br>	&lt;/div&gt;<br>	&lt;div class=&quot;rightside-button&quot; id=&quot;js-go_bottom&quot;&gt;<br>		&lt;span&gt;<br>			&lt;img src=&quot;&lt;%- theme.icon.go_bottom %&gt;&quot; class=&quot;rightside-button-icon&quot; alt=&quot;Icon&quot;&gt;<br>		&lt;/span&gt;<br>	&lt;/div&gt;<br>&lt;/div&gt;<br><br>&lt;script&gt;<br>    $(&#x27;#js-go_top&#x27;)<br>	.gotoPosition( &#123;<br>		speed: 300,<br>		target: &#x27;top&#x27;,<br>	&#125; );<br>	$(&#x27;#js-go_bottom&#x27;)<br>	.gotoPosition( &#123;<br>		speed: 300,<br>		target: &#x27;bottom&#x27;,<br>	&#125; );<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<h4 id="goto_position.js" tabindex="-1" id="goto-position-js">goto_position.js</h4>
<p>​    魔改原来的 <code>goTop.js</code> 使其可以也滚动到底部：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs javascript">(<span class="hljs-keyword">function</span> (<span class="hljs-params">$</span>) &#123;<br>  jQuery.<span class="hljs-property">fn</span>.<span class="hljs-property">gotoPosition</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">opt</span>) &#123;<br>    <span class="hljs-keyword">var</span> ele = <span class="hljs-variable language_">this</span>;<br>    <span class="hljs-keyword">var</span> win = $(<span class="hljs-variable language_">window</span>);<br>    <span class="hljs-keyword">var</span> doc = $(<span class="hljs-string">&quot;html,body&quot;</span>);<br>    <span class="hljs-keyword">var</span> defaultOpt = &#123;<br>      <span class="hljs-attr">speed</span>: <span class="hljs-number">500</span>,<br>      <span class="hljs-attr">iconSpeed</span>: <span class="hljs-number">200</span>,<br>      <span class="hljs-attr">animationShow</span>: &#123;<br>        <span class="hljs-attr">opacity</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>      &#125;,<br>      <span class="hljs-attr">animationHide</span>: &#123;<br>        <span class="hljs-attr">opacity</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>      &#125;,<br>    &#125;;<br>    <span class="hljs-keyword">var</span> options = $.<span class="hljs-title function_">extend</span>(defaultOpt, opt);<br><br>    ele.<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-keyword">var</span> targetOffset = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">if</span> (opt &amp;&amp; opt.<span class="hljs-property">target</span>) &#123;<br>        <span class="hljs-keyword">if</span> (opt.<span class="hljs-property">target</span> === <span class="hljs-string">&quot;top&quot;</span>) &#123;<br>          targetOffset = <span class="hljs-number">0</span>; <span class="hljs-comment">// 跳转至文档顶部</span><br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (opt.<span class="hljs-property">target</span> === <span class="hljs-string">&quot;bottom&quot;</span>) &#123;<br>          targetOffset = $(<span class="hljs-variable language_">document</span>).<span class="hljs-title function_">height</span>() - win.<span class="hljs-title function_">height</span>(); <span class="hljs-comment">// 跳转至文档底部</span><br>        &#125;<br>      &#125;<br>      doc.<span class="hljs-title function_">animate</span>(<br>        &#123;<br>          <span class="hljs-attr">scrollTop</span>: targetOffset, <span class="hljs-comment">// 将文档元素滚动到目标位置</span><br>        &#125;,<br>        options.<span class="hljs-property">speed</span><br>      );<br>    &#125;);<br>  &#125;;<br>&#125;)(jQuery);<br></code></pre></td></tr></table></figure>
<h4 id="toc.js" tabindex="-1" id="toc-js">toc.js</h4>
<h5 id="function-inittoc()" tabindex="-1" id="function-initToc">function initToc()</h5>
<p>​    初始化目录，如果文章没有被加密（类名为 <code>hbe</code> 和 <code>hbe-content</code> 的元素）不存在，则移除目录的 <code>hidden</code> 类。</p>
<p>​    模仿 Butterfly，借助 <code>localStorage</code> 判断默认状态下是否显示目录。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">initToc</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 检查是否存在具有类名为 &#x27;hbe&#x27; 和 &#x27;hbe-content&#x27; 的元素</span><br>    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">&#x27;.hbe.hbe-content&#x27;</span>).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">// 如果存在该元素，则给 &#x27;.rightside-button&#x27; 和 &#x27;.post-toc&#x27; 添加 &#x27;hidden&#x27; 类</span><br>        $(<span class="hljs-string">&#x27;.rightside-button, .post-toc&#x27;</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// 找到类名为 .rightside-button 的元素，并移除 hidden 类</span><br>        $(<span class="hljs-string">&#x27;.rightside-button&#x27;</span>).<span class="hljs-title function_">removeClass</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);<br>        <span class="hljs-comment">// 找到类名为 .post-toc 的元素，并移除 hidden 类</span><br>        $(<span class="hljs-string">&#x27;.post-toc&#x27;</span>).<span class="hljs-title function_">removeClass</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">var</span> value = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;aside-status&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span>) &#123;  <span class="hljs-comment">// 如果存储项不存在，则创建它</span><br>        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&#x27;aside-status&#x27;</span>, <span class="hljs-string">&quot;true&quot;</span>);<br>        value = <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (value === <span class="hljs-string">&quot;true&quot;</span>) &#123;<br>        $(<span class="hljs-string">&quot;#post-toc&quot;</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&quot;show-toc&quot;</span>);<br>        $(<span class="hljs-string">&quot;#content&quot;</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&quot;show-toc&quot;</span>);<br>    &#125;<br>    <span class="hljs-title function_">createToc</span>();<br>&#125;<br></code></pre></td></tr></table></figure>
<h5 id="createtoc()" tabindex="-1" id="createToc">createToc()</h5>
<p>创建目录：</p>
<ul>
<li>往 <code>&lt;ol class=&quot;toc-child&quot;&gt;&lt;/ol&gt;</code> 里不断追加元素</li>
<li>点击目录中的元素会平滑跳转到对应的位置。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createToc</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> toc = $(<span class="hljs-string">&#x27;.toc&#x27;</span>);<br>    toc.<span class="hljs-title function_">empty</span>();<br><br>    <span class="hljs-keyword">var</span> headings = $(<span class="hljs-string">&#x27;#content&#x27;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&#x27;h1, h2, h3, h4, h5, h6&#x27;</span>);<br>    <span class="hljs-keyword">var</span> currentLevel = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">var</span> currentList = toc;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; headings.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> heading = $(headings[i]);<br>        <span class="hljs-comment">// ID 开头不能为数字，如果为了，加个下划线</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^[0-9]/</span>.<span class="hljs-title function_">test</span>(heading.<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;id&#x27;</span>))) &#123;<br>            heading.<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span> + heading.<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;id&#x27;</span>));<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!heading.<span class="hljs-title function_">find</span>(<span class="hljs-string">&#x27;a&#x27;</span>).<span class="hljs-property">length</span>)  <span class="hljs-comment">// 标题里没有&lt;a&gt;，可能是用户自己创建的标题，跳过</span><br>            <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">var</span> level = <span class="hljs-built_in">parseInt</span>(heading.<span class="hljs-title function_">prop</span>(<span class="hljs-string">&#x27;tagName&#x27;</span>).<span class="hljs-title function_">charAt</span>(<span class="hljs-number">1</span>));<br>        <span class="hljs-comment">// 创建目录</span><br>        <span class="hljs-keyword">if</span> (level &gt; currentLevel) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = currentLevel + <span class="hljs-number">1</span>; j &lt;= level; j++) &#123;<br>                <span class="hljs-keyword">var</span> newOl = $(<span class="hljs-string">&#x27;&lt;ol&gt;&#x27;</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&#x27;toc-child&#x27;</span>);<br>                <span class="hljs-keyword">var</span> newLi = $(<span class="hljs-string">&#x27;&lt;li&gt;&#x27;</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&#x27;toc-item toc-level-level1-&#x27;</span> + j);<br>                currentList.<span class="hljs-title function_">append</span>(newLi);<br>                newLi.<span class="hljs-title function_">append</span>(newOl);<br>                currentList = newOl;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (level &lt; currentLevel) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = level; j &lt; currentLevel; j++) &#123;<br>                currentList = currentList.<span class="hljs-title function_">parent</span>().<span class="hljs-title function_">parent</span>();<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">var</span> li = $(<span class="hljs-string">&#x27;&lt;li&gt;&#x27;</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&#x27;toc-item toc-level-level-&#x27;</span> + level);<br>        <span class="hljs-comment">// 获取 hrefValue</span><br>        <span class="hljs-keyword">var</span> hrefValue = heading.<span class="hljs-title function_">html</span>().<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/href=&quot;([^&quot;]+)&quot;/</span>) ? heading.<span class="hljs-title function_">html</span>().<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/href=&quot;([^&quot;]+)&quot;/</span>)[<span class="hljs-number">1</span>] : <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-comment">// ID 开头不能为数字，如果为了，加个下划线</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isNaN</span>(<span class="hljs-built_in">parseInt</span>(hrefValue.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">1</span>)))) &#123;<br>            hrefValue = hrefValue.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) + <span class="hljs-string">&quot;_&quot;</span> + hrefValue.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-comment">// 获取 titleValue</span><br>        <span class="hljs-keyword">var</span> titleValue = heading.<span class="hljs-title function_">html</span>().<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/title=&quot;([^&quot;]+)&quot;/</span>) ? heading.<span class="hljs-title function_">html</span>().<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/title=&quot;([^&quot;]+)&quot;/</span>)[<span class="hljs-number">1</span>] : <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-comment">// 创建 &lt;a&gt;</span><br>        li.<span class="hljs-title function_">html</span>(<span class="hljs-string">&#x27;&lt;a class=&quot;toc-link&quot; href=&quot;&#x27;</span> + hrefValue + <span class="hljs-string">&#x27;&quot;&gt;&lt;span class=&quot;toc-text&quot;&gt;&#x27;</span> + titleValue + <span class="hljs-string">&#x27;&lt;/span&gt;&lt;/a&gt;&#x27;</span>);<br>        <span class="hljs-keyword">var</span> a = li.<span class="hljs-title function_">find</span>(<span class="hljs-string">&quot;a&quot;</span>);<br>        <span class="hljs-comment">// 重写点击目录时的跳转逻辑</span><br>        a.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123;<br>            event.<span class="hljs-title function_">preventDefault</span>();<br>            <span class="hljs-keyword">var</span> element = $($(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&quot;href&quot;</span>));<br>            <span class="hljs-keyword">var</span> rect = element[<span class="hljs-number">0</span>].<span class="hljs-title function_">getBoundingClientRect</span>();<br>            <span class="hljs-keyword">var</span> topOffset = rect.<span class="hljs-property">top</span> + <span class="hljs-variable language_">window</span>.<span class="hljs-property">scrollY</span> - <span class="hljs-number">90</span>;  <span class="hljs-comment">// 有顶端栏的存在，-90</span><br>            <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">scrollTo</span>(&#123;<br>                <span class="hljs-attr">top</span>: topOffset,<br>                <span class="hljs-attr">behavior</span>: <span class="hljs-string">&quot;smooth&quot;</span><br>            &#125;);<br>        &#125;);<br>        currentList.<span class="hljs-title function_">append</span>(li);<br>        currentLevel = level;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h5 id="%24(%E2%80%9C%23js-toc%E2%80%9D).click()" tabindex="-1" id="“-js-toc”-click">$(“#js-toc”).click()</h5>
<p>​    点击按钮，控制目录是否展示。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript">$(<span class="hljs-string">&quot;#js-toc&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> postToc = $(<span class="hljs-string">&quot;#post-toc&quot;</span>);<br>    <span class="hljs-keyword">var</span> content = $(<span class="hljs-string">&quot;#content&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!postToc.<span class="hljs-title function_">hasClass</span>(<span class="hljs-string">&quot;show-toc&quot;</span>)) &#123;<br>        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&#x27;aside-status&#x27;</span>, <span class="hljs-literal">true</span>);<br>        content.<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&quot;show-toc&quot;</span>);<br>        postToc.<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&quot;show-toc&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        content.<span class="hljs-title function_">removeClass</span>(<span class="hljs-string">&quot;show-toc&quot;</span>);<br>        postToc.<span class="hljs-title function_">removeClass</span>(<span class="hljs-string">&quot;show-toc&quot;</span>);<br>        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&#x27;aside-status&#x27;</span>, <span class="hljs-literal">false</span>);<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>​    用于控制目录是否显示，送它一个 <code>show-toc</code> 类，剩下的交给 less。</p>
<h5 id="function-gettopheadingid()" tabindex="-1" id="function-getTopHeadingId">function getTopHeadingId()</h5>
<p>​    获取当前网页最顶端标题的 id，抄着下面的代码，<code>-110</code> 是考虑到了主题顶端栏的存在：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://qzy.im/blog/2020/02/generate-article-catalogs-and-switch-catalog-following-article-s-scroll-using-javascript/">js 实现文章目录生成以及目录跟随内容滚动变化 - 郄郄私语 (qzy.im)</a></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getTopHeadingId</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> headings = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#content&#x27;</span>).<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;h1, h2, h3, h4, h5, h6&#x27;</span>);<br>    <span class="hljs-keyword">let</span> topHeadingId = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">let</span> minDistanceFromTop = <span class="hljs-title class_">Infinity</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> heading <span class="hljs-keyword">of</span> headings) &#123;<br>        <span class="hljs-keyword">const</span> boundingRect = heading.<span class="hljs-title function_">getBoundingClientRect</span>();<br>        <span class="hljs-keyword">const</span> distanceFromTop = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(boundingRect.<span class="hljs-property">y</span> - <span class="hljs-number">90</span>);<br>        <span class="hljs-keyword">if</span> (distanceFromTop &lt; minDistanceFromTop) &#123;<br>            minDistanceFromTop = distanceFromTop;<br>            topHeadingId = heading.<span class="hljs-property">id</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> topHeadingId;<br>&#125;<br></code></pre></td></tr></table></figure>
<h5 id="document.addeventlistener()" tabindex="-1" id="document-addEventListener">document.addEventListener()</h5>
<p>​    目录会根据当前所在位置高亮标题，送它一个 <code>active</code> 类，剩下的交给 less。</p>
<p>​    当当前标题不在显示范围时，再给它强行滚动到可见范围。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;scroll&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123;<br>    <span class="hljs-keyword">const</span> tocLinks = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;a.toc-link&#x27;</span>);<br>    <span class="hljs-keyword">const</span> topHeadingId = <span class="hljs-title function_">getTopHeadingId</span>();<br>    tocLinks.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">link</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">var</span> href = <span class="hljs-built_in">decodeURIComponent</span>(link.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^#/</span>, <span class="hljs-string">&#x27;&#x27;</span>);;<br>        <span class="hljs-keyword">if</span> (href == topHeadingId) &#123;<br>            <span class="hljs-keyword">if</span> (!link.<span class="hljs-property">classList</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">&#x27;active&#x27;</span>)) &#123;<br>                link.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&quot;active&quot;</span>);<br>                <span class="hljs-keyword">var</span> toc = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.toc&quot;</span>);<br>                <span class="hljs-keyword">var</span> activeItem = toc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.active&quot;</span>);<br>                <span class="hljs-keyword">if</span> (activeItem) &#123;<br>                    toc.<span class="hljs-title function_">scrollTo</span>(&#123;<br>                        <span class="hljs-attr">top</span>: activeItem.<span class="hljs-property">offsetTop</span> - <span class="hljs-number">100</span><br>                    &#125;);<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            link.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&quot;active&quot;</span>);<br>        &#125;<br>    &#125;);<br>&#125;, <span class="hljs-number">3000</span>);<br></code></pre></td></tr></table></figure>
<h4 id="toc.less" tabindex="-1" id="toc-less">toc.less</h4>
<p>​    继续模仿 Butterfly 的布局，展示目录的时候，主页面会向左移动，同时写了移动端的适配。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.post-toc</span> &#123;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.9</span>);<br>    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">40px</span> <span class="hljs-number">0</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">0.08</span>);<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">5px</span> <span class="hljs-number">10px</span> <span class="hljs-number">5px</span>;<br>    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">18</span>, <span class="hljs-number">24</span>, <span class="hljs-number">58</span>, <span class="hljs-number">0.06</span>);<br><br>    <span class="hljs-selector-class">.post-toc-title</span> &#123;<br>        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">15px</span>;<br>        <span class="hljs-attribute">font-weight</span>: bold;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#424242</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.toc</span> &#123;<br>        <span class="hljs-attribute">margin</span>: <span class="hljs-number">12px</span> <span class="hljs-number">5px</span> <span class="hljs-number">5px</span> <span class="hljs-number">5px</span>;<br>        <span class="hljs-attribute">display</span>: block;<br>        <span class="hljs-attribute">overflow</span>: auto;<br>    &#125;<br>    <span class="hljs-selector-class">.toc</span>::-webkit-scrollbar &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">5px</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">5px</span>;<br>    &#125;<br>    <br>    <span class="hljs-selector-class">.toc</span>::-webkit-scrollbar-thumb &#123;<br>        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#AAA</span>; <span class="hljs-comment">/* 修改滚动条滑块的颜色 */</span><br>        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;<br>    &#125;<br>    <br><br>    <span class="hljs-selector-tag">a</span> &#123;<br>        <span class="hljs-attribute">text-decoration</span>: none;<br>    &#125;<br><br>    <span class="hljs-selector-tag">ol</span> &#123;<br>        <span class="hljs-attribute">display</span>: inline;<br>        <span class="hljs-attribute">list-style-type</span>: none;<br><br>        <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.active</span><span class="hljs-selector-class">.toc-link</span> &#123;<br>            <span class="hljs-selector-class">.toc-text</span> &#123;<br>                <span class="hljs-attribute">color</span>: <span class="hljs-number">#FFF</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-selector-class">.toc-link</span> &#123;<br>            <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">5px</span>;<br>            <span class="hljs-attribute">padding-top</span>: <span class="hljs-number">5px</span>;<br>            <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">5px</span>;<br>            <span class="hljs-attribute">display</span>: block;<br>        &#125;<br><br>        <span class="hljs-selector-tag">li</span> &#123;<br>            <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">10px</span>;<br>            <span class="hljs-attribute">background</span>: none;<br><br>            <span class="hljs-selector-class">.toc-text</span> &#123;<br>                <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span>;<br>                <span class="hljs-attribute">color</span>: <span class="hljs-number">#898fa0</span>;<br>            &#125;<br><br>            <span class="hljs-selector-class">.active</span> &#123;<br>                <span class="hljs-selector-tag">span</span>&#123;<br>                    <span class="hljs-attribute">padding</span>: <span class="hljs-number">4px</span> <span class="hljs-number">10px</span>;<br>                    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;<br>                    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">106</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.8</span>);<br>                &#125;<br>            &#125;<br><br>        &#125;<br><br>        <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">:hover</span> &#123;<br>            <span class="hljs-attribute">color</span>: <span class="hljs-number">#4183c4</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">1100px</span>) &#123;<br>    <span class="hljs-selector-class">.post-toc</span> &#123;<br>        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">2</span>;<br>        <span class="hljs-attribute">position</span>: fixed;<br>        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">200px</span>;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">260px</span>;<br>        <span class="hljs-attribute">right</span>: -<span class="hljs-number">250px</span>;<br>        <span class="hljs-attribute">transition</span>: right <span class="hljs-number">0.5s</span> ease-out;<br>    &#125;<br><br>    <span class="hljs-selector-class">.toc</span> &#123;<br>        <span class="hljs-attribute">max-height</span>: <span class="hljs-number">40vh</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.post-toc</span><span class="hljs-selector-class">.show-toc</span> &#123;<br>        <span class="hljs-attribute">right</span>: <span class="hljs-built_in">min</span>(<span class="hljs-number">30px</span>, <span class="hljs-number">2vw</span>);<br>    &#125;<br><br>    <span class="hljs-selector-class">.post-toc</span><span class="hljs-selector-class">.show-toc</span><span class="hljs-selector-class">.hidden</span>&#123;<br>        <span class="hljs-attribute">right</span>: -<span class="hljs-number">250px</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.post-content</span><span class="hljs-selector-class">.show-toc</span>&#123;<br>        <span class="hljs-attribute">max-width</span>: <span class="hljs-built_in">min</span>(<span class="hljs-number">960px</span>, <span class="hljs-number">80vw</span>);<br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-built_in">calc</span>(-<span class="hljs-number">0.1</span> * <span class="hljs-built_in">min</span>(<span class="hljs-number">960px</span>, <span class="hljs-number">80vw</span>)));<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">1100px</span>) &#123;<br>    <span class="hljs-selector-class">.post-toc</span> &#123;<br>        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">2</span>;<br>        <span class="hljs-attribute">position</span>: fixed;<br>        <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">30vh</span>;<br>        <span class="hljs-attribute">min-width</span>: <span class="hljs-number">40vw</span>;<br>        <span class="hljs-attribute">max-width</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">75vw</span> - <span class="hljs-number">10px</span>);<br>        <span class="hljs-attribute">right</span>: <span class="hljs-built_in">min</span>(<span class="hljs-number">70px</span>, <span class="hljs-built_in">calc</span>(<span class="hljs-number">10vw</span> + <span class="hljs-number">30px</span>));<br>        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">20px</span>;<br>        <span class="hljs-attribute">transition</span>: bottom <span class="hljs-number">0.5s</span> ease-out;<br>    &#125;<br><br>    <span class="hljs-selector-class">.toc</span> &#123;<br>        <span class="hljs-attribute">max-height</span>: <span class="hljs-number">16vh</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.post-toc</span><span class="hljs-selector-class">.show-toc</span> &#123;<br>        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">20px</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.post-toc</span><span class="hljs-selector-class">.show-toc</span><span class="hljs-selector-class">.hidden</span>&#123;<br>        <span class="hljs-attribute">right</span>: -<span class="hljs-number">30vh</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="dispatch_event.js" tabindex="-1" id="dispatch-event-js">dispatch_event.js</h4>
<p>​    新版的 <a target="_blank" rel="noopener" href="https://github.com/D0n9X1n/hexo-blog-encrypt">hexo-blog-encrypt</a> 提供了解密后的回调函数，更新这个插件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm update hexo-blog-encrypt<br></code></pre></td></tr></table></figure>
<blockquote>
<h3 id="after-decrypt-event" tabindex="-1" id="After-Decrypt-Event">After Decrypt Event</h3>
<p>Thanks to @<a target="_blank" rel="noopener" href="https://github.com/f-dong">f-dong</a>, we now will trigger a event named <code>hexo-blog-decrypt</code>, so you can add a call back to listen to that event.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// trigger event</span><br><span class="hljs-keyword">var</span> event = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">&#x27;hexo-blog-decrypt&#x27;</span>);<br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">dispatchEvent</span>(event);<br></code></pre></td></tr></table></figure>
</blockquote>
<p>​    在解密后重新初始化目录：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// trigger event</span><br><span class="hljs-keyword">var</span> event = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">&#x27;hexo-blog-decrypt&#x27;</span>);<br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">dispatchEvent</span>(event);<br><br><span class="hljs-comment">// 定义回调函数</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">handleHexoBlogDecryptEvent</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;文章解密成功！&quot;</span>);<br>    <span class="hljs-title function_">initToc</span>();<br>&#125;<br><br><span class="hljs-comment">// 添加事件监听器</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;hexo-blog-decrypt&#x27;</span>, handleHexoBlogDecryptEvent);<br></code></pre></td></tr></table></figure>
<h3 id="%E6%BC%94%E7%A4%BA-3" tabindex="-1" id="演示-4">演示</h3>
<p>​    电脑端：</p>
<p><img src="08.png" alt="png"></p>
<p>​    移动端：</p>
<p><img src="09.png" alt="png"></p>
<h2 id="%E6%A0%87%E9%A2%98%E5%9B%BE%E8%B6%85%E6%A1%86" tabindex="-1" id="标题图超框">标题图超框</h2>
<blockquote>
<p>​    这是自己突发奇想原创的一个功能，增加一个变量控制这个功能让其看上去没有那么屎山。</p>
</blockquote>
<h3 id="%E4%BB%A3%E7%A0%81-4" tabindex="-1" id="代码-5">代码</h3>
<h4 id="home.ejs-2" tabindex="-1" id="home-ejs-3">home.ejs</h4>
<p>​    修改 <code>home.ejs</code>，增加 <code>post.cover_style</code> 变量允许文章头部的 yaml 控制标题图的 style：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;div class=&quot;img-container&quot;&gt;<br>    &lt;img style=&quot;&lt;%- post.cover_style || &#x27;&#x27; %&gt;&quot; src=&quot;&lt;%= post.cover ? post.cover : theme.default_cover %&gt;&quot; alt=&quot;Cover&quot;&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure>
<h4 id="home.less-2" tabindex="-1" id="home-less-3">home.less</h4>
<p>​    对应 less：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-class">.img-container</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-variable">@headerBackgroundColor</span>;<br>    <span class="hljs-attribute">position</span>: relative;<br>    <span class="hljs-selector-tag">img</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;<br>        <span class="hljs-attribute">object-fit</span>: cover;<br>        <span class="hljs-attribute">display</span>: block;<br>      &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>
<h3 id="%E8%B6%85%E6%A1%86%E5%9B%BE%E5%88%B6%E4%BD%9C" tabindex="-1" id="超框图制作">超框图制作</h3>
<p>​    用 PS 修一个超框图，就决定是你了，癫狂公爵西塔尔！疯子也要有教养。</p>
<p>​    我一般的 <code>cover</code> 都是设成 800px * 450px 的，这个封面图设置为 800px * 738px，用 PS 保证“框”的高度为 450px，“框“的顶部距离画面顶部 150px。</p>
<p><img src="10.png" alt="png"></p>
<h3 id="cover_style" tabindex="-1" id="cover-style">cover_style</h3>
<p>​    文章自定义 <code>cover_style</code>：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">cover_style:</span> <span class="hljs-string">&quot;height: 164%; position: absolute; top: 0; left: 0; transform: translateY(-20.3%);&quot;</span><br></code></pre></td></tr></table></figure>
<p>​    覆盖之前的封面图样式：</p>
<ul>
<li><code>height: 164%;</code>：由 738 / 450 = 1.64 得到。</li>
<li><code>position: absolute; top: 0; left: 0; object-fit: contain;</code> 超框的处理。</li>
<li><code>transform: translateY(-20.3%);&quot;</code> 向上移 20.3%，因为 150 / 738 ≈ 20.3%。</li>
</ul>
<h3 id="%E6%BC%94%E7%A4%BA-4" tabindex="-1" id="演示-5">演示</h3>
<p>​    帅呆了！</p>
<p><img src="11.png" alt="png"></p>
<h2 id="%E7%BD%AE%E9%A1%B6%E5%9B%BE%E6%A0%87" tabindex="-1" id="置顶图标">置顶图标</h2>
<p>​    对于含有 <code>top</code> 属性的文章，增加一个置顶图标。</p>
<h3 id="%E4%BB%A3%E7%A0%81-5" tabindex="-1" id="代码-6">代码</h3>
<h4 id="home.ejs-3" tabindex="-1" id="home-ejs-4">home.ejs</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;% if(post.top)&#123; %&gt;<br>    &lt;img src=&quot;&lt;%= theme.icon.stiky %&gt;&quot; class=&quot;stiky&quot; alt=&quot;Icon&quot;&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure>
<h4 id="home.less-3" tabindex="-1" id="home-less-4">home.less</h4>
<p>​    对应的：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-class">.stiky</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">18px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">18px</span>;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">8px</span> <span class="hljs-number">6px</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="%E6%BC%94%E7%A4%BA-5" tabindex="-1" id="演示-6">演示</h3>
<p><img src="12.png" alt="png"></p>
<h2 id="%E5%8A%A0%E5%AF%86%E5%9B%BE%E6%A0%87" tabindex="-1" id="加密图标">加密图标</h2>
<blockquote>
<p>​    首页展示这个文章是否被加密，防止白点一趟。</p>
</blockquote>
<h3 id="%E4%BB%A3%E7%A0%81-6" tabindex="-1" id="代码-7">代码</h3>
<h4 id="home.ejs-4" tabindex="-1" id="home-ejs-5">home.ejs</h4>
<p>​    根据 <code>post.password</code> 的值是否为空判断这个文章是否被加密。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;img src=&quot;&lt;%- post.password ? theme.icon.locked : theme.icon.normal %&gt;&quot; class=&quot;meat-type&quot; alt=&quot;Icon&quot;&gt;<br></code></pre></td></tr></table></figure>
<h3 id="%E6%BC%94%E7%A4%BA-6" tabindex="-1" id="演示-7">演示</h3>
<p><img src="13.png" alt="png"></p>
<h2 id="%E9%9D%A2%E5%8C%85%E5%B1%91%E5%AF%BC%E8%88%AA%E6%A0%8F" tabindex="-1" id="面包屑导航栏">面包屑导航栏</h2>
<blockquote>
<p>​    设计的嵌套页面太深了，设计一个面包屑导航栏防止迷路。</p>
</blockquote>
<h3 id="header.ejs" tabindex="-1" id="header-ejs">header.ejs</h3>
<p>​    添加一个 <code>&lt;ul&gt;</code> 以放置导航栏。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;div class=&quot;h-left&quot;&gt;<br>    &lt;a href=&quot;&lt;%= theme.menus_link.home %&gt;&quot; class=&quot;logo&quot;&gt;<br>        &lt;img src=&quot;&lt;%- theme.logo %&gt;&quot; alt=&quot;Quiet&quot;&gt;<br>    &lt;/a&gt;<br>    &lt;ul class=&quot;breadcrumb&quot; id=&quot;breadcrumb&quot;&gt;&lt;/ul&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure>
<p>​    底部调用 js，并传参（从 yaml 传参给 JS 还蛮复杂的，要花点脑经）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;%- js(&#x27;js/breadcrumb.js&#x27;) %&gt;<br>&lt;script&gt;<br>	var menus_title = [];<br>	&lt;% Object.keys(theme.menus_title).forEach(function(menu) &#123; %&gt;<br>	    menus_title.push(&#123;&lt;%= menu %&gt;: &#x27;&lt;%= theme.menus_title[menu] %&gt;&#x27;&#125;);<br>	&lt;% &#125;); %&gt;<br>	&lt;% if(page.categories)&#123; %&gt;<br>		&lt;% page.categories.data.map((cat)=&gt;&#123; %&gt;<br>			categoriesBreadcrumb(document.getElementById(&#x27;breadcrumb&#x27;), &quot;&lt;%- cat.name %&gt;&quot;, &quot;/categories/&lt;%- cat.name %&gt;&quot;);<br>		&lt;% &#125;) %&gt;<br>	&lt;% &#125; else &#123; %&gt;<br>		customBreadcrumb(document.getElementById(&#x27;breadcrumb&#x27;), menus_title);<br>	&lt;% &#125; %&gt;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<h3 id="breadcrumb.js" tabindex="-1" id="breadcrumb-js">breadcrumb.js</h3>
<p>​    设计两种面包屑导航栏：</p>
<ul>
<li><code>customBreadcrumb</code> 简单地根据页面网址生成导航栏。</li>
<li><code>categoriesBreadcrumb</code> 对于常规的推文，根据它的类别生成导航栏。</li>
</ul>
<h4 id="function-custombreadcrumb()" tabindex="-1" id="function-customBreadcrumb">function customBreadcrumb()</h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">customBreadcrumb</span>(<span class="hljs-params">breadcrumb, menus_title</span>) &#123;<br>    <span class="hljs-comment">// 获取当前页面路径</span><br>    <span class="hljs-keyword">var</span> path = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>;<br>    <span class="hljs-keyword">var</span> levels = path.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>);<br>    levels.<span class="hljs-title function_">shift</span>(); <span class="hljs-comment">// 移除第一个空字符串元素</span><br>    levels.<span class="hljs-title function_">pop</span>();  <span class="hljs-comment">// 移除最后一个空字符串元素</span><br><br>    <span class="hljs-comment">// 生成面包屑导航</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; levels.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> levelLink = <span class="hljs-string">&#x27;/&#x27;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) &#123;<br>            levelLink += levels[j] + <span class="hljs-string">&#x27;/&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">var</span> levelName = <span class="hljs-built_in">decodeURIComponent</span>(levels[i]);<br>        <br>        <span class="hljs-keyword">if</span> (i === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// 查找 menus_title 中与 levelName 相同的键，并获取对应的值</span><br>            <span class="hljs-keyword">var</span> title_obj = menus_title.<span class="hljs-title function_">find</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) &#123;<br>                <span class="hljs-keyword">return</span> item[levelName] !== <span class="hljs-literal">undefined</span>;<br>            &#125;);<br>            <span class="hljs-keyword">var</span> title_value = title_obj ? title_obj[levelName] : <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">if</span> (!title_value) &#123;<br>                <span class="hljs-keyword">return</span>; <span class="hljs-comment">// 如果找不到对应的值，直接返回，不执行后续代码</span><br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-comment">// 如果代码执行到这里，说明所有的值都能找到，可以继续添加元素到面包屑导航栏</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; levels.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> levelLink = <span class="hljs-string">&#x27;/&#x27;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) &#123;<br>            levelLink += levels[j] + <span class="hljs-string">&#x27;/&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">var</span> levelName = <span class="hljs-built_in">decodeURIComponent</span>(levels[i]);<br>        <span class="hljs-keyword">var</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br>        <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;a&#x27;</span>);<br>        &#123;<br>        <span class="hljs-keyword">if</span> (i === <span class="hljs-number">0</span>) &#123;<br>            a.<span class="hljs-property">textContent</span> = title_value;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            a.<span class="hljs-property">textContent</span> = levelName;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(i == levels.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) &#123;<br>            a.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&quot;last&quot;</span>);<br>        &#125;<br>        a.<span class="hljs-property">href</span> = levelLink;<br>        &#125;<br>        li.<span class="hljs-title function_">appendChild</span>(a);<br>        breadcrumb.<span class="hljs-title function_">appendChild</span>(li);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="function-categoriesbreadcrumb()" tabindex="-1" id="function-categoriesBreadcrumb">function categoriesBreadcrumb()</h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">categoriesBreadcrumb</span>(<span class="hljs-params">breadcrumb, categories, categoriesLink</span>) &#123;<br>    <span class="hljs-keyword">var</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;a&#x27;</span>);<br><br>    a.<span class="hljs-property">textContent</span> = categories;<br>    a.<span class="hljs-property">href</span> = categoriesLink;<br>    li.<span class="hljs-title function_">appendChild</span>(a);<br>    breadcrumb.<span class="hljs-title function_">appendChild</span>(li);<br><br>    li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br>    a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;a&#x27;</span>);<br><br>    a.<span class="hljs-property">textContent</span> = <span class="hljs-string">&quot;文章&quot;</span>;<br>    a.<span class="hljs-property">href</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>;<br>    a.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&quot;last&quot;</span>);<br><br>    li.<span class="hljs-title function_">appendChild</span>(a);<br>    breadcrumb.<span class="hljs-title function_">appendChild</span>(li);<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="header.less" tabindex="-1" id="header-less">header.less</h3>
<p>​    在 <code>hearer.less</code> 的相应位置设置样式：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-class">.breadcrumb</span> &#123;<br>    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">5px</span>;<br>    <span class="hljs-attribute">display</span>: flex;<br>    <span class="hljs-attribute">list-style</span>: none;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-selector-tag">a</span>&#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#898fa0</span>;<br>        <span class="hljs-attribute">text-decoration</span>: none;<br>    &#125;<br>    <span class="hljs-selector-class">.last</span>&#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#12183A</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.dot</span> &#123;<br>        <span class="hljs-attribute">display</span>: inline-block;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">5px</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">5px</span>;<br>        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;<br>        <span class="hljs-attribute">background</span>: <span class="hljs-number">#006AFF</span>;<br>        <span class="hljs-attribute">position</span>: relative;<br>        <span class="hljs-attribute">top</span>: -<span class="hljs-number">12px</span>;<br>        <span class="hljs-attribute">left</span>: <span class="hljs-number">2px</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-selector-class">.breadcrumb</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">::before</span> &#123;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#898fa0</span>;<br>    <span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;&gt;&quot;</span>;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​    修改一下对于手机端的适配：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>:<span class="hljs-number">660px</span>) &#123;<br>	<span class="hljs-selector-class">.header</span> &#123;<br>		<span class="hljs-selector-class">.header-top</span> &#123;<br>			<span class="hljs-selector-class">.h-left</span> &#123;<br>				<span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">3</span>;<br>			&#125;<br>...<br></code></pre></td></tr></table></figure>
<h3 id="%E6%95%88%E6%9E%9C" tabindex="-1" id="效果">效果</h3>
<h4 id="custombreadcrumb" tabindex="-1" id="customBreadcrumb">customBreadcrumb</h4>
<p><img src="14.png" alt="png"></p>
<h4 id="function-categoriesbreadcrumb()-1" tabindex="-1" id="function-categoriesBreadcrumb-2">function categoriesBreadcrumb()</h4>
<p><img src="15.png" alt="png"></p>
<h2 id="hexo-tag-aplayer-%E4%B8%8E-hexo-blog-encrypt-%E5%86%B2%E7%AA%81" tabindex="-1" id="hexo-tag-aplayer-与-hexo-blog-encrypt-冲突">hexo-tag-aplayer 与 hexo-blog-encrypt 冲突</h2>
<blockquote>
<p>​    这似乎是个通病，无论什么主题都有这种问题。</p>
</blockquote>
<p>​    在使用 Aplayer 的推文前面加上标记：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">APlayer:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>
<p>​    从 <a target="_blank" rel="noopener" href="https://gitee.com/mirrors/APlayer">APlayer: APlayer 是一个简约且漂亮的 HTML5 音乐播放器，支持多种模式，包括播放列表模式、吸底模式 (gitee.com)</a> 搞到 <code>APlayer.min.css</code> 和 <code>APlayer.min.js</code> 放到对应目录下。</p>
<p>​    修改 <code>header.ejs</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;% if(page.APlayer) &#123; %&gt;<br>    &lt;%- css(&#x27;css/third-party/APlayer.min.css&#x27;) %&gt;<br>    &lt;%- js(&#x27;js/third-party/APlayer.min.js&#x27;) %&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure>
<p>​    <code>source/_config.yml</code> 下设置参数避免重复调用（<a target="_blank" rel="noopener" href="https://github.com/MoePlayer/hexo-tag-aplayer/blob/master/docs/README-zh_cn.md#%E9%87%8D%E5%A4%8D%E8%BD%BD%E5%85%A5-aplayerjs-%E8%B5%84%E6%BA%90%E8%84%9A%E6%9C%AC%E9%97%AE%E9%A2%98">hexo-tag-aplayer/docs/README-zh_cn.md at master · MoePlayer/hexo-tag-aplayer (github.com)</a>）</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">aplayer:</span><br>  <span class="hljs-attr">asset_inject:</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure>
<p>​    OK 了，我想 hexo-tag-map 插件也是同理，不过这个插件我不太喜欢，也很久没用了，还是不设置了。</p>
<h3 id="giscus-%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F" tabindex="-1" id="Giscus-评论系统">Giscus 评论系统</h3>
<p>​    将评论系统改成：<a target="_blank" rel="noopener" href="https://giscus.app/zh-CN">giscus</a></p>
<h2 id="tabs" tabindex="-1" id="tabs">tabs</h2>
<p>​    使用方法：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs markdown">&#123;% tabs Unique name, [index] %&#125;<br>&lt;!-- tab [Tab caption] [@icon] --&gt;<br>Any content (support inline tags too).<br>&lt;!-- endtab --&gt;<br>&#123;% endtabs %&#125;<br><br>Unique name   : Unique name of tabs block tag without comma.<br><span class="hljs-code">                Will be used in #id&#x27;s as prefix for each tab with their index numbers.</span><br><span class="hljs-code">                If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes.</span><br><span class="hljs-code">                Only for current url of post/page must be unique!</span><br><span class="hljs-code">[index]       : Index number of active tab.</span><br><span class="hljs-code">                If not specified, first tab (1) will be selected.</span><br><span class="hljs-code">                If index is -1, no tab will be selected. It&#x27;s will be something like spoiler.</span><br><span class="hljs-code">                Optional parameter.</span><br><span class="hljs-code">[Tab caption] : Caption of current tab.</span><br><span class="hljs-code">                If not caption specified, unique name with tab index suffix will be used as caption of tab.</span><br><span class="hljs-code">                If not caption specified, but specified icon, caption will empty.</span><br><span class="hljs-code">                Optional parameter.</span><br><span class="hljs-code">[@icon]       : FontAwesome icon name (full-name, look like &#x27;fas fa-font&#x27;)</span><br><span class="hljs-code">                Can be specified with or without space; e.g. &#x27;Tab caption @icon&#x27; similar to &#x27;Tab caption@icon&#x27;.</span><br><span class="hljs-code">                Optional parameter.</span><br></code></pre></td></tr></table></figure>
<div class="tabs" id="test4"><div class="nav-tabs"><button type="button" class="tab active" data-href="test4-1">第一个 Tab</button><button type="button" class="tab" data-href="test4-2">圣光会制裁你！</button><button type="button" class="tab" data-href="test4-3">你的灵魂将受到折磨！</button></div><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tab 名字为第一个 Tab</strong></p></div><div class="tab-item-content" id="test4-2"><p><strong>只有图标 没有 Tab 名字</strong></p></div><div class="tab-item-content" id="test4-3"><p><strong>名字+icon</strong></p></div></div></div>
<h2 id="hide" tabindex="-1" id="hide">hide</h2>
<p>​    搬运自 butterfly：<a target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/#tag-hide">Butterfly 安裝文檔(三) 主題配置-1 | Butterfly</a></p>
<blockquote>
<p>​    2.2.0 以上提供</p>
<p>​    請注意，tag-hide 內的標簽外掛 content 內都不建議有 h1 - h6 等標題。因為 Toc 會把隱藏內容標題也顯示出來，而且當滾動屏幕時，如果隱藏內容沒有顯示出來，會導致 Toc 的滾動出現異常。</p>
</blockquote>
<h3 id="inline" tabindex="-1" id="inline">inline</h3>
<p>​    <code>inline</code> 在文本里面添加按鈕隱藏內容，只限文字</p>
<p>​    ( content 不能包含英文逗號，可用 <code>&amp;sbquo;</code>)</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">哪個英文字母最酷？&#123;% hideInline 因為西裝褲(C 裝酷),查看答案,#FF7242,#fff %&#125;<br><br>門裏站着一個人? &#123;% hideInline 閃 %&#125;<br></code></pre></td></tr></table></figure>
<p>哪個英文字母最酷？<span class="hide-inline"><button type="button" class="hide-button" style="background-color: #FF7242;color: #fff">查看答案
  </button><span class="hide-content">因為西裝褲(C 裝酷)</span></span></p>
<p>門裏站着一個人? <span class="hide-inline"><button type="button" class="hide-button" style="">Click
  </button><span class="hide-content">閃</span></span></p>
<h3 id="block" tabindex="-1" id="Block">Block</h3>
<p>​    block 獨立的 block 隱藏內容，可以隱藏很多內容，包括圖片，代碼塊等等</p>
<p>​    ( display 不能包含英文逗號，可用 <code>&amp;sbquo;</code>)</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown">查看答案<br>&#123;% hideBlock 查看答案 %&#125;<br>傻子，怎麼可能有答案<br>&#123;% endhideBlock %&#125;<br></code></pre></td></tr></table></figure>
<p>查看答案</p>
<div class="hide-block"><button type="button" class="hide-button" style="">查看答案
    </button><div class="hide-content"><p>傻子，怎麼可能有答案</p>
</div></div>
<h3 id="toggle" tabindex="-1" id="Toggle">Toggle</h3>
<p>​    如果你需要展示的內容太多，可以把它隱藏在收縮框裏，需要時再把它展開。</p>
<p>​    ( display 不能包含英文逗號，可用<code>&amp;sbquo;</code>)</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs markdown">&#123;% hideToggle Butterfly 安裝方法 %&#125;<br>在你的博客根目錄裏<br><br>git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly<br><br>如果想要安裝比較新的 dev 分支，可以<br><br>git clone -b dev https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly<br><br>&#123;% endhideToggle %&#125;<br></code></pre></td></tr></table></figure>
<details class="toggle" ><summary class="toggle-button" style="">Butterfly 安裝方法</summary><div class="toggle-content"><p>在你的博客根目錄裏</p>
<p>git clone -b master <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly.git">https://github.com/jerryc127/hexo-theme-butterfly.git</a> themes/Butterfly</p>
<p>如果想要安裝比較新的 dev 分支，可以</p>
<p>git clone -b dev <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly.git">https://github.com/jerryc127/hexo-theme-butterfly.git</a> themes/Butterfly</p>
</div></details>
<h2 id="css-%E4%B8%8E-less" tabindex="-1" id="CSS-与-LESS">CSS 与 LESS</h2>
<p>​    一些浏览器似乎不支持 CSS 文件使用的一些语法，换成 LESS 就可行！</p>
<p><img src="16.png" alt="png"></p>
<h2 id="inject" tabindex="-1" id="Inject">Inject</h2>
<h3 id="%E4%BB%8B%E7%BB%8D" tabindex="-1" id="介绍">介绍</h3>
<p>​	搬运自：<a target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/#Inject">Butterfly 安裝文檔(四) 主題配置-2 | Butterfly</a></p>
<blockquote>
<p>如想添加额外的 <code>js/css/meta</code> 等等东西，可以在 <code>Inject</code> 里添加，支持添加到<code>head</code>（<code>&lt;/body&gt;</code> 标签之前）和 <code>bottom</code>（<code>&lt;/html&gt;</code> 标签之前）。</p>
<p>请注意：以标准的 html 格式添加内容</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">inject:</span><br>  <span class="hljs-attr">head:</span><br>  	<span class="hljs-bullet">-</span> <span class="hljs-string">&lt;link</span> <span class="hljs-string">rel=&quot;stylesheet&quot;</span> <span class="hljs-string">href=&quot;/self.css&quot;&gt;</span><br>  <span class="hljs-attr">bottom:</span><br>  	<span class="hljs-bullet">-</span> <span class="hljs-string">&lt;script</span> <span class="hljs-string">src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span><br></code></pre></td></tr></table></figure>
<p>​	这样还绕开了一些 JS 被加密插件搞崩的问题，真是太棒了！</p>
<h3 id="%E5%AE%9E%E7%8E%B0" tabindex="-1" id="实现">实现</h3>
<p>​	<code>post_head.ejs</code> 里添加：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;% if(page.inject) &#123; %&gt;<br>    &lt;% if(page.inject.head) &#123; %&gt;<br>        &lt;% for(let i = 0; i &lt; page.inject.head.length; i++)&#123; %&gt;<br>            &lt;%- page.inject.head[i] %&gt;<br>        &lt;% &#125; %&gt;<br>    &lt;% &#125; %&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure>
<p>​	<code>footer.ejs</code> 里添加：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ejs">&lt;% if(page.inject) &#123; %&gt;<br>    &lt;% if(page.inject.bottom) &#123; %&gt;<br>        &lt;% for(let i = 0; i &lt; page.inject.bottom.length; i++)&#123; %&gt;<br>            &lt;%- page.inject.bottom[i] %&gt;<br>        &lt;% &#125; %&gt;<br>    &lt;% &#125; %&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure>
<h2 id="%E6%8A%98%E5%8F%A0%E7%9B%AE%E5%BD%95-2024%2F11%2F11" tabindex="-1" id="折叠目录-2024-11-11">折叠目录 2024/11/11</h2>
<p>​	现在目录终于可以像 butterfly 等主题一样折叠了！如果不想要折叠目录，需要在文章标头设置：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">toc_collapsed<span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br></code></pre></td></tr></table></figure>
<h2 id="%E5%85%B6%E5%AE%83" tabindex="-1" id="其它">其它</h2>
<ul>
<li>还有一些 css 的调整没有放上去，按着自己的审美随便调了下。</li>
<li>得益于自己的兴趣和 ChatGPT 强大的能力，让我即使没有系统地学过前端知识也能够编写许多代码，确实是个深坑啊！</li>
<li>原主题还有一点编译错误，找机会修一修。</li>
<li>最好把各种颜色都用变量存起来，不然太屎山了。</li>
<li>想起了当时实习的时候看同事写的屎山代码，我已经尽力把代码写的比较规范了……</li>
</ul>

            </article>
            
	<div class="rightside">
	
		<div class="rightside-button" id="js-aside">
			<span>
				<img no-lazy src="/images/icon/aside.png" class="rightside-button-icon" alt="Icon">
			</span>
		</div>
		<script>
			$("#js-aside").click(function () {
				onShowAsideButton();
			});
		</script>
	
	<div class="rightside-button" id="js-toggle_theme">
		<span>
			<img no-lazy src="/images/icon/toggle_theme.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	
<script src="/js/plugins/goto_position.js"></script>

	
	<div class="rightside-button" id="js-go_top">
		<span>
			<img no-lazy src="/images/icon/go_top.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>
	<div class="rightside-button" id="js-go_bottom">
		<span>
			<img no-lazy src="/images/icon/go_bottom.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	<script>
		setToggleThemeButtonListener();
	</script>
	<script>
		$('#js-go_top')
		.gotoPosition( {
			speed: 300,
			target: 'top',
		} );
		$('#js-go_bottom')
		.gotoPosition( {
			speed: 300,
			target: 'bottom',
		} );
	</script>
</div>


<div class="post-bottom">
    
        <div class="post-paging">     
            <div class="post-paging-last">
                
                    <a href="/posts/Hexo-%E5%8D%9A%E5%AE%A2%E7%9B%B8%E5%86%8C%E5%8A%9F%E8%83%BD%E7%9A%84%E5%BC%80%E5%8F%91/">
                        上一篇：Hexo-博客相册功能的开发
                    </a>
                
            </div>
            <div class="post-paging-next">
                
                    <a href="/posts/Diary-8-%E7%99%BD%E8%8C%AB%E8%8C%AB/">
                        下一篇：Diary-8-白茫茫
                    </a>
                
            </div>
        </div>
    
    
    
        
            <div class="giscus comments"></div>
            <script>
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://giscus.app/client.js';
                scriptElement.setAttribute('data-repo', 'GZ-Metal-Cell/GZ-Metal-Cell.github.io');
                scriptElement.setAttribute('data-repo-id', 'R_kgDOIHLEOQ');
                scriptElement.setAttribute('data-category', 'Announcements');
                scriptElement.setAttribute('data-category-id', 'DIC_kwDOIHLEOc4CcVwP');
                scriptElement.setAttribute('data-mapping', 'title');
                scriptElement.setAttribute('data-strict', '1');
                scriptElement.setAttribute('data-reactions-enabled', '');
                scriptElement.setAttribute('data-emit-metadata', '0');
                scriptElement.setAttribute('data-input-position', 'bottom');
                scriptElement.setAttribute('data-theme', localStorage.getItem('theme') === 'light' ? 'light' : 'dark_high_contrast');
                scriptElement.setAttribute('data-lang', 'zh-CN');
                
                scriptElement.setAttribute('crossorigin', 'anonymous');
                scriptElement.async = true;
                document.head.appendChild(scriptElement);
            </script>
        
    
</div>
        </div>
    </main>
    
        <aside class="main-aside">
    
<script src="/js/widgets/aside.js"></script>

    <script>
        showAside();
    </script>

    <div class="aside-top">
        <div class="aside-top-about aside-card">
            <a href="/about" class="aside-top-about-portrait">
                <img no-lazy src="/about/portrait.png" alt="Q">
            </a>
            <div class="aside-top-about-info">
                <span class="author"> Zi-Zi</span>
                <span class="description">不以物喜，不以己悲。</span>
            </div>              
            <div class="aside-top-about-site">
                <a href="/categories" class="aside-top-about-site-item">
                    <span class="title">类别</span>
                    <span class="count">5</span>
                </a>
                <a href="/tags" class="aside-top-about-site-item">
                    <span class="title">标签</span>
                    <span class="count">119</span>
                </a>
                <a href="/archives" class="aside-top-about-site-item">
                    <span class="title">归档</span>
                    <span class="count">429</span>
                </a>
            </div>
            <div class="aside-top-about-contact">
                
                    
                        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
                            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
                            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
                            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
                            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
                        </a>
                    
                
            </div>
        </div> 

        
            <div class="aside-top-series aside-card">
                <ol class="aside-top-series-content">
                    
                    
                    
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-第一篇博客/">
                                                <span class="text">Hexo-第一篇博客</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-更新了hexo主题/">
                                                <span class="text">Hexo-更新了hexo主题</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-继续优化 hexo 主题/">
                                                <span class="text">Hexo-继续优化 hexo 主题</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        
                                        <li class="series-item active">
                                            <a class="series-link active" href="/posts/Hexo-Quiet 主题魔改笔记/">
                                                <span class="text">Hexo-Quiet 主题魔改笔记</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-博客相册功能的开发/">
                                                <span class="text">Hexo-博客相册功能的开发</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-给博客提提速！/">
                                                <span class="text">Hexo-给博客提提速！</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Server-阿里云 ECS/">
                                                <span class="text">Server-阿里云 ECS</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-昼夜切换/">
                                                <span class="text">Hexo-昼夜切换</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-Artitalk/">
                                                <span class="text">Hexo-Artitalk</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-写点工具加快 hexo g 的速度/">
                                                <span class="text">Hexo-写点工具加快 hexo g 的速度</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-侧边栏/">
                                                <span class="text">Hexo-侧边栏</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-基于 CryptoJS-AES 的 Hexo 文章片段加密插件/">
                                                <span class="text">Hexo-基于 CryptoJS-AES 的 Hexo 文章片段加密插件</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-markdown-it/">
                                                <span class="text">Hexo-markdown-it</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Hexo-插件/">
                                                <span class="text">Hexo-插件</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                </ol>
                <div class="aside-top-series-title">
                    <h1>
                        <a href="/tags/Hexo">标签：Hexo</a>
                    </h1>
                    <span id="serial-number">4/14</span>
                </div>
            </div>
            <script>
                activeSeriesItem();
            </script> 
        
    </div>

    <div class="aside-bottom">
        
            <script>
                
                    const tocCollapsed = true;
                
                
                    const tocDepth = 6;
                
                var headerString = '';
                for (let i = 1; i <= tocDepth; i++) {
                    if (i === 1) {
                        headerString += 'h1';
                    } else {
                        headerString += ', h' + i;
                    }
                }
                hbeToc();
            </script>
            <div class="aside-bottom-toc aside-card">
                <div class="aside-bottom-toc-title">
                    <h1>目录</h1>
                    <span class="toc-percentage"></span>
                </div>
                <ol class="aside-bottom-toc-content"></ol>
            </div>
        
    </div>
</aside>
    
</div>
		<footer>
	<div class="content">
		
			<span>©2022-2025&nbsp;By&nbsp;<a href="/about">Zi-Zi</a>.</span>
		
		<span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> theme by <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell/hexo-theme-quieter">Quieter</a>.</span>
		
			<span style="display: flex;">
				<img no-lazy alt="icp" src="/images/icp_icon.png" style="width: 16px; height: 16px;">
				<a href="https://icp.gov.moe/?keyword=20241647" target="_blank">萌 ICP 备 20241647 号</a>
			</span>
		
	</div>

	
<script src="/js/plugins/ref.js"></script>

	
<script src="/js/plugins/highlight_tools.js"></script>

	<script>
		const  COPY_ICON = "/images/icon/copy.png";
		const CLOSE_CODE_BLOCK_ICON = "/images/icon/close_code_block.png";
		const HIGHLIGHT_SHRINK = "true";
		const HIGHLIGHT_HEIGHT_LIMIT = "480px";
	</script>

	
	
	<!-- Analytics -->

    
        <!-- Busuanzi Analytics -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?e57cf62289f84322ebff116e8b3d343e";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


	

	

    
		
<link rel="stylesheet" href="/css/plugins/textIndent.css">

		
<script src="/js/plugins/textIndent.js"></script>

	

	
	
	
		<script>
			if (typeof init === 'function') {
				init();
			}
		</script>
	

	
		
	

	

	<!--
		
<script src="/js/plugins/jquery.pjax.min.js"></script>

		<script>
			$(document).pjax('a[target!=_blank]', 'main', {
				fragment: 'main',
				timeout: 8000
			});

			$(document).on('pjax:complete', function() {
			});
		</script> 
	-->
	<script>
		console.log('\n %c Hexo-Quieter 主题 %c https://github.com/GZ-Metal-Cell/hexo-theme-quieter \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
	</script>
</footer>
	</body>

	<!-- Hexo-Quieter 主题  https://github.com/GZ-Metal-Cell/hexo-theme-quieter -->
</html>

