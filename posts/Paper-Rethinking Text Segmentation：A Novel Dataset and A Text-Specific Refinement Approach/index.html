<!DOCTYPE html>
<html lang=zh-CN data-theme="light">
	
<script src="/js/plugins/toggleTheme.js"></script>

	<script>
		setTheme();
	</script>
	<head>
		
<title>Paper-Rethinking Text Segmentation：A Novel Dataset and A Text-Specific Refinement Approach | Zi-Zi's Journey</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/images/icon/favicon.ico">
<link href="/css/plugins/print.css" media="print" rel="stylesheet" />

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="Python,论文,Pytorch,代码复现,图像分割,">
<meta name="description" content="论文阅读。">



<script src="/js/plugins/jquery.min.js"></script>


<script src="/js/plugins/hljs.min.js"></script>


<script src="/js/plugins/init.js"></script>


<script src="/js/plugins/hide.js"></script>


<script src="/js/plugins/tabs.js"></script>



    



    
<script src="/js/plugins/alert-title.js"></script>

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-base.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-dark-class.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-light.css">






    

	<meta name="generator" content="Hexo 6.1.0"></head>

	<body>
		<header class="sticky-header">
	<nav>
		<div class="nav-left">
			<a href="/" class="logo">
				<img no-lazy src="/images/headers_icon/logo.webp" alt="Quieter">
			</a>
			<ul class="breadcrumb" id="breadcrumb"></ul>
		</div>
		<div class="nav-right">
			<ul>
				
					<li>
						<a href="/">
						  主页
						</a>
					</li>
				
					<li>
						<a href="/categories">
						  类别
						</a>
					</li>
				
					<li>
						<a href="/tags">
						  标签
						</a>
					</li>
				
					<li>
						<a href="/archives">
						  归档
						</a>
					</li>
				
					<li>
						<a href="/galleries">
						  相册
						</a>
					</li>
				
					<li>
						<a href="/links">
						  链接
						</a>
					</li>
				
					<li>
						<a href="/about">
						  关于
						</a>
					</li>
								  
			</ul>
		</div>
		<div class="nav-right-close">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
				<path fill="none" d="M0 0h24v24H0z" />
				<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
			</svg>
		</div>

		<div class="sidebar">
    <div class="topo">
        <p>Zi-Zi's Journey</p>
    </div>
    <ul>
        
        <li>
            <a href="/">
                主页
            </a>
        </li>
        
        <li>
            <a href="/categories">
                类别
            </a>
        </li>
        
        <li>
            <a href="/tags">
                标签
            </a>
        </li>
        
        <li>
            <a href="/archives">
                归档
            </a>
        </li>
        
        <li>
            <a href="/galleries">
                相册
            </a>
        </li>
        
        <li>
            <a href="/links">
                链接
            </a>
        </li>
        
        <li>
            <a href="/about">
                关于
            </a>
        </li>
        
    </ul>
    <div class="sidebar-footer">
        
        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
        </a>
        
    </div>
</div>
<div class='shelter'>
    <script>
        $(function() {
            $('.nav-right-close > svg').click(function() {
                $('.sidebar').animate({
                    right: "0"
                }, 500);
                $('.shelter').fadeIn("slow");
            
                var element = $('.topo');
                element.addClass('custom-style');
            
                var links = null;
                if ("") {
                    links = "".split(',');
                } else {
                    links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
                }
            
                var randomLink = links[Math.floor(Math.random() * links.length)];
                element.css('background-image', "url('" + randomLink + "')");
            });
          
            $('.shelter').click(function(e) {
                $('.sidebar').animate({
                    right: "-100%"
                }, 500);
                $('.shelter').fadeOut("slow");
            });
        });      
    </script>
</div>
	</nav>

	
		<div class="header-background"></div>
	

	<script>
		const name = 'post';
		const ul = document.querySelectorAll('.nav-right ul')[0];
		const lis = ul.querySelectorAll('li');

		if (name == 'home') {
			lis[0].classList.add('select');
		} else {
			for (let i = 0; i < lis.length; i++) {
				const li = lis[i];
				const a = li.querySelector('a');
				if (name === a.href.split('/')[3]) {
					li.classList.add('select');
				}
			}
		}
	</script>
	
	<script>
		var element = document.querySelector('.header-background');
		if(element) {
			element.classList.add('custom-style');
			var links = null;
			if("")
			{
				links = "".split(',');
			} else
			{
				links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
			}
			var randomLink = links[Math.floor(Math.random() * links.length)];
			element.style.backgroundImage = "url('" + randomLink + "')";
		}
	</script>

	
<script src="/js/plugins/breadcrumb.js"></script>

	<script>
		var menus_title = [];
		
			menus_title.push({home: '主页'});
		
			menus_title.push({categories: '类别'});
		
			menus_title.push({tags: '标签'});
		
			menus_title.push({archives: '归档'});
		
			menus_title.push({galleries: '相册'});
		
			menus_title.push({links: '链接'});
		
			menus_title.push({about: '关于'});
		
		
			
				postsBreadcrumb(
					document.getElementById('breadcrumb'),
					"类别",
					"/categories",
					"学习",
					"/categories/学习",
					1
				);
			
		
	</script>
</header>

<div class="main-wrapper">
    <main class="post">
        <header class="main-header">
	
		
			
				
<link rel="stylesheet" href="/css/plugins/fancybox.css">

				
<script src="/js/plugins/fancybox.umd.js"></script>

				
<script src="/js/plugins/fancybox.js"></script>

			
			<div class="post-header-background-content">
				<ul class="post-header-tag">
					
						
							<li><a href="/tags/Python"><span>Python</span></a></li>
						
							<li><a href="/tags/论文"><span>论文</span></a></li>
						
							<li><a href="/tags/Pytorch"><span>Pytorch</span></a></li>
						
							<li><a href="/tags/代码复现"><span>代码复现</span></a></li>
						
							<li><a href="/tags/图像分割"><span>图像分割</span></a></li>
						
					
				</ul>
				
				<h1>Paper-Rethinking Text Segmentation：A Novel Dataset and A Text-Specific Refinement Approach</h1>
		
				
					<div class="post-header-desc">
						<svg t="1714702231661" class="icon" viewBox="0 0 1024 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="1154" xmlns:xlink="http://www.w3.org/1999/xlink"
						width="20" height="20">
						<path
							d="M778.24 117.76A46.08 46.08 0 0 1 824.32 163.84v430.08c0 8.4992-4.13696 16.01536-10.50624 20.6848l-0.24576 0.2048L587.5712 846.09024a35.84 35.84 0 0 1-61.48096-25.06752v-220.9792a46.08 46.08 0 0 1 46.08-46.08l200.94976-0.02048V168.96h-522.24v686.08H389.12c13.25056 0 24.1664 10.07616 25.47712 22.97856l0.12288 2.62144c0 14.1312-11.4688 25.6-25.6 25.6h-143.36A46.08 46.08 0 0 1 199.68 860.16V163.84A46.08 46.08 0 0 1 245.76 117.76h532.48z m-26.78784 487.38304h-174.16192v178.176l174.16192-178.176z m-45.19936-169.94304a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z m0-122.88a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z"
							fill="#ffffff" p-id="1155"></path>
						</svg>
						<p>论文阅读。</p>
					</div>
				
		
				<div class="post-header-info">
					<svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
					xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
						<path
							d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
							p-id="2902" fill="#ffffff"></path>
					</svg>
					<div class="post-header-info-author">
						<a href="/about">Zi-Zi</a>
					</div>
					
						<div class="post-header-info-categories">
							
								<a href="/categories/学习">学习</a>
							
						</div>
					
					<time>2023/05/04 17:09:00</time>
				</div>
		
				
					<div class="post-header-stat">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
						viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve" width="20" height="20">
							<path fill="#FFFFFF" d="M187.2,165.6c0,2.6-2.1,4.7-4.7,4.7H17.5c-2.6,0-4.7-2.1-4.7-4.7s2.1-4.7,4.7-4.7h165.1
								C185.2,160.9,187.2,163,187.2,165.6z"/>
							<path fill="#FFFFFF" d="M17.5,29.7c2.6,0,4.7,2.1,4.7,4.7v131.2c0,2.6-2.1,4.7-4.7,4.7s-4.7-2.1-4.7-4.7V34.4
								C12.8,31.8,14.9,29.7,17.5,29.7z M77.9,91.5c1.8,1.8,1.8,4.8,0,6.6l-39.8,39.8c-1.9,1.8-4.9,1.7-6.6-0.2c-1.7-1.8-1.7-4.6,0-6.4
								l39.8-39.8C73.1,89.6,76,89.6,77.9,91.5z M169.9,70.2c1.6,2.1,1.1,5-0.9,6.5c0,0,0,0,0,0l-64.2,48.2c-2.1,1.5-5,1.1-6.6-0.9
								c-1.6-2.1-1.1-5,0.9-6.5c0,0,0,0,0,0l64.2-48.2C165.4,67.7,168.3,68.1,169.9,70.2L169.9,70.2z"/>
							<path fill="#FFFFFF" d="M104.6,124.5c-1.8,1.8-4.8,1.8-6.6,0L71.6,98.1c-1.8-1.8-1.8-4.8,0-6.6c1.8-1.8,4.8-1.8,6.6,0l26.3,26.3
								C106.4,119.6,106.4,122.6,104.6,124.5C104.6,124.4,104.6,124.4,104.6,124.5z"/>
						</svg>
		
						
							
<script src="/js/plugins/wordCount.js"></script>

							<p class="post-count">文字数：---</p>
						
		
						
							<p id="busuanzi_container_page_pv" style='display:none;'>阅读数：<span id="busuanzi_value_page_pv"></span></p>
						
					</div>
				
			</div>
		
	
</header>
        <div class="post-content article-container">
            <article class="post-content-info">
                <h1 id="%E8%B5%84%E6%BA%90" tabindex="-1">资源</h1>
<ul>
<li>
<p>原文：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2011.14021v1">[2011.14021v1] Rethinking Text Segmentation: A Novel Dataset and A Text-Specific Refinement Approach (arxiv.org)</a></p>
</li>
<li>
<p>代码：<a target="_blank" rel="noopener" href="https://github.com/SHI-Labs/Rethinking-Text-Segmentation">SHI-Labs/Rethinking-Text-Segmentation: [CVPR 2021] Rethinking Text Segmentation: A Novel Dataset and A Text-Specific Refinement Approach (github.com)</a></p>
</li>
</ul>
<h1 id="%E7%AC%94%E8%AE%B0" tabindex="-1">笔记</h1>
<p><strong>文本分割（text segmentation）<strong>是很多任务的先决条件！如</strong>文本样式迁移（text style transfer）<strong>和</strong>场景文本移除（scene text removal）</strong>。</p>
<h2 id="textseg" tabindex="-1" id="TextSeg">TextSeg</h2>
<p>最近一次公共文本分割挑战在 2013-2015 年，由 ICDAR 主办。只有数据集：</p>
<ul>
<li>Total Text</li>
<li>COCO TS</li>
<li>MLT_S</li>
</ul>
<p>都只有场景文本，没有艺术设计文本。</p>
<p>目前数据集太少了啊啊啊啊！但是我们提出了一种新的数据集 <em><strong>TextSeg</strong></em>！</p>
<ul>
<li>
<p>4024 张图像</p>
<ul>
<li>2646 训练集</li>
<li>340 验证集</li>
<li>1038 测试集</li>
</ul>
</li>
<li>
<p>具有六种类型的注释：</p>
<ul>
<li>
<p>单词 word</p>
</li>
<li>
<p>字符 character</p>
</li>
<li>
<p>边界多边形 bounding polygons</p>
</li>
<li>
<p>蒙版 masks</p>
</li>
<li>
<p>转录 transcriptions</p>
</li>
<li>
<p>阴影、3D、光晕等也进行了注释</p>
</li>
</ul>
</li>
<li>
<p>先进之处：</p>
<ul>
<li>来自不同来源，样式更多</li>
<li>注释更全面</li>
<li>accurate masks 更准确</li>
</ul>
</li>
</ul>
<h2 id="texrnet" tabindex="-1" id="TexRNet">TexRNet</h2>
<p>早期都是用<strong>阈值法</strong>进行分割，对复杂颜色和纹理的场景文本图像就 GG。深度学习方法：SMANet。</p>
<p>提出了一种新的文本分割网络：<em><strong>TexRNet</strong></em>！</p>
<p><img src="3.png" alt="png"></p>
<ul>
<li>适应了文本的独特特性，如非凸边界、不同纹理等。</li>
<li>DeeplabV3+ 或 HRNet
<ul>
<li>ResNet101-DeeplabV3+ 和 HRNetV-W48 是语义分割领域的里程碑和最先进的作品</li>
</ul>
</li>
<li>有效的网络模块：<strong>关键特征池（key features pooling）<strong>和</strong>基于注意力的相似性检查（attention-based similarity checking）</strong>
<ul>
<li>关键特征池：使用余弦相似性学习文本纹理</li>
<li>基于注意力的相似性检查，使用一个注意力层，用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span> 作为关键字，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">x_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 作为查询，并通过点积和 softmax 来计算查询关键字的相似性 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>a</mi><mi>t</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{att}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>a</mi><mi>t</mi><mi>t</mi></mrow></msub><mo>=</mo><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow><mo>(</mo><msup><mi>v</mi><mi>T</mi></msup><mo>⋅</mo><msub><mi>x</mi><mi>f</mi></msub><mo>)</mo><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>a</mi><mi>t</mi><mi>t</mi></mrow></msub><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>c</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">x_{att}=\mathrm{Softmax}(v^T\cdot x_f),x_{att}\in \mathbb{R}^{c\times n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.1274389999999999em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathrm">S</span><span class="mord mathrm">o</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm">t</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">∈</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">c</span><span class="mbin">×</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li>
</ul>
</li>
<li>引入了**三映射（trimap loss）<strong>和</strong>鉴别器（glyph discriminator）**损失
<ul>
<li>
<p>关注边界的损失函数将进一步提高文本的精度</p>
<ul>
<li>\mathcal L_{tri}=\mathrm{WCE}(x_{rfn},x_{gt},w_{tri})\\\mathrm{WCE}(x,y,m)=-\frac{\sum^m_{j=1}w_j\sum^c_{j=1}x_{i,j}\log(y_{i,j})}{\sum^n_{j=1}w_j}
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>t</mi><mi>r</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{tri}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 是文本边界上值为 1、其他地方为 0 的二进制映射</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">W</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">E</mi></mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathrm{WCE}(x,y,w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.01389em;">W</span><span class="mord mathrm">C</span><span class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span> 是由空间映射 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span> 加权的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span> 之间的交叉熵</li>
</ul>
</li>
</ul>
</li>
<li>
<p>预训练用于字符识别的分类器，有 37 个类，包含 26 个字母，10 个数字和 misc</p>
</li>
<li>
<p>最终损失函数：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">L</mi><mo>=</mo><msub><mi mathvariant="script">L</mi><mrow><mi>s</mi><mi>e</mi><mi>m</mi></mrow></msub><mo>+</mo><mi>α</mi><msub><mi mathvariant="script">L</mi><mrow><mi>r</mi><mi>f</mi><mi>n</mi></mrow></msub><mo>+</mo><mi>β</mi><msub><mi mathvariant="script">L</mi><mrow><mi>t</mi><mi>r</mi><mi>i</mi></mrow></msub><mo>+</mo><mi>γ</mi><msub><mi mathvariant="script">L</mi><mrow><mi>d</mi><mi>i</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal L = \mathcal L_{sem} +\alpha\mathcal L_{rfn} +\beta\mathcal L_{tri} +\gamma\mathcal L_{dis}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord mathcal">L</span><span class="mrel">=</span><span class=""><span class="mord mathcal">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class=""><span class="mord mathcal">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05278em;">β</span><span class=""><span class="mord mathcal">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class=""><span class="mord mathcal">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">i</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p>
</li>
</ul>
</li>
</ul>
<hr>
<p>实验结果：</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>TextSeg(Ours)</th>
<th>ICDAR13 FST</th>
<th>COCO_TS</th>
<th>MLT_S</th>
<th>Total-Text</th>
</tr>
</thead>
<tbody>
<tr>
<td>指标</td>
<td>fgIoU/F-score</td>
<td>fgIoU/F-score</td>
<td>fgIoU/F-score</td>
<td>fgIoU/F-score</td>
<td>fgIoU/F-score</td>
</tr>
<tr>
<td>DeeplabV3+</td>
<td>84.07/0.914</td>
<td>69.27/0.802</td>
<td>72.07/0.641</td>
<td>84.63/0.837</td>
<td>74.44/0.824</td>
</tr>
<tr>
<td>HRNetV2-W48</td>
<td>85.03/0.914</td>
<td>70.98/0.822</td>
<td>68.93/0.629</td>
<td>83.26/0.836</td>
<td>75.29/0.825</td>
</tr>
<tr>
<td>HRNetV2-W48 + OCR</td>
<td>85.98/0.918</td>
<td>72.45/0.830</td>
<td>69.54/0.627</td>
<td>83.49/0.838</td>
<td>76.23/0.832</td>
</tr>
<tr>
<td>Ours: TexRNet + DeeplabV3+</td>
<td>86.06/0.921</td>
<td>72.16/0.835</td>
<td><strong>73.98/0.722</strong></td>
<td><strong>86.31</strong>/0.830</td>
<td>76.53/0.844</td>
</tr>
<tr>
<td>Ours: TexRNet + HRNetV2-W48</td>
<td><strong>86.84/0.924</strong></td>
<td><strong>73.38/0.850</strong></td>
<td>72.39/0.720</td>
<td>86.09/<strong>0.865</strong></td>
<td><strong>78.47/0.848</strong></td>
</tr>
</tbody>
</table>
<h1 id="%E4%BB%A3%E7%A0%81" tabindex="-1">代码</h1>
<h2 id="textseg-1" tabindex="-1" id="TextSeg-2">TextSeg</h2>
<blockquote>
<p>我们的数据集（TextSeg）仅供学术界使用，不能用于任何商业项目和研究。要下载数据，请向 <em><a href="mailto:textseg.dataset@gmail.com">textseg.dataset@gmail.com</a></em> 发送请求电子邮件，并告诉我们您隶属于哪所学校。</p>
</blockquote>
<p>但是网上居然还是能找到下载地址……：<a target="_blank" rel="noopener" href="https://hyper.ai/datasets/15774">TextSeg 大规模文本检测及分割数据集 - 数据集下载 - 超神经 (hyper.ai)</a></p>
<hr>
<p><img src="C1.png" alt="png"></p>
<ul>
<li>
<p><code>image.tar.gz</code>包含 4024 张图像。</p>
</li>
<li>
<p><code>annotation.tar.gz</code></p>
<p>与图像对应的标签。包括以下三种类型的文件：</p>
<ul>
<li><code>[dataID]_anno.json</code> 包含所有单词和字符级别的翻译以及边界多边形。</li>
<li><code>[dataID]_mask.png</code> 包含所有字符掩码。字符掩码标签值将从 1 到 n 排序。标签值 0 表示背景，255 表示忽略。</li>
<li><code>[dataID]_maskeff.png</code> 包含所有<strong>具有效果的</strong>字符掩码。</li>
<li><code>Adobe_Research_License_TextSeg.txt</code> 许可证文件。</li>
</ul>
</li>
<li>
<p><code>semantic_label.tar.gz</code></p>
<p>包含所有字级（语义级）掩码。它包含：</p>
<ul>
<li><code>[dataID]_maskfg.png</code> 0 表示背景，100 表示单词，200 表示单词效果，255 表示忽略。（也可以使用<code>[dataID]_maskfg.png</code>、<code>[dataID]_mask.png</code>  和 <code>[dataID]_maskeff.png</code>)</li>
</ul>
</li>
<li>
<p><code>split.json</code> 训练集，验证集和测试集的官方拆分。</p>
</li>
<li>
<p>[可选]我们论文中使用的旧版本标签。可以下载它以复制我们的论文结果。<code>semantic_label_v1.tar.gz</code></p>
</li>
</ul>
<h2 id="texrnet-1" tabindex="-1" id="TexRNet-2">TexRNet</h2>
<p>有两种 Backbone，效果各有千秋？</p>
<ul>
<li>HENetV-W48</li>
<li>DeeplabV3+</li>
</ul>
<p>从 <a target="_blank" rel="noopener" href="https://drive.google.com/drive/folders/1EvGNvI5R6NKsW0YTy_0YHD9dpvtM0HDi">TexRNet - Google Drive</a> 下载相应内容：</p>
<ul>
<li>
<p>测试：<code>texrnet_hrnet.pth</code> 或 <code>texrnet_deeplab.pth</code></p>
</li>
<li>
<p>训练：<code>init/*</code></p>
</li>
</ul>
<h2 id="%E9%85%8D%E7%BD%AE" tabindex="-1" id="配置">配置</h2>
<ol>
<li>新建一个 conda 环境：</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda create -n texrnet python=3.7<br></code></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda activate texrnet<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>使用离线安装方式安装 <code>pytorch</code>（被坑了 n 次逐渐熟练了 orz，还是离线安装的方式好使），从 <a target="_blank" rel="noopener" href="https://download.pytorch.org/whl/torch_stable.html">download.pytorch.org/whl/torch_stable.html</a> 下载对应版本的 <code>pytorch</code> 和 <code>torchvision</code>：</li>
</ol>
<ul>
<li><code>torch-1.13.1+cu117-cp37-cp37m-win_amd64.whl</code></li>
<li><code>torchvision-0.14.1+cu117-cp37-cp37m-win_amd64.whl</code></li>
</ul>
<p>不知道为什么今天 edge 下载得特别慢，用迅雷了。</p>
<p><img src="C2.png" alt="png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip install torch-1.13.1+cu117-cp37-cp37m-win_amd64.whl -i https://pypi.tuna.tsinghua.edu.cn/simple<br></code></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip install torchvision-0.14.1+cu117-cp37-cp37m-win_amd64.whl -i https://pypi.tuna.tsinghua.edu.cn/simple<br></code></pre></td></tr></table></figure>
<p><img src="C3.png" alt="png"></p>
<ol start="3">
<li>
<p>拉取仓库：<a target="_blank" rel="noopener" href="https://github.com/SHI-Labs/Rethinking-Text-Segmentation">SHI-Labs/Rethinking-Text-Segmentation: [CVPR 2021] Rethinking Text Segmentation: A Novel Dataset and A Text-Specific Refinement Approach (github.com)</a></p>
</li>
<li>
<p>在仓库目录下，将 <code>requirement.txt</code> 里的 <code>torch==1.6</code> 和 <code>torchvision==0.7</code> 删掉，然后执行：</p>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip install -r requirement.txt -i https://pypi.tuna.tsinghua.edu.cn/simple<br></code></pre></td></tr></table></figure>
<ol start="6">
<li>在仓库目录下，新建好下列文件夹：</li>
</ol>
<ul>
<li><code>pretrained</code>
<ul>
<li><code>pretrained/init</code></li>
</ul>
</li>
<li><code>data</code></li>
<li><code>log</code></li>
</ul>
<p><img src="C4.png" alt="png"></p>
<ol start="7">
<li>放置数据库在 <code>data/TextSeg</code> 中：</li>
</ol>
<p><img src="C5.png" alt="png"></p>
<h2 id="%E6%B5%8B%E8%AF%95" tabindex="-1" id="测试">测试</h2>
<ol>
<li>
<p>先改代码！Windows 下踩坑：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_61787307/article/details/129638108">Pytorch 报错解决——（亲测有效）RuntimeError: Distributed package doesn‘t have NCCL built in_康康好老啊的博客-CSDN 博客</a>。pycharm 中 <code>ctrl+shift+r</code> 将所有 <code>nccl</code> 替换为 <code>gloo</code></p>
</li>
<li>
<p>设置参数：<code>--eval --pth pretrained/texrnet_hrnet.pth --hrnet --gpu 0 --dsname textseg</code></p>
</li>
</ol>
<p><img src="C6.png" alt="png"></p>
<ol start="3">
<li>能跑，GPU 风扇疯狂转，吓得我赶紧停了😅。还是用服务器吧呜呜呜……</li>
</ol>
<p><img src="C7.png" alt="png"></p>
<h2 id="%E8%AE%AD%E7%BB%83" tabindex="-1" id="训练">训练</h2>
<ol>
<li>设置参数：<code>--hrnet --gpu 0 --dsname textseg --trainwithcls</code></li>
</ol>
<p><img src="C8.png" alt="png"></p>
<ol start="2">
<li>踩坑，在 <code>data\TextSeg</code> 中，把 <code>annotation</code> 文件夹名称修改为 <code>bpoly_label</code></li>
</ol>
<p><img src="C9.png" alt="png"></p>
<ol start="3">
<li><s>应该能 train 吧，显示显存不够是真的牛逼😅。还是用服务器吧呜呜呜……（是不是调成 gloo 的问题？该好好学 linux 了呜呜呜）</s></li>
</ol>
<p><img src="C10.png" alt="png"></p>
<p>我说婷婷！在 <code>train_utils.py</code> 里把 <code>cfg.DATA.NUM_WORKERS_PER_GPU</code> 调小就又可以跑了！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cfg.DEBUG:<br>    cfg.DATA.NUM_WORKERS_PER_GPU = <span class="hljs-number">2</span><br>    cfg.TRAIN.BATCH_SIZE_PER_GPU = <span class="hljs-number">2</span><br>cfg.TRAIN.OPTIM_MANAGER_LRSCALE = &#123;<br>    <span class="hljs-string">&#x27;hrnet&#x27;</span>:<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;texrnet&#x27;</span>: <span class="hljs-number">10</span>&#125;<br><span class="hljs-keyword">return</span> cfg<br></code></pre></td></tr></table></figure>
<p>好吧还是跑不了，giao！<font color="red">  File “D:\Study\XXXXX\Rethinking-Text-Segmentation\lib\torchutils.py”, line 262, in <em>_call</em>_
return y
UnboundLocalError: local variable ‘y’ referenced before assignment</font></p>
<h2 id="%E9%98%85%E8%AF%BB" tabindex="-1" id="阅读">阅读</h2>
<p>感觉这个仓库的代码写的很隐秘……一层又一层的。</p>
<h3 id="main.py" tabindex="-1" id="main-py"><a target="_blank" rel="noopener" href="http://main.py">main.py</a></h3>
<p><code>--eval --pth pretrained/texrnet_hrnet.pth --hrnet --gpu 0 --dsname textseg</code></p>
<p>表示：</p>
<ul>
<li>开启 eval 模式</li>
<li>预训练模型路径：<code>pretrained/texrnet_hrnet.pth</code></li>
<li>使用 HRNet 模型</li>
<li>使用 0 号 GPU</li>
<li>数据集：<code>textseg</code></li>
</ul>
<p>设置 parser 参数：</p>
<table>
<thead>
<tr>
<th>name</th>
<th>type</th>
<th>default</th>
<th>help</th>
</tr>
</thead>
<tbody>
<tr>
<td>–debug</td>
<td>bool</td>
<td>False</td>
<td>是否启动 debug 模式</td>
</tr>
<tr>
<td>–hrnet</td>
<td>bool</td>
<td>False</td>
<td>是否使用 HRNet 模型</td>
</tr>
<tr>
<td>–eval</td>
<td>bool</td>
<td>False</td>
<td>是否开启 eval 模式</td>
</tr>
<tr>
<td>–pth</td>
<td>str</td>
<td></td>
<td>保存的权重文件路径，即预训练模型的路径</td>
</tr>
<tr>
<td>–gpu</td>
<td></td>
<td></td>
<td>使用哪些 GPU</td>
</tr>
<tr>
<td>–port</td>
<td>int</td>
<td>11233</td>
<td>分布式处理的端口号</td>
</tr>
<tr>
<td>–dsname</td>
<td>str</td>
<td>‘textseg’</td>
<td>数据集名称，可选：‘textseg’、‘cocots’、‘mlt’、‘icdar13’、‘totaltext’</td>
</tr>
<tr>
<td>–trainwithcls</td>
<td>bool</td>
<td>False</td>
<td>是否使用分类器来训练</td>
</tr>
</tbody>
</table>
<p><code>istrain = not args.eval</code>，如果不开启 eval 模式，那就是开启 train 模式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 设置训练模式</span><br><span class="hljs-keyword">if</span> istrain:<br>    cfg = copy.deepcopy(cfg_train)<br><span class="hljs-keyword">else</span>:<br>    cfg = copy.deepcopy(cfg_test)<br><br><span class="hljs-keyword">if</span> istrain:<br>    <span class="hljs-comment"># 运行在训练模式下，则调用 get_experiment_id()函数获取一个新的实验 ID，并将其赋值给 cfg.EXPERIMENT_ID。</span><br>    <span class="hljs-comment"># 每次运行程序时，都会产生一个新的实验 ID，以便在训练多个模型时能够区分它们之间的差异</span><br>    cfg.EXPERIMENT_ID = get_experiment_id()<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-comment"># 表示当前不处于任何实验中</span><br>    cfg.EXPERIMENT_ID = <span class="hljs-literal">None</span><br><br><span class="hljs-comment"># 设置数据集</span><br><span class="hljs-keyword">if</span> args.dsname == <span class="hljs-string">&quot;textseg&quot;</span>:<br>    cfg_data = cfg_textseg<br><span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;cocots&quot;</span>:<br>    cfg_data = cfg_cocots<br><span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;mlt&quot;</span>:<br>    cfg_data = cfg_mlt<br><span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;icdar13&quot;</span>:<br>    cfg_data = cfg_icdar13<br><span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;totaltext&quot;</span>:<br>    cfg_data = cfg_totaltext<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">raise</span> ValueError<br><br>cfg.DEBUG = args.debug<br>cfg.DIST_URL = <span class="hljs-string">&#x27;tcp://127.0.0.1:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(args.port)<br><span class="hljs-keyword">if</span> args.gpu <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-comment"># 如果不设置 GPU，就都用了</span><br>    cfg.GPU_DEVICE = <span class="hljs-string">&#x27;all&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-comment"># 使用指定的 GPU</span><br>    cfg.GPU_DEVICE = args.gpu<br><br><span class="hljs-comment"># 加载模型和数据</span><br>cfg.MODEL = copy.deepcopy(cfg_mdel)<br>cfg.DATA  = copy.deepcopy(cfg_data)<br><br><span class="hljs-keyword">if</span> istrain:<br>    cfg = set_cfg_train(cfg, dsname=args.dsname)<br>    <span class="hljs-keyword">if</span> args.hrnet:<br>        <span class="hljs-comment"># 调用 set_cfg_hrnetw48_train 函数对 HRNet-W48 模型进行配置</span><br>        cfg = set_cfg_hrnetw48_train(cfg)<br><span class="hljs-keyword">else</span>:<br>    cfg = set_cfg_eval(cfg, dsname=args.dsname)<br>    <span class="hljs-keyword">if</span> args.hrnet:<br>        cfg = set_cfg_hrnetw48_eval(cfg)<br>    <span class="hljs-comment"># 加载预训练模型</span><br>    cfg.MODEL.TEXRNET.PRETRAINED_PTH = args.pth<br><br><span class="hljs-comment"># 设置数据集模式</span><br><span class="hljs-keyword">if</span> istrain:<br>    <span class="hljs-keyword">if</span> args.dsname == <span class="hljs-string">&quot;textseg&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;train+val&#x27;</span><br>    <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;cocots&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;train&#x27;</span><br>    <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;mlt&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;trainseg&#x27;</span><br>    <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;icdar13&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;train_fst&#x27;</span><br>    <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;totaltext&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;train&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> ValueError<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">if</span> args.dsname == <span class="hljs-string">&quot;textseg&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;test&#x27;</span><br>    <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;cocots&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;val&#x27;</span><br>    <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;mlt&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;valseg&#x27;</span><br>    <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;icdar13&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;test_fst&#x27;</span><br>    <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&quot;totaltext&quot;</span>:<br>        cfg.DATA.DATASET_MODE = <span class="hljs-string">&#x27;test&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> ValueError<br>        <br><span class="hljs-keyword">if</span> istrain:<br>    <span class="hljs-keyword">if</span> args.trainwithcls:  <span class="hljs-comment"># 启动分布式训练</span><br>        <span class="hljs-keyword">if</span> args.dsname == <span class="hljs-string">&#x27;textseg&#x27;</span>:  <span class="hljs-comment"># 数据集</span><br>            cfg.DATA.LOADER_PIPELINE = [<br>                <span class="hljs-string">&#x27;NumpyImageLoader&#x27;</span>,   <span class="hljs-comment"># 使用 numpy 模块读取图像数据</span><br>                <span class="hljs-string">&#x27;TextSeg_SeglabelLoader&#x27;</span>,  <span class="hljs-comment"># 加载文本区域分割标签数据</span><br>                <span class="hljs-string">&#x27;CharBboxSpLoader&#x27;</span>,]  <span class="hljs-comment"># 加载字符边界框数据。这些数据都是用于文本检测或分割任务的</span><br>            cfg.DATA.RANDOM_RESIZE_CROP_SIZE = [<span class="hljs-number">32</span>, <span class="hljs-number">32</span>]  <span class="hljs-comment"># 随机裁剪的尺寸</span><br>            cfg.DATA.RANDOM_RESIZE_CROP_SCALE = [<span class="hljs-number">0.8</span>, <span class="hljs-number">1.2</span>]  <span class="hljs-comment"># 缩放比例</span><br>            cfg.DATA.RANDOM_RESIZE_CROP_RATIO = [<span class="hljs-number">3</span>/<span class="hljs-number">4</span>, <span class="hljs-number">4</span>/<span class="hljs-number">3</span>]  <span class="hljs-comment"># 宽高比范围</span><br>            cfg.DATA.TRANS_PIPELINE = [<br>                <span class="hljs-string">&#x27;UniformNumpyType&#x27;</span>,  <span class="hljs-comment"># 将图像数据类型转换为相同的类型，以便进行后续的处理</span><br>                <span class="hljs-string">&#x27;TextSeg_RandomResizeCropCharBbox&#x27;</span>,  <span class="hljs-comment"># 对文本区域分割标签和字符边界框等数据进行随机尺度变换和裁剪操作，以增强模型鲁棒性</span><br>                <span class="hljs-string">&#x27;NormalizeUint8ToZeroOne&#x27;</span>,   <span class="hljs-comment"># 将像素值范围从[0, 255]归一化到[0, 1]</span><br>                <span class="hljs-string">&#x27;Normalize&#x27;</span>,  <span class="hljs-comment"># 进行零均值和单位方差的标准化处理</span><br>                <span class="hljs-string">&#x27;RandomScaleOneSide&#x27;</span>,  <span class="hljs-comment"># 对图像数据进行单边缩放，以增加模型对图像尺度的鲁棒性</span><br>                <span class="hljs-string">&#x27;RandomCrop&#x27;</span>,   <span class="hljs-comment"># 对图像数据进行随机裁剪操作</span><br>            ]<br>        <span class="hljs-keyword">elif</span> args.dsname == <span class="hljs-string">&#x27;icdar13&#x27;</span>:<br>            cfg.DATA.LOADER_PIPELINE = [<br>                <span class="hljs-string">&#x27;NumpyImageLoader&#x27;</span>,   <span class="hljs-comment"># 使用 numpy 模块读取图像数据</span><br>                <span class="hljs-string">&#x27;SeglabelLoader&#x27;</span>,  <span class="hljs-comment"># 加载文本区域分割标签数据</span><br>                <span class="hljs-string">&#x27;CharBboxSpLoader&#x27;</span>,]  <span class="hljs-comment"># 加载字符边界框数据</span><br>            cfg.DATA.TRANS_PIPELINE = [<br>                <span class="hljs-string">&#x27;UniformNumpyType&#x27;</span>,  <span class="hljs-comment"># 将图像数据类型转换为相同的类型，以便进行后续的处理</span><br>                <span class="hljs-string">&#x27;NormalizeUint8ToZeroOne&#x27;</span>,   <span class="hljs-comment"># 将像素值范围从[0, 255]归一化到[0, 1]</span><br>                <span class="hljs-string">&#x27;Normalize&#x27;</span>,  <span class="hljs-comment"># 进行零均值和单位方差的标准化处理</span><br>                <span class="hljs-string">&#x27;RandomScaleOneSide&#x27;</span>,  <span class="hljs-comment"># 对图像数据进行单边缩放，以增加模型对图像尺度的鲁棒性</span><br>                <span class="hljs-string">&#x27;RandomCrop&#x27;</span>,  <span class="hljs-comment"># 对图像数据进行随机裁剪操作</span><br>            ]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">raise</span> ValueError<br>        <span class="hljs-comment"># 将文本数据格式化为文本区域和字符边界框标签，以便进行检测和识别任务的训练</span><br>        cfg.DATA.FORMATTER = <span class="hljs-string">&#x27;SemChinsChbbxFormatter&#x27;</span><br>        <span class="hljs-comment"># 用于将字符边界框转化成方形，以方便进行 RoI 池化</span><br>        cfg.DATA.LOADER_SQUARE_BBOX = <span class="hljs-literal">True</span><br>        <span class="hljs-comment"># 表示随机裁剪操作从哪个阶段开始，这里设为&#x27;sem&#x27;即从语义分割的阶段开始</span><br>        cfg.DATA.RANDOM_RESIZE_CROP_FROM = <span class="hljs-string">&#x27;sem&#x27;</span><br>        <span class="hljs-comment"># 表示网络在训练过程中从哪个阶段进行预测得到输出结果，这里设为&#x27;sem&#x27;也是从语义分割的阶段开始</span><br>        cfg.MODEL.TEXRNET.INTRAIN_GETPRED_FROM = <span class="hljs-string">&#x27;sem&#x27;</span><br>        <span class="hljs-comment"># the one with 93.98% and trained on semantic crops</span><br>        <span class="hljs-comment"># 分类器的预训练模型路径</span><br>        cfg.TRAIN.CLASSIFIER_PATH = osp.join(<br>            <span class="hljs-string">&#x27;pretrained&#x27;</span>, <span class="hljs-string">&#x27;init&#x27;</span>, <span class="hljs-string">&#x27;resnet50_textcls.pth&#x27;</span>,<br>        )<br>        <span class="hljs-comment"># RoI 池化时边界框的扩充方式，这里采用 semcrop</span><br>        cfg.TRAIN.ROI_BBOX_PADDING_TYPE = <span class="hljs-string">&#x27;semcrop&#x27;</span><br>        <span class="hljs-comment"># RoI 池化后的图像大小</span><br>        cfg.TRAIN.ROI_ALIGN_SIZE = [<span class="hljs-number">32</span>, <span class="hljs-number">32</span>]<br>        <span class="hljs-comment"># 是否对分类器进行更新</span><br>        cfg.TRAIN.UPDATE_CLASSIFIER = <span class="hljs-literal">False</span><br>        <span class="hljs-comment"># 在训练过程中从语义分割的阶段开始多少次迭代后激活分类器的训练</span><br>        cfg.TRAIN.ACTIVATE_CLASSIFIER_FOR_SEGMODEL_AFTER = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># 各个损失函数的权重，包括语义分割的损失、RFN 的损失、RFNtri 的损失和分类器的损失</span><br>        cfg.TRAIN.LOSS_WEIGHT = &#123;<br>            <span class="hljs-string">&#x27;losssem&#x27;</span>   : <span class="hljs-number">1</span>, <br>            <span class="hljs-string">&#x27;lossrfn&#x27;</span>   : <span class="hljs-number">0.5</span>,<br>            <span class="hljs-string">&#x27;lossrfntri&#x27;</span>: <span class="hljs-number">0.5</span>,<br>            <span class="hljs-string">&#x27;losscls&#x27;</span>   : <span class="hljs-number">0.1</span>,<br>        &#125;<br><br><span class="hljs-keyword">if</span> istrain:<br>    <span class="hljs-comment"># 是否采用 HRNet 作为语义分割网络模型，如果不采用，就用 deeplab</span><br>    <span class="hljs-keyword">if</span> args.hrnet:<br>        cfg.TRAIN.SIGNATURE = [<span class="hljs-string">&#x27;texrnet&#x27;</span>, <span class="hljs-string">&#x27;hrnet&#x27;</span>]<br>    <span class="hljs-keyword">else</span>:<br>        cfg.TRAIN.SIGNATURE = [<span class="hljs-string">&#x27;texrnet&#x27;</span>, <span class="hljs-string">&#x27;deeplab&#x27;</span>]<br>    <span class="hljs-comment"># &#x27;LOG_DIR&#x27;：日志文件所在目录，如果是训练模式则创建一个新的实验文件夹，并将日志文件保存在该目录下的&#x27;train.log&#x27;中</span><br>    cfg.LOG_DIR = experiment_folder(cfg, isnew=<span class="hljs-literal">True</span>, sig=cfg.TRAIN.SIGNATURE)<br>    cfg.LOG_FILE = osp.join(cfg.LOG_DIR, <span class="hljs-string">&#x27;train.log&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-comment"># 如果是评估模式则将日志文件保存在&#x27;eval.log&#x27;中</span><br>    cfg.LOG_DIR = osp.join(cfg.MISC_DIR, <span class="hljs-string">&#x27;eval&#x27;</span>)<br>    cfg.LOG_FILE = osp.join(cfg.LOG_DIR, <span class="hljs-string">&#x27;eval.log&#x27;</span>)<br>    cfg.TEST.SUB_DIR = <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">if</span> cfg.DEBUG:<br>    <span class="hljs-comment"># 如果开启了调试模式，则将实验 ID 设置为 999999999999，方便跟踪调试结果</span><br>    cfg.EXPERIMENT_ID = <span class="hljs-number">999999999999</span><br>    <span class="hljs-comment"># 每个 GPU 使用的数据加载器线程数</span><br>    cfg.DATA.NUM_WORKERS_PER_GPU = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># 每个 GPU 使用的 batch size 大小</span><br>    cfg.TRAIN.BATCH_SIZE_PER_GPU = <span class="hljs-number">2</span><br><br>cfg = common_initiates(cfg)  <span class="hljs-comment"># 该函数用于加载训练和测试数据，并进行数据预处理、标准化等操作</span><br><br><span class="hljs-keyword">if</span> istrain:<br>    <span class="hljs-keyword">if</span> args.trainwithcls:<br>        <span class="hljs-comment"># 执行训练操作的时间戳。如果使用分类器，则调用 ts_with_classifier()函数进行时间戳设置</span><br>        exec_ts = ts_with_classifier()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># 调用 ts()函数进行时间戳设置</span><br>        exec_ts = ts()<br>    <span class="hljs-comment"># 训练器对象</span><br>    trainer = train(cfg)<br>    <span class="hljs-comment"># 向训练器对象注册不同的训练阶段，包括数据加载、前向传播、反向传播、参数更新等流程</span><br>    trainer.register_stage(exec_ts)<br><br>    <span class="hljs-comment"># trainer(0)</span><br>    <span class="hljs-comment"># 使用多进程方式进行训练，设置 nprocs 为 GPU_COUNT 即可利用 GPU 并行加速训练过程。</span><br>    <span class="hljs-comment"># 最后，join=True 表示程序会一直阻塞在这里，直到所有进程都完成并退出后才会继续往下执行</span><br>    mp.spawn(trainer,<br>                args=(),<br>                nprocs=cfg.GPU_COUNT,<br>                join=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-comment"># 执行测试操作的时间戳</span><br>    exec_es = es()<br>    <span class="hljs-comment"># 测试器对象</span><br>    tester = <span class="hljs-built_in">eval</span>(cfg)<br>    <span class="hljs-comment"># 向测试器对象注册不同的测试阶段，包括数据加载、前向传播、评估等流程</span><br>    tester.register_stage(exec_es)<br><br>    <span class="hljs-comment"># tester(0)</span><br>    <span class="hljs-comment"># 使用多进程方式进行测试，设置 nprocs 为 GPU_COUNT 即可利用 GPU 并行加速测试过程。</span><br>    <span class="hljs-comment"># 最后，join=True 表示程序会一直阻塞在这里，直到所有进程都完成并退出后才会继续往下执行</span><br>    mp.spawn(tester,<br>            args=(),<br>            nprocs=cfg.GPU_COUNT,<br>            join=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>开跑时，会显示各种参数的情况：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>&#x27;COMPUTER_NAME&#x27;<span class="hljs-punctuation">:</span> &#x27;OMEN&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 电脑名称</span><br> &#x27;CUDA&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// CUDA 是否可用</span><br> &#x27;DATA&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;ALIGN_CORNERS&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否对齐图像的四个角</span><br>          &#x27;CLASS_NAME&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>&#x27;background&#x27;<span class="hljs-punctuation">,</span> &#x27;text&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 类别名称。在本例中，有两类分别为&#x27;background&#x27;和&#x27;text&#x27;</span><br>          &#x27;CLASS_NUM&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 类别数量</span><br>          &#x27;DATASET_MODE&#x27;<span class="hljs-punctuation">:</span> &#x27;train+val&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 数据集模式。在本例中，是训练数据集和验证数据集结合在一起使用</span><br>          &#x27;DATASET_NAME&#x27;<span class="hljs-punctuation">:</span> &#x27;textseg&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 数据集名称，在本例中为&#x27;textseg&#x27;</span><br>          &#x27;EFFECTIVE_CLASS_NUM&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 有效的类别数量</span><br>          &#x27;FORMATTER&#x27;<span class="hljs-punctuation">:</span> &#x27;SemChinsChbbxFormatter&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 数据格式化器的名称，在本例中为&#x27;SemChinsChbbxFormatter&#x27;</span><br>          &#x27;IGNORE_LABEL&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">999</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 忽略的标签值，在本例中为 999</span><br>          &#x27;IM_MEAN&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0.485</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.456</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.406</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 图像各个通道的均值</span><br>          &#x27;IM_STD&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0.229</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.224</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.225</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 图像各个通道的标准差</span><br>          &#x27;LOADER_DERIVED_CLS_MAP_TO&#x27;<span class="hljs-punctuation">:</span> &#x27;bg&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 加载程序映射的类名</span><br>          &#x27;LOADER_PIPELINE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>&#x27;NumpyImageLoader&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 加载数据的处理流程</span><br>                              &#x27;TextSeg_SeglabelLoader&#x27;<span class="hljs-punctuation">,</span><br>                              &#x27;CharBboxSpLoader&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>          &#x27;LOADER_SQUARE_BBOX&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否在加载时将字符的 bbox 转换为正方形</span><br>          &#x27;LOAD_BACKEND_IMAGE&#x27;<span class="hljs-punctuation">:</span> &#x27;pil&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 读取图像的库名称</span><br>          &#x27;LOAD_IS_MC_IMAGE&#x27;<span class="hljs-punctuation">:</span> False<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否是多通道图像</span><br>          &#x27;LOAD_IS_MC_SEGLABEL&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 加载的标签是否是多通道的</span><br>          &#x27;NUM_WORKERS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 加载数据的线程数</span><br>          &#x27;NUM_WORKERS_PER_GPU&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 每个 GPU 上加载数据的线程数</span><br>          &#x27;RANDOM_CROP_FILL&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;image&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> &#x27;seglabel&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">999</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 对图像进行随机 crop 时需要填充的内容</span><br>          &#x27;RANDOM_CROP_PADDING_MODE&#x27;<span class="hljs-punctuation">:</span> &#x27;random&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 填充模式，在本例中为&#x27;random&#x27;</span><br>          &#x27;RANDOM_CROP_SIZE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">513</span><span class="hljs-punctuation">,</span> <span class="hljs-number">513</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 进行随机 crop 时输出的尺寸大小</span><br>          &#x27;RANDOM_RESIZE_CROP_FROM&#x27;<span class="hljs-punctuation">:</span> &#x27;sem&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 将 semantic label resize 到指定大小后再进行随机 crop</span><br>          &#x27;RANDOM_RESIZE_CROP_RATIO&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0.75</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.3333333333333333</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 进行 resize 时的纵横比范围</span><br>          &#x27;RANDOM_RESIZE_CROP_SCALE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 进行 resize 时的缩放比例范围</span><br>          &#x27;RANDOM_RESIZE_CROP_SIZE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">32</span><span class="hljs-punctuation">,</span> <span class="hljs-number">32</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 在进行 resize 前需要保证 semantic label 的最小尺寸大小</span><br>          &#x27;RANDOM_SCALE_ONESIDE_ALIGN_CORNERS&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否对齐图像的四个角</span><br>          &#x27;RANDOM_SCALE_ONESIDE_DIM&#x27;<span class="hljs-punctuation">:</span> &#x27;shortside&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 进行缩放的维度，在本例中为长边</span><br>          &#x27;RANDOM_SCALE_ONESIDE_RANGE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">513</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1025</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 进行缩放时的尺寸范围</span><br>          &#x27;ROOT_DIR&#x27;<span class="hljs-punctuation">:</span> &#x27;D<span class="hljs-punctuation">:</span>\\Study\\XXX\\TextSeg&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 数据集所在目录</span><br>          &#x27;SEGLABEL_IGNORE_LABEL&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">999</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 忽略的标签值，在本例中为 999</span><br>          &#x27;SEMANTIC_PICK_CLASS&#x27;<span class="hljs-punctuation">:</span> &#x27;all&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 要选择的语义类别，在本例中为&#x27;all&#x27;</span><br>          &#x27;TRANS_PIPELINE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>&#x27;UniformNumpyType&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 图像的预处理流程</span><br>                             &#x27;TextSeg_RandomResizeCropCharBbox&#x27;<span class="hljs-punctuation">,</span><br>                             &#x27;NormalizeUint8ToZeroOne&#x27;<span class="hljs-punctuation">,</span><br>                             &#x27;Normalize&#x27;<span class="hljs-punctuation">,</span><br>                             &#x27;RandomScaleOneSide&#x27;<span class="hljs-punctuation">,</span><br>                             &#x27;RandomCrop&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>          &#x27;TRY_SAMPLE&#x27;<span class="hljs-punctuation">:</span> None<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 尝试样本的数量</span><br> &#x27;DEBUG&#x27;<span class="hljs-punctuation">:</span> False<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否开启调试模式</span><br> &#x27;DIST_BACKEND&#x27;<span class="hljs-punctuation">:</span> &#x27;gloo&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 分布式训练的后端，本例中为&#x27;gloo&#x27;</span><br> &#x27;DIST_URL&#x27;<span class="hljs-punctuation">:</span> &#x27;tcp<span class="hljs-punctuation">:</span><span class="hljs-comment">//127.0.0.1:11233&#x27;,  // 分布式训练的 URL</span><br> &#x27;EXPERIMENT_ID&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">168471973979</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 实验的 ID</span><br> &#x27;GPU_COUNT&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 使用的 GPU 数量</span><br> &#x27;GPU_DEVICE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 使用的 GPU 编号</span><br> &#x27;LOG_DIR&#x27;<span class="hljs-punctuation">:</span> &#x27;D<span class="hljs-punctuation">:</span>\\Study\\XXXX\\Rethinking-Text-Segmentation\\log\\texrnet_textseg\\<span class="hljs-number">168471973979</span>_texrnet_hrnet&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 日志存储的目录路径</span><br> &#x27;LOG_FILE&#x27;<span class="hljs-punctuation">:</span> &#x27;D<span class="hljs-punctuation">:</span>\\Study\\XXXX\Rethinking-Text-Segmentation\\log\\texrnet_textseg\\<span class="hljs-number">168471973979</span>_texrnet_hrnet\\train.log&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 日志输出的文件路径</span><br> &#x27;MAINLOOP_EXECUTE&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否执行主循环</span><br> &#x27;MAIN_CODE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>&#x27;main.py&#x27;<span class="hljs-punctuation">,</span> &#x27;train_utils.py&#x27;<span class="hljs-punctuation">,</span> &#x27;eval_utils.py&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 主要的代码文件</span><br> &#x27;MAIN_CODE_PATH&#x27;<span class="hljs-punctuation">:</span> &#x27;D<span class="hljs-punctuation">:</span>\\Study\\XXXX\\Rethinking-Text-Segmentation&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 代码所在的路径</span><br> &#x27;MATPLOTLIB_MODE&#x27;<span class="hljs-punctuation">:</span> &#x27;Agg&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// Matplotlib 模式</span><br> &#x27;MISC_DIR&#x27;<span class="hljs-punctuation">:</span> &#x27;D<span class="hljs-punctuation">:</span>\\Study\\XXXX\\Rethinking-Text-Segmentation\\log&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 杂项文件的存储目录路径</span><br> <span class="hljs-comment">// 模型的配置文件，包含了 HRNet 模型的距离参数和结构</span><br> &#x27;MODEL&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;HRNET&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;ALIGN_CORNERS&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否使用 align_corners 参数对齐角点</span><br>                     &#x27;BN_MOMENTUM&#x27;<span class="hljs-punctuation">:</span> &#x27;hardcoded to <span class="hljs-number">0.1</span>&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// Batch Normalization 层的动量</span><br>                     &#x27;FINAL_CONV_KERNEL&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 最终卷积核的大小</span><br>                     &#x27;IGNORE_LABEL&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">999</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 忽略标签的数值</span><br>                     &#x27;INTRAIN_GETPRED&#x27;<span class="hljs-punctuation">:</span> False<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否在训练时计算预测结果</span><br>                     &#x27;LOSS_TYPE&#x27;<span class="hljs-punctuation">:</span> &#x27;ce&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 使用的损失函数类型</span><br>                     &#x27;MODEL_TAGS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>&#x27;v0&#x27;<span class="hljs-punctuation">,</span> &#x27;base&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 模型标签</span><br>                     &#x27;OUTPUT_CHANNEL_NUM&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">720</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 模型输出通道数</span><br>                     &#x27;PRETRAINED_PTH&#x27;<span class="hljs-punctuation">:</span> &#x27;D<span class="hljs-punctuation">:</span>\\Study\\XXXX\\Rethinking-Text-Segmentation\\pretrained\\init\\hrnetv2_w48_imagenet_pretrained.pth.base&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 预训练模型的路径</span><br>                     &#x27;STAGE1_PARA&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;BLOCK&#x27;<span class="hljs-punctuation">:</span> &#x27;BOTTLENECK&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// HRNet 中所使用的块的类型</span><br>                                     &#x27;FUSE_METHOD&#x27;<span class="hljs-punctuation">:</span> &#x27;SUM&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// HRNet 的每个分支上进行特征融合的方法</span><br>                                     &#x27;NUM_BLOCKS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">4</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 每个分支中块的数量</span><br>                                     &#x27;NUM_BRANCHES&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 使用的分支数</span><br>                                     &#x27;NUM_CHANNELS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">64</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 每个分支的通道数</span><br>                                     &#x27;NUM_MODULES&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 使用的模块数</span><br>                     &#x27;STAGE2_PARA&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;BLOCK&#x27;<span class="hljs-punctuation">:</span> &#x27;BASIC&#x27;<span class="hljs-punctuation">,</span><br>                                     &#x27;FUSE_METHOD&#x27;<span class="hljs-punctuation">:</span> &#x27;SUM&#x27;<span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_BLOCKS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_BRANCHES&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_CHANNELS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">48</span><span class="hljs-punctuation">,</span> <span class="hljs-number">96</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_MODULES&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                     &#x27;STAGE3_PARA&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;BLOCK&#x27;<span class="hljs-punctuation">:</span> &#x27;BASIC&#x27;<span class="hljs-punctuation">,</span><br>                                     &#x27;FUSE_METHOD&#x27;<span class="hljs-punctuation">:</span> &#x27;SUM&#x27;<span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_BLOCKS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_BRANCHES&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_CHANNELS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">48</span><span class="hljs-punctuation">,</span> <span class="hljs-number">96</span><span class="hljs-punctuation">,</span> <span class="hljs-number">192</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_MODULES&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                     &#x27;STAGE4_PARA&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;BLOCK&#x27;<span class="hljs-punctuation">:</span> &#x27;BASIC&#x27;<span class="hljs-punctuation">,</span><br>                                     &#x27;FUSE_METHOD&#x27;<span class="hljs-punctuation">:</span> &#x27;SUM&#x27;<span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_BLOCKS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_BRANCHES&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_CHANNELS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">48</span><span class="hljs-punctuation">,</span> <span class="hljs-number">96</span><span class="hljs-punctuation">,</span> <span class="hljs-number">192</span><span class="hljs-punctuation">,</span> <span class="hljs-number">384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                                     &#x27;NUM_MODULES&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>           &#x27;MODEL_NAME&#x27;<span class="hljs-punctuation">:</span> &#x27;texrnet&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 模型名称</span><br>           &#x27;TEXRNET&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;ALIGN_CORNERS&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否使用 align_corners 参数对齐角点</span><br>                       &#x27;BIAS_ATTENTION_TYPE&#x27;<span class="hljs-punctuation">:</span> &#x27;cossim&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 偏置注意力的类型</span><br>                       &#x27;BN_TYPE&#x27;<span class="hljs-punctuation">:</span> &#x27;bn&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// Batch Normalization 层的类型</span><br>                       &#x27;CONV_TYPE&#x27;<span class="hljs-punctuation">:</span> &#x27;conv&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 卷积层的类型</span><br>                       &#x27;INIT_BIAS_ATTENTION_WITH&#x27;<span class="hljs-punctuation">:</span> None<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 哪个注意力层进行初始化偏置注意力</span><br>                       &#x27;INPUT_CHANNEL_NUM&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">720</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 输入 Tensor 的通道数</span><br>                       &#x27;INTRAIN_GETPRED_FROM&#x27;<span class="hljs-punctuation">:</span> &#x27;sem&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 在训练时计算预测结果的来源。此处为&#x27;sem&#x27;，表示来自语义分割</span><br>                       &#x27;MODEL_TAGS&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>&#x27;hrnet&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 模型标签</span><br>                       &#x27;PRETRAINED_PTH&#x27;<span class="hljs-punctuation">:</span> None<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 预训练模型的路径</span><br>                       &#x27;REFINEMENT_CHANNEL_NUM&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">725</span><span class="hljs-punctuation">,</span> <span class="hljs-number">64</span><span class="hljs-punctuation">,</span> <span class="hljs-number">64</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 精细化模块中各层输出通道数</span><br>                       &#x27;REFINEMENT_LOSS_TYPE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;lossrfn&#x27;<span class="hljs-punctuation">:</span> &#x27;ce&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 精细化模块中各损失函数类型</span><br>                                                &#x27;lossrfntri&#x27;<span class="hljs-punctuation">:</span> &#x27;trimapce&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                       &#x27;RELU_TYPE&#x27;<span class="hljs-punctuation">:</span> &#x27;relu&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// ReLU 激活函数的类型</span><br>                       &#x27;SEMANTIC_CLASS_NUM&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 语义分割的类别数</span><br>                       &#x27;SEMANTIC_IGNORE_LABEL&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">999</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 语义分割中被忽略的标签</span><br>                       &#x27;SEMANTIC_LOSS_TYPE&#x27;<span class="hljs-punctuation">:</span> &#x27;ce&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 语义分割中使用的损失函数类型</span><br> &#x27;RND_RECORDING&#x27;<span class="hljs-punctuation">:</span> False<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否记录随机数生成器的状态</span><br> &#x27;RND_SEED&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 随机数种子</span><br> &#x27;SAVE_CODE&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否保存代码</span><br> &#x27;TORCH_VERSION&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">1.13</span><span class="hljs-number">.1</span>+cu117&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 使用的 PyTorch 版本号</span><br> &#x27;TRAIN&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;ACTIVATE_CLASSIFIER_FOR_SEGMODEL_AFTER&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 在第几次迭代后为分割模型激活分类器</span><br>           &#x27;ACTIVATE_REFINEMENT_AT_ITER&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 在第几次迭代后激活精细化模块</span><br>           &#x27;BATCH_SIZE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 每个 GPU 上的 batch 大小</span><br>           &#x27;BATCH_SIZE_PER_GPU&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><br>           &#x27;CKPT_EVERY&#x27;<span class="hljs-punctuation">:</span> inf<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 每多少 epoch 保存一次模型权重</span><br>           &#x27;CLASSIFIER_PATH&#x27;<span class="hljs-punctuation">:</span> &#x27;pretrained\\init\\resnet50_textcls.pth&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 分类器的路径</span><br>           &#x27;COMMENT&#x27;<span class="hljs-punctuation">:</span> &#x27;&gt;&gt;&gt;&gt;later&lt;&lt;&lt;&lt;&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 训练过程中的注释信息</span><br>           &#x27;DISPLAY&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 每隔多少次迭代输出一次日志信息</span><br>           &#x27;LOSS_WEIGHT&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;losscls&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 不同损失函数的权重</span><br>                           &#x27;lossrfn&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><br>                           &#x27;lossrfntri&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><br>                           &#x27;losssem&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>           &#x27;LOSS_WEIGHT_NORMALIZED&#x27;<span class="hljs-punctuation">:</span> False<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否使用归一化的损失权重</span><br>           &#x27;LR_BASE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.01</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 学习率的基础值</span><br>           &#x27;LR_ITER_BY&#x27;<span class="hljs-punctuation">:</span> &#x27;iter&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 学习率的迭代方式。此处为&#x27;iter&#x27;，表示按照迭代次数更新学习率</span><br>           &#x27;LR_TYPE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>(&#x27;linear&#x27;<span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.01</span><span class="hljs-punctuation">,</span> <span class="hljs-number">500</span>)<span class="hljs-punctuation">,</span> (&#x27;ploy&#x27;<span class="hljs-punctuation">,</span> <span class="hljs-number">0.01</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">20000</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.9</span>)<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 学习率的更新方式。包含了两种类型：&#x27;linear&#x27;和&#x27;ploy&#x27;</span><br>           &#x27;MAX_STEP&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">20500</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 最大迭代次数或 epoch 数</span><br>           &#x27;MAX_STEP_TYPE&#x27;<span class="hljs-punctuation">:</span> &#x27;iter&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 最大迭代次数或 epoch 数的类型。此处为&#x27;iter&#x27;，表示按照迭代次数来计算。</span><br>           &#x27;OPTIMIZER&#x27;<span class="hljs-punctuation">:</span> &#x27;sgd&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 优化器的类型。此处为&#x27;sgd&#x27;，表示随机梯度下降法</span><br>           &#x27;OPTIM_MANAGER_LRSCALE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>&#x27;hrnet&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> &#x27;texrnet&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 不同模型在优化器中学习率的比例。包含了&#x27;texrnet&#x27;和&#x27;hrnet&#x27;两个键，分别对应不同模型</span><br>           &#x27;OVERFIT_A_BATCH&#x27;<span class="hljs-punctuation">:</span> False<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否以一个 batch 进行过拟合实验</span><br>           &#x27;ROI_ALIGN_SIZE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">32</span><span class="hljs-punctuation">,</span> <span class="hljs-number">32</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 表示 Region of Interest (ROI) Align 的大小</span><br>           &#x27;ROI_BBOX_PADDING_TYPE&#x27;<span class="hljs-punctuation">:</span> &#x27;semcrop&#x27;<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 表示 ROI Align 时的填充类型</span><br>           &#x27;SAVE_CODE&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否保存代码</span><br>           &#x27;SAVE_INIT_MODEL&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否保存初始化模型</span><br>           &#x27;SGD_MOMENTUM&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// SGD 优化器的动量</span><br>           &#x27;SGD_WEIGHT_DECAY&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0.0005</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// SGD 优化器的权重衰减因子</span><br>           &#x27;SIGNATURE&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>&#x27;texrnet&#x27;<span class="hljs-punctuation">,</span> &#x27;hrnet&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 模型签名</span><br>           &#x27;SKIP_PARTIAL&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否跳过部分数据</span><br>           &#x27;UPDATE_CLASSIFIER&#x27;<span class="hljs-punctuation">:</span> False<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否更新分类器参数</span><br>           &#x27;USE_OPTIM_MANAGER&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 是否使用优化器管理器</span><br>           &#x27;VISUAL&#x27;<span class="hljs-punctuation">:</span> False<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span>  <span class="hljs-comment">// 是否可视化</span><br></code></pre></td></tr></table></figure>

            </article>
            
	<div class="rightside">
	
		<div class="rightside-button" id="js-aside">
			<span>
				<img no-lazy src="/images/icon/aside.png" class="rightside-button-icon" alt="Icon">
			</span>
		</div>
		<script>
			$("#js-aside").click(function () {
				onShowAsideButton();
			});
		</script>
	
	<div class="rightside-button" id="js-toggle_theme">
		<span>
			<img no-lazy src="/images/icon/toggle_theme.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	
<script src="/js/plugins/goto_position.js"></script>

	
	<div class="rightside-button" id="js-go_top">
		<span>
			<img no-lazy src="/images/icon/go_top.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>
	<div class="rightside-button" id="js-go_bottom">
		<span>
			<img no-lazy src="/images/icon/go_bottom.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	<script>
		setToggleThemeButtonListener();
	</script>
	<script>
		$('#js-go_top')
		.gotoPosition( {
			speed: 300,
			target: 'top',
		} );
		$('#js-go_bottom')
		.gotoPosition( {
			speed: 300,
			target: 'bottom',
		} );
	</script>
</div>


<div class="post-bottom">
    
        <div class="post-paging">     
            <div class="post-paging-last">
                
                    <a href="/posts/Paper-Segment%20Everything%20Everywhere%20All%20at%20Once/">
                        上一篇：Paper-Segment Everything Everywhere All at Once
                    </a>
                
            </div>
            <div class="post-paging-next">
                
                    <a href="/posts/Plan-%E4%B8%80%E4%BA%9B%E7%A5%9E%E5%A5%87%E5%B0%8F%E7%BD%91%E7%AB%99/">
                        下一篇：Plan-一些神奇小网站
                    </a>
                
            </div>
        </div>
    
    
    
        
            <div class="giscus comments"></div>
            <script>
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://giscus.app/client.js';
                scriptElement.setAttribute('data-repo', 'GZ-Metal-Cell/GZ-Metal-Cell.github.io');
                scriptElement.setAttribute('data-repo-id', 'R_kgDOIHLEOQ');
                scriptElement.setAttribute('data-category', 'Announcements');
                scriptElement.setAttribute('data-category-id', 'DIC_kwDOIHLEOc4CcVwP');
                scriptElement.setAttribute('data-mapping', 'title');
                scriptElement.setAttribute('data-strict', '1');
                scriptElement.setAttribute('data-reactions-enabled', '');
                scriptElement.setAttribute('data-emit-metadata', '0');
                scriptElement.setAttribute('data-input-position', 'bottom');
                scriptElement.setAttribute('data-theme', localStorage.getItem('theme') === 'light' ? 'light' : 'dark_high_contrast');
                scriptElement.setAttribute('data-lang', 'zh-CN');
                
                scriptElement.setAttribute('crossorigin', 'anonymous');
                scriptElement.async = true;
                document.head.appendChild(scriptElement);
            </script>
        
    
</div>
        </div>
    </main>
    
        <aside class="main-aside">
    
<script src="/js/widgets/aside.js"></script>

    <script>
        showAside();
    </script>

    <div class="aside-top">
        <div class="aside-top-about aside-card">
            <a href="/about" class="aside-top-about-portrait">
                <img no-lazy src="/about/portrait.png" alt="Q">
            </a>
            <div class="aside-top-about-info">
                <span class="author"> Zi-Zi</span>
                <span class="description">不以物喜，不以己悲。</span>
            </div>              
            <div class="aside-top-about-site">
                <a href="/categories" class="aside-top-about-site-item">
                    <span class="title">类别</span>
                    <span class="count">5</span>
                </a>
                <a href="/tags" class="aside-top-about-site-item">
                    <span class="title">标签</span>
                    <span class="count">120</span>
                </a>
                <a href="/archives" class="aside-top-about-site-item">
                    <span class="title">归档</span>
                    <span class="count">435</span>
                </a>
            </div>
            <div class="aside-top-about-contact">
                
                    
                        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
                            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
                            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
                            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
                            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
                        </a>
                    
                
            </div>
        </div> 

        
    </div>

    <div class="aside-bottom">
        
            <script>
                
                    const tocCollapsed = true;
                
                
                    const tocDepth = 6;
                
                var headerString = '';
                for (let i = 1; i <= tocDepth; i++) {
                    if (i === 1) {
                        headerString += 'h1';
                    } else {
                        headerString += ', h' + i;
                    }
                }
                hbeToc();
            </script>
            <div class="aside-bottom-toc aside-card">
                <div class="aside-bottom-toc-title">
                    <h1>目录</h1>
                    <span class="toc-percentage"></span>
                </div>
                <ol class="aside-bottom-toc-content"></ol>
            </div>
        
    </div>
</aside>
    
</div>
		<footer>
	<div class="content">
		
			<span>©2022-2025&nbsp;By&nbsp;<a href="/about">Zi-Zi</a>.</span>
		
		<span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> theme by <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell/hexo-theme-quieter">Quieter</a>.</span>
		
			<span style="display: flex;">
				<img no-lazy alt="icp" src="/images/icp_icon.png" style="width: 16px; height: 16px;">
				<a href="https://icp.gov.moe/?keyword=20241647" target="_blank">萌 ICP 备 20241647 号</a>
			</span>
		
	</div>

	
<script src="/js/plugins/ref.js"></script>

	
<script src="/js/plugins/highlight_tools.js"></script>

	<script>
		const  COPY_ICON = "/images/icon/copy.png";
		const CLOSE_CODE_BLOCK_ICON = "/images/icon/close_code_block.png";
		const HIGHLIGHT_SHRINK = "";
		const HIGHLIGHT_HEIGHT_LIMIT = "";
	</script>

	
	
	<!-- Analytics -->

    
        <!-- Busuanzi Analytics -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?e57cf62289f84322ebff116e8b3d343e";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


	

	
		
			
				<link rel="stylesheet" href="/css/plugins/katex/katex.min.css">
				<script src="/js/plugins/copy-tex.js"></script>
			
		
	

    
		
<link rel="stylesheet" href="/css/plugins/textIndent.css">

		
<script src="/js/plugins/textIndent.js"></script>

	

	
	
	
		<script>
			if (typeof init === 'function') {
				init();
			}
		</script>
	

	
		
	

	

	<!--
		
<script src="/js/plugins/jquery.pjax.min.js"></script>

		<script>
			$(document).pjax('a[target!=_blank]', 'main', {
				fragment: 'main',
				timeout: 8000
			});

			$(document).on('pjax:complete', function() {
			});
		</script> 
	-->
	<script>
		console.log('\n %c Hexo-Quieter 主题 %c https://github.com/GZ-Metal-Cell/hexo-theme-quieter \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
	</script>
</footer>
	</body>

	<!-- Hexo-Quieter 主题  https://github.com/GZ-Metal-Cell/hexo-theme-quieter -->
</html>

