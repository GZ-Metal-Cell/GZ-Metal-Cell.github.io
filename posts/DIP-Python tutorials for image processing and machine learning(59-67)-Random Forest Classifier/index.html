<!DOCTYPE html>
<html lang=zh-CN data-theme="light">
	
<script src="/js/plugins/toggleTheme.js"></script>

	<script>
		setTheme();
	</script>
	<head>
		
<title>DIP-Python tutorials for image processing and machine learning(59-67)-Random Forest Classifier | Zi-Zi's Journey</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/images/icon/favicon.ico">
<link href="/css/plugins/print.css" media="print" rel="stylesheet" />

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="Python,DigitalSreeni,">
<meta name="description" content="学习自 Youtube 博主 DigitalSreeni。">



<script src="/js/plugins/jquery.min.js"></script>


<script src="/js/plugins/hljs.min.js"></script>


<script src="/js/plugins/init.js"></script>


<script src="/js/plugins/hide.js"></script>


<script src="/js/plugins/tabs.js"></script>



    



    
<script src="/js/plugins/alert-title.js"></script>

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-base.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-dark-class.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-light.css">






    

	<meta name="generator" content="Hexo 6.1.0"></head>

	<body>
		<header class="sticky-header">
	<nav>
		<div class="nav-left">
			<a href="/" class="logo">
				<img no-lazy src="/images/headers_icon/logo.webp" alt="Quieter">
			</a>
			<ul class="breadcrumb" id="breadcrumb"></ul>
		</div>
		<div class="nav-right">
			<ul>
				
					<li>
						<a href="/">
						  主页
						</a>
					</li>
				
					<li>
						<a href="/categories">
						  类别
						</a>
					</li>
				
					<li>
						<a href="/tags">
						  标签
						</a>
					</li>
				
					<li>
						<a href="/archives">
						  归档
						</a>
					</li>
				
					<li>
						<a href="/galleries">
						  相册
						</a>
					</li>
				
					<li>
						<a href="/links">
						  链接
						</a>
					</li>
				
					<li>
						<a href="/about">
						  关于
						</a>
					</li>
								  
			</ul>
		</div>
		<div class="nav-right-close">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
				<path fill="none" d="M0 0h24v24H0z" />
				<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
			</svg>
		</div>

		<div class="sidebar">
    <div class="topo">
        <p>Zi-Zi's Journey</p>
    </div>
    <ul>
        
        <li>
            <a href="/">
                主页
            </a>
        </li>
        
        <li>
            <a href="/categories">
                类别
            </a>
        </li>
        
        <li>
            <a href="/tags">
                标签
            </a>
        </li>
        
        <li>
            <a href="/archives">
                归档
            </a>
        </li>
        
        <li>
            <a href="/galleries">
                相册
            </a>
        </li>
        
        <li>
            <a href="/links">
                链接
            </a>
        </li>
        
        <li>
            <a href="/about">
                关于
            </a>
        </li>
        
    </ul>
    <div class="sidebar-footer">
        
        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
        </a>
        
    </div>
</div>
<div class='shelter'>
    <script>
        $(function() {
            $('.nav-right-close > svg').click(function() {
                $('.sidebar').animate({
                    right: "0"
                }, 500);
                $('.shelter').fadeIn("slow");
            
                var element = $('.topo');
                element.addClass('custom-style');
            
                var links = null;
                if ("") {
                    links = "".split(',');
                } else {
                    links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
                }
            
                var randomLink = links[Math.floor(Math.random() * links.length)];
                element.css('background-image', "url('" + randomLink + "')");
            });
          
            $('.shelter').click(function(e) {
                $('.sidebar').animate({
                    right: "-100%"
                }, 500);
                $('.shelter').fadeOut("slow");
            });
        });      
    </script>
</div>
	</nav>

	
		<div class="header-background"></div>
	

	<script>
		const name = 'post';
		const ul = document.querySelectorAll('.nav-right ul')[0];
		const lis = ul.querySelectorAll('li');

		if (name == 'home') {
			lis[0].classList.add('select');
		} else {
			for (let i = 0; i < lis.length; i++) {
				const li = lis[i];
				const a = li.querySelector('a');
				if (name === a.href.split('/')[3]) {
					li.classList.add('select');
				}
			}
		}
	</script>
	
	<script>
		var element = document.querySelector('.header-background');
		if(element) {
			element.classList.add('custom-style');
			var links = null;
			if("")
			{
				links = "".split(',');
			} else
			{
				links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
			}
			var randomLink = links[Math.floor(Math.random() * links.length)];
			element.style.backgroundImage = "url('" + randomLink + "')";
		}
	</script>

	
<script src="/js/plugins/breadcrumb.js"></script>

	<script>
		var menus_title = [];
		
			menus_title.push({home: '主页'});
		
			menus_title.push({categories: '类别'});
		
			menus_title.push({tags: '标签'});
		
			menus_title.push({archives: '归档'});
		
			menus_title.push({galleries: '相册'});
		
			menus_title.push({links: '链接'});
		
			menus_title.push({about: '关于'});
		
		
			
				postsBreadcrumb(
					document.getElementById('breadcrumb'),
					"类别",
					"/categories",
					"学习",
					"/categories/学习",
					1
				);
			
		
	</script>
</header>

<div class="main-wrapper">
    <main class="post">
        <header class="main-header">
	
		
			
				
<link rel="stylesheet" href="/css/plugins/fancybox.css">

				
<script src="/js/plugins/fancybox.umd.js"></script>

				
<script src="/js/plugins/fancybox.js"></script>

			
			<div class="post-header-background-content">
				<ul class="post-header-tag">
					
						
							<li><a href="/tags/Python"><span>Python</span></a></li>
						
							<li><a href="/tags/DigitalSreeni"><span>DigitalSreeni</span></a></li>
						
					
				</ul>
				
				<h1>DIP-Python tutorials for image processing and machine learning(59-67)-Random Forest Classifier</h1>
		
				
					<div class="post-header-desc">
						<svg t="1714702231661" class="icon" viewBox="0 0 1024 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="1154" xmlns:xlink="http://www.w3.org/1999/xlink"
						width="20" height="20">
						<path
							d="M778.24 117.76A46.08 46.08 0 0 1 824.32 163.84v430.08c0 8.4992-4.13696 16.01536-10.50624 20.6848l-0.24576 0.2048L587.5712 846.09024a35.84 35.84 0 0 1-61.48096-25.06752v-220.9792a46.08 46.08 0 0 1 46.08-46.08l200.94976-0.02048V168.96h-522.24v686.08H389.12c13.25056 0 24.1664 10.07616 25.47712 22.97856l0.12288 2.62144c0 14.1312-11.4688 25.6-25.6 25.6h-143.36A46.08 46.08 0 0 1 199.68 860.16V163.84A46.08 46.08 0 0 1 245.76 117.76h532.48z m-26.78784 487.38304h-174.16192v178.176l174.16192-178.176z m-45.19936-169.94304a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z m0-122.88a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z"
							fill="#ffffff" p-id="1155"></path>
						</svg>
						<p>学习自 Youtube 博主 DigitalSreeni。</p>
					</div>
				
		
				<div class="post-header-info">
					<svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
					xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
						<path
							d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
							p-id="2902" fill="#ffffff"></path>
					</svg>
					<div class="post-header-info-author">
						<a href="/about">Zi-Zi</a>
					</div>
					
						<div class="post-header-info-categories">
							
								<a href="/categories/学习">学习</a>
							
						</div>
					
					<time>2022/12/15 15:09:00</time>
				</div>
		
				
					<div class="post-header-stat">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
						viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve" width="20" height="20">
							<path fill="#FFFFFF" d="M187.2,165.6c0,2.6-2.1,4.7-4.7,4.7H17.5c-2.6,0-4.7-2.1-4.7-4.7s2.1-4.7,4.7-4.7h165.1
								C185.2,160.9,187.2,163,187.2,165.6z"/>
							<path fill="#FFFFFF" d="M17.5,29.7c2.6,0,4.7,2.1,4.7,4.7v131.2c0,2.6-2.1,4.7-4.7,4.7s-4.7-2.1-4.7-4.7V34.4
								C12.8,31.8,14.9,29.7,17.5,29.7z M77.9,91.5c1.8,1.8,1.8,4.8,0,6.6l-39.8,39.8c-1.9,1.8-4.9,1.7-6.6-0.2c-1.7-1.8-1.7-4.6,0-6.4
								l39.8-39.8C73.1,89.6,76,89.6,77.9,91.5z M169.9,70.2c1.6,2.1,1.1,5-0.9,6.5c0,0,0,0,0,0l-64.2,48.2c-2.1,1.5-5,1.1-6.6-0.9
								c-1.6-2.1-1.1-5,0.9-6.5c0,0,0,0,0,0l64.2-48.2C165.4,67.7,168.3,68.1,169.9,70.2L169.9,70.2z"/>
							<path fill="#FFFFFF" d="M104.6,124.5c-1.8,1.8-4.8,1.8-6.6,0L71.6,98.1c-1.8-1.8-1.8-4.8,0-6.6c1.8-1.8,4.8-1.8,6.6,0l26.3,26.3
								C106.4,119.6,106.4,122.6,104.6,124.5C104.6,124.4,104.6,124.4,104.6,124.5z"/>
						</svg>
		
						
							
<script src="/js/plugins/wordCount.js"></script>

							<p class="post-count">文字数：---</p>
						
		
						
							<p id="busuanzi_container_page_pv" style='display:none;'>阅读数：<span id="busuanzi_value_page_pv"></span></p>
						
					</div>
				
			</div>
		
	
</header>
        <div class="post-content article-container">
            <article class="post-content-info">
                <h1 id="%E6%AD%A3%E6%96%87" tabindex="-1">正文</h1>
<h2 id="59---what-is-random-forest-classifier" tabindex="-1" id="59-What-is-Random-Forest-classifier">59 - What is Random Forest classifier</h2>
<blockquote>
<p>很多的决策树在一起就变成了森林，就是随机森林了。</p>
</blockquote>
<ul>
<li><strong>决策树</strong></li>
</ul>
<p>比如要将一张图分类成:</p>
<ul>
<li>
<p>Air 空气</p>
</li>
<li>
<p>Pyrite 黄铁矿</p>
</li>
<li>
<p>Clay 粘土</p>
</li>
<li>
<p>Pore 孔洞</p>
</li>
<li>
<p>Quartz 石英</p>
</li>
</ul>
<p>从图像的 Pixel Value 灰度值和 Texture 纹理进行分类:</p>
<p><img src="59_1.jpg" alt="jpg"></p>
<ul>
<li>
<p><strong>Why start with pixel value and not texture metric for this image?</strong></p>
<ul>
<li><strong>为什么从像素值开始，而不是纹理度量这张图像?</strong></li>
</ul>
</li>
<li>
<p>Because it gives the best split of input data.</p>
<ul>
<li>因为它给出了输入数据的最佳分割。</li>
</ul>
</li>
<li>
<p><strong>How to pick a node that gives the best split?</strong></p>
<ul>
<li>如何选择一个能给出最佳分割的节点?</li>
</ul>
</li>
<li>
<p>Use Gini impurity → pick the one that maximizes the Gini gain.</p>
<ul>
<li>使用基尼系数→选择一个使基尼系数增益最大化的。</li>
</ul>
</li>
<li>
<p>Gini lmpurity is the probability of incorrectly classifying a randomly chosenelement in the dataset if it were randomly labeled according to the classdistribution in the dataset. lt’s calculated as</p>
<ul>
<li>基尼系数是指数据集中随机选择的元素，如果根据数据集中的类别分布随机标记，则错误分类的概率。计算为</li>
</ul>
</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><mi>p</mi><mo>(</mo><mi>i</mi><mo>)</mo><mo>∗</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo>(</mo><mi>i</mi><mo>)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">G=\sum^C_{i=1}p(i)*\left(1-p(i)\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">G</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mbin">∗</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span></span></p>
<ul>
<li>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span> is the number of classes and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span> is the probability of randomly picking an element of class <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>.</p>
<ul>
<li>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span> 是类的数量，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span> 是随机抽取类 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> 中的一个元素的概率。</li>
</ul>
</li>
<li>
<p><strong>Primary Disadvantage of decision trees:</strong>
Often suffers from overfitting →works well on training data but fails on newdata leading to low accuracy.</p>
<ul>
<li>
<p><strong>决策树的主要缺点:</strong></p>
<p>经常存在过拟合问题→在训练数据上很好，但在新数据上失败，导致精度低。</p>
</li>
</ul>
</li>
<li>
<p><strong>Random Forest to the rescue!</strong></p>
<ul>
<li>使用决策森林规避决策树的缺点。</li>
</ul>
</li>
</ul>
<p><img src="59_2.jpg" alt="jpg"></p>
<h2 id="60---how-to-use-random-forest-in-python" tabindex="-1" id="60-How-to-use-Random-Forest-in-Python">60 - How to use Random Forest in Python</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>df = pd.read_csv(<span class="hljs-string">&#x27;data/images_analyzed_productivity1.csv&#x27;</span>)<br>df.head()<br></code></pre></td></tr></table></figure>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>User</th>
      <th>Time</th>
      <th>Coffee</th>
      <th>Age</th>
      <th>Images_Analyzed</th>
      <th>Productivity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>23</td>
      <td>20</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>13</td>
      <td>0</td>
      <td>23</td>
      <td>14</td>
      <td>Bad</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>17</td>
      <td>0</td>
      <td>23</td>
      <td>18</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>22</td>
      <td>0</td>
      <td>23</td>
      <td>15</td>
      <td>Bad</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>23</td>
      <td>22</td>
      <td>Good</td>
    </tr>
  </tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">sizes = df[<span class="hljs-string">&#x27;Productivity&#x27;</span>].value_counts(sort=<span class="hljs-number">1</span>)<br>sizes<br></code></pre></td></tr></table></figure>
<pre><code>Bad     42
Good    38
Name: Productivity, dtype: int64
</code></pre>
<p>去除无关的列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">df.drop([<span class="hljs-string">&#x27;Images_Analyzed&#x27;</span>], axis=<span class="hljs-number">1</span>, inplace=<span class="hljs-literal">True</span>)<br>df.drop([<span class="hljs-string">&#x27;User&#x27;</span>], axis=<span class="hljs-number">1</span>, inplace=<span class="hljs-literal">True</span>)<br>df.head()<br></code></pre></td></tr></table></figure>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Coffee</th>
      <th>Age</th>
      <th>Productivity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>0</td>
      <td>23</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>0</td>
      <td>23</td>
      <td>Bad</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17</td>
      <td>0</td>
      <td>23</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>0</td>
      <td>23</td>
      <td>Bad</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>2</td>
      <td>23</td>
      <td>Good</td>
    </tr>
  </tbody>
</table>
<p>删除缺失数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">df = df.dropna()<br></code></pre></td></tr></table></figure>
<p>将分析结果转换为数字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">df.Productivity[df.Productivity == <span class="hljs-string">&#x27;Good&#x27;</span>] = <span class="hljs-number">1</span><br>df.Productivity[df.Productivity == <span class="hljs-string">&#x27;Bad&#x27;</span>] = <span class="hljs-number">2</span><br>df.head()<br></code></pre></td></tr></table></figure>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Coffee</th>
      <th>Age</th>
      <th>Productivity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>0</td>
      <td>23</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>0</td>
      <td>23</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17</td>
      <td>0</td>
      <td>23</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>0</td>
      <td>23</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>2</td>
      <td>23</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>定义因变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">Y = df[<span class="hljs-string">&#x27;Productivity&#x27;</span>].values<br>Y = Y.astype(<span class="hljs-string">&#x27;int&#x27;</span>)<br>Y<br></code></pre></td></tr></table></figure>
<pre><code>array([1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2,
       1, 2, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1,
       1, 2, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2,
       1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 2])
</code></pre>
<p>定义自变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">X = df.drop(labels=[<span class="hljs-string">&#x27;Productivity&#x27;</span>], axis=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<p>将数据分割为训练集和测试集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><br>X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=<span class="hljs-number">0.4</span>, random_state=<span class="hljs-number">20</span>)<br></code></pre></td></tr></table></figure>
<p>使用随机森林</p>
<p><a target="_blank" rel="noopener" href="https://scikitlearn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">sklearn.ensemble.RandomForestClassifier</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier<br><br>model = RandomForestClassifier(n_estimators=<span class="hljs-number">10</span>, random_state=<span class="hljs-number">30</span>)<br>model.fit(X_train, Y_train)<br>prediction_test = model.predict(X_test)<br>prediction_test<br></code></pre></td></tr></table></figure>
<pre><code>array([1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1, 1, 2, 1, 2,
       1, 1, 2, 1, 1, 2, 1, 1, 1, 1])
</code></pre>
<p>计算训练出的结果的精确度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> metrics<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Accuracy =&#x27;</span>, metrics.accuracy_score(Y_test, prediction_test))<br></code></pre></td></tr></table></figure>
<pre><code>Accuracy = 0.9375
</code></pre>
<p>扩大训练集的比例可以增加精确度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">20</span>)<br>model = RandomForestClassifier(n_estimators=<span class="hljs-number">10</span>, random_state=<span class="hljs-number">30</span>)<br>model.fit(X_train, Y_train)<br>prediction_test = model.predict(X_test)<br>prediction_test<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Accuracy =&#x27;</span>, metrics.accuracy_score(Y_test, prediction_test))<br></code></pre></td></tr></table></figure>
<pre><code>Accuracy = 0.9375
</code></pre>
<p>显示特征值的重要性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">feature_list = <span class="hljs-built_in">list</span>(X.columns)<br>feature_imp = pd.Series(model.feature_importances_, index=feature_list).sort_values(ascending=<span class="hljs-literal">False</span>)<br>feature_imp<br></code></pre></td></tr></table></figure>
<pre><code>Time      0.714433
Coffee    0.205474
Age       0.080092
dtype: float64
</code></pre>
<p>随机森林可视化</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_36728101/article/details/124672217">python 随机森林可视化_阿雷吖睚的博客-CSDN 博客_随机森林可视化</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> IPython.display <span class="hljs-keyword">import</span> HTML, display<br><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> tree<br><span class="hljs-keyword">import</span> pydotplus<br><br>estimators = model.estimators_<br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> estimators:<br>    dot_data = tree.export_graphviz(m, out_file=<span class="hljs-literal">None</span>,<br>                         feature_names=[<span class="hljs-string">&#x27;Time&#x27;</span>, <span class="hljs-string">&#x27;Coffee&#x27;</span>, <span class="hljs-string">&#x27;Age&#x27;</span>],<br>                         class_names=[<span class="hljs-string">&#x27;Good&#x27;</span>, <span class="hljs-string">&#x27;Bad&#x27;</span>],<br>                         filled=<span class="hljs-literal">True</span>, rounded=<span class="hljs-literal">True</span>,<br>                         special_characters=<span class="hljs-literal">True</span>)<br>    graph = pydotplus.graph_from_dot_data(dot_data)<br><span class="hljs-comment"># 使用 ipython 的终端 jupyter notebook 显示。</span><br>svg = graph.create_svg()<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(svg, <span class="hljs-string">&quot;decode&quot;</span>):<br>     svg = svg.decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>html = HTML(svg)<br>display(html)<br></code></pre></td></tr></table></figure>
<p><img src="60_1.svg" alt="svg"></p>
<h2 id="61---how-to-create-gabor-feature-banks-for-machine-learning" tabindex="-1" id="61-How-to-create-Gabor-feature-banks-for-machine-learning">61 - How to create Gabor feature banks for machine learning</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">img = cv2.imread(<span class="hljs-string">&#x27;images/synthetic.jpg&#x27;</span>, <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">df = pd.DataFrame()<br>img2 = img.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Original Pixels&#x27;</span>] = img2<br>df<br></code></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Original Pixels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>255</td>
    </tr>
    <tr>
      <th>1</th>
      <td>255</td>
    </tr>
    <tr>
      <th>2</th>
      <td>255</td>
    </tr>
    <tr>
      <th>3</th>
      <td>255</td>
    </tr>
    <tr>
      <th>4</th>
      <td>255</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>363446</th>
      <td>255</td>
    </tr>
    <tr>
      <th>363447</th>
      <td>255</td>
    </tr>
    <tr>
      <th>363448</th>
      <td>255</td>
    </tr>
    <tr>
      <th>363449</th>
      <td>255</td>
    </tr>
    <tr>
      <th>363450</th>
      <td>255</td>
    </tr>
  </tbody>
</table>
<p>363451 rows × 1 columns</p>
<p>设置 Gabor 的不同参数构造出不同的卷积核，生成用于机器学习的 csv 文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">num = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> sigma <span class="hljs-keyword">in</span> (<span class="hljs-number">3</span>, <span class="hljs-number">5</span>):<br>    <span class="hljs-keyword">for</span> theta <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        theta = theta / <span class="hljs-number">4.</span> * np.pi<br>        <span class="hljs-keyword">for</span> lamda <span class="hljs-keyword">in</span> np.arange(<span class="hljs-number">0</span>, np.pi, np.pi / <span class="hljs-number">4.</span>):<br>            <span class="hljs-keyword">for</span> gamma <span class="hljs-keyword">in</span> (<span class="hljs-number">0.05</span>, <span class="hljs-number">0.5</span>):<br>                gabor_label = <span class="hljs-string">&#x27;Gabor &#x27;</span> + <span class="hljs-built_in">str</span>(num)<br>                kernel = cv2.getGaborKernel((<span class="hljs-number">5</span>, <span class="hljs-number">5</span>), sigma, theta, lamda, gamma, <span class="hljs-number">0</span>, ktype=cv2.CV_32F)<br>                fimg = cv2.filter2D(img, cv2.CV_8UC3, kernel)<br>                filtered_img = fimg.reshape(-<span class="hljs-number">1</span>)<br>                df[gabor_label] = filtered_img<br>                num += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">df.head()<br></code></pre></td></tr></table></figure>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Original Pixels</th>
      <th>Gabor 1</th>
      <th>Gabor 2</th>
      <th>Gabor 3</th>
      <th>Gabor 4</th>
      <th>Gabor 5</th>
      <th>Gabor 6</th>
      <th>Gabor 7</th>
      <th>Gabor 8</th>
      <th>Gabor 9</th>
      <th>...</th>
      <th>Gabor 23</th>
      <th>Gabor 24</th>
      <th>Gabor 25</th>
      <th>Gabor 26</th>
      <th>Gabor 27</th>
      <th>Gabor 28</th>
      <th>Gabor 29</th>
      <th>Gabor 30</th>
      <th>Gabor 31</th>
      <th>Gabor 32</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>...</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>130</td>
      <td>122</td>
      <td>255</td>
      <td>255</td>
    </tr>
    <tr>
      <th>1</th>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>...</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>130</td>
      <td>122</td>
      <td>255</td>
      <td>255</td>
    </tr>
    <tr>
      <th>2</th>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>...</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>130</td>
      <td>122</td>
      <td>255</td>
      <td>255</td>
    </tr>
    <tr>
      <th>3</th>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>...</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>130</td>
      <td>122</td>
      <td>255</td>
      <td>255</td>
    </tr>
    <tr>
      <th>4</th>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>...</td>
      <td>255</td>
      <td>255</td>
      <td>0</td>
      <td>0</td>
      <td>255</td>
      <td>255</td>
      <td>130</td>
      <td>122</td>
      <td>255</td>
      <td>255</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 33 columns</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">df.to_csv(<span class="hljs-string">&#x27;Gabor.csv&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><img src="61_1.png" alt="png"></p>
<h2 id="62---image-segmentation-using-traditional-machine-learning---the-plan" tabindex="-1" id="62-Image-Segmentation-using-traditional-machine-learning-The-plan">62 - Image Segmentation using traditional machine learning - The plan</h2>
<p>​    讲了下后面几篇视频要干啥。</p>
<h2 id="63---image-segmentation-using-traditional-machine-learning-part1---featureextraction" tabindex="-1" id="63-Image-Segmentation-using-traditional-machine-learning-Part1-FeatureExtraction">63 - Image Segmentation using traditional machine learning Part1 - FeatureExtraction</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>img = cv2.imread(<span class="hljs-string">&#x27;images/Train_images/Sandstone_Versa0000.tif&#x27;</span>, <span class="hljs-number">0</span>)<br>plt.imshow(img, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x17d0c13f730&gt;
</code></pre>
<p><img src="1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">df = pd.DataFrame()<br></code></pre></td></tr></table></figure>
<ul>
<li>Add original pixel values to the data frame as feature #1</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">img2 = img.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Original Image&#x27;</span>] = img2<br>df.head()<br></code></pre></td></tr></table></figure>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Original Image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
<ul>
<li>
<p>Add Other features</p>
</li>
<li>
<p>First set - Gabor features</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Generate Gabor features</span><br>num = <span class="hljs-number">1</span>  <span class="hljs-comment"># To count numbers up in order to give Gabor features a lable in the data frame</span><br>kernels = []<br><span class="hljs-keyword">for</span> theta <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):  <span class="hljs-comment"># Define number of thetas</span><br>    theta = theta / <span class="hljs-number">4.</span> * np.pi<br>    <span class="hljs-keyword">for</span> sigma <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>, <span class="hljs-number">3</span>):  <span class="hljs-comment"># Sigma with 1 and 3</span><br>        <span class="hljs-keyword">for</span> lamda <span class="hljs-keyword">in</span> np.arange(<span class="hljs-number">0</span>, np.pi, np.pi / <span class="hljs-number">4</span>):  <span class="hljs-comment"># Range of wavelengths</span><br>            <span class="hljs-keyword">for</span> gamma <span class="hljs-keyword">in</span> (<span class="hljs-number">0.05</span>, <span class="hljs-number">0.5</span>):  <span class="hljs-comment"># Gamma values of 0.05 and 0.5</span><br>                gabor_label = <span class="hljs-string">&#x27;Gabor&#x27;</span> + <span class="hljs-built_in">str</span>(num)  <span class="hljs-comment"># Label Gabor columns as Gabor1, Gabor2, etc.</span><br>                ksize = <span class="hljs-number">9</span><br>                kernel = cv2.getGaborKernel((ksize, ksize), sigma, theta, lamda, gamma, <span class="hljs-number">0</span>, ktype=cv2.CV_32F)    <br>                kernels.append(kernel)<br>                <span class="hljs-comment"># Now filter the image and add values to a new column </span><br>                fimg = cv2.filter2D(img2, cv2.CV_8UC3, kernel)<br>                filtered_img = fimg.reshape(-<span class="hljs-number">1</span>)<br>                df[gabor_label] = filtered_img  <span class="hljs-comment"># Labels columns as Gabor1, Gabor2, etc.</span><br>                <span class="hljs-built_in">print</span>(gabor_label, <span class="hljs-string">&#x27;: theta =&#x27;</span>, theta, <span class="hljs-string">&#x27;: sigma =&#x27;</span>, sigma, <span class="hljs-string">&#x27;: lamda =&#x27;</span>, lamda, <span class="hljs-string">&#x27;: gamma =&#x27;</span>, gamma)<br>                num += <span class="hljs-number">1</span>  <span class="hljs-comment"># Increment for gabor column label</span><br></code></pre></td></tr></table></figure>
<pre><code>Gabor1 : theta = 0.0 : sigma = 1 : lamda = 0.0 : gamma = 0.05
Gabor2 : theta = 0.0 : sigma = 1 : lamda = 0.0 : gamma = 0.5
Gabor3 : theta = 0.0 : sigma = 1 : lamda = 0.7853981633974483 : gamma = 0.05
Gabor4 : theta = 0.0 : sigma = 1 : lamda = 0.7853981633974483 : gamma = 0.5
Gabor5 : theta = 0.0 : sigma = 1 : lamda = 1.5707963267948966 : gamma = 0.05
Gabor6 : theta = 0.0 : sigma = 1 : lamda = 1.5707963267948966 : gamma = 0.5
Gabor7 : theta = 0.0 : sigma = 1 : lamda = 2.356194490192345 : gamma = 0.05
Gabor8 : theta = 0.0 : sigma = 1 : lamda = 2.356194490192345 : gamma = 0.5
Gabor9 : theta = 0.0 : sigma = 3 : lamda = 0.0 : gamma = 0.05
Gabor10 : theta = 0.0 : sigma = 3 : lamda = 0.0 : gamma = 0.5
Gabor11 : theta = 0.0 : sigma = 3 : lamda = 0.7853981633974483 : gamma = 0.05
Gabor12 : theta = 0.0 : sigma = 3 : lamda = 0.7853981633974483 : gamma = 0.5
Gabor13 : theta = 0.0 : sigma = 3 : lamda = 1.5707963267948966 : gamma = 0.05
Gabor14 : theta = 0.0 : sigma = 3 : lamda = 1.5707963267948966 : gamma = 0.5
Gabor15 : theta = 0.0 : sigma = 3 : lamda = 2.356194490192345 : gamma = 0.05
Gabor16 : theta = 0.0 : sigma = 3 : lamda = 2.356194490192345 : gamma = 0.5
Gabor17 : theta = 0.7853981633974483 : sigma = 1 : lamda = 0.0 : gamma = 0.05
Gabor18 : theta = 0.7853981633974483 : sigma = 1 : lamda = 0.0 : gamma = 0.5
Gabor19 : theta = 0.7853981633974483 : sigma = 1 : lamda = 0.7853981633974483 : gamma = 0.05
Gabor20 : theta = 0.7853981633974483 : sigma = 1 : lamda = 0.7853981633974483 : gamma = 0.5
Gabor21 : theta = 0.7853981633974483 : sigma = 1 : lamda = 1.5707963267948966 : gamma = 0.05
Gabor22 : theta = 0.7853981633974483 : sigma = 1 : lamda = 1.5707963267948966 : gamma = 0.5
Gabor23 : theta = 0.7853981633974483 : sigma = 1 : lamda = 2.356194490192345 : gamma = 0.05
Gabor24 : theta = 0.7853981633974483 : sigma = 1 : lamda = 2.356194490192345 : gamma = 0.5
Gabor25 : theta = 0.7853981633974483 : sigma = 3 : lamda = 0.0 : gamma = 0.05
Gabor26 : theta = 0.7853981633974483 : sigma = 3 : lamda = 0.0 : gamma = 0.5
Gabor27 : theta = 0.7853981633974483 : sigma = 3 : lamda = 0.7853981633974483 : gamma = 0.05
Gabor28 : theta = 0.7853981633974483 : sigma = 3 : lamda = 0.7853981633974483 : gamma = 0.5
Gabor29 : theta = 0.7853981633974483 : sigma = 3 : lamda = 1.5707963267948966 : gamma = 0.05
Gabor30 : theta = 0.7853981633974483 : sigma = 3 : lamda = 1.5707963267948966 : gamma = 0.5
Gabor31 : theta = 0.7853981633974483 : sigma = 3 : lamda = 2.356194490192345 : gamma = 0.05
Gabor32 : theta = 0.7853981633974483 : sigma = 3 : lamda = 2.356194490192345 : gamma = 0.5
</code></pre>
<ul>
<li>
<p>Gerate <strong>OTHER FEATURES</strong> and add them to the data frame</p>
</li>
<li>
<p><strong>Canny edge</strong></p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">edges = cv2.Canny(img, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>)<br>edges1 = edges.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Canny Edge&#x27;</span>] = edges1<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>ROBERTS EDGE</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> skimage.filters <span class="hljs-keyword">import</span> roberts, sobel, scharr, prewitt<br><br>edge_roberts = roberts(img)<br>edge_roberts1 = edge_roberts.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Roberts&#x27;</span>] = edge_roberts1<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>SOBEL</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">edge_sobel = sobel(img)<br>edge_sobel1 = edge_sobel.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Sobel&#x27;</span>] = edge_sobel1<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>SCHARR</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">edge_scharr = scharr(img)<br>edge_scharr1 = edge_scharr.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Scharr&#x27;</span>] = edge_scharr1<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>PREWITT</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">edge_prewitt = prewitt(img)<br>edge_prewitt1 = edge_prewitt.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Prewitt&#x27;</span>] = edge_prewitt1<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>GAUSSIAN with sigma = 3</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> ndimage <span class="hljs-keyword">as</span> nd<br><br>gaussian_img = nd.gaussian_filter(img, sigma=<span class="hljs-number">3</span>)<br>gaussian_img1 = gaussian_img.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Gaussian s3&#x27;</span>] = gaussian_img1<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>GAUSSIAN with sigma = 7</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">gaussian_img2 = nd.gaussian_filter(img, sigma=<span class="hljs-number">7</span>)<br>gaussian_img3 = gaussian_img2.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Gaussian s7&#x27;</span>] = gaussian_img3<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>MEDIAN with sigma = 3</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">median_img = nd.median_filter(img, size=<span class="hljs-number">3</span>)<br>median_img1 = median_img.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Median s3&#x27;</span>] = median_img1<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>VARIANCE with size = 3</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">variance_img = nd.generic_filter(img, np.var, size=<span class="hljs-number">3</span>)<br>variance_img1 = variance_img.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Variance s3&#x27;</span>] = variance_img1  <span class="hljs-comment"># Add column to original dataframe</span><br></code></pre></td></tr></table></figure>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">df.head()<br></code></pre></td></tr></table></figure>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Original Image</th>
      <th>Gabor1</th>
      <th>Gabor2</th>
      <th>Gabor3</th>
      <th>Gabor4</th>
      <th>Gabor5</th>
      <th>Gabor6</th>
      <th>Gabor7</th>
      <th>Gabor8</th>
      <th>Gabor9</th>
      <th>...</th>
      <th>Gabor32</th>
      <th>Canny Edge</th>
      <th>Roberts</th>
      <th>Sobel</th>
      <th>Scharr</th>
      <th>Prewitt</th>
      <th>Gaussian s3</th>
      <th>Gaussian s7</th>
      <th>Median s3</th>
      <th>Variance s3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 42 columns</p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">labeled_img = cv2.imread(<span class="hljs-string">&#x27;images/Train_masks/Sandstone_Versa0000.tif&#x27;</span>, <span class="hljs-number">0</span>)<br>labeled_img1 = labeled_img.reshape(-<span class="hljs-number">1</span>)<br>df[<span class="hljs-string">&#x27;Label&#x27;</span>] = labeled_img1<br></code></pre></td></tr></table></figure>
<h2 id="64---image-segmentation-using-traditional-machine-learning---part2-training-rf" tabindex="-1" id="64-Image-Segmentation-using-traditional-machine-learning-Part2-Training-RF">64 - Image Segmentation using traditional machine learning - Part2 Training RF</h2>
<ul>
<li>Dependent variable</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">Y = df[<span class="hljs-string">&#x27;Label&#x27;</span>].values<br>X = df.drop(labels=[<span class="hljs-string">&#x27;Label&#x27;</span>], axis=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<ul>
<li>Split data into test and train</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><br>X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=<span class="hljs-number">0.4</span>, random_state=<span class="hljs-number">20</span>)<br></code></pre></td></tr></table></figure>
<ul>
<li>Import ML algorithm and train the model</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier<br><br>model = RandomForestClassifier(n_estimators=<span class="hljs-number">10</span>, random_state=<span class="hljs-number">42</span>)<br>model.fit(X_train, Y_train)<br>prediction_test = model.predict(X_test)<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> metrics<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Accuracy =&quot;</span>, metrics.accuracy_score(Y_test, prediction_test))<br></code></pre></td></tr></table></figure>
<pre><code>Accuracy = 0.9812850216441728
</code></pre>
<h2 id="65---image-segmentation-using-traditional-machine-learning---part3-feature-ranking" tabindex="-1" id="65-Image-Segmentation-using-traditional-machine-learning-Part3-Feature-Ranking">65 - Image Segmentation using traditional machine learning - Part3 Feature Ranking</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">fig = plt.figure(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">16</span>))<br>p = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> index, feature <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(df.columns):<br>    <span class="hljs-keyword">if</span> index == <span class="hljs-number">0</span>:<br>        p += <span class="hljs-number">1</span><br>        ax = fig.add_subplot(<span class="hljs-number">181</span>)<br>        plt.xticks([])<br>        plt.yticks([])<br>        ax.imshow(img, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)<br>        ax.title.set_text(feature)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> p % <span class="hljs-number">8</span> == <span class="hljs-number">1</span>:<br>            p += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;ax&quot;</span> + <span class="hljs-built_in">str</span>(index) + <span class="hljs-string">&quot;=fig.add_subplot(6, 8, &quot;</span> + <span class="hljs-built_in">str</span>(p) + <span class="hljs-string">&quot;)&quot;</span>)<br>        plt.xticks([])<br>        plt.yticks([])<br>        <span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;ax&quot;</span> + <span class="hljs-built_in">str</span>(index) + <span class="hljs-string">&quot;.imshow(np.array(df[feature]).reshape(img.shape), cmap=&#x27;gray&#x27;)&quot;</span>)<br>        <span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;ax&quot;</span> + <span class="hljs-built_in">str</span>(index) + <span class="hljs-string">&quot;.title.set_text(&#x27;&quot;</span> + feature + <span class="hljs-string">&quot;&#x27;)&quot;</span>)<br>        p += <span class="hljs-number">1</span><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">importances = <span class="hljs-built_in">list</span>(model.feature_importances_)<br>features_list = <span class="hljs-built_in">list</span>(X.columns)<br>feature_imp = pd.Series(model.feature_importances_, index=features_list).sort_values(ascending=<span class="hljs-literal">False</span>)<br>feature_imp<br></code></pre></td></tr></table></figure>
<pre><code>Gabor4            0.248493
Gaussian s3       0.168623
Median s3         0.122685
Original Image    0.092540
Gabor8            0.086585
Gabor11           0.076893
Gabor3            0.070587
Gabor6            0.021357
Gaussian s7       0.020470
Gabor24           0.011645
Gabor7            0.010555
Prewitt           0.010252
Gabor21           0.007676
Sobel             0.007102
Gabor23           0.006989
Gabor5            0.006329
Scharr            0.005543
Roberts           0.005393
Gabor22           0.004461
Variance s3       0.002942
Gabor31           0.002886
Gabor29           0.002720
Gabor32           0.002607
Gabor30           0.002361
Canny Edge        0.001267
Gabor12           0.001025
Gabor20           0.000011
Gabor28           0.000002
Gabor27           0.000002
Gabor14           0.000000
Gabor26           0.000000
Gabor25           0.000000
Gabor1            0.000000
Gabor19           0.000000
Gabor18           0.000000
Gabor17           0.000000
Gabor16           0.000000
Gabor10           0.000000
Gabor9            0.000000
Gabor15           0.000000
Gabor2            0.000000
Gabor13           0.000000
dtype: float64
</code></pre>
<h2 id="66---image-segmentation-using-traditional-machine-learning---part4-pickling-model" tabindex="-1" id="66-Image-Segmentation-using-traditional-machine-learning-Part4-Pickling-Model">66 - Image Segmentation using traditional machine learning - Part4 Pickling Model</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><br>filename = <span class="hljs-string">&#x27;sandstone_model&#x27;</span><br>pickle.dump(model, <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;wb&#x27;</span>))<br><br>load_model = pickle.load(<span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;rb&#x27;</span>))<br>result = load_model.predict(X)<br><br>segmented = result.reshape((img.shape))<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>plt.imshow(segmented, cmap=<span class="hljs-string">&#x27;jet&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x17d37062220&gt;
</code></pre>
<p><img src="3.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">plt.imsave(<span class="hljs-string">&#x27;segmented_rock.jpg&#x27;</span>, segmented, cmap=<span class="hljs-string">&#x27;jet&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h2 id="67---image-segmentation-using-traditional-machine-learning---part5-segmenting-images" tabindex="-1" id="67-Image-Segmentation-using-traditional-machine-learning-Part5-Segmenting-Images">67 - Image Segmentation using traditional machine learning - Part5 Segmenting Images</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">feature_extraction</span>(<span class="hljs-params">img</span>):<br>    df = pd.DataFrame()<br><br><br><span class="hljs-comment"># All features generated must match the way features are generated for TRAINING.</span><br><span class="hljs-comment"># Feature1 is our original image pixels</span><br>    img2 = img.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Original Image&#x27;</span>] = img2<br><br><span class="hljs-comment"># Generate Gabor features</span><br>    num = <span class="hljs-number">1</span><br>    kernels = []<br>    <span class="hljs-keyword">for</span> theta <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        theta = theta / <span class="hljs-number">4.</span> * np.pi<br>        <span class="hljs-keyword">for</span> sigma <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>, <span class="hljs-number">3</span>):<br>            <span class="hljs-keyword">for</span> lamda <span class="hljs-keyword">in</span> np.arange(<span class="hljs-number">0</span>, np.pi, np.pi / <span class="hljs-number">4</span>):<br>                <span class="hljs-keyword">for</span> gamma <span class="hljs-keyword">in</span> (<span class="hljs-number">0.05</span>, <span class="hljs-number">0.5</span>):      <br>                    gabor_label = <span class="hljs-string">&#x27;Gabor&#x27;</span> + <span class="hljs-built_in">str</span>(num)<br>                    ksize=<span class="hljs-number">9</span><br>                    kernel = cv2.getGaborKernel((ksize, ksize), sigma, theta, lamda, gamma, <span class="hljs-number">0</span>, ktype=cv2.CV_32F)    <br>                    kernels.append(kernel)<br>                    <span class="hljs-comment"># Now filter image and add values to new column</span><br>                    fimg = cv2.filter2D(img2, cv2.CV_8UC3, kernel)<br>                    filtered_img = fimg.reshape(-<span class="hljs-number">1</span>)<br>                    df[gabor_label] = filtered_img  <span class="hljs-comment"># Modify this to add new column for each gabor</span><br>                    num += <span class="hljs-number">1</span><br>    <span class="hljs-comment">########################################</span><br>    <span class="hljs-comment"># Geerate OTHER FEATURES and add them to the data frame</span><br>    <span class="hljs-comment"># Feature 3 is canny edge</span><br>    edges = cv2.Canny(img, <span class="hljs-number">100</span>,<span class="hljs-number">200</span>)   <span class="hljs-comment"># Image, min and max values</span><br>    edges1 = edges.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Canny Edge&#x27;</span>] = edges1  <span class="hljs-comment"># Add column to original dataframe</span><br><br>    <span class="hljs-keyword">from</span> skimage.filters <span class="hljs-keyword">import</span> roberts, sobel, scharr, prewitt<br><br>    <span class="hljs-comment"># Feature 4 is Roberts edge</span><br>    edge_roberts = roberts(img)<br>    edge_roberts1 = edge_roberts.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Roberts&#x27;</span>] = edge_roberts1<br><br>    <span class="hljs-comment"># Feature 5 is Sobel</span><br>    edge_sobel = sobel(img)<br>    edge_sobel1 = edge_sobel.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Sobel&#x27;</span>] = edge_sobel1<br><br>    <span class="hljs-comment"># Feature 6 is Scharr</span><br>    edge_scharr = scharr(img)<br>    edge_scharr1 = edge_scharr.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Scharr&#x27;</span>] = edge_scharr1<br><br>    <span class="hljs-comment"># Feature 7 is Prewitt</span><br>    edge_prewitt = prewitt(img)<br>    edge_prewitt1 = edge_prewitt.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Prewitt&#x27;</span>] = edge_prewitt1<br><br>    <span class="hljs-comment"># Feature 8 is Gaussian with sigma=3</span><br>    <span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> ndimage <span class="hljs-keyword">as</span> nd<br>    gaussian_img = nd.gaussian_filter(img, sigma=<span class="hljs-number">3</span>)<br>    gaussian_img1 = gaussian_img.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Gaussian s3&#x27;</span>] = gaussian_img1<br><br>    <span class="hljs-comment"># Feature 9 is Gaussian with sigma=7</span><br>    gaussian_img2 = nd.gaussian_filter(img, sigma=<span class="hljs-number">7</span>)<br>    gaussian_img3 = gaussian_img2.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Gaussian s7&#x27;</span>] = gaussian_img3<br><br>    <span class="hljs-comment"># Feature 10 is Median with sigma=3</span><br>    median_img = nd.median_filter(img, size=<span class="hljs-number">3</span>)<br>    median_img1 = median_img.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Median s3&#x27;</span>] = median_img1<br><br>    <span class="hljs-comment"># Feature 11 is Variance with size=3</span><br>    variance_img = nd.generic_filter(img, np.var, size=<span class="hljs-number">3</span>)<br>    variance_img1 = variance_img.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Variance s3&#x27;</span>] = variance_img1  <span class="hljs-comment"># Add column to original dataframe</span><br><br>    <span class="hljs-keyword">return</span> df<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> glob<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt<br><br>filename = <span class="hljs-string">&quot;sandstone_model&quot;</span><br>loaded_model = pickle.load(<span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;rb&#x27;</span>))<br><br>path = <span class="hljs-string">&quot;images/Train_images/*.tif&quot;</span><br><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> glob.glob(path):<br>    <span class="hljs-built_in">print</span>(file)  <span class="hljs-comment"># just stop here to see all file names printed</span><br>    img = cv2.imread(file, <span class="hljs-number">0</span>)<br>    <span class="hljs-comment"># Call the feature extraction function.</span><br>    X = feature_extraction(img)<br>    result = loaded_model.predict(X)<br>    segmented = result.reshape((img.shape))<br>    <br>    name = file.split(<span class="hljs-string">&quot;e_&quot;</span>)<br>    cv2.imwrite(<span class="hljs-string">&#x27;images/Segmented/&#x27;</span>+ name[<span class="hljs-number">1</span>], segmented)<br></code></pre></td></tr></table></figure>
<p><img src="67_1.jpg" alt="jpg"></p>
<h2 id="67b---feature-based-image-segmentation-using-traditional-machine-learning.--multi-training-images-" tabindex="-1" id="67b-Feature-based-image-segmentation-using-traditional-machine-learning-Multi-training-images">67b - Feature based image segmentation using traditional machine learning. -Multi-training images-</h2>
<p>总结通过传统机器学习方法进行图像分类的各个步骤。</p>
<blockquote>
<p>使用随机森林或支持向量机，这是传统的机器学习方法之一，我相信这比深度学习方法要好得多，因为对于大多数应用程序来说，您通常没有深度学习所需的数据类型，因此传统机器学习有时效果很好，如果您没有大量训练数据，实际上有时比深度学习好得多。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> os<br></code></pre></td></tr></table></figure>
<ul>
<li>STEP 1:   READ TRAINING IMAGES AND EXTRACT FEATURES</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs python">image_dataset = pd.DataFrame()  <span class="hljs-comment"># Dataframe to capture image features</span><br><br>img_path = <span class="hljs-string">&quot;images/train_images/&quot;</span><br><span class="hljs-keyword">for</span> image <span class="hljs-keyword">in</span> os.listdir(img_path):  <span class="hljs-comment"># iterate through each file </span><br>    <span class="hljs-built_in">print</span>(image)<br>    <br>    df = pd.DataFrame()  <span class="hljs-comment"># Temporary data frame to capture information for each loop.</span><br>    <span class="hljs-comment"># Reset dataframe to blank after each loop.</span><br>    <br>    input_img = cv2.imread(img_path + image)  <span class="hljs-comment"># Read images</span><br>    <br>    <span class="hljs-comment"># Check if the input image is RGB or grey and convert to grey if RGB</span><br>    <span class="hljs-keyword">if</span> input_img.ndim == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> input_img.shape[-<span class="hljs-number">1</span>] == <span class="hljs-number">3</span>:<br>        img = cv2.cvtColor(input_img,cv2.COLOR_BGR2GRAY)<br>    <span class="hljs-keyword">elif</span> input_img.ndim == <span class="hljs-number">2</span>:<br>        img = input_img<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> excerption(<span class="hljs-string">&quot;The module works only with grayscale and RGB images!&quot;</span>)<br><br><span class="hljs-comment">################################################################</span><br><span class="hljs-comment"># START ADDING DATA TO THE DATAFRAME</span><br><br>    <span class="hljs-comment"># Add pixel values to the data frame</span><br>    pixel_values = img.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Pixel_Value&#x27;</span>] = pixel_values  <span class="hljs-comment"># Pixel value itself as a feature</span><br>    df[<span class="hljs-string">&#x27;Image_Name&#x27;</span>] = image  <span class="hljs-comment"># Capture image name as we read multiple images</span><br>    <br><span class="hljs-comment">############################################################################    </span><br>    <span class="hljs-comment"># Generate Gabor features</span><br>    num = <span class="hljs-number">1</span>  <span class="hljs-comment"># To count numbers up in order to give Gabor features a lable in the data frame</span><br>    kernels = []<br>    <span class="hljs-keyword">for</span> theta <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):   <span class="hljs-comment"># Define number of thetas</span><br>        theta = theta / <span class="hljs-number">4.</span> * np.pi<br>        <span class="hljs-keyword">for</span> sigma <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>, <span class="hljs-number">3</span>):  <span class="hljs-comment"># Sigma with 1 and 3</span><br>            <span class="hljs-keyword">for</span> lamda <span class="hljs-keyword">in</span> np.arange(<span class="hljs-number">0</span>, np.pi, np.pi / <span class="hljs-number">4</span>):   <span class="hljs-comment"># Range of wavelengths</span><br>                <span class="hljs-keyword">for</span> gamma <span class="hljs-keyword">in</span> (<span class="hljs-number">0.05</span>, <span class="hljs-number">0.5</span>):  <span class="hljs-comment"># Gamma values of 0.05 and 0.5</span><br>                    gabor_label = <span class="hljs-string">&#x27;Gabor&#x27;</span> + <span class="hljs-built_in">str</span>(num)  <span class="hljs-comment"># Label Gabor columns as Gabor1, Gabor2, etc.</span><br>                    ksize=<span class="hljs-number">9</span><br>                    kernel = cv2.getGaborKernel((ksize, ksize), sigma, theta, lamda, gamma, <span class="hljs-number">0</span>, ktype=cv2.CV_32F)    <br>                    kernels.append(kernel)<br>                    <span class="hljs-comment"># Now filter the image and add values to a new column </span><br>                    fimg = cv2.filter2D(img, cv2.CV_8UC3, kernel)<br>                    filtered_img = fimg.reshape(-<span class="hljs-number">1</span>)<br>                    df[gabor_label] = filtered_img  <span class="hljs-comment">#Labels columns as Gabor1, Gabor2, etc.</span><br>                    <span class="hljs-built_in">print</span>(gabor_label, <span class="hljs-string">&#x27;: theta=&#x27;</span>, theta, <span class="hljs-string">&#x27;: sigma=&#x27;</span>, sigma, <span class="hljs-string">&#x27;: lamda=&#x27;</span>, lamda, <span class="hljs-string">&#x27;: gamma=&#x27;</span>, gamma)<br>                    num += <span class="hljs-number">1</span>  <span class="hljs-comment"># Increment for gabor column label</span><br><span class="hljs-comment">########################################</span><br><span class="hljs-comment"># Gerate OTHER FEATURES and add them to the data frame</span><br>                <br>    <span class="hljs-comment"># CANNY EDGE</span><br>    edges = cv2.Canny(img, <span class="hljs-number">100</span>,<span class="hljs-number">200</span>)   <span class="hljs-comment">#Image, min and max values</span><br>    edges1 = edges.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Canny Edge&#x27;</span>] = edges1 <span class="hljs-comment">#Add column to original dataframe</span><br>    <br>    <span class="hljs-keyword">from</span> skimage.filters <span class="hljs-keyword">import</span> roberts, sobel, scharr, prewitt<br>    <br>    <span class="hljs-comment"># ROBERTS EDGE</span><br>    edge_roberts = roberts(img)<br>    edge_roberts1 = edge_roberts.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Roberts&#x27;</span>] = edge_roberts1<br>    <br>    <span class="hljs-comment"># SOBEL</span><br>    edge_sobel = sobel(img)<br>    edge_sobel1 = edge_sobel.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Sobel&#x27;</span>] = edge_sobel1<br>    <br>    <span class="hljs-comment"># SCHARR</span><br>    edge_scharr = scharr(img)<br>    edge_scharr1 = edge_scharr.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Scharr&#x27;</span>] = edge_scharr1<br>    <br>    <span class="hljs-comment"># PREWITT</span><br>    edge_prewitt = prewitt(img)<br>    edge_prewitt1 = edge_prewitt.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Prewitt&#x27;</span>] = edge_prewitt1<br>    <br>    <span class="hljs-comment"># GAUSSIAN with sigma=3</span><br>    <span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> ndimage <span class="hljs-keyword">as</span> nd<br>    gaussian_img = nd.gaussian_filter(img, sigma=<span class="hljs-number">3</span>)<br>    gaussian_img1 = gaussian_img.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Gaussian s3&#x27;</span>] = gaussian_img1<br>    <br>    <span class="hljs-comment"># GAUSSIAN with sigma=7</span><br>    gaussian_img2 = nd.gaussian_filter(img, sigma=<span class="hljs-number">7</span>)<br>    gaussian_img3 = gaussian_img2.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Gaussian s7&#x27;</span>] = gaussian_img3<br>    <br>    <span class="hljs-comment"># MEDIAN with sigma=3</span><br>    median_img = nd.median_filter(img, size=<span class="hljs-number">3</span>)<br>    median_img1 = median_img.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Median s3&#x27;</span>] = median_img1<br>    <br>    <span class="hljs-comment"># VARIANCE with size=3</span><br>    variance_img = nd.generic_filter(img, np.var, size=<span class="hljs-number">3</span>)<br>    variance_img1 = variance_img.reshape(-<span class="hljs-number">1</span>)<br>    df[<span class="hljs-string">&#x27;Variance s3&#x27;</span>] = variance_img1  <span class="hljs-comment"># Add column to original dataframe</span><br><br><span class="hljs-comment">######################################                    </span><br><span class="hljs-comment"># Update dataframe for images to include details for each image in the loop</span><br>    image_dataset = image_dataset.append(df)<br></code></pre></td></tr></table></figure>
<ul>
<li>STEP 2: READ LABELED IMAGES (MASKS) AND CREATE ANOTHER DATAFRAME WITH LABEL VALUES AND LABEL FILE NAMES</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">mask_dataset = pd.DataFrame()  <span class="hljs-comment"># Create dataframe to capture mask info.</span><br><br>mask_path = <span class="hljs-string">&quot;images/train_masks/&quot;</span>    <br><span class="hljs-keyword">for</span> mask <span class="hljs-keyword">in</span> os.listdir(mask_path):  <span class="hljs-comment"># iterate through each file to perform some action</span><br>    <span class="hljs-built_in">print</span>(mask)<br>    <br>    df2 = pd.DataFrame()  <span class="hljs-comment"># Temporary dataframe to capture info for each mask in the loop</span><br>    input_mask = cv2.imread(mask_path + mask)<br>    <br>    <span class="hljs-comment"># Check if the input mask is RGB or grey and convert to grey if RGB</span><br>    <span class="hljs-keyword">if</span> input_mask.ndim == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> input_mask.shape[-<span class="hljs-number">1</span>] == <span class="hljs-number">3</span>:<br>        label = cv2.cvtColor(input_mask,cv2.COLOR_BGR2GRAY)<br>    <span class="hljs-keyword">elif</span> input_mask.ndim == <span class="hljs-number">2</span>:<br>        label = input_mask<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> excerption(<span class="hljs-string">&quot;The module works only with grayscale and RGB images!&quot;</span>)<br><br>    <span class="hljs-comment"># Add pixel values to the data frame</span><br>    label_values = label.reshape(-<span class="hljs-number">1</span>)<br>    df2[<span class="hljs-string">&#x27;Label_Value&#x27;</span>] = label_values<br>    df2[<span class="hljs-string">&#x27;Mask_Name&#x27;</span>] = mask<br>    <br>    mask_dataset = mask_dataset.append(df2)  <span class="hljs-comment"># Update mask dataframe with all the info from each mask</span><br></code></pre></td></tr></table></figure>
<ul>
<li>STEP 3: GET DATA READY FOR RANDOM FOREST (or other classifier) COMBINE BOTH DATAFRAMES INTO A SINGLE DATASET</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">dataset = pd.concat([image_dataset, mask_dataset], axis=<span class="hljs-number">1</span>)  <span class="hljs-comment"># Concatenate both image and mask datasets</span><br><br><span class="hljs-comment"># If you expect image and mask names to be the same this is where we can perform sanity check</span><br><span class="hljs-comment"># dataset[&#x27;Image_Name&#x27;].equals(dataset[&#x27;Mask_Name&#x27;])   </span><br><span class="hljs-comment"># If we do not want to include pixels with value 0 </span><br><span class="hljs-comment"># e.g. Sometimes unlabeled pixels may be given a value 0.</span><br>dataset = dataset[dataset.Label_Value != <span class="hljs-number">0</span>]<br><br><span class="hljs-comment"># Assign training features to X and labels to Y</span><br><span class="hljs-comment"># Drop columns that are not relevant for training (non-features)</span><br>X = dataset.drop(labels = [<span class="hljs-string">&quot;Image_Name&quot;</span>, <span class="hljs-string">&quot;Mask_Name&quot;</span>, <span class="hljs-string">&quot;Label_Value&quot;</span>], axis=<span class="hljs-number">1</span>) <br><br><span class="hljs-comment"># Assign label values to Y (our prediction)</span><br>Y = dataset[<span class="hljs-string">&quot;Label_Value&quot;</span>].values <br><br><span class="hljs-comment"># Split data into train and test to verify accuracy after fitting the model. </span><br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br>X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">20</span>)<br></code></pre></td></tr></table></figure>
<ul>
<li>STEP 4: Define the classifier and fit a model with our training data</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Import training classifier</span><br><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier<br><span class="hljs-comment"># Instantiate model with n number of decision trees</span><br>model = RandomForestClassifier(n_estimators = <span class="hljs-number">50</span>, random_state = <span class="hljs-number">42</span>)<br><br><span class="hljs-comment"># Train the model on training data</span><br>model.fit(X_train, y_train)<br></code></pre></td></tr></table></figure>
<ul>
<li>STEP 5: Accuracy check</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> metrics<br><br>prediction_test = model.predict(X_test)<br><span class="hljs-comment"># Check accuracy on test dataset. </span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Accuracy = &quot;</span>, metrics.accuracy_score(y_test, prediction_test))<br></code></pre></td></tr></table></figure>
<ul>
<li>STEP 6: SAVE MODEL FOR FUTURE USE</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># You can store the model for future use. In fact, this is how you do machine elarning</span><br><span class="hljs-comment"># Train on training images, validate on test images and deploy the model on unknown images. </span><br><span class="hljs-comment"># Save the trained model as pickle string to disk for future use</span><br>model_name = <span class="hljs-string">&quot;sandstone_model&quot;</span><br>pickle.dump(model, <span class="hljs-built_in">open</span>(model_name, <span class="hljs-string">&#x27;wb&#x27;</span>))<br></code></pre></td></tr></table></figure>

            </article>
            
	<div class="rightside">
	
		<div class="rightside-button" id="js-aside">
			<span>
				<img no-lazy src="/images/icon/aside.png" class="rightside-button-icon" alt="Icon">
			</span>
		</div>
		<script>
			$("#js-aside").click(function () {
				onShowAsideButton();
			});
		</script>
	
	<div class="rightside-button" id="js-toggle_theme">
		<span>
			<img no-lazy src="/images/icon/toggle_theme.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	
<script src="/js/plugins/goto_position.js"></script>

	
	<div class="rightside-button" id="js-go_top">
		<span>
			<img no-lazy src="/images/icon/go_top.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>
	<div class="rightside-button" id="js-go_bottom">
		<span>
			<img no-lazy src="/images/icon/go_bottom.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	<script>
		setToggleThemeButtonListener();
	</script>
	<script>
		$('#js-go_top')
		.gotoPosition( {
			speed: 300,
			target: 'top',
		} );
		$('#js-go_bottom')
		.gotoPosition( {
			speed: 300,
			target: 'bottom',
		} );
	</script>
</div>


<div class="post-bottom">
    
        <div class="post-paging">     
            <div class="post-paging-last">
                
                    <a href="/posts/DIP-Python%20tutorials%20for%20image%20processing%20and%20machine%20learning(68)-SVM/">
                        上一篇：DIP-Python tutorials for image processing and machine learning(68)-SVM
                    </a>
                
            </div>
            <div class="post-paging-next">
                
                    <a href="/posts/Homework-%E4%BB%80%E4%B9%88%E7%8B%97%E5%B1%81%E6%B4%8B%E6%96%87/">
                        下一篇：Homework-什么狗屁洋文
                    </a>
                
            </div>
        </div>
    
    
    
        
            <div class="giscus comments"></div>
            <script>
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://giscus.app/client.js';
                scriptElement.setAttribute('data-repo', 'GZ-Metal-Cell/GZ-Metal-Cell.github.io');
                scriptElement.setAttribute('data-repo-id', 'R_kgDOIHLEOQ');
                scriptElement.setAttribute('data-category', 'Announcements');
                scriptElement.setAttribute('data-category-id', 'DIC_kwDOIHLEOc4CcVwP');
                scriptElement.setAttribute('data-mapping', 'title');
                scriptElement.setAttribute('data-strict', '1');
                scriptElement.setAttribute('data-reactions-enabled', '');
                scriptElement.setAttribute('data-emit-metadata', '0');
                scriptElement.setAttribute('data-input-position', 'bottom');
                scriptElement.setAttribute('data-theme', localStorage.getItem('theme') === 'light' ? 'light' : 'dark_high_contrast');
                scriptElement.setAttribute('data-lang', 'zh-CN');
                
                scriptElement.setAttribute('crossorigin', 'anonymous');
                scriptElement.async = true;
                document.head.appendChild(scriptElement);
            </script>
        
    
</div>
        </div>
    </main>
    
        <aside class="main-aside">
    
<script src="/js/widgets/aside.js"></script>

    <script>
        showAside();
    </script>

    <div class="aside-top">
        <div class="aside-top-about aside-card">
            <a href="/about" class="aside-top-about-portrait">
                <img no-lazy src="/about/portrait.png" alt="Q">
            </a>
            <div class="aside-top-about-info">
                <span class="author"> Zi-Zi</span>
                <span class="description">不以物喜，不以己悲。</span>
            </div>              
            <div class="aside-top-about-site">
                <a href="/categories" class="aside-top-about-site-item">
                    <span class="title">类别</span>
                    <span class="count">5</span>
                </a>
                <a href="/tags" class="aside-top-about-site-item">
                    <span class="title">标签</span>
                    <span class="count">122</span>
                </a>
                <a href="/archives" class="aside-top-about-site-item">
                    <span class="title">归档</span>
                    <span class="count">438</span>
                </a>
            </div>
            <div class="aside-top-about-contact">
                
                    
                        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
                            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
                            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
                            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
                            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
                        </a>
                    
                
            </div>
        </div> 

        
            <div class="aside-top-series aside-card">
                <ol class="aside-top-series-content">
                    
                    
                    
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Introductory python tutorials for image processing(1-21)-Python Basics/">
                                                <span class="text">DIP-Introductory python tutorials for image processing(1-21)-Python Basics</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Introductory python tutorials for image processing(22-28)-Python Libraries/">
                                                <span class="text">DIP-Introductory python tutorials for image processing(22-28)-Python Libraries</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Introductory python tutorials for image processing(29-41)-Image Filtering/">
                                                <span class="text">DIP-Introductory python tutorials for image processing(29-41)-Image Filtering</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Introductory python tutorials for image processing(42-43)-CLAHE/">
                                                <span class="text">DIP-Introductory python tutorials for image processing(42-43)-CLAHE</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Introductory python tutorials for image processing(44-45)-Color Spaces/">
                                                <span class="text">DIP-Introductory python tutorials for image processing(44-45)-Color Spaces</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Introductory python tutorials for image processing(46-47)-Image Registration/">
                                                <span class="text">DIP-Introductory python tutorials for image processing(46-47)-Image Registration</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Introductory python tutorials for image processing(48-50)-Image Quality/">
                                                <span class="text">DIP-Introductory python tutorials for image processing(48-50)-Image Quality</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Introductory python tutorials for image processing(51-58)-Image Segmentation/">
                                                <span class="text">DIP-Introductory python tutorials for image processing(51-58)-Image Segmentation</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Python tutorials for image processing and machine learning(36-42)-Pandas/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(36-42)-Pandas</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Python tutorials for image processing and machine learning(43-49)-Regression/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(43-49)-Regression</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Python tutorials for image processing and machine learning(50-54)-Unsupervised Learning/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(50-54)-Unsupervised Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Python tutorials for image processing and machine learning(55-58)-Supervised Learning/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(55-58)-Supervised Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        
                                        <li class="series-item active">
                                            <a class="series-link active" href="/posts/DIP-Python tutorials for image processing and machine learning(59-67)-Random Forest Classifier/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(59-67)-Random Forest Classifier</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Python tutorials for image processing and machine learning(68)-SVM/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(68)-SVM</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Python tutorials for image processing and machine learning(69)-BOVW/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(69)-BOVW</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Python tutorials for image processing and machine learning(73-78)-U-net/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(73-78)-U-net</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/DIP-Python tutorials for image processing and machine learning(70-71)-Deep Learning/">
                                                <span class="text">DIP-Python tutorials for image processing and machine learning(70-71)-Deep Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                </ol>
                <div class="aside-top-series-title">
                    <h1>
                        <a href="/tags/DigitalSreeni">标签：DigitalSreeni</a>
                    </h1>
                    <span id="serial-number">13/17</span>
                </div>
            </div>
            <script>
                activeSeriesItem();
            </script> 
        
    </div>

    <div class="aside-bottom">
        
            <script>
                
                    const tocCollapsed = true;
                
                
                    const tocDepth = 6;
                
                var headerString = '';
                for (let i = 1; i <= tocDepth; i++) {
                    if (i === 1) {
                        headerString += 'h1';
                    } else {
                        headerString += ', h' + i;
                    }
                }
                hbeToc();
            </script>
            <div class="aside-bottom-toc aside-card">
                <div class="aside-bottom-toc-title">
                    <h1>目录</h1>
                    <span class="toc-percentage"></span>
                </div>
                <ol class="aside-bottom-toc-content"></ol>
            </div>
        
    </div>
</aside>
    
</div>
		<footer>
	<div class="content">
		
			<span>©2022-2025&nbsp;By&nbsp;<a href="/about">Zi-Zi</a>.</span>
		
		<span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> theme by <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell/hexo-theme-quieter">Quieter</a>.</span>
		
			<span style="display: flex;">
				<img no-lazy alt="icp" src="/images/icp_icon.png" style="width: 16px; height: 16px;">
				<a href="https://icp.gov.moe/?keyword=20241647" target="_blank">萌 ICP 备 20241647 号</a>
			</span>
		
	</div>

	
<script src="/js/plugins/ref.js"></script>

	
<script src="/js/plugins/highlight_tools.js"></script>

	<script>
		const  COPY_ICON = "/images/icon/copy.png";
		const CLOSE_CODE_BLOCK_ICON = "/images/icon/close_code_block.png";
		const HIGHLIGHT_SHRINK = "";
		const HIGHLIGHT_HEIGHT_LIMIT = "";
	</script>

	
	
	<!-- Analytics -->

    
        <!-- Busuanzi Analytics -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?e57cf62289f84322ebff116e8b3d343e";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


	

	
		
			
				<link rel="stylesheet" href="/css/plugins/katex/katex.min.css">
				<script src="/js/plugins/copy-tex.js"></script>
			
		
	

    
		
<link rel="stylesheet" href="/css/plugins/textIndent.css">

		
<script src="/js/plugins/textIndent.js"></script>

	

	
	
	
		<script>
			if (typeof init === 'function') {
				init();
			}
		</script>
	

	
		
	

	

	<!--
		
<script src="/js/plugins/jquery.pjax.min.js"></script>

		<script>
			$(document).pjax('a[target!=_blank]', 'main', {
				fragment: 'main',
				timeout: 8000
			});

			$(document).on('pjax:complete', function() {
			});
		</script> 
	-->
	<script>
		console.log('\n %c Hexo-Quieter 主题 %c https://github.com/GZ-Metal-Cell/hexo-theme-quieter \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
	</script>
</footer>
	</body>

	<!-- Hexo-Quieter 主题  https://github.com/GZ-Metal-Cell/hexo-theme-quieter -->
</html>

