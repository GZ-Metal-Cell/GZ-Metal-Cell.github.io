<!DOCTYPE html>
<html lang=zh-CN data-theme="light">
	
<script src="/js/plugins/toggleTheme.js"></script>

	<script>
		setTheme();
	</script>
	<head>
		
<title>ML-李宏毅-Lecture 5-Sequence to sequence | Zi-Zi's Journey</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/images/icon/favicon.ico">
<link href="/css/plugins/print.css" media="print" rel="stylesheet" />

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="李宏毅,">
<meta name="description" content="李宏毅《机器学习2022》课程学习笔记。">



<script src="/js/plugins/jquery.min.js"></script>


<script src="/js/plugins/hljs.min.js"></script>


<script src="/js/plugins/init.js"></script>


<script src="/js/plugins/hide.js"></script>


<script src="/js/plugins/tabs.js"></script>



    



    
<script src="/js/plugins/alert-title.js"></script>

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-base.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-dark-class.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-light.css">






    

	<meta name="generator" content="Hexo 6.1.0"></head>

	<body>
		<header class="sticky-header">
	<nav>
		<div class="nav-left">
			<a href="/" class="logo">
				<img no-lazy src="/images/headers_icon/logo.webp" alt="Quieter">
			</a>
			<ul class="breadcrumb" id="breadcrumb"></ul>
		</div>
		<div class="nav-right">
			<ul>
				
					<li>
						<a href="/">
						  主页
						</a>
					</li>
				
					<li>
						<a href="/categories">
						  类别
						</a>
					</li>
				
					<li>
						<a href="/tags">
						  标签
						</a>
					</li>
				
					<li>
						<a href="/archives">
						  归档
						</a>
					</li>
				
					<li>
						<a href="/galleries">
						  相册
						</a>
					</li>
				
					<li>
						<a href="/links">
						  链接
						</a>
					</li>
				
					<li>
						<a href="/about">
						  关于
						</a>
					</li>
								  
			</ul>
		</div>
		<div class="nav-right-close">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
				<path fill="none" d="M0 0h24v24H0z" />
				<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
			</svg>
		</div>

		<div class="sidebar">
    <div class="topo">
        <p>Zi-Zi's Journey</p>
    </div>
    <ul>
        
        <li>
            <a href="/">
                主页
            </a>
        </li>
        
        <li>
            <a href="/categories">
                类别
            </a>
        </li>
        
        <li>
            <a href="/tags">
                标签
            </a>
        </li>
        
        <li>
            <a href="/archives">
                归档
            </a>
        </li>
        
        <li>
            <a href="/galleries">
                相册
            </a>
        </li>
        
        <li>
            <a href="/links">
                链接
            </a>
        </li>
        
        <li>
            <a href="/about">
                关于
            </a>
        </li>
        
    </ul>
    <div class="sidebar-footer">
        
        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
        </a>
        
    </div>
</div>
<div class='shelter'>
    <script>
        $(function() {
            $('.nav-right-close > svg').click(function() {
                $('.sidebar').animate({
                    right: "0"
                }, 500);
                $('.shelter').fadeIn("slow");
            
                var element = $('.topo');
                element.addClass('custom-style');
            
                var links = null;
                if ("") {
                    links = "".split(',');
                } else {
                    links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
                }
            
                var randomLink = links[Math.floor(Math.random() * links.length)];
                element.css('background-image', "url('" + randomLink + "')");
            });
          
            $('.shelter').click(function(e) {
                $('.sidebar').animate({
                    right: "-100%"
                }, 500);
                $('.shelter').fadeOut("slow");
            });
        });      
    </script>
</div>
	</nav>

	
		<div class="header-background"></div>
	

	<script>
		const name = 'post';
		const ul = document.querySelectorAll('.nav-right ul')[0];
		const lis = ul.querySelectorAll('li');

		if (name == 'home') {
			lis[0].classList.add('select');
		} else {
			for (let i = 0; i < lis.length; i++) {
				const li = lis[i];
				const a = li.querySelector('a');
				if (name === a.href.split('/')[3]) {
					li.classList.add('select');
				}
			}
		}
	</script>
	
	<script>
		var element = document.querySelector('.header-background');
		if(element) {
			element.classList.add('custom-style');
			var links = null;
			if("")
			{
				links = "".split(',');
			} else
			{
				links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
			}
			var randomLink = links[Math.floor(Math.random() * links.length)];
			element.style.backgroundImage = "url('" + randomLink + "')";
		}
	</script>

	
<script src="/js/plugins/breadcrumb.js"></script>

	<script>
		var menus_title = [];
		
			menus_title.push({home: '主页'});
		
			menus_title.push({categories: '类别'});
		
			menus_title.push({tags: '标签'});
		
			menus_title.push({archives: '归档'});
		
			menus_title.push({galleries: '相册'});
		
			menus_title.push({links: '链接'});
		
			menus_title.push({about: '关于'});
		
		
			
				postsBreadcrumb(
					document.getElementById('breadcrumb'),
					"类别",
					"/categories",
					"学习",
					"/categories/学习",
					1
				);
			
		
	</script>
</header>

<div class="main-wrapper">
    <main class="post">
        <header class="main-header">
	
		
			
				
<link rel="stylesheet" href="/css/plugins/fancybox.css">

				
<script src="/js/plugins/fancybox.umd.js"></script>

				
<script src="/js/plugins/fancybox.js"></script>

			
			<div class="post-header-background-content">
				<ul class="post-header-tag">
					
						
							<li><a href="/tags/李宏毅"><span>李宏毅</span></a></li>
						
					
				</ul>
				
				<h1>ML-李宏毅-Lecture 5-Sequence to sequence</h1>
		
				
					<div class="post-header-desc">
						<svg t="1714702231661" class="icon" viewBox="0 0 1024 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="1154" xmlns:xlink="http://www.w3.org/1999/xlink"
						width="20" height="20">
						<path
							d="M778.24 117.76A46.08 46.08 0 0 1 824.32 163.84v430.08c0 8.4992-4.13696 16.01536-10.50624 20.6848l-0.24576 0.2048L587.5712 846.09024a35.84 35.84 0 0 1-61.48096-25.06752v-220.9792a46.08 46.08 0 0 1 46.08-46.08l200.94976-0.02048V168.96h-522.24v686.08H389.12c13.25056 0 24.1664 10.07616 25.47712 22.97856l0.12288 2.62144c0 14.1312-11.4688 25.6-25.6 25.6h-143.36A46.08 46.08 0 0 1 199.68 860.16V163.84A46.08 46.08 0 0 1 245.76 117.76h532.48z m-26.78784 487.38304h-174.16192v178.176l174.16192-178.176z m-45.19936-169.94304a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z m0-122.88a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z"
							fill="#ffffff" p-id="1155"></path>
						</svg>
						<p>李宏毅《机器学习2022》课程学习笔记。</p>
					</div>
				
		
				<div class="post-header-info">
					<svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
					xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
						<path
							d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
							p-id="2902" fill="#ffffff"></path>
					</svg>
					<div class="post-header-info-author">
						<a href="/about">Zi-Zi</a>
					</div>
					
						<div class="post-header-info-categories">
							
								<a href="/categories/学习">学习</a>
							
						</div>
					
					<time>2023/01/30 12:52:00</time>
				</div>
		
				
					<div class="post-header-stat">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
						viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve" width="20" height="20">
							<path fill="#FFFFFF" d="M187.2,165.6c0,2.6-2.1,4.7-4.7,4.7H17.5c-2.6,0-4.7-2.1-4.7-4.7s2.1-4.7,4.7-4.7h165.1
								C185.2,160.9,187.2,163,187.2,165.6z"/>
							<path fill="#FFFFFF" d="M17.5,29.7c2.6,0,4.7,2.1,4.7,4.7v131.2c0,2.6-2.1,4.7-4.7,4.7s-4.7-2.1-4.7-4.7V34.4
								C12.8,31.8,14.9,29.7,17.5,29.7z M77.9,91.5c1.8,1.8,1.8,4.8,0,6.6l-39.8,39.8c-1.9,1.8-4.9,1.7-6.6-0.2c-1.7-1.8-1.7-4.6,0-6.4
								l39.8-39.8C73.1,89.6,76,89.6,77.9,91.5z M169.9,70.2c1.6,2.1,1.1,5-0.9,6.5c0,0,0,0,0,0l-64.2,48.2c-2.1,1.5-5,1.1-6.6-0.9
								c-1.6-2.1-1.1-5,0.9-6.5c0,0,0,0,0,0l64.2-48.2C165.4,67.7,168.3,68.1,169.9,70.2L169.9,70.2z"/>
							<path fill="#FFFFFF" d="M104.6,124.5c-1.8,1.8-4.8,1.8-6.6,0L71.6,98.1c-1.8-1.8-1.8-4.8,0-6.6c1.8-1.8,4.8-1.8,6.6,0l26.3,26.3
								C106.4,119.6,106.4,122.6,104.6,124.5C104.6,124.4,104.6,124.4,104.6,124.5z"/>
						</svg>
		
						
							
<script src="/js/plugins/wordCount.js"></script>

							<p class="post-count">文字数：---</p>
						
		
						
							<p id="busuanzi_container_page_pv" style='display:none;'>阅读数：<span id="busuanzi_value_page_pv"></span></p>
						
					</div>
				
			</div>
		
	
</header>
        <div class="post-content article-container">
            <article class="post-content-info">
                <h1 id="preparation" tabindex="-1">Preparation</h1>
<h2 id="%E3%80%90%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-2021%E3%80%91transformer--%E4%B8%8A-" tabindex="-1" id="【機器學習-2021】Transformer-上">【機器學習 2021】Transformer -上-</h2>
<blockquote>
<p><strong>Transformer</strong> 是 2017 年引入的深度学习模型，主要用于自然语言处理领域。与循环神经网络一样，Transformers 旨在处理顺序数据（例如自然语言），以执行翻译和文本摘要等任务。但是，与 RNN 不同，Transformers 不需要按顺序处理顺序数据。</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/349569097">【DL】图解 Transformer – 李宏毅 - 知乎 (zhihu.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/wl1780852311/article/details/121015369">（2021 李宏毅）机器学习-Transformer_顾道长生’的博客-CSDN 博客</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/530344872">李宏毅老师《机器学习》课程笔记-5 Transformer - 知乎 (zhihu.com)</a></li>
</ul>
<p><img src="P1.1.png" alt="png"></p>
<p>Seq2seq 问题：输入一个序列，输出一个序列，输出序列的长度由模型决定。</p>
<ul>
<li>Speech Recognition：输入一段语音 T，输出对应的文字 N。</li>
<li>Machine Translation：输出一段文字 N，输出另一种语言的文字 N’。</li>
<li>Speech Translation：输入一段语音（这段语音使用的语言可能没有对应的文字），输出另一种语言的文字。
<ul>
<li>对于有文字的语言，可以将 Speech Recognition 和 Machine Translation 结合成 Speech Translation，但是没有文字的语言就不行。</li>
</ul>
</li>
</ul>
<p><img src="P1.2.png" alt="png"></p>
<p>​    尝试使用 1500 小时的乡土剧（台语声音，中文字幕）做数据集，让机器试着听台语输出中文。</p>
<p><img src="P1.3.png" alt="png"></p>
<p>​    不考虑训练集中 BGM、噪音、翻译文本的噪声、台语的口音等的因素。</p>
<p><img src="P1.4.png" alt="png"></p>
<p>​    最后也能得到差强人意的效果。</p>
<p><img src="P1.5.png" alt="png"></p>
<p>​    Taiwanese Speech Synthetic：语音辨识反过来：语言合成，输入文本，输出台语的项目。</p>
<p><img src="P1.6.png" alt="png"></p>
<p>​    Seq2seq model 用在聊天模型中。</p>
<p><img src="P1.7.png" alt="png"></p>
<p>​    把所有对话问题（各式各样的 NLP 问题）当作 QA 问题，用 seq2seq 模型解决。输入 question，context，输出 answer。</p>
<ul>
<li>[[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1806.08730">1806.08730] The Natural Language Decathlon: Multitask Learning as Question Answering (arxiv.org)</a>](<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1806.08730">https://arxiv.org/abs/1806.08730</a>)</li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1909.03329">1909.03329] LAMOL: LAnguage MOdeling for Lifelong Language Learning (arxiv.org)</a></li>
</ul>
<p><img src="P1.8.png" alt="png"></p>
<p>​    将 seq2seq 模型用在文法分析 Syntactic Parsing 中：输入一句话，输出这句话的语法成分（将语法成分看作用序列表示的一棵树）。</p>
<p><img src="P1.9.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1412.7449">1412.7449] Grammar as a Foreign Language (arxiv.org)</a> 当时 Seq2Seq 还主要用在翻译上，因此论文题目”将文法当作一门外语“。</li>
</ul>
<p><img src="P1.10.png" alt="png"></p>
<p>​    用在多标签分类问题。（同一个东西可能属于不同分类）输入一个文章，输出几个 class（由机器及自己决定）</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1909.03434">1909.03434] Order-free Learning Alleviating Exposure Bias in Multi-label Classification (arxiv.org)</a></li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1707.05495">1707.05495] Order-Free RNN with Visual Attention for Multi-Label Classification (arxiv.org)</a></li>
</ul>
<p><img src="P1.11.png" alt="png"></p>
<p>​    用在目标检测（看似没有关系，但是可以用 seq2seq 硬做）</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2005.12872">2005.12872] End-to-End Object Detection with Transformers (arxiv.org)</a></li>
</ul>
<p><img src="P1.12.png" alt="png"></p>
<p>​    在 2014 年，就提出了 Seq2seq 模型（不过时间比较久远，模型比较旧）：[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1409.3215">1409.3215] Sequence to Sequence Learning with Neural Networks (arxiv.org)</a>。由两个 RNN 分别组成了 Encoder、Decoder，可以应用于机器翻译。</p>
<p><img src="P1.13.png" alt="png"></p>
<p>​    今天典型的 seq2deq model：Transformer [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1706.03762">1706.03762] Attention Is All You Need (arxiv.org)</a></p>
<p>一般的 seq2seq model 会分成两块：Encoder（负责处理 input 的 seq）、Decoder（决定输出什么样的 seq）</p>
<h3 id="encoder" tabindex="-1" id="Encoder">Encoder</h3>
<p><img src="P1.14.png" alt="png"></p>
<p><img src="P1.15.png" alt="png"></p>
<p>​    在 seq2seq 模型中的 Encoder 要做的事情就是 <strong>输入一排向量，输出另一排向量</strong>。能实现输入一排向量，输出一排向量功能的模型有 Self-attention、CNN 和 RNN 等模型，而 <strong>Transformer</strong> 中用到的则是 <strong>Multi-Head attention 模型</strong>。</p>
<p><img src="P1.19.png" alt="png"></p>
<p>​    Transformer 中有 N 个 Block，每个 Block 中包含了 Multi-Head Attention 和 Fully Connected 的 Feed Forward Network。</p>
<ul>
<li>先做一个 self-attention，输入一排向量，经过 self-attention 考虑整个 sequence 的信息后，输出另外一排向量。</li>
<li>接下来将输出的这一排向量输入到 fully connected 的前馈网络中，得到处理后的向量，就是 Block 的输出。</li>
</ul>
<p><img src="P1.16.png" alt="png"></p>
<p>​    Transformer 引入了 <strong>residual connection</strong>，直接把 input 的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span></span></span></span> 和 output 的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">b</span></span></span></span> 加起来得到新的 vector，再进行 layer normalization，得到 self-attention 的输出（FC 网络的输入）。</p>
<p>​    在 fully connected 中也增加了同样的 residual 网络结构，FC 网络的输出先直接加上它对应的输入，然后经过 layer normalization 之后才是 FC 网络最终的输出。</p>
<p>Layer Norm：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mrow><mi mathvariant="normal">′</mi></mrow></msubsup><mo>=</mo><mfrac><mrow><msubsup><mi>x</mi><mi>i</mi><mrow><mi mathvariant="normal">′</mi></mrow></msubsup><mo>−</mo><mi>m</mi></mrow><mrow><mi>σ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">x&#x27;_i=\frac{x&#x27;_i-m}{\sigma}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.428892em;"></span><span class="strut bottom" style="height:2.114892em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">σ</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.258664em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1607.06450">1607.06450] Layer Normalization (arxiv.org)</a></li>
</ul>
<p><img src="P1.17.png" alt="png"></p>
<p>​    BERT 就使用了 transformer Eecoder。</p>
<h3 id="encoder-%E6%80%BB%E7%BB%93" tabindex="-1" id="Encoder-总结">Encoder 总结</h3>
<ul>
<li>
<p>在将输入向量进行 self-attention 之前，先加上 Positional Encoding，也就是输入向量中的位置信息。</p>
</li>
<li>
<p>Multi-Head Attention：进行 Multi-Head 的 self-attention 处理得到输出向量。</p>
</li>
<li>
<p>Add &amp; Norm (residual &amp; layer normalization): 也就是将 self-attention 的输出加上它对应的输入然后对其进行 Layer Normalization。</p>
</li>
<li>
<p>Feed Forward：将上一层的输出输入到 fully connected Network 中，将得到的输出向量和对应的输入向量同样经过 residual &amp; layer normalization 操作后得到该 block 的最终输出。</p>
</li>
<li>
<p>将这个 block 重复 n 次。</p>
</li>
</ul>
<p><img src="P1.18.png" alt="png"></p>
<p>尝试对原始的 transformer 的改进：[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2002.04745">2002.04745] On Layer Normalization in the Transformer Architecture (arxiv.org)</a></p>
<p>为什么说要用 layer normalization 而不是 batch normalization：[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2003.07845">2003.07845] PowerNorm: Rethinking Batch Normalization in Transformers (arxiv.org)</a></p>
<h2 id="%E3%80%90%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-2021%E3%80%91transformer--%E4%B8%8B-" tabindex="-1" id="【機器學習-2021】Transformer-下">【機器學習 2021】Transformer -下-</h2>
<p>Decoder 分为 <strong>Auto regressive</strong>（AT）和 <strong>Non-Auto regressive</strong>（NAT）两种。其中 AT 应用范围更为广泛一些。</p>
<h3 id="decoder-autoregressive-(at)" tabindex="-1" id="Decoder-Autoregressive-AT">Decoder-Autoregressive (AT)</h3>
<p><img src="P2.1.png" alt="png"></p>
<p><img src="P2.2.png" alt="png"></p>
<p>​    以 Speech Recognition 为例，从一段音频文件转换为文字序列。先由 Encoder 将这段音频变成一排 vector，再由 Decoder 将这排 vector 变成一段文字。每一个文字（Token）都用一个独热编码的向量表示（如果是英文，会更复杂）。BEGIN 和 END 被作为特殊的 Token。</p>
<ul>
<li>
<p>在 Encoder 完成之后，将其输出作为一个输入喂到 Decoder 中。</p>
</li>
<li>
<p>同时，输入一个 special token：BEGIN 表示开始工作。</p>
</li>
<li>
<p>Decoder 结合这两个输入，输出一个经过 softmax 处理后的长度为 Vocabulary Size 的输出向量（是个概率分布），该向量中每一个中文字都对应一个数值，数值最大的中文字为最终输出的中文字，下图中，输出的结果是“机”。</p>
</li>
</ul>
<p><img src="P2.3.png" alt="png"></p>
<p>​    接下来将“机”作为 Decoder 的输入，输出”器“，依次法得到”学“和”习“。（Decoder 会把自己的输入当作接下来的输出）</p>
<p><img src="P2.4.png" alt="png"></p>
<p>​    Decoder 的结构。</p>
<p><img src="P2.5.png" alt="png"></p>
<p>​    Encoder 与 Decoder 相比，<strong>每一个 block 中 Decoder 比 Encoder 多了中间的一个 Multi-Head Attention</strong>，同时第一个自注意力机制使用的是 <strong>Masked Multi-Head Attention</strong>。
<img src="P2.7.png" alt="png"></p>
<p><strong>Masked Self-attention 与 Self-attention 的不同</strong></p>
<p>​    Masked Self-attention 的计算顺序其实是和 Decoder 的串行计算顺序相对应的，以上图中计算 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>b</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">b^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 为例：在计算 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>b</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">b^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 的时候，和原来的 Self-attention 考虑<strong>所有</strong>输入信息 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><msup><mi>a</mi><mn>1</mn></msup><mo separator="true">,</mo><msup><mi>a</mi><mn>2</mn></msup><mo separator="true">,</mo><msup><mi>a</mi><mn>3</mn></msup><mo separator="true">,</mo><msup><mi>a</mi><mn>4</mn></msup><mo>]</mo></mrow><annotation encoding="application/x-tex">[a^1,a^2,a^3,a^4]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">4</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">]</span></span></span></span> 不同，Masked Self-attention <strong>只</strong>考虑 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><msup><mi>a</mi><mn>1</mn></msup><mo separator="true">,</mo><msup><mi>a</mi><mn>2</mn></msup><mo>]</mo></mrow><annotation encoding="application/x-tex">[a^1,a^2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">]</span></span></span></span> , 因为此时的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><msup><mi>a</mi><mn>3</mn></msup><mo separator="true">,</mo><msup><mi>a</mi><mn>4</mn></msup><mo>]</mo></mrow><annotation encoding="application/x-tex">[a^3,a^4]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">4</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">]</span></span></span></span> 还没有计算出来。</p>
<p><strong>Why masked？</strong></p>
<p>​    Encoder 是知道所有的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span></span></span></span>，所以使用 Self-attention，而 Decoder 需要知道前一个的输出作为输入，不知道所有的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span></span></span></span>（只能考虑左边的东西，不能考虑右边的东西），所以使用 Masked Multi attention。</p>
<p><img src="P2.8.png" alt="png"></p>
<p><img src="P2.9.png" alt="png"></p>
<p><strong>Decoder 无法知道最终输出的长度？</strong></p>
<p>​    加入 special token：STOP，机器就会停止。</p>
<p><img src="P2.10.png" alt="png"></p>
<p>​    要让机器识别出“机器学习”后，会输出 END。</p>
<h3 id="decoder-non-autoregressive-(nat)" tabindex="-1" id="Decoder-Non-Autoregressive-NAT">Decoder-Non-Autoregressive (NAT)</h3>
<p><img src="P2.11.png" alt="png"></p>
<p><img src="P2.12.png" alt="png"></p>
<p>​    与 AT 不同的是，NAT 并不使用之前时刻的输出，而是一次输入一组 special token。</p>
<ul>
<li>
<p>How to decide the output length for NAT Decoder?</p>
<ul>
<li>
<p>Another predictor for output length（由其他部分决定输出长度）</p>
</li>
<li>
<p>Output a very long sequence, ignore tokens after END</p>
</li>
</ul>
</li>
<li>
<p><font color="green">Advantage</font>:</p>
<ul>
<li>parallel
<ul>
<li>AT 一次输出一个 vector（因为上一个输出又作为下一个输入），无法并行处理。而 NAT 可以并行处理，NAT 速度比 AT 更快，在有 self-attention 之前，RNN 和 LSTM 是不能设计 NAT 的。</li>
</ul>
</li>
<li>controllable output length
<ul>
<li>比如在语音合成 (TTS) 任务中，把 Eecoder 的输出送入一个 Classifier，预测 Decoder 输出 sequence 长度。通过改变这个 Classifier 预测的长度，可以调整生成语音的语速。例如，设置输出 sequence 长度 x2，语速就可以慢一倍。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>NAT is usually <font color="red">worse</font> than AT (why? Multi-modality 多模态的问题)</p>
</li>
</ul>
<p>了解更多 NAT：<a target="_blank" rel="noopener" href="https://youtu.be/jvyKmU40M3c">https://youtu.be/jvyKmU40M3c</a></p>
<h3 id="encoder-decoder" tabindex="-1" id="Encoder-Decoder">Encoder-Decoder</h3>
<p><img src="P2.13.png" alt="png"></p>
<p><img src="P2.14.png" alt="png"></p>
<p>​    Encoder 与 Decoder 联系起来的部分：<strong>Cross attention</strong>。两个输入 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>k</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(k,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 来自 Encoder，一个输入 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span></span> 来自 Decoder。它计算的是 Encoder 的输出与当前 vector 的 cross attention。</p>
<p><img src="P2.15.png" alt="png"></p>
<p>​    用 Decoder 中 Self-attention 层的输出 vector 生成 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span></span>，与由 Encoder 最后一层输出 sequence 产生的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>k</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(k,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 做运算。</p>
<p><img src="P2.16.png" alt="png"></p>
<p>​    Cross Attention 实际的展示：<strong>Listen, attend and spell</strong>: A neural network for large vocabulary conversational speech recognition</p>
<p>​    并不是 transformer，说明先有 cross attention 机制后才有的 self-attention 机制。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/7472621">Listen, attend and spell: A neural network for large vocabulary conversational speech recognition | IEEE Conference Publication | IEEE Xplore</a></li>
</ul>
<p><img src="P2.17.png" alt="png"></p>
<blockquote>
<p>​    试想一下，如果你要做一个演讲，虽然记了演讲内容，但还是会担心一上台紧张忘词。怎么办呢？可以把提纲写在卡片上，演讲中看上一眼，就知道接下来要讲什么了。我觉得 cross attention 的作用就有点像这个小卡片，因为它看过整个 sequence，可以给 Decoder 提示信息。</p>
<p>​    cross attention 在早期的 Seq2seq 模型论文中就已经出现，是 Seq2seq 的重要单元。看到 <a href="https://link.zhihu.com/?target=https%3A//jalammar.github.io/visualizing-neural-machine-translation-mechanics-of-seq2seq-models-with-attention/">seq2seq model with attention</a> 和 <a href="https://link.zhihu.com/?target=https%3A//www.bilibili.com/video/BV1s64y1M721%3Fp%3D4">Yannic Kilcher 大神的论文解读视频</a> 介绍，早期 Seq2seq 模型的 Eecoder 和 Decoder 是用 RNN，attention 用在 cross attention 单元。本来 Decoder 只能利用 Eecoder RNN 最后一个时刻的 hidden state，用了 cross attention 之后，之前时刻的 hidden state 也可以看。哪个时刻的 hidden state 对当前 Decoder 输出最相关 (attention)，重点看这个 hidden state，这样模型的性能更好。而 Transformer 架构干脆把 Eecoder 和 Decoder 也全部用 attention 来做 (Self-attention)，正如论文标题所言 “Attention is all you need”。</p>
<p>​    你可能会有疑问，Decoder 有很多层 self-attention，每一层 self-attention 的输出都是与 Eecoder 最后的输出 sequence 做 cross attention 吗？可以有不同的设计吗？Transformer 论文中是这样设计，但是也可以用不同的设计，现在已经有一些这方面的研究和实验。</p>
</blockquote>
<p>​    不同的 Cross Attention 连接方式：[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2005.08081">2005.08081] Rethinking and Improving Natural Language Generation with Layer-Wise Multi-View Decoding (arxiv.org)</a></p>
<h3 id="training" tabindex="-1" id="Training">Training</h3>
<p><img src="P2.18.png" alt="png"></p>
<p><img src="P2.19.png" alt="png"></p>
<p>​    Decoder 的输出 (output) 是一个概率分布，label 是 one-hot vector，优化的目标就是使 label 与 Decoder output 之间的 cross entropy 最小。这其实是一个分类问题。</p>
<p><img src="P2.20.png" alt="png"></p>
<p>​    Decoder 中，前一个输出又作为下一个输入。使用 Teacher Forcing 方法，Decoder 输入用的是 ground truth value（在训练的时候会给 Decoder 看正确答案）。</p>
<p>​    测试的时候没有正确答案？可能会有 mis match 的问题。</p>
<h4 id="copy-mechanism" tabindex="-1" id="Copy-Mechanism">Copy Mechanism</h4>
<p><img src="P2.21.png" alt="png"></p>
<blockquote>
<p>​    Copy Mechanism 指<strong>在文本生成领域，生成的输出是输入序列元素的复制或者指向</strong>。该机制最早由 Vinyals et al.（2015）在 Pointer Network 中提出，所以有时也被称为 Pointer Mechanism 指针机制。</p>
</blockquote>
<p>​    有些情况，不需要对输入做改动，比如翻译人名地名，聊天机器人(chat-bot)，摘要 (summarization) 等，可以直接复制一部分输入内容。</p>
<p>​    具体的方法：</p>
<ul>
<li>Pointer Network</li>
<li>Copy network</li>
</ul>
<p><img src="P2.22.png" alt="png"></p>
<p>应用：给机器读一篇文章，让机器输出一篇文章的摘要。</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1704.04368">1704.04368] Get To The Point: Summarization with Pointer-Generator Networks (arxiv.org)</a></li>
</ul>
<p><img src="P2.23.png" alt="png"></p>
<p>Seq2seq model 如何做到 Copy Mechanism？</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://youtu.be/VdOyqNQ9aww">https://youtu.be/VdOyqNQ9aww</a></li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1603.06393">1603.06393] Incorporating Copying Mechanism in Sequence-to-Sequence Learning (arxiv.org)</a></li>
</ul>
<h4 id="guided-attention" tabindex="-1" id="Guided-Attention">Guided Attention</h4>
<p><img src="P2.24.png" alt="png"></p>
<p>​    举了一个语音合成 (TTS) 的例子，机器一次说四遍“发财”这个词时，说得挺好，还有抑扬顿挫之感。一次说三遍或两遍“发财”也正常。但是，一次说一遍“发财”时，不知怎的，只有一个音“财”（也许机器不知道怎么处理非常短的句子）。</p>
<p><img src="P2.25.png" alt="png"></p>
<p>​    从这个例子可以看到，在处理语音识别 (speech recognition) 或语音合成 (TTS) 等任务时，我们不希望漏掉其中的任何一段内容，Guided Attention 正是要满足这个要求。而 chat-bot, summary 一类的应用在这方面的要求就宽松得多。</p>
<p>​    Guided Attention 是让 attention 的计算按照一定顺序来进行。比如在做语音合成时，attention 的计算应该从左向右推进，如下图中前三幅图所示。如果 attention 的计算时顺序错乱，如下图中后三幅图所示，那就说明出了错误。具体方法：Monotonic Attention, Location-aware attention。</p>
<h4 id="beam-search" tabindex="-1" id="Beam-Search">Beam Search</h4>
<p><img src="P2.26.png" alt="png"></p>
<p>​    这其实是一个最优路径的问题。前面介绍，Decoder 每次输出一个变量，假设输出词汇库只有 A, B 两个词汇。每一次都选择最大概率的作为输出，如下图中红色路径所示，这就是 Greedy Decoding。同时，Decoder 的每个输出又是下一时刻输入，如果我们从整个 sequence 的角度考虑，可能第一次不选最大概率，后面的输出概率（把握）都很大，整体更佳，如下图中绿色路径所示。</p>
<p>​    怎么找到最好的路径（图中绿色路径）？穷尽所有选择（路径）吗？这不现实，运算量太大。一个优化方法就是 Beam Search，比如每次存前两个概率大的输出，下一步把这两种输出各走一遍，依此类推，一直到最后。</p>
<p>​    但是，用 Beam Search 找到分数最高的路径，就一定是最好的吗？比如下图所示文本生成的例子，使用 Beam Search，后面一直在重复同一个句子。而 Pure Sampling 生成的文本至少看起来还正常。</p>
<h5 id="sampling" tabindex="-1" id="Sampling">Sampling</h5>
<p><img src="P2.27.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1904.09751">1904.09751] The Curious Case of Neural Text Degeneration (arxiv.org)</a></li>
</ul>
<p>​    Beam Search 有时有用，有时没用。对于有明确答案的任务，比如语音识别，beam search 方法表现好。对于有些创造型任务，比如文本生成，Decoder 是需要一些随机性 (randomness)（论文显示可能出现重复输出同一句话）。</p>
<p>​    在实验室做语言合成 (TTS) 的经历。一开始总做不出理想的效果，和 Google 的研究人员交流，他们提到，测试时 Decoder 要加噪声 (noise)。听上去是不是难以置信？训练时 Decoder 加噪可以理解，让模型 more robust。测试时 Decoder 加噪，这不是给自己找麻烦吗？但是，按这个方法去做，效果确实好！没加噪时，Decoder 产生的声音就像机关枪一样。加噪（加入随机性）之后，产生的声音就接近人声。对于 TTS 或文本生成而言，Decoder 用 Beam Search 找到的最好结果，不见得是人类认为的最好结果（不自然）。加入一点随机性，效果反而更好。正如西谚所言：“Accept that nothing is perfect. True beauty lies in the cracks of imperfection.”（没有事情是完美的，真正的完美可能在不完美之中）</p>
<h4 id="optimizing-evaluation-metrics%3F" tabindex="-1" id="Optimizing-Evaluation-Metrics">Optimizing Evaluation Metrics?</h4>
<p><img src="P2.28.png" alt="png"></p>
<p>​    最佳优化评估指标？</p>
<p>​    在 homework 中，train 使用 cross entropy loss 做 criterion，要使 output 和 label 在对应 vector 上 cross-entropy 最小。而评估模型用的是 BLEU score, 是在两个 sequence 上运算（cross entropy 最小的模型 BLEU socre 不一定最大）。因此，validation 挑选模型时也用 BLEU score 作为衡量标准。</p>
<p>​    那么，training 直接就用 BLEU score 做 criterion 岂不更好？</p>
<p>​    问题就在于：BLEU score 没办法微分，不知道要怎么做 gradient descent。实在要做：Reinforcement Learning(RL)。</p>
<p>​    秘诀：”When you don’t know how to optimize, just use reinforcement learning(RL).” 遇到在 optimization 无法解决的问题，用 RL “硬 train 一发”。</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1511.06732">1511.06732] Sequence Level Training with Recurrent Neural Networks (arxiv.org)</a></li>
</ul>
<p>​</p>
<p><img src="P2.29.png" alt="png"></p>
<p>​    exposure bias：训练和测试时不一致：训练时 Decoder 永远看到正确的东西，而测试时可能看到错误的东西（可能一步错步步错）。</p>
<p>​    有些解决方法：给训练时加一点错误的东西：Scheduled Sampling</p>
<h3 id="scheduled-sampling" tabindex="-1" id="Scheduled-Sampling">Scheduled Sampling</h3>
<p><img src="P2.30.png" alt="png"></p>
<p>Scheduled Sampling（可能会伤害到 transformer 的并行计算能力）</p>
<ul>
<li>Original Scheduled Sampling
<ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1506.03099">https://arxiv.org/abs/1506.03099</a></li>
</ul>
</li>
<li>Scheduled Sampling for Transformer
<ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1906.07651">https://arxiv.org/abs/1906.07651</a></li>
</ul>
</li>
<li>Parallel Scheduled Sampling
<ul>
<li><a target="_blank" rel="noopener" href="https://arxivorg/abs/1906.04331">https://arxivorg/abs/1906.04331</a></li>
</ul>
</li>
</ul>
<p><img src="P2.31.png" alt="png"></p>
<h1 id="class-material" tabindex="-1">Class Material</h1>
<h2 id="%E3%80%90%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-2022%E3%80%91%E5%90%84%E5%BC%8F%E5%90%84%E6%A8%A3%E7%A5%9E%E5%A5%87%E7%9A%84%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%A9%9F%E5%88%B6--self-attention--%E8%AE%8A%E5%9E%8B" tabindex="-1" id="【機器學習-2022】各式各樣神奇的自注意力機制-Self-attention-變型">【機器學習 2022】各式各樣神奇的自注意力機制 -Self-attention- 變型</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2165918">收藏！各种各样神奇的自注意力机制（Self-attention）- 腾讯云开发者社区-腾讯云 (tencent.com)</a></li>
</ul>
<p><img src="C1.1.png" alt="png"></p>
<p>​    本节主要讲 Transformer 的变形：</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2011.04006">2011.04006] Long Range Arena: A Benchmark for Efficient Transformers (arxiv.org)</a></li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2009.06732">2009.06732] Efficient Transformers: A Survey (arxiv.org)</a></li>
</ul>
<p><img src="C1.2.png" alt="png"></p>
<p>​    原始的 self-attention 的 Attention Matrix 大小为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">N\times N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>，当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> 特别大时计算量很大。</p>
<p><img src="C1.3.png" alt="png"></p>
<p><strong>Notice</strong></p>
<ul>
<li>对于 transformer 来说，self-attention 只是大的网络架构中的一个 module</li>
<li>由上述分析我们知道，对于 self-attention 的运算量是跟 N 的平方成正比的。当 N 很小的时候，单纯增加 self-attention 的运算效率可能并不会对整个网络的计算效率有太大的影响。</li>
<li>这种问题一般是用在处理图像的问题上，如一张 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mn>5</mn><mn>6</mn><mo>×</mo><mn>2</mn><mn>5</mn><mn>6</mn></mrow><annotation encoding="application/x-tex">256\times 256</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">5</span><span class="mord mathrm">6</span><span class="mbin">×</span><span class="mord mathrm">2</span><span class="mord mathrm">5</span><span class="mord mathrm">6</span></span></span></span> 的图像，其 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><mn>2</mn><mn>5</mn><mn>6</mn><mo>×</mo><mn>2</mn><mn>5</mn><mn>6</mn><mo>=</mo><mn>6</mn><mn>5</mn><mn>5</mn><mn>3</mn><mn>6</mn></mrow><annotation encoding="application/x-tex">N=256\times256=65536</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathrm">5</span><span class="mord mathrm">6</span><span class="mbin">×</span><span class="mord mathrm">2</span><span class="mord mathrm">5</span><span class="mord mathrm">6</span><span class="mrel">=</span><span class="mord mathrm">6</span><span class="mord mathrm">5</span><span class="mord mathrm">5</span><span class="mord mathrm">3</span><span class="mord mathrm">6</span></span></span></span>。</li>
</ul>
<p><img src="C1.4.png" alt="png"></p>
<p>​    用人类知识跳过某些计算，选择性的计算 Attention Matrix 中的某些数值或者某些数值不需要计算就可以知道数值，理论上可以减小计算量，提高计算效率。</p>
<h3 id="local-attention-%2F-truncated-attention" tabindex="-1" id="Local-Attention-Truncated-Attention">Local Attention / Truncated Attention</h3>
<p><img src="C1.5.png" alt="png"></p>
<p>​    举个例子，比如我们在做文本翻译的时候，有时候在翻译当前的 token 时不需要给出整个 sequence，其实只需要知道这个 token 两边的邻居，就可以翻译的很准，也就是做局部的 attention（local attention）。这样可以大大提升运算效率，但是缺点就是只关注周围局部的值，这样做法其实跟 CNN 就没有太大的区别了。</p>
<h3 id="stride-attention" tabindex="-1" id="Stride-Attention">Stride Attention</h3>
<p><img src="C1.6.png" alt="png"></p>
<p>​    如果觉得上述这种 local attention 不好，也可以换一种思路，就是在翻译当前 token 的时候，给它空一定间隔（stride）的左右邻居，从而捕获当前与过去和未来的关系。当然 stride 的数值可以自己确定。</p>
<h3 id="global-attention" tabindex="-1" id="Global-Attention">Global Attention</h3>
<p><img src="C1.7.png" alt="png"></p>
<p>​    global attention 选择 sequence 中的某些 token 作为 special token（比如标点符号），或者在原始的 sequence 中增加 special token。让 special token 与序列产生全局的关系，但是其他不是 special token 的 token 之间没有 attention。</p>
<p>Add special token into original sequence</p>
<ul>
<li>Attend to every token → collect global information</li>
<li>Attended（参加）by every token → it knows global information</li>
</ul>
<p><img src="C1.8.png" alt="png"></p>
<p>​    对于上述三种 Attention，可以使用 different heads 使用多种 attention 机制。</p>
<p><img src="C1.9.png" alt="png"></p>
<ul>
<li>Longformer 就是组合了上面的三种 attention
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2004.05150">2004.05150] Longformer: The Long-Document Transformer (arxiv.org)</a></li>
</ul>
</li>
<li>Big Bird 就是在 Longformer 基础上 Random attention 赋值，进一步提高计算效率
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2007.14062">2007.14062] Big Bird: Transformers for Longer Sequences (arxiv.org)</a></li>
</ul>
</li>
</ul>
<h3 id="can-we-only-focus-on-critical-parts%EF%BC%9F" tabindex="-1" id="Can-we-only-focus-on-Critical-Parts？">Can we only focus on Critical Parts？</h3>
<p><img src="C1.10.png" alt="png"></p>
<p>​    上面集中方法都是人为设定的哪些地方需要算 attention，哪些地方不需要算 attention，但是这样算是最好的方法吗？并不一定。对于 Attention Matrix 来说，如果某些位置值非常小，我们可以直接把这些位置设为 0，这样对实际预测的结果也不会有太大的影响。也就是说我们只需要找出 Attention Matrix 中 attention 的值相对较大的值。但是如何找出哪些位置的值非常小/非常大呢？</p>
<h3 id="clustering" tabindex="-1" id="Clustering">Clustering</h3>
<p><img src="C1.11.png" alt="png"></p>
<p><img src="C1.12.png" alt="png"></p>
<p>​    下面这两个文献中给出一种 Clustering（聚类）的方案，即先对 query 和 key 进行聚类。属于同一类的 query 和 key 来计算 attention，不属于同一类的就不参与计算，这样就可以加快 Attention Matrix 的计算。比如下面这个例子中，分为 4 类：1（红框）、2（紫框）、3（绿框）、4（黄框）。在下面两个文献中介绍了可以快速粗略聚类的方法。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://openreview.net/forum?id=rkgNKkHtvB">Reformer: The Efficient Transformer | OpenReview</a></li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2003.05997">2003.05997] Efficient Content-Based Sparse Attention with Routing Transformers (arxiv.org)</a></li>
</ul>
<h3 id="learnable-patterns" tabindex="-1" id="Learnable-Patterns">Learnable Patterns</h3>
<p><img src="C1.13.png" alt="png"></p>
<p>​    上述我们所讲的都是 N<em>N 的 Matrix，但是实际来说，这样的 Matrix 通常来说并不是满秩的，也就是说我们可以对原始 N</em>N 的矩阵降维，将重复的 column 去掉，得到一个比较小的 Matrix。</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2002.11296">2002.11296] Sparse Sinkhorn Attention (arxiv.org)</a></li>
</ul>
<h3 id="do-we-need-full-attention-matrix%EF%BC%9F" tabindex="-1" id="Do-we-need-full-attention-matrix？">Do we need full attention matrix？</h3>
<p><img src="C1.14.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2006.04768">2006.04768] Linformer: Self-Attention with Linear Complexity (arxiv.org)</a></li>
</ul>
<p><img src="C1.15.png" alt="png"></p>
<p>​    具体来说，从 N 个 key 中选出 K 个具有代表的 key，每个 key 对应一个 value，然后跟 query 做点乘。然后做 gradient-decent，更新 value。</p>
<p>​    为什么选有代表性的 key 不选有代表性的 query 呢？因为 query 跟 output 是对应的，这样会 output 就会缩短从而损失信息。</p>
<h3 id="reduce-number-of-keys" tabindex="-1" id="Reduce-Number-of-Keys">Reduce Number of Keys</h3>
<p><img src="C1.16.png" alt="png"></p>
<p>​    怎么选出有代表性的 key 呢？这里介绍两种方法：</p>
<ul>
<li>直接对 key 做卷积（conv）
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1801.10198">1801.10198] Generating Wikipedia by Summarizing Long Sequences (arxiv.org)</a></li>
</ul>
</li>
<li>对 key 跟一个矩阵做矩阵乘法
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2006.04768">2006.04768] Linformer: Self-Attention with Linear Complexity (arxiv.org)</a></li>
</ul>
</li>
</ul>
<p><img src="C1.17.png" alt="png"></p>
<p>​    回顾一下注意力机制的计算过程，其中 I 为输入矩阵，O 为输出矩阵，暂时忽略 softmax 过程。</p>
<p><img src="C1.19.png" alt="png"></p>
<p>​    矩阵乘法交换计算顺序，得出的结果相同，但是计算量可能不同。</p>
<p><img src="C1.20.png" alt="png"></p>
<p>​    依法<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>≈</mo><mi>V</mi><mo>(</mo><msup><mi>K</mi><mi>T</mi></msup><mi>Q</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O\approx V(K^TQ)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mrel">≈</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">Q</span><span class="mclose">)</span></span></span></span> 计算（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>d</mi><mo>+</mo><msup><mi>d</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>)</mo><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">(d+d&#x27;)N^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">d</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 次乘法）要比 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>≈</mo><mo>(</mo><mi>V</mi><msup><mi>K</mi><mi>T</mi></msup><mo>)</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">O\approx (VK^T)Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mrel">≈</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathit">Q</span></span></span></span> 计算（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>d</mi><msup><mi>d</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mi>N</mi></mrow><annotation encoding="application/x-tex">2dd&#x27;N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> 次乘法）量大得多。</p>
<p><img src="C1.21.png" alt="png"></p>
<p>​    把 softmax 拿回来……</p>
<p><img src="C1.22.png" alt="png"></p>
<p><img src="C1.23.png" alt="png"></p>
<p>如果我们可以将 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>exp</mi><mo>(</mo><mi>q</mi><mo>⋅</mo><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\exp(q\cdot k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> 转换成两个映射相乘 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>≈</mo><mi>ϕ</mi><mo>(</mo><mi>q</mi><mo>)</mo><mo>⋅</mo><mi>ϕ</mi><mo>(</mo><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\approx \phi(q)\cdot\phi(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mrel">≈</span><span class="mord mathit">ϕ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mbin">⋅</span><span class="mord mathit">ϕ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> 的形式，那么可以对上式进行进一步简化：</p>
<p><img src="C1.24.png" alt="png"></p>
<p><img src="C1.25.png" alt="png"></p>
<p><img src="C1.26.png" alt="png"></p>
<p><img src="C1.27.png" alt="png"></p>
<p><img src="C1.28.png" alt="png"></p>
<p><img src="C1.29.png" alt="png"></p>
<p><img src="C1.30.png" alt="png"></p>
<h3 id="realization" tabindex="-1" id="Realization">Realization</h3>
<p><img src="C1.31.png" alt="png"></p>
<p>​    可以这样去理解，将 φ(k) 跟 v 计算的 vector 当做一个 template，然后通过 φ(q) 去寻找哪个 template 是最重要的，并进行矩阵的运算，得到输出 b。</p>
<p>那么 φ 到底如何选择呢？不同的文献有不同的做法：</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1812.01243">1812.01243] Efficient Attention: Attention with Linear Complexities (arxiv.org)</a></li>
<li><a target="_blank" rel="noopener" href="https://linear-transformers.com/">Linear Transformers (linear-transformers.com)</a></li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2103.02143">2103.02143] Random Feature Attention (arxiv.org)</a></li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2009.14794">2009.14794] Rethinking Attention with Performers (arxiv.org)</a></li>
</ul>
<p><img src="C1.32.png" alt="png"></p>
<p>​    在计算 self-attention 的时候一定需要 q 和 k 吗？不一定。在 Synthesizer 文献里面，对于 attention matrix 不是通过 q 和 k 得到的，而是作为网络参数学习得到。虽然不同的 input sequence 对应的 attention weight 是一样的，但是 performance 不会变差太多。其实这也引发一个思考，attention 的价值到底是什么？</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2005.00743">2005.00743] Synthesizer: Rethinking Self-Attention in Transformer Models (arxiv.org)</a></li>
</ul>
<h3 id="attention-free" tabindex="-1" id="Attention-free">Attention-free</h3>
<p><img src="C1.33.png" alt="png"></p>
<p>​    不使用 attention 机制处理 seq2seq 问题：</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2105.03824">2105.03824] FNet: Mixing Tokens with Fourier Transforms (arxiv.org)</a></li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2105.08050">2105.08050] Pay Attention to MLPs (arxiv.org)</a></li>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2105.01601">2105.01601] MLP-Mixer: An all-MLP Architecture for Vision (arxiv.org)</a></li>
</ul>
<h3 id="summary" tabindex="-1" id="Summary">Summary</h3>
<p><img src="C1.34.png" alt="png"></p>
<p>图中横轴为训练速度，纵轴为性能得分。</p>
<ul>
<li>Human knowledge
<ul>
<li>Local Attention，Big Bird</li>
</ul>
</li>
<li>Clustering
<ul>
<li>Reformer</li>
</ul>
</li>
<li>Learnable Pattern
<ul>
<li>Sinkforn</li>
</ul>
</li>
<li>Representative key
<ul>
<li>Linformer</li>
</ul>
</li>
<li>k, q first → v, k first
<ul>
<li>Linear Transformer, Performer</li>
</ul>
</li>
<li>New framework
<ul>
<li>Synthesizer</li>
</ul>
</li>
</ul>
<h1 id="extra-material" tabindex="-1">Extra Material</h1>
<h2 id="-dlhlp-2020--non-autoregressive-sequence-generation--%E7%94%B1%E5%8A%A9%E6%95%99%E8%8E%8A%E6%B0%B8%E6%9D%BE%E5%90%8C%E5%AD%B8%E8%AC%9B%E6%8E%88-" tabindex="-1" id="DLHLP-2020-Non-Autoregressive-Sequence-Generation-由助教莊永松同學講授">-DLHLP 2020- Non-Autoregressive Sequence Generation -由助教莊永松同學講授-</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/Raphael9900/article/details/128283073">【学习】自注意力机制的改进方法、non-autoregressive sequence generation、point network_自注意力机制改进_Raphael9900 的博客-CSDN 博客</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/oldmao_2001/article/details/109580466">李宏毅 DLHLP.20.Non-Autoregressive Generation_oldmao_2000 的博客-CSDN 博客</a></li>
</ul>
<p><img src="E1.1.png" alt="png"></p>
<p>条件序列生成：语音识别</p>
<p><img src="E1.2.png" alt="png"></p>
<p>其他条件序列生成：</p>
<ul>
<li>Image Caption Generation 给一张图片返回文字描述</li>
<li>Machine Translation 机器翻译</li>
</ul>
<h3 id="autoegressive-model-(inference-stage)" tabindex="-1" id="Autoegressive-model-inference-stage">Autoegressive model (inference stage)</h3>
<p><img src="E1.3.png" alt="png"></p>
<p>​    RNN，逐个的吃 token，然后生成 token 的时候是生成下一个 token 的时候要参考当前时间步的 token，因此，无论是输入和输出都比较花费时间。</p>
<p>​    后来有了 BERT，这个时候就可以用 BERT 替换输入模块，这个时候可以直接一次把所有的输入都吃进来，不用一个个的吃，输入的速度是解决了，但是输出还是和 RNN 一样，一个个的往外吐。</p>
<p><img src="E1.4.png" alt="png"></p>
<p>​    因此，就想能不能把输出也改成直接吐所有的 token 的模式，这个就是 Non-autoregressive model 的目标。</p>
<h3 id="what%E2%80%98s-the-problem%3F" tabindex="-1" id="What‘s-the-problem">What‘s the problem?</h3>
<p><img src="E1.5.png" alt="png"></p>
<p>要实现上面提出的目标，有难度，借用之前 ML 课程中讲过的一个例子来说：
有一个 Text-to-lmage 的任务，就是给一段文字，然后模型为文字配一个图片，传统使用有监督的方式进行训练，例如下图中给出的文字是奔跑的狗子，那么模型生成的图片要和 ground truth 要越接近越好。</p>
<p><img src="E1.6.png" alt="png"></p>
<p>​    由于各个神经元之间没有相互联系，输出的模型又想像这张图片，又想像那张图片。</p>
<p><img src="E1.7.png" alt="png"></p>
<p>​    假如我们使用 Non-Autoregressive Sequence Generation 的方式来进行 translation。输入是【Hello!】，输出可以看到有好几种合理的翻译。可以看到输出第一个 token 中【哈】【你】几率都相等，都为 50%，第二个 token 同理。那么在输出整个 sequence 的时候就有可能是 你喽/哈好。</p>
<p>​    明显这两个都是错误的翻译，但是都是有可能被模型 sample 出来的结果。我们将这个问题称为：multi-modality problem，同一个输入，可能对应多个输出，那么 Non-Autoregressive 模型就会把各种可能的输出进行叠加，导致错误。</p>
<p><img src="E1.8.png" alt="png"></p>
<table>
<thead>
<tr>
<th>generate target / methods</th>
<th>Image</th>
<th>Text</th>
</tr>
</thead>
<tbody>
<tr>
<td>naive approach</td>
<td>Deconvolution layer + L2 loss，求均值，效果差</td>
<td>non-autoregressive decoder，multi-modality problem 本文重点要解决的问题</td>
</tr>
<tr>
<td>autoregressive</td>
<td>PixelRNN, VQVAE-2，效果好</td>
<td>autoregressive decoder，成熟，缺点是一个个输出效率低</td>
</tr>
<tr>
<td>Generative Adversarial Networks/ non-auto model</td>
<td>效果好</td>
<td>文字应用还不成熟，待研究</td>
</tr>
</tbody>
</table>
<h3 id="vanilla-nat-(non-autoregressive-translation)" tabindex="-1" id="Vanilla-NAT-Non-Autoregressive-Translation">Vanilla NAT (Non-Autoregressive Translation)</h3>
<p><img src="E1.9.png" alt="png"></p>
<h3 id="fertility" tabindex="-1" id="Fertility">Fertility</h3>
<p><img src="E1.10.png" alt="png"></p>
<h3 id="sequence-level-knowledge-distillation" tabindex="-1" id="Sequence-level-knowledge-distillation">Sequence-level knowledge distillation</h3>
<p><img src="E1.11.png" alt="png"></p>
<p><img src="E1.12.png" alt="png"></p>
<h3 id="npd" tabindex="-1" id="NPD">NPD</h3>
<p><img src="E1.13.png" alt="png"></p>
<h3 id="autogressive-model-w%2Fteacher-forcing" tabindex="-1" id="Autogressive-model-w-teacher-forcing">Autogressive model w/teacher forcing</h3>
<p><img src="E1.14.png" alt="png"></p>
<h3 id="evolution-of-nat" tabindex="-1" id="Evolution-of-NAT">Evolution of NAT</h3>
<p><img src="E1.16.png" alt="png"></p>
<h3 id="nat-with-lterative-refinement" tabindex="-1" id="NAT-with-lterative-Refinement">NAT with lterative Refinement</h3>
<p><img src="E1.17.png" alt="png"></p>
<h3 id="mask-predict" tabindex="-1" id="Mask-Predict">Mask-Predict</h3>
<p><img src="E1.18.png" alt="png"></p>
<p><img src="E1.19.png" alt="png"></p>
<h3 id="insertion-transformer" tabindex="-1" id="Insertion-Transformer">Insertion Transformer</h3>
<p><img src="E1.20.png" alt="png"></p>
<p>​    Partially Autoregressive Model，不是纯正的 NAT，该模型会在每两个字之间做预测，是否需要插入新字</p>
<p><img src="E1.21.png" alt="png"></p>
<p><img src="E1.22.png" alt="png"></p>
<h3 id="multiple-target-words-to-predict%3F" tabindex="-1" id="Multiple-target-words-to-predict">Multiple target words to predict?</h3>
<p><img src="E1.23.png" alt="png"></p>
<p><img src="E1.24.png" alt="png"></p>
<h3 id="kermit" tabindex="-1" id="KERMIT">KERMIT</h3>
<p><img src="E1.25.png" alt="png"></p>
<p>这个算法对于 Insertion Transformer 而言是将 encoder 和 Decoder 都合并在一起了</p>
<p><img src="E1.26.png" alt="png"></p>
<p><img src="E1.27.png" alt="png"></p>
<h3 id="levenshtein-transformer" tabindex="-1" id="Levenshtein-Transformer">Levenshtein Transformer</h3>
<p><img src="E1.28.png" alt="png"></p>
<p>​    这个模型是在插入的基础上加入了删除功能，模型如下图所示：</p>
<p><img src="E1.29.png" alt="png"></p>
<p>可以看到输入经过 encoder 之后得到初始的输出要经过三个 Decoder：</p>
<ul>
<li>第一个 Decoder 是一个删除分类器，判断是否需要删除当前单词；</li>
<li>第二个 Decoder 是一个插入分类器，判断是否要在当前单词与单词之间插入单词，如果插入则生成一个占位符【PLH】place holder；</li>
<li>第三个 Decoder 是 token 分类器，根据【PLH】的位置预测对应的单词。</li>
</ul>
<p>​    这个模型训练就是采用上面提到的从另外一个模型学习的方法（knowledge distillation）。具体算法称为：Levenshtein Distance Algorithm</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> Levenshtein<br>Levenshtein.distance(<span class="hljs-string">&quot;ABCEFGHJJ&quot;</span>, <span class="hljs-string">&quot;ABCDEFGHI&quot;</span>)<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">3<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">Levenshtein.editops(<span class="hljs-string">&quot;ABCEFGHJJ&quot;</span>, <span class="hljs-string">&quot;ABCDEFGHI&quot;</span>)<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">[(&#x27;insert&#x27;, 3, 3), (&#x27;delete&#x27;, 7, 8), (&#x27;replace&#x27;, 8, 8)]<br></code></pre></td></tr></table></figure>
<p><img src="E1.30.png" alt="png"></p>
<h3 id="ctc" tabindex="-1" id="CTC">CTC</h3>
<p><img src="E1.31.png" alt="png"></p>
<p>​    CTC 也是 Non-Autoregressive 模型，只不过用在语音识别上；</p>
<p>​    语音识别没有 multi-modality 问题，就是一段语音对应多个结果。（特殊情况当然也有，不过加入 LM 可以解决，例如有人说：城市/程式还不错！）</p>
<h3 id="block-decoding" tabindex="-1" id="Block-Decoding">Block Decoding</h3>
<p><img src="E1.32.png" alt="png"></p>
<p><img src="E1.33.png" alt="png"></p>
<h3 id="knowledge-distillation-in-nat" tabindex="-1" id="Knowledge-Distillation-in-NAT">Knowledge Distillation in NAT</h3>
<p><img src="E1.34.png" alt="png"></p>
<p>​    最后给出来 NAT 对 Autoregressive 模型进行 Knowledge Distillation 后效果提升的研究，语料中原文为英文，译文有 de 德文，es 西班牙文，fr 法文，然后 Autoregressive 模型翻译结果非常清楚，一句话翻译出来是三种目标文字中的一种，不会混乱（下图中第一个图每一个点代表一个句子。），但是 NAT 模型就不行，最后以 Autoregressive 模型为例进行学习后，NAT 可以获得很好的效果。</p>
<h3 id="reference" tabindex="-1" id="Reference">Reference</h3>
<p><img src="E1.35.png" alt="png"></p>
<p><img src="E1.36.png" alt="png"></p>
<h2 id="pointer-network" tabindex="-1" id="Pointer-Network">Pointer Network</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/388279039">李宏毅 pointer network 笔记 - 知乎 (zhihu.com)</a></li>
</ul>
<blockquote>
<p>​    Pointer Network 是[seq2seq 模型](<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=seq2seq">https://www.zhihu.com/search?q=seq2seq</a> 模型&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra={“sourceType”%3A&quot;answer&quot;%2C&quot;sourceId&quot;%3A1187307191})的一个变种。他们不是把一个序列转换成另一个序列, 而是产生一系列指向输入序列元素的指针。最基础的用法是对可变长度序列或集合的元素进行排序。</p>
<p>​    传统的 seq2seq 模型是无法解决<strong>输出序列的词汇表</strong>会随着<strong>输入序列长度的改变</strong>而改变的问题的。在某些任务中，<strong>输入严格依赖于输入</strong>，或者说<strong>输出只能从输入中选择</strong>。例如输入一段话，提取这句话中最关键的几个词语。又或是输入一串数字，输出对这些数字的排序。这时如果使用传统 seq2seq 模型，则忽略了<strong>输入只能从输出中选择</strong>这个<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E5%85%88%E9%AA%8C%E4%BF%A1%E6%81%AF&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A1187307191%7D">先验信息</a>，Pointer Networks 正是为了解决这个问题而提出的。</p>
</blockquote>
<h3 id="pointer-network-1" tabindex="-1" id="Pointer-Network-2">Pointer Network</h3>
<p><img src="E2.1.png" alt="png"></p>
<p>​    pointer network 是一种对 attention 机制的应用。它的输出是输入的子集（相当于输出的是输入序列中部分元素的 copy）</p>
<p>引例：使用 NN 求解一堆散点的凸包，输入是一堆点的坐标，输出是一个序列，每个元素表示选择了第几个输入的点。</p>
<p><img src="E2.2.png" alt="png"></p>
<p>​    首先考虑使用 seq2seq，但是会存在一个问题，因为我们输出的“候选集”的长度应该是 1～输入元素的个数，而输入的点的个数是不确定的，所以这个输出的候选集是变的（也就是每一个输出时间步中，softmax 输出的种类数是变化的）。（注意，这个候选集指的不是序列的长度，序列的长度是构成凸包的点的个数）在 seq2seq 模型中，只有输出序列的长度是变的，而这个 softmax 的类别数是固定的。</p>
<p><img src="E2.3.png" alt="png"></p>
<p>​    解决方法，用 attention 机制对每一个输入元素做 attention，取这个 attention weight 来做 softmax，然后取 argmax 得到当前时间步的输出。为什么这样做 work：因为输出每一步会对输入的所有元素去 attention，这个 attention vector 的维度正好等于输入的个数，所以每个时间步的分类个数就等于输入元素数。</p>
<p>​    用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_0,y_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span> 表示 END，当 argmax 的结果是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_0,y_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span> 时，结束。</p>
<h3 id="applications---summarization" tabindex="-1" id="Applications-Summarization">Applications - Summarization</h3>
<p><img src="E2.4.png" alt="png"></p>
<p>​    其他应用：summary 给一段文章，返回它的简介。</p>
<p>​    之所以加入 pointer network 在这个任务上可以比 seq2seq 更好，一个原因是，文章中一般会出现一些人名地名，而这些东西可能在我们的词汇表里没有。另外，pointer network 可以直接从 input 中挑关键词出来，所以更适合做 summary。</p>
<p>​    上面的方案是传统 seq2seq + pointer network。特点是学出来的一个 weight <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><mi>g</mi><mi>e</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_{gen}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">e</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>，表示 pointer network 和 seq2seq 分布结果的加权，求和之后得到最后的分布。</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1704.04368">1704.04368] Get To The Point: Summarization with Pointer-Generator Networks (arxiv.org)</a></li>
</ul>
<p><img src="E2.5.png" alt="png"></p>
<p>​    其他应用：机器翻译/chat bot，思想就是从输入中直接取一部分（这部分可能不在词汇库中）</p>

            </article>
            
	<div class="rightside">
	
		<div class="rightside-button" id="js-aside">
			<span>
				<img no-lazy src="/images/icon/aside.png" class="rightside-button-icon" alt="Icon">
			</span>
		</div>
		<script>
			$("#js-aside").click(function () {
				onShowAsideButton();
			});
		</script>
	
	<div class="rightside-button" id="js-toggle_theme">
		<span>
			<img no-lazy src="/images/icon/toggle_theme.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	
<script src="/js/plugins/goto_position.js"></script>

	
	<div class="rightside-button" id="js-go_top">
		<span>
			<img no-lazy src="/images/icon/go_top.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>
	<div class="rightside-button" id="js-go_bottom">
		<span>
			<img no-lazy src="/images/icon/go_bottom.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	<script>
		setToggleThemeButtonListener();
	</script>
	<script>
		$('#js-go_top')
		.gotoPosition( {
			speed: 300,
			target: 'top',
		} );
		$('#js-go_bottom')
		.gotoPosition( {
			speed: 300,
			target: 'bottom',
		} );
	</script>
</div>


<div class="post-bottom">
    
        <div class="post-paging">     
            <div class="post-paging-last">
                
                    <a href="/posts/Homework-%E5%BF%AB%E5%86%80%E4%BA%86%E8%AF%A5%E5%86%99%E5%AF%92%E5%81%87%E4%BD%9C%E4%B8%9A%E4%BA%86%E4%B8%8D%E7%84%B6%E5%B0%B1%E5%AF%84%E4%BA%86/">
                        上一篇：Homework-快冀了该写寒假作业了不然就寄了
                    </a>
                
            </div>
            <div class="post-paging-next">
                
                    <a href="/posts/Python-%E4%B8%80%E4%BA%9B%E6%88%91%E5%B8%B8%E7%94%A8%E7%9A%84%E5%B0%8F%E6%93%8D%E4%BD%9C/">
                        下一篇：Python-一些我常用的小操作
                    </a>
                
            </div>
        </div>
    
    
    
        
            <div class="giscus comments"></div>
            <script>
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://giscus.app/client.js';
                scriptElement.setAttribute('data-repo', 'GZ-Metal-Cell/GZ-Metal-Cell.github.io');
                scriptElement.setAttribute('data-repo-id', 'R_kgDOIHLEOQ');
                scriptElement.setAttribute('data-category', 'Announcements');
                scriptElement.setAttribute('data-category-id', 'DIC_kwDOIHLEOc4CcVwP');
                scriptElement.setAttribute('data-mapping', 'title');
                scriptElement.setAttribute('data-strict', '1');
                scriptElement.setAttribute('data-reactions-enabled', '');
                scriptElement.setAttribute('data-emit-metadata', '0');
                scriptElement.setAttribute('data-input-position', 'bottom');
                scriptElement.setAttribute('data-theme', localStorage.getItem('theme') === 'light' ? 'light' : 'dark_high_contrast');
                scriptElement.setAttribute('data-lang', 'zh-CN');
                
                scriptElement.setAttribute('crossorigin', 'anonymous');
                scriptElement.async = true;
                document.head.appendChild(scriptElement);
            </script>
        
    
</div>
        </div>
    </main>
    
        <aside class="main-aside">
    
<script src="/js/widgets/aside.js"></script>

    <script>
        showAside();
    </script>

    <div class="aside-top">
        <div class="aside-top-about aside-card">
            <a href="/about" class="aside-top-about-portrait">
                <img no-lazy src="/about/portrait.png" alt="Q">
            </a>
            <div class="aside-top-about-info">
                <span class="author"> Zi-Zi</span>
                <span class="description">不以物喜，不以己悲。</span>
            </div>              
            <div class="aside-top-about-site">
                <a href="/categories" class="aside-top-about-site-item">
                    <span class="title">类别</span>
                    <span class="count">5</span>
                </a>
                <a href="/tags" class="aside-top-about-site-item">
                    <span class="title">标签</span>
                    <span class="count">122</span>
                </a>
                <a href="/archives" class="aside-top-about-site-item">
                    <span class="title">归档</span>
                    <span class="count">437</span>
                </a>
            </div>
            <div class="aside-top-about-contact">
                
                    
                        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
                            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
                            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
                            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
                            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
                        </a>
                    
                
            </div>
        </div> 

        
            <div class="aside-top-series aside-card">
                <ol class="aside-top-series-content">
                    
                    
                    
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 1-Introduction of Deep Learning/">
                                                <span class="text">ML-李宏毅-Lecture 1-Introduction of Deep Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 2-What to do if my network fails to train/">
                                                <span class="text">ML-李宏毅-Lecture 2-What to do if my network fails to train</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 3-Image as input/">
                                                <span class="text">ML-李宏毅-Lecture 3-Image as input</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 4-Sequence as input/">
                                                <span class="text">ML-李宏毅-Lecture 4-Sequence as input</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        
                                        <li class="series-item active">
                                            <a class="series-link active" href="/posts/ML-李宏毅-Lecture 5-Sequence to sequence/">
                                                <span class="text">ML-李宏毅-Lecture 5-Sequence to sequence</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 6-Generation/">
                                                <span class="text">ML-李宏毅-Lecture 6-Generation</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Recent Advance of Self-supervised learning for NLP/">
                                                <span class="text">ML-李宏毅-Recent Advance of Self-supervised learning for NLP</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 7-Self-supervised learning for Speech and Image/">
                                                <span class="text">ML-李宏毅-Lecture 7-Self-supervised learning for Speech and Image</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 8-Auto-encoder Anomaly Detection/">
                                                <span class="text">ML-李宏毅-Lecture 8-Auto-encoder Anomaly Detection</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 9-Explainable AI/">
                                                <span class="text">ML-李宏毅-Lecture 9-Explainable AI</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 10-Attack/">
                                                <span class="text">ML-李宏毅-Lecture 10-Attack</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-正確認識 ChatGPT/">
                                                <span class="text">ML-李宏毅-正確認識 ChatGPT</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器學習基本概念介紹/">
                                                <span class="text">ML-李宏毅-機器學習基本概念介紹</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器如何生成文句/">
                                                <span class="text">ML-李宏毅-機器如何生成文句</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-【生成式AI】大模型 + 大資料 = 神奇結果？/">
                                                <span class="text">ML-李宏毅-【生成式AI】大模型 + 大資料 = 神奇結果？</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器如何生成圖像/">
                                                <span class="text">ML-李宏毅-機器如何生成圖像</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Pytorch-放一放之前看的一些代码/">
                                                <span class="text">Pytorch-放一放之前看的一些代码</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 11-Adaptation/">
                                                <span class="text">ML-李宏毅-Lecture 11-Adaptation</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 12-Reinforcement Learning/">
                                                <span class="text">ML-李宏毅-Lecture 12-Reinforcement Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 13-Network Compression/">
                                                <span class="text">ML-李宏毅-Lecture 13-Network Compression</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                </ol>
                <div class="aside-top-series-title">
                    <h1>
                        <a href="/tags/李宏毅">标签：李宏毅</a>
                    </h1>
                    <span id="serial-number">5/20</span>
                </div>
            </div>
            <script>
                activeSeriesItem();
            </script> 
        
    </div>

    <div class="aside-bottom">
        
            <script>
                
                    const tocCollapsed = true;
                
                
                    const tocDepth = 6;
                
                var headerString = '';
                for (let i = 1; i <= tocDepth; i++) {
                    if (i === 1) {
                        headerString += 'h1';
                    } else {
                        headerString += ', h' + i;
                    }
                }
                hbeToc();
            </script>
            <div class="aside-bottom-toc aside-card">
                <div class="aside-bottom-toc-title">
                    <h1>目录</h1>
                    <span class="toc-percentage"></span>
                </div>
                <ol class="aside-bottom-toc-content"></ol>
            </div>
        
    </div>
</aside>
    
</div>
		<footer>
	<div class="content">
		
			<span>©2022-2025&nbsp;By&nbsp;<a href="/about">Zi-Zi</a>.</span>
		
		<span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> theme by <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell/hexo-theme-quieter">Quieter</a>.</span>
		
			<span style="display: flex;">
				<img no-lazy alt="icp" src="/images/icp_icon.png" style="width: 16px; height: 16px;">
				<a href="https://icp.gov.moe/?keyword=20241647" target="_blank">萌 ICP 备 20241647 号</a>
			</span>
		
	</div>

	
<script src="/js/plugins/ref.js"></script>

	
<script src="/js/plugins/highlight_tools.js"></script>

	<script>
		const  COPY_ICON = "/images/icon/copy.png";
		const CLOSE_CODE_BLOCK_ICON = "/images/icon/close_code_block.png";
		const HIGHLIGHT_SHRINK = "";
		const HIGHLIGHT_HEIGHT_LIMIT = "";
	</script>

	
	
	<!-- Analytics -->

    
        <!-- Busuanzi Analytics -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?e57cf62289f84322ebff116e8b3d343e";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


	

	
		
			
				<link rel="stylesheet" href="/css/plugins/katex/katex.min.css">
				<script src="/js/plugins/copy-tex.js"></script>
			
		
	

    
		
<link rel="stylesheet" href="/css/plugins/textIndent.css">

		
<script src="/js/plugins/textIndent.js"></script>

	

	
	
	
		<script>
			if (typeof init === 'function') {
				init();
			}
		</script>
	

	
		
	

	

	<!--
		
<script src="/js/plugins/jquery.pjax.min.js"></script>

		<script>
			$(document).pjax('a[target!=_blank]', 'main', {
				fragment: 'main',
				timeout: 8000
			});

			$(document).on('pjax:complete', function() {
			});
		</script> 
	-->
	<script>
		console.log('\n %c Hexo-Quieter 主题 %c https://github.com/GZ-Metal-Cell/hexo-theme-quieter \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
	</script>
</footer>
	</body>

	<!-- Hexo-Quieter 主题  https://github.com/GZ-Metal-Cell/hexo-theme-quieter -->
</html>

