<!DOCTYPE html>
<html lang=zh-CN data-theme="light">
	
<script src="/js/plugins/toggleTheme.js"></script>

	<script>
		setTheme();
	</script>
	<head>
		
<title>GAMES104-Rendering | Zi-Zi's Journey</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/images/icon/favicon.ico">
<link href="/css/plugins/print.css" media="print" rel="stylesheet" />

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="游戏引擎架构,GAMES104,">
<meta name="description" content="王希-GAMES104-现代游戏引擎：从入门到实践。">



<script src="/js/plugins/jquery.min.js"></script>


<script src="/js/plugins/hljs.min.js"></script>


<script src="/js/plugins/init.js"></script>


<script src="/js/plugins/hide.js"></script>


<script src="/js/plugins/tabs.js"></script>



    



    
<script src="/js/plugins/alert-title.js"></script>

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-base.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-dark-class.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-light.css">






    

	<meta name="generator" content="Hexo 6.1.0"></head>

	<body>
		<header class="sticky-header">
	<nav>
		<div class="nav-left">
			<a href="/" class="logo">
				<img no-lazy src="/images/headers_icon/logo.webp" alt="Quieter">
			</a>
			<ul class="breadcrumb" id="breadcrumb"></ul>
		</div>
		<div class="nav-right">
			<ul>
				
					<li>
						<a href="/">
						  主页
						</a>
					</li>
				
					<li>
						<a href="/categories">
						  类别
						</a>
					</li>
				
					<li>
						<a href="/tags">
						  标签
						</a>
					</li>
				
					<li>
						<a href="/archives">
						  归档
						</a>
					</li>
				
					<li>
						<a href="/galleries">
						  相册
						</a>
					</li>
				
					<li>
						<a href="/links">
						  链接
						</a>
					</li>
				
					<li>
						<a href="/about">
						  关于
						</a>
					</li>
								  
			</ul>
		</div>
		<div class="nav-right-close">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
				<path fill="none" d="M0 0h24v24H0z" />
				<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
			</svg>
		</div>

		<div class="sidebar">
    <div class="topo">
        <p>Zi-Zi's Journey</p>
    </div>
    <ul>
        
        <li>
            <a href="/">
                主页
            </a>
        </li>
        
        <li>
            <a href="/categories">
                类别
            </a>
        </li>
        
        <li>
            <a href="/tags">
                标签
            </a>
        </li>
        
        <li>
            <a href="/archives">
                归档
            </a>
        </li>
        
        <li>
            <a href="/galleries">
                相册
            </a>
        </li>
        
        <li>
            <a href="/links">
                链接
            </a>
        </li>
        
        <li>
            <a href="/about">
                关于
            </a>
        </li>
        
    </ul>
    <div class="sidebar-footer">
        
        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
        </a>
        
    </div>
</div>
<div class='shelter'>
    <script>
        $(function() {
            $('.nav-right-close > svg').click(function() {
                $('.sidebar').animate({
                    right: "0"
                }, 500);
                $('.shelter').fadeIn("slow");
            
                var element = $('.topo');
                element.addClass('custom-style');
            
                var links = null;
                if ("") {
                    links = "".split(',');
                } else {
                    links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
                }
            
                var randomLink = links[Math.floor(Math.random() * links.length)];
                element.css('background-image', "url('" + randomLink + "')");
            });
          
            $('.shelter').click(function(e) {
                $('.sidebar').animate({
                    right: "-100%"
                }, 500);
                $('.shelter').fadeOut("slow");
            });
        });      
    </script>
</div>
	</nav>

	
		<div class="header-background"></div>
	

	<script>
		const name = 'post';
		const ul = document.querySelectorAll('.nav-right ul')[0];
		const lis = ul.querySelectorAll('li');

		if (name == 'home') {
			lis[0].classList.add('select');
		} else {
			for (let i = 0; i < lis.length; i++) {
				const li = lis[i];
				const a = li.querySelector('a');
				if (name === a.href.split('/')[3]) {
					li.classList.add('select');
				}
			}
		}
	</script>
	
	<script>
		var element = document.querySelector('.header-background');
		if(element) {
			element.classList.add('custom-style');
			var links = null;
			if("")
			{
				links = "".split(',');
			} else
			{
				links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
			}
			var randomLink = links[Math.floor(Math.random() * links.length)];
			element.style.backgroundImage = "url('" + randomLink + "')";
		}
	</script>

	
<script src="/js/plugins/breadcrumb.js"></script>

	<script>
		var menus_title = [];
		
			menus_title.push({home: '主页'});
		
			menus_title.push({categories: '类别'});
		
			menus_title.push({tags: '标签'});
		
			menus_title.push({archives: '归档'});
		
			menus_title.push({galleries: '相册'});
		
			menus_title.push({links: '链接'});
		
			menus_title.push({about: '关于'});
		
		
			
				postsBreadcrumb(
					document.getElementById('breadcrumb'),
					"类别",
					"/categories",
					"学习",
					"/categories/学习",
					1
				);
			
		
	</script>
</header>

<div class="main-wrapper">
    <main class="post">
        <header class="main-header">
	
		
			
				
<link rel="stylesheet" href="/css/plugins/fancybox.css">

				
<script src="/js/plugins/fancybox.umd.js"></script>

				
<script src="/js/plugins/fancybox.js"></script>

			
			<div class="post-header-background-content">
				<ul class="post-header-tag">
					
						
							<li><a href="/tags/游戏引擎架构"><span>游戏引擎架构</span></a></li>
						
							<li><a href="/tags/GAMES104"><span>GAMES104</span></a></li>
						
					
				</ul>
				
				<h1>GAMES<b><font color="#0FF">104</font></b>-Rendering</h1>
		
				
					<div class="post-header-desc">
						<svg t="1714702231661" class="icon" viewBox="0 0 1024 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="1154" xmlns:xlink="http://www.w3.org/1999/xlink"
						width="20" height="20">
						<path
							d="M778.24 117.76A46.08 46.08 0 0 1 824.32 163.84v430.08c0 8.4992-4.13696 16.01536-10.50624 20.6848l-0.24576 0.2048L587.5712 846.09024a35.84 35.84 0 0 1-61.48096-25.06752v-220.9792a46.08 46.08 0 0 1 46.08-46.08l200.94976-0.02048V168.96h-522.24v686.08H389.12c13.25056 0 24.1664 10.07616 25.47712 22.97856l0.12288 2.62144c0 14.1312-11.4688 25.6-25.6 25.6h-143.36A46.08 46.08 0 0 1 199.68 860.16V163.84A46.08 46.08 0 0 1 245.76 117.76h532.48z m-26.78784 487.38304h-174.16192v178.176l174.16192-178.176z m-45.19936-169.94304a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z m0-122.88a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z"
							fill="#ffffff" p-id="1155"></path>
						</svg>
						<p>王希-GAMES104-现代游戏引擎：从入门到实践。</p>
					</div>
				
		
				<div class="post-header-info">
					<svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
					xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
						<path
							d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
							p-id="2902" fill="#ffffff"></path>
					</svg>
					<div class="post-header-info-author">
						<a href="/about">Zi-Zi</a>
					</div>
					
						<div class="post-header-info-categories">
							
								<a href="/categories/学习">学习</a>
							
						</div>
					
					<time>2024/05/21 09:20:00</time>
				</div>
		
				
					<div class="post-header-stat">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
						viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve" width="20" height="20">
							<path fill="#FFFFFF" d="M187.2,165.6c0,2.6-2.1,4.7-4.7,4.7H17.5c-2.6,0-4.7-2.1-4.7-4.7s2.1-4.7,4.7-4.7h165.1
								C185.2,160.9,187.2,163,187.2,165.6z"/>
							<path fill="#FFFFFF" d="M17.5,29.7c2.6,0,4.7,2.1,4.7,4.7v131.2c0,2.6-2.1,4.7-4.7,4.7s-4.7-2.1-4.7-4.7V34.4
								C12.8,31.8,14.9,29.7,17.5,29.7z M77.9,91.5c1.8,1.8,1.8,4.8,0,6.6l-39.8,39.8c-1.9,1.8-4.9,1.7-6.6-0.2c-1.7-1.8-1.7-4.6,0-6.4
								l39.8-39.8C73.1,89.6,76,89.6,77.9,91.5z M169.9,70.2c1.6,2.1,1.1,5-0.9,6.5c0,0,0,0,0,0l-64.2,48.2c-2.1,1.5-5,1.1-6.6-0.9
								c-1.6-2.1-1.1-5,0.9-6.5c0,0,0,0,0,0l64.2-48.2C165.4,67.7,168.3,68.1,169.9,70.2L169.9,70.2z"/>
							<path fill="#FFFFFF" d="M104.6,124.5c-1.8,1.8-4.8,1.8-6.6,0L71.6,98.1c-1.8-1.8-1.8-4.8,0-6.6c1.8-1.8,4.8-1.8,6.6,0l26.3,26.3
								C106.4,119.6,106.4,122.6,104.6,124.5C104.6,124.4,104.6,124.4,104.6,124.5z"/>
						</svg>
		
						
							
<script src="/js/plugins/wordCount.js"></script>

							<p class="post-count">文字数：---</p>
						
		
						
							<p id="busuanzi_container_page_pv" style='display:none;'>阅读数：<span id="busuanzi_value_page_pv"></span></p>
						
					</div>
				
			</div>
		
	
</header>
        <div class="post-content article-container">
            <article class="post-content-info">
                <h1 id="%E8%B5%84%E6%BA%90" tabindex="-1">资源</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1oU4y1R7Km/">GAMES104-现代游戏引擎：从入门到实践_哔哩哔哩_bilibili</a></li>
<li><a target="_blank" rel="noopener" href="https://games104.boomingtech.com/sc/">GAMES104 - 现代游戏引擎入门必修课 (boomingtech.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.piccoloengine.com/topics/node/feed/all">Piccolo 社区 - 游戏引擎爱好者的新家园 (piccoloengine.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/BoomingTech/Piccolo">BoomingTech/Piccolo: Piccolo (formerly Pilot) – mini game engine for games104 (github.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/597024196">GAMES104：现代游戏引擎，从理论到实践 - 知乎 (zhihu.com)</a></li>
</ul>
<h1 id="%E8%AF%BE%E7%A8%8B" tabindex="-1">课程</h1>
<h2 id="%E7%AC%AC%E5%9B%9B%E8%8A%82%EF%BC%9A%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E4%B8%AD%E7%9A%84%E6%B8%B2%E6%9F%93%E5%AE%9E%E8%B7%B5" tabindex="-1" id="第四节：游戏引擎中的渲染实践">第四节：游戏引擎中的渲染实践</h2>
<h3 id="rendering-on-game-engine" tabindex="-1" id="Rendering-on-Game-Engine">Rendering on Game Engine</h3>
<h4 id="rendering-system-in-games" tabindex="-1" id="Rendering-System-in-Games">Rendering System in Games</h4>
<p><img src="4.1.webp" alt="webp"></p>
<p>​	游戏渲染发展历程。</p>
<p>Q: Is there any game without rendering?</p>
<p>​	有。比如文字游戏。</p>
<h4 id="rendering-on-graphics-theory" tabindex="-1" id="Rendering-on-Graphics-Theory">Rendering on Graphics Theory</h4>
<ul>
<li>
<p>Objects with one type of effect</p>
<p>具有一种效果的对象</p>
</li>
<li>
<p>Focus on representation and math correctness</p>
<p>注重表示和数学正确性</p>
</li>
<li>
<p>No strict performance requirement</p>
<p>无严格的性能要求</p>
<ul>
<li>
<p>Realtime (30 FPS) / interactive (10 FPS)</p>
<p>实时 (30 FPS) / 交互式 (10 FPS)</p>
<p>对于游戏来说，应保证游戏画面流畅</p>
</li>
<li>
<p>offline rendering</p>
<p>离线渲染（无法实时渲染，如电影，海报等，画质好）</p>
</li>
<li>
<p>Out-of-core rendering</p>
<p>核外渲染</p>
</li>
</ul>
</li>
</ul>
<h4 id="challenges-on-game-rendering-(1%2F4)" tabindex="-1" id="Challenges-on-Game-Rendering-1-4">Challenges on Game Rendering (1/4)</h4>
<p><img src="4.2.webp" alt="webp"></p>
<p>Tens of thousands of objects with dozens type of effects</p>
<p>​	数万个物体，数十种效果。容易跑不动。</p>
<h4 id="challenges-on-game-rendering-(2%2F4)" tabindex="-1" id="Challenges-on-Game-Rendering-2-4">Challenges on Game Rendering (2/4)</h4>
<p><img src="4.3.webp" alt="webp"></p>
<p>Deal with architecture of modern computer with a complex combination of CPU and GPU</p>
<p>​	处理具有 CPU 和 GPU 复杂组合的现代计算机体系结构。（设计游戏引擎时，要考虑 CPU 和 GPU 的架构来写代码）</p>
<h4 id="challenges-on-game-rendering-(3%2F4)" tabindex="-1" id="Challenges-on-Game-Rendering-3-4">Challenges on Game Rendering (3/4)</h4>
<p><img src="4.4.webp" alt="webp"></p>
<p>Commit a bullet-proof framerate</p>
<p>​	保证帧率</p>
<ul>
<li>
<p>30 FPS (60 FPS,120 FPS + VR)</p>
</li>
<li>
<p>1080P, 4K and 8K resolution</p>
</li>
</ul>
<p>​	现在对游戏的分辨率和帧率要求越来越高了。</p>
<h4 id="challenges-on-game-rendering-(4%2F4)" tabindex="-1" id="Challenges-on-Game-Rendering-4-4">Challenges on Game Rendering (4/4)</h4>
<ul>
<li>
<p>Limit access to CPU bandwidthand memory footprint</p>
<p>限制对 CPU 带宽和内存占用的访问</p>
</li>
<li>
<p>Game logic, network, animation, physics and Al systems are major consumers of CPU and main memory</p>
<p>游戏逻辑、网络、动画、物理和人工智能系统是 CPU 和主存的主要消耗者</p>
</li>
</ul>
<h4 id="rendering-on-game-engine-1" tabindex="-1" id="Rendering-on-Game-Engine-2">Rendering on Game Engine</h4>
<p>A heavily optimized practical software framework to fulfill the critical rendering requirements of games on modern hardware (PC, console and mobiles)</p>
<p>​	高度优化的实用软件框架，可满足现代硬件（PC、游戏机和移动设备）上游戏的关键渲染要求</p>
<h4 id="outline-of-rendering" tabindex="-1" id="Outline-of-Rendering">Outline of Rendering</h4>
<p>​	本课程主要介绍的渲染技术，仅是蜻蜓点水，这玩意太复杂了。</p>
<ol>
<li>
<p>Basics of Game Rendering</p>
<p>游戏渲染基础知识</p>
<ul>
<li>
<p>Hardware architecture</p>
<p>硬件架构</p>
</li>
<li>
<p>Render data organization</p>
<p>渲染数据组织</p>
</li>
<li>
<p>Visibility</p>
<p>能见度</p>
</li>
</ul>
</li>
<li>
<p>Materials, Shaders and Lighting</p>
<p>材质、着色器和光照</p>
<ul>
<li>
<p>PBR (SG, MR)</p>
<p>PBR（SG、MR）</p>
</li>
<li>
<p>Shader permutation</p>
<p>着色器排列</p>
</li>
<li>
<p>Lighting</p>
<p>灯光</p>
<ul>
<li>
<p>Point / Directional lighting</p>
<p>点/定向照明</p>
</li>
<li>
<p>IBL / Simple GI</p>
<p>IBL / 简单 GI</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Special Renering</p>
<p>特殊渲染</p>
<ul>
<li>
<p>Terrain</p>
<p>地形</p>
</li>
<li>
<p>Sky / Fog</p>
<p>天空/雾</p>
</li>
<li>
<p>Postprocess</p>
<p>后期处理</p>
</li>
</ul>
</li>
<li>
<p>Pipeline</p>
<p>管道</p>
<ul>
<li>
<p>Forward, deferred rendering, forward plus</p>
<p>前向、延迟渲染、前向加号</p>
</li>
<li>
<p>Real pipeline with mixed effects</p>
<p>具有混合效果的真实管道</p>
</li>
<li>
<p>Ring buffer and V-Sync</p>
<p>环形缓冲区和垂直同步</p>
</li>
<li>
<p>Tiled-based rendering</p>
<p>基于平铺的渲染</p>
</li>
</ul>
</li>
</ol>
<h4 id="what-is-not-included" tabindex="-1" id="What-Is-Not-Included">What Is Not Included</h4>
<ul>
<li>
<p>Cartoon Rendering</p>
<p>卡通渲染（非真实渲染）</p>
</li>
<li>
<p>2D Rendering Engine</p>
<p>二维渲染引擎（三渲二）</p>
</li>
<li>
<p>Subsurface</p>
<p>皮肤</p>
</li>
<li>
<p>Hair /Fur</p>
<p>头发 / 皮毛</p>
</li>
</ul>
<h3 id="building-blocks-of-rendering" tabindex="-1" id="Building-Blocks-of-Rendering">Building Blocks of Rendering</h3>
<p>​	渲染的构建块</p>
<h4 id="rendering-pipeline-and-data" tabindex="-1" id="Rendering-Pipeline-and-Data">Rendering Pipeline and Data</h4>
<p>​	渲染管道及数据</p>
<p><img src="4.5.webp" alt="webp"></p>
<p>​	图像的渲染过程。从 GAMES101 里搬来的图。</p>
<p>Tens of millions of pixels with hundreds ALU and dozen of texture samplings.</p>
<p>​	数千万像素，数百个 ALU 和数十个纹理采样。</p>
<h4 id="computation---projection-and-rasterization" tabindex="-1" id="Computation-Projection-and-Rasterization">Computation - Projection and Rasterization</h4>
<p>​	计算-投影和光栅化</p>
<p><img src="4.6.webp" alt="webp"></p>
<h4 id="computation---shading" tabindex="-1" id="Computation-Shading">Computation - Shading</h4>
<p>​	计算-着色</p>
<p>​	写的 Shader 在显卡中存储/计算。</p>
<p><img src="4.7.webp" alt="webp"></p>
<p>A shader sample code</p>
<p>​	着色器示例代码</p>
<ul>
<li>
<p>Constants /Parameters</p>
<p>常量/参数</p>
</li>
<li>
<p>ALU algorithms</p>
<p>ALU 算法</p>
</li>
<li>
<p>Texture Sampling</p>
<p>纹理采样</p>
</li>
<li>
<p>Branches</p>
<p>分支</p>
</li>
</ul>
<h4 id="computation--texture-sampling" tabindex="-1" id="Computation-Texture-Sampling">Computation -Texture Sampling</h4>
<p>​	计算-纹理采样</p>
<p><img src="4.8.webp" alt="webp"></p>
<ul>
<li>
<p>Step1</p>
<p>Use two nearest mipmap levels</p>
<p>使用两个最近的 mipmap 级别</p>
</li>
<li>
<p>Step2</p>
<p>Perform bilinear interpolation in both mip-maps</p>
<p>在两个 mip-map 中执行双线性插值</p>
</li>
<li>
<p>Step3</p>
<p>Linearly interpolate betweenthe results</p>
<p>在结果之间进行线性插值</p>
</li>
</ul>
<h4 id="understanding-the-hardware" tabindex="-1" id="Understanding-the-Hardware">Understanding the Hardware</h4>
<p>​	即使是游戏开发者/技术美术工作人员，了解一下显卡的基本架构也是很有用的。</p>
<p><strong>GPU</strong></p>
<p>The dedicated hardware to solve massive jobs</p>
<p>​	解决大量工作的专用硬件</p>
<h4 id="simd-and-simt" tabindex="-1" id="SIMD-and-SIMT">SIMD and SIMT</h4>
<p><img src="4.9.webp" alt="webp"></p>
<p><strong>SlMD</strong> (Single Instruction Multiple Data 单指令多数据)</p>
<ul>
<li>
<p>Describes computers with multiple processing elements that perform the same operation on multiple data points simultaneously</p>
<p>描述具有多个处理元件的计算机，这些元件同时对多个数据点执行相同的操作</p>
</li>
</ul>
<p><img src="4.10.webp" alt="webp"></p>
<p><strong>SlMT</strong> (Single Instruction Multiple Threads 单指令多线程)</p>
<ul>
<li>
<p>An execution model used in parallel computing where single instruction, multiple data (SlMD) is combined with multithreading</p>
<p>并行计算中使用的执行模型，其中单指令、多数据 (SlMD) 与多线程相结合</p>
</li>
</ul>
<h4 id="gpu-architecture" tabindex="-1" id="GPU-Architecture">GPU Architecture</h4>
<p><img src="4.11.webp" alt="webp"></p>
<p><strong>GPC</strong> (Graphics Processing Cluster 图形处理集群)</p>
<p>A dedicated hardware block for computing, rasterization, shadingand texturing</p>
<p>​	用于计算、光栅化、着色和纹理的专用硬件块</p>
<p><strong>SM</strong> (Streaming Multiprocessor 流式多处理器)</p>
<p>Part of the GPU that runs CUDA kernels</p>
<p>​	运行 CUDA 内核的 GPU 的一部分</p>
<p><strong>Texture Units</strong> 纹理单位</p>
<p>A texture processing unit, that can fetch and filter a texture</p>
<p>​	纹理处理单元，可以获取和过滤纹理</p>
<p><strong>CUDA Core</strong></p>
<p>Parallel processor that allow data to be workedon simultaneously by different processors</p>
<p>​	并行处理器允许不同处理器同时处理数据</p>
<p><strong>Warp</strong></p>
<p>A collection of threads</p>
<p>​	线程的集合</p>
<h4 id="data-flow-from-cpu-to-gpu" tabindex="-1" id="Data-Flow-from-CPU-to-GPU">Data Flow from CPU to GPU</h4>
<p><img src="4.12.webp" alt="webp"></p>
<ul>
<li>
<p>CPU and Main Memory</p>
<p>CPU 和主内存</p>
<ul>
<li>
<p>Data Load / Unload</p>
<p>数据加载/卸载</p>
</li>
<li>
<p>Data Preparation</p>
<p>数据准备</p>
</li>
</ul>
</li>
<li>
<p>CPU to GPU</p>
<ul>
<li>
<p>High Latency</p>
<p>高延迟</p>
</li>
<li>
<p>Limited Bandwidth</p>
<p>带宽有限</p>
</li>
</ul>
</li>
<li>
<p>GPU and Video Memory</p>
<p>GPU 和视频内存</p>
<ul>
<li>
<p>High Performance Parallel Rendering</p>
<p>高性能并行渲染</p>
</li>
</ul>
</li>
</ul>
<p>Always minimize data transfer between CPU and GPU when possible</p>
<p>​	尽可能减少 CPU 和 GPU 之间的数据传输</p>
<h4 id="be-aware-of-cache-efficiency" tabindex="-1" id="Be-Aware-of-Cache-Efficiency">Be Aware of Cache Efficiency</h4>
<p><img src="4.13.webp" alt="webp"></p>
<p>​	Cache 比内存更快，尽量少做内存交换。</p>
<p><img src="4.14.webp" alt="webp"></p>
<ul>
<li>
<p>Take full advantage of hardware parallel computing</p>
<p>充分利用硬件并行计算</p>
</li>
<li>
<p>Try to avoid the von Neumann bottleneck</p>
<p>尽量避免冯诺依曼瓶颈</p>
</li>
</ul>
<h4 id="gpu-bounds-and-performance" tabindex="-1" id="GPU-Bounds-and-Performance">GPU Bounds and Performance</h4>
<p>​	GPU 限制和性能</p>
<p>Application performance is limited by:</p>
<p>​	应用程序性能受到以下因素的限制：</p>
<ul>
<li>
<p>Memory Bounds</p>
<p>内存限制</p>
</li>
<li>
<p>ALU Bounds</p>
<p>ALU 边界</p>
</li>
<li>
<p>TMU (Texture Mapping Unit) Bound</p>
<p>TMU（纹理映射单元）绑定</p>
</li>
<li>
<p>BW (Bandwidth) Bound</p>
<p>BW（带宽）限制</p>
</li>
</ul>
<h4 id="modern-hardware-pipeline" tabindex="-1" id="Modern-Hardware-Pipeline">Modern Hardware Pipeline</h4>
<p><img src="4.15.webp" alt="webp"></p>
<ul>
<li>
<p>Direct3D 12graphics pipeline</p>
<p>Direct3D 12 图形管道</p>
</li>
<li>
<p>Mesh and amplification shaders</p>
<p>网格和放大着色器</p>
</li>
<li>
<p>Direct3D 12 compute pipeline</p>
<p>Direct3D 12 计算管道</p>
</li>
</ul>
<h4 id="other-state-of-art-architectures" tabindex="-1" id="Other-State-of-Art-Architectures">Other State-of-Art Architectures</h4>
<p>​	其他最先进的架构</p>
<p><img src="4.16.webp" alt="webp"></p>
<p><strong>GPU:</strong></p>
<p>1.825 GHZ, 52CUS, 12 TFLOPS FP32,332 8streaming processors</p>
<p><strong>DRAM:</strong></p>
<p>16 GB GDDR6, 10GB high memory interleave + 6GB low memory interleave</p>
<p>20 channels of x16 GDDR6 @ 14 Gbps-&gt;560GB</p>
<p><strong>CPU:</strong></p>
<p>8x Zen2 CPU cores @ 3.8 GHz, 3.6 GHz W/SMT 32KB L1 I<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo separator="true">,</mo><mn>3</mn><mn>2</mn><mi>K</mi><mi>B</mi><mi>L</mi><mn>1</mn><mi>D</mi></mrow><annotation encoding="application/x-tex">,32KB L1 D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mpunct">,</span><span class="mord mathrm">3</span><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">L</span><span class="mord mathrm">1</span><span class="mord mathit" style="margin-right:0.02778em;">D</span></span></span></span>,512KB L2 per CPU core</p>
<p><img src="4.17.webp" alt="webp"></p>
<h3 id="renderable" tabindex="-1" id="Renderable">Renderable</h3>
<h4 id="mesh-render-component" tabindex="-1" id="Mesh-Render-Component">Mesh Render Component</h4>
<ul>
<li>
<p>Everything is a game object in the game world</p>
<p>游戏世界中的一切都是游戏对象</p>
</li>
<li>
<p>Game object could be described in the component-based way</p>
<p>游戏对象可以用<strong>基于组件</strong>的方式描述</p>
</li>
</ul>
<h4 id="building-blocks-of-renderable" tabindex="-1" id="Building-Blocks-of-Renderable">Building Blocks of Renderable</h4>
<p>​	可渲染的构建块</p>
<p><img src="4.18.webp" alt="webp"></p>
<h4 id="mesh-primitive" tabindex="-1" id="Mesh-Primitive">Mesh Primitive</h4>
<p>​	网格基元</p>
<p><img src="4.19.webp" alt="webp"></p>
<h4 id="vertex-and-index-buffer" tabindex="-1" id="Vertex-and-Index-Buffer">Vertex and Index Buffer</h4>
<p>​	顶点和索引缓冲区</p>
<p><img src="4.20.webp" alt="webp"></p>
<ul>
<li>
<p>Vertex Data</p>
<p>顶点数据</p>
<ul>
<li>
<p>Vertex declaration</p>
<p>顶点声明</p>
</li>
<li>
<p>Vertex buffer</p>
<p>顶点缓冲区</p>
</li>
</ul>
</li>
<li>
<p>Index Data</p>
<p>索引数据</p>
<ul>
<li>
<p>Index declaration</p>
<p>索引声明</p>
</li>
<li>
<p>Index buffer</p>
<p>索引缓冲区</p>
</li>
</ul>
</li>
</ul>
<h4 id="why-we-need-per-vertex-normal" tabindex="-1" id="Why-We-Need-Per-Vertex-Normal">Why We Need Per-Vertex Normal</h4>
<p><img src="4.21.webp" alt="webp"></p>
<p>​	为什么我们需要顶点法线？如果根据面法线计算的话，对于转角处，顶点法线方向可能会有歧义。</p>
<h4 id="materials" tabindex="-1" id="Materials">Materials</h4>
<p><img src="4.22.webp" alt="webp"></p>
<p>Determine the appearance of objects, and how objects interact with light</p>
<p>​	确定物体的外观以及物体如何与光相互作用</p>
<h4 id="famous-material-models" tabindex="-1" id="Famous-Material-Models">Famous Material Models</h4>
<p><img src="4.23.webp" alt="webp"></p>
<p>Phong Model</p>
<p>PBR Model - Physically based rendering 基于物理的渲染</p>
<p>Subsurface Material - Burley SubSurface Profile 渲染皮肤</p>
<h4 id="various-texures-in-materials" tabindex="-1" id="Various-Texures-in-Materials">Various Texures in Materials</h4>
<p><img src="4.24.webp" alt="webp"></p>
<h4 id="variety-of-shaders" tabindex="-1" id="Variety-of-Shaders">Variety of Shaders</h4>
<p><img src="4.25.webp" alt="webp"></p>
<h3 id="render-objects-in-engine" tabindex="-1" id="Render-Objects-in-Engine">Render Objects in Engine</h3>
<h4 id="coordinate-system-and-transformation" tabindex="-1" id="Coordinate-System-and-Transformation">Coordinate System and Transformation</h4>
<p>​	坐标系和变换</p>
<p><img src="4.26.webp" alt="webp"></p>
<p>Model assets are made based on local coordinate systems, and eventually we need to render them into screen space</p>
<p>​	模型资源是基于局部坐标系制作的，最终我们需要将它们渲染到屏幕空间中</p>
<h4 id="object-with-many-materials" tabindex="-1" id="Object-with-Many-Materials">Object with Many Materials</h4>
<p><img src="4.27.webp" alt="webp"></p>
<p>​	如果一个对象仅使用一个材质，渲染出的效果可能不够真实。</p>
<h4 id="how-to-display-different-textures-on-a-single-model" tabindex="-1" id="How-to-Display-Different-Textures-on-a-Single-Model">How to Display Different Textures on a Single Model</h4>
<p><img src="4.28.webp" alt="webp"></p>
<p>​	将 Object 模型分为多个 Submesh，每个 Submesh 使用不同的 Material。</p>
<p><img src="4.29.webp" alt="webp"></p>
<p>​	如果每个 Submesh 都占据显存的空间，会导致浪费。</p>
<h4 id="resource-pool" tabindex="-1" id="Resource-Pool">Resource Pool</h4>
<p><img src="4.30.webp" alt="webp"></p>
<p>​	使用一个资源池，加强资源的复用。</p>
<h4 id="instance%3A-use-handle-to-reuse-resources" tabindex="-1" id="Instance-Use-Handle-to-Reuse-Resources">Instance: Use Handle to Reuse Resources</h4>
<p>​	实例：使用句柄重用资源</p>
<p><img src="4.31.webp" alt="webp"></p>
<h4 id="sort-by-material" tabindex="-1" id="Sort-by-Material">Sort by Material</h4>
<p><img src="4.32.webp" alt="webp"></p>
<h4 id="gpu-batch-rendering" tabindex="-1" id="GPU-Batch-Rendering">GPU Batch Rendering</h4>
<p><img src="4.33.webp" alt="webp"></p>
<blockquote>
<p>​	GPU Batch Rendering 是一种图形渲染技术，它利用计算机的 GPU（Graphics Processing Unit）来加速图形渲染过程。在传统的图形渲染中，每个物体都需要单独渲染，这会导致大量的数据传输和渲染时的负载，降低了渲染效率。</p>
<p>​	而 GPU Batch Rendering 则可以将多个物体合并成一个批次（Batch），同时进行渲染。这种方式可以减少数据传输，提高渲染效率，特别是在大规模场景和复杂模型的情况下，可以极大地提高渲染速度。</p>
</blockquote>
<p>Q: What if group rendering all instances with identical submeshes and materials together?</p>
<p>​	问：如果将具有相同子网格和材质的所有实例分组渲染在一起会怎样？</p>
<h3 id="visibility-culling" tabindex="-1" id="Visibility-Culling">Visibility Culling</h3>
<p>​	可见性剔除</p>
<h4 id="culling-one-object" tabindex="-1" id="Culling-One-Object">Culling One Object</h4>
<p><img src="4.34.webp" alt="webp"></p>
<p>View Frustum</p>
<p>​	观察片元</p>
<p>Solider Bounding Box</p>
<p>​	士兵边界框</p>
<h4 id="using-the-simplest-bound-to-create-culling" tabindex="-1" id="Using-the-Simplest-Bound-to-Create-Culling">Using the Simplest Bound to Create Culling</h4>
<p>​	使用最简单的绑定来创建剔除</p>
<p><img src="4.35.webp" alt="webp"></p>
<ul>
<li>
<p>Inexpensive intersection tests</p>
<p>廉价的交叉测试</p>
</li>
<li>
<p>Tight fitting</p>
<p>紧身</p>
</li>
<li>
<p>Inexpensive to compute</p>
<p>计算成本低廉</p>
</li>
<li>
<p>Easy to rotate and transform</p>
<p>易于旋转和变换</p>
</li>
<li>
<p>Use little memory</p>
<p>使用很少的内存</p>
</li>
</ul>
<h4 id="hierarchical-view-frustum-culling" tabindex="-1" id="Hierarchical-View-Frustum-Culling">Hierarchical View Frustum Culling</h4>
<p><img src="4.36.webp" alt="webp"></p>
<p>​	使用 Quad Tree Culling 和 BVH 等，排除不可见对象</p>
<h4 id="construction-and-insertion-of-bvh-in-game-engine" tabindex="-1" id="Construction-and-insertion-of-BVH-in-Game-Engine">Construction and insertion of BVH in Game Engine</h4>
<p>​	游戏引擎中 BVH 的构建和插入</p>
<p><img src="4.37.webp" alt="webp"></p>
<h4 id="pvs-(potential-visibility-set)" tabindex="-1" id="PVS-Potential-Visibility-Set">PVS (Potential Visibility Set)</h4>
<p>​	PVS（潜在可见性集）</p>
<p><img src="4.38.webp" alt="webp"></p>
<blockquote>
<p>​	PVS（Potentially Visible Set）是一种基于空间划分的可视性剔除算法，用于在三维场景中快速确定观察点能够看到哪些物体。</p>
<p>​	PVS 算法的基本思想是将场景分割成多个相邻的小区域（如八叉树等），然后对每个小区域计算其与其他小区域的可见性关系，即确定一个小区域可以直接看到哪些相邻的小区域，这些可见的小区域组成了该小区域的 PVS 集合。</p>
<p>​	当观察点移动时，只需要判断当前观察点所处的小区域的 PVS 集合中是否包含其他小区域，从而确定哪些物体需要被渲染。这种方法可以大大减少需要渲染的物体数量，提高渲染效率。</p>
<p>​	PVS 算法还可以通过优化 PVS 集合的计算和存储方式，以及合并相邻小区域的 PVS 集合等手段进一步提高效率。但是，由于 PVS 算法依赖于场景的空间划分，因此对于具有复杂几何形状或存在大量遮挡物的场景，该算法可能会带来较大的计算负担。</p>
</blockquote>
<h4 id="portal-and-pvs-data" tabindex="-1" id="Portal-and-PVS-Data">Portal and PVS Data</h4>
<p><img src="4.39.webp" alt="webp"></p>
<p>Determine potentially visible leaf nodes immediately from portal</p>
<p>​	立即从门户确定潜在可见的叶节点</p>
<h4 id="the-ldea-of-using-pvs-in-stand-alone-games" tabindex="-1" id="The-ldea-of-Using-PVS-in-Stand-alone-Games">The ldea of Using PVS in Stand-alone Games</h4>
<p>​	单机游戏中 PVS 的使用思路</p>
<p><img src="4.40.webp" alt="webp"></p>
<p><strong>Green box:</strong></p>
<p>The area to determine the potential visibility where you need</p>
<p>​	确定您需要的潜在可见度的区域</p>
<p><strong>Blue cells:</strong></p>
<p>Auto generated smaller regions of each green box.</p>
<p>​	自动生成每个绿色框的较小区域。</p>
<p>**Pros **优点</p>
<ul>
<li>
<p>Much faster than BSP/Octree</p>
<p>比 BSP/八叉树快得多</p>
</li>
<li>
<p>More flexible and compatible</p>
<p>更灵活、更兼容</p>
</li>
<li>
<p>Preload resources by PVS</p>
<p>通过 PVS 预加载资源</p>
</li>
</ul>
<h4 id="gpu-culling" tabindex="-1" id="GPU-Culling">GPU Culling</h4>
<p><img src="4.41.webp" alt="webp"></p>
<p>​	先不渲染材质，根据深度信息排除掉不可见部分后再渲染。</p>
<h3 id="texture-compression" tabindex="-1" id="Texture-Compression">Texture Compression</h3>
<p>​	纹理压缩</p>
<p>A must-know for game engine</p>
<p>​	游戏引擎必须了解的知识</p>
<h4 id="texture-compression-1" tabindex="-1" id="Texture-Compression-2">Texture Compression</h4>
<p><img src="4.42.webp" alt="webp"></p>
<ul>
<li>
<p>Traditional image compression like JPG and PNG</p>
<p>传统图像压缩，如 JPG 和 PNG</p>
<ul>
<li>
<p>Good compression rates</p>
<p>良好的压缩率</p>
</li>
<li>
<p>lmage quality</p>
<p>图像质量</p>
</li>
<li>
<p>Designed to compress or decompress an entire image</p>
<p>设计用于压缩或解压缩整个图像</p>
</li>
</ul>
</li>
<li>
<p>In game texture compression</p>
<p>游戏中的纹理压缩</p>
<ul>
<li>
<p>Decoding speed</p>
<p>解码速度</p>
</li>
<li>
<p>Random access</p>
<p>随机访问（传统图像压缩无法做到随机访问，即快速获取某个坐标的颜色值）</p>
</li>
<li>
<p>Compression rate and visual quality</p>
<p>压缩率和视觉质量</p>
</li>
<li>
<p>Encoding speed</p>
<p>编码速度</p>
</li>
</ul>
</li>
</ul>
<h4 id="block-compression" tabindex="-1" id="Block-Compression">Block Compression</h4>
<p><img src="4.43.webp" alt="webp"></p>
<p>Common block-based compression format</p>
<p>​	常见的基于块的压缩格式</p>
<ul>
<li>
<p>On PC, BC7 (modern) or DXTC (old) formats</p>
<p>在 PC 上，BC7（现代）或 DXTC（旧）格式</p>
</li>
<li>
<p>On mobile, ASTC (modern) or ETC / PVRTC (old) formats</p>
<p>在移动设备上，ASTC（现代）或 ETC / PVRTC（旧）格式</p>
</li>
</ul>
<h3 id="authoring-tools-of-modeling" tabindex="-1" id="Authoring-Tools-of-Modeling">Authoring Tools of Modeling</h3>
<p>​	建模创作工具</p>
<h4 id="modeling---polymodeling" tabindex="-1" id="Modeling-Polymodeling">Modeling - Polymodeling</h4>
<p><img src="4.44.webp" alt="webp"></p>
<p>​	使用基于多边形建模的软件。</p>
<h4 id="modeling---sculpting" tabindex="-1" id="Modeling-Sculpting">Modeling - Sculpting</h4>
<p><img src="4.45.webp" alt="webp"></p>
<p>​	ZBrush 提供了一种新的建模概念——雕刻。</p>
<h4 id="modeling--scanning" tabindex="-1" id="Modeling-Scanning">Modeling -Scanning</h4>
<p><img src="4.46.webp" alt="webp"></p>
<p>​	使用扫描仪建模。</p>
<h4 id="modeling---procedural-modeling" tabindex="-1" id="Modeling-Procedural-Modeling">Modeling - Procedural Modeling</h4>
<p><img src="4.47.webp" alt="webp"></p>
<p>​	程序化建模：</p>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/626037013">houdini 到底是什么？- 知乎 (zhihu.com)</a></p>
</li>
<li>
<p>Unreal</p>
</li>
</ul>
<h4 id="comparison-of-authoring-methods" tabindex="-1" id="Comparison-of-Authoring-Methods">Comparison of Authoring Methods</h4>
<p>​	创作方法比较</p>
<table>
<thead>
<tr>
<th></th>
<th>Polymodeling</th>
<th>Sculpting</th>
<th>Scanning</th>
<th>Procedural modeling</th>
</tr>
</thead>
<tbody>
<tr>
<td>Advantage</td>
<td>Flexible</td>
<td>Creative</td>
<td>Realistic</td>
<td>Intelligent</td>
</tr>
<tr>
<td>Disadvantage</td>
<td>Heavy workload</td>
<td>Large volume of data</td>
<td>Large volume of data</td>
<td>Hard to achieve</td>
</tr>
</tbody>
</table>
<h3 id="cluster-based-mesh-pipeline" tabindex="-1" id="Cluster-Based-Mesh-Pipeline">Cluster-Based Mesh Pipeline</h3>
<p>​	基于集群的网格管道</p>
<h4 id="sculpting-tools-create-infinite-details" tabindex="-1" id="Sculpting-Tools-Create-Infinite-Details">Sculpting Tools Create Infinite Details</h4>
<p><img src="4.48.webp" alt="webp"></p>
<p>​	雕刻工具创造无限细节</p>
<ul>
<li>
<p>Artists create models with infinite details</p>
<p>艺术家创造具有无限细节的模型</p>
</li>
<li>
<p>From linear fps to open world fps, complex scene submit 10more times triangles to GPU per-frame</p>
<p>从线性 fps 到开放世界 fps，复杂场景每帧向 GPU 提交 10 倍以上的三角形</p>
</li>
</ul>
<h4 id="cluster-based-mesh-pipeline-1" tabindex="-1" id="Cluster-Based-Mesh-Pipeline-2">Cluster-Based Mesh Pipeline</h4>
<p>​	基于集群的网格管道</p>
<p><img src="4.49.webp" alt="webp"></p>
<p><strong>GPU-Driven Rendering Pipeline (2015)</strong> GPU 驱动的渲染管道 (2015)</p>
<ul>
<li>
<p>Mesh Cluster Rendering</p>
<p>网格簇渲染</p>
<ul>
<li>
<p>Arbitrary number of meshes in single drawcal</p>
<p>单次绘制中任意数量的网格</p>
</li>
<li>
<p>GPU-culled by cluster bounds</p>
<p><strong>按集群边界进行 GPU 剔除</strong>，一个对象中的不可见部分就不渲染了</p>
</li>
<li>
<p>Cluster depth sorting</p>
<p>聚类深度排序</p>
</li>
</ul>
</li>
</ul>
<p><strong>Geometry Rendering Pipeline Architecture (2021)</strong> 几何渲染管线架构（2021）</p>
<ul>
<li>
<p>Rendering primitives are divided as:</p>
<p>渲染基元分为：</p>
<ul>
<li>
<p>Batch: a single APl draw (drawlndirect /drawIndexIndirect), composed of many Surfs</p>
<p>Batch：单个 APl 绘制（drawlndirect /drawIndexIndirect），由许多 Surf 组成</p>
</li>
<li>
<p>Surf: submeshes based on materials, composed of many Clusters</p>
<p>Surf：基于材质的子网格，由许多簇组成</p>
</li>
<li>
<p>Cluster: 64 triangles strip</p>
<p>簇：64 个三角形条</p>
</li>
</ul>
</li>
</ul>
<h4 id="programmable-mesh-pipeline" tabindex="-1" id="Programmable-Mesh-Pipeline">Programmable Mesh Pipeline</h4>
<p><img src="4.50.webp" alt="webp"></p>
<h4 id="gpu-culling-in-cluster-based-mesh" tabindex="-1" id="GPU-Culling-in-Cluster-Based-Mesh">GPU Culling in Cluster-Based Mesh</h4>
<p>​	基于集群的网格中的 GPU 剔除</p>
<p><img src="4.51.webp" alt="webp"></p>
<p>​	背面的 cluster 就看不见了。</p>
<h4 id="nanite" tabindex="-1" id="Nanite">Nanite</h4>
<ul>
<li>
<p>Hierarchical LOD clusters with seamless boundary</p>
<p>具有无缝边界的分层 LOD 集群</p>
</li>
<li>
<p>Don’t need hardware support, but using a hierarchical cluster culling on the precomputed BVH tree by persistent threads (CS) on GPU instead of task shader</p>
<p>不需要硬件支持，但通过 GPU 上的持久线程（CS）而不是任务着色器对预先计算的 BVH 树使用分层集群剔除</p>
</li>
</ul>
<h4 id="take-away" tabindex="-1" id="Take-Away">Take Away</h4>
<ol>
<li>
<p>The design of game engine is deeply related to the hardware architecture design</p>
<p>游戏引擎的设计与硬件架构设计有很深的关系</p>
</li>
<li>
<p>A submesh design is used to support a model with multiple materials</p>
<p>采用子网格设计来支持多种材质的模型</p>
</li>
<li>
<p>Use culling algorithms to draw as few objects as possible</p>
<p>使用剔除算法绘制尽可能少的对象</p>
</li>
<li>
<p>As GPU become more powerful, more and more work are moved into GPU, which called GPu Driven</p>
<p>随着 GPU 越来越强大，越来越多的工作转移到 GPU 上，这就是 GPU 驱动</p>
</li>
</ol>
<h2 id="%E7%AC%AC%E4%BA%94%E8%8A%82%EF%BC%9A%E6%B8%B2%E6%9F%93%E4%B8%AD%E5%85%89%E5%92%8C%E6%9D%90%E8%B4%A8%E7%9A%84%E6%95%B0%E5%AD%A6%E9%AD%94%E6%B3%95" tabindex="-1" id="第五节：渲染中光和材质的数学魔法">第五节：渲染中光和材质的数学魔法</h2>
<h3 id="rendering-on-game-engine-2" tabindex="-1" id="Rendering-on-Game-Engine-3">Rendering on Game Engine</h3>
<p>Lighting, Materials and Shaders</p>
<h4 id="participants-of-rendering-computation" tabindex="-1" id="Participants-of-Rendering-Computation">Participants of Rendering Computation</h4>
<p>​	渲染计算参与者</p>
<ul>
<li>
<p>Lighting</p>
<p>灯光</p>
<ul>
<li>
<p>Photon emit, bounce, absorb and perception is the origin of everything in rendering</p>
<p>光子的发射、反弹、吸收和感知是渲染中一切的起源</p>
</li>
</ul>
</li>
<li>
<p>Material</p>
<p>材料</p>
<ul>
<li>
<p>How matter react to photon</p>
<p>物质如何对光子做出反应</p>
</li>
</ul>
</li>
<li>
<p>Shader</p>
<p>着色器</p>
<ul>
<li>
<p>How to train and organize those micro-slaves to finish such a vast and dirty computation job between photon and materials</p>
<p>如何训练和组织这些微型奴隶来完成光子和材料之间如此庞大而肮脏的计算工作</p>
</li>
</ul>
</li>
</ul>
<p>An interesting adventure story joined by smart graphics <strong>scientists</strong> and <strong>engineers</strong> based on evolution of <strong>hardware</strong>.</p>
<p>​	智能图形<strong>科学家</strong>和<strong>工程师</strong>基于<strong>硬件</strong>的演变而加入的有趣冒险故事。</p>
<h4 id="the-rendering-equation" tabindex="-1" id="The-Rendering-Equation">The Rendering Equation</h4>
<p>​	James Kajiya 在 1986 年的 SIGGRAPH 提出了渲染方程：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>o</mi></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>)</mo><mo>=</mo><msub><mi>L</mi><mi>e</mi></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo>)</mo><mo>+</mo><msub><mo>∫</mo><mrow><msup><mi>H</mi><mn>2</mn></msup></mrow></msub><msub><mi>f</mi><mi>r</mi></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo separator="true">,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>)</mo><msub><mi>L</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>)</mo><mi>cos</mi><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>ω</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_o(x,\omega_o)=L_e(x,\omega_o)+\int_{H^2}f_r(x,\omega_o,\omega_i)L_i(x,\omega_i)\cos\theta_id\omega_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.27225em;vertical-align:-0.91225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mop"><span class="op-symbol large-op mop" style="margin-right:0.44445em;top:-0.0011249999999999316em;">∫</span><span class="vlist"><span style="top:0.91225em;margin-right:0.05em;margin-left:-0.44445em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mop">cos</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<center>出射 outgoing = 自发光 emitted + 反射光 reflected </center>
<blockquote>
<p>​	Radiance（辐射度）指的是在给定方向上单位面积上的能量辐射量。它表示了光线从光源或物体表面出射的能量。Radiance 与发射光线的方向、面积以及能量有关，通常用符号 L 表示，单位为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mi mathvariant="normal">/</mi><mo>(</mo><mi>s</mi><mi>r</mi><mo>∗</mo><msup><mi>m</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">W/(sr*m^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mord mathrm">/</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">m</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>（瓦特/球面弧度平方米）。</p>
<p>​	Irradiance（入射照度）指的是单位面积上受到的来自各个方向的光能量的总和。它表示了光线对物体表面的照射强度。Irradiance 与入射光线的方向、面积以及能量有关，通常用符号 E 表示，单位为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mi mathvariant="normal">/</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">W/m^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">m</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>（瓦特/平方米）。</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/539740506">辐射度量学（Radiometry/Photometry）和物理光照 - 知乎 (zhihu.com)</a></li>
</ul>
<p><img src="5.1.webp" alt="webp"></p>
<p>​	虽然这个方程很早就被提出，但是想要正确又高效地计算这个方程太困难了。</p>
<p><img src="5.2.webp" alt="webp"></p>
<h4 id="complexity-of-real-rendering" tabindex="-1" id="Complexity-of-Real-Rendering">Complexity of Real Rendering</h4>
<p><img src="5.3.webp" alt="webp"></p>
<p>​	现实生活中的光太复杂了。</p>
<ul>
<li>
<p>Indirect light</p>
<p>间接光</p>
</li>
<li>
<p>Indirect shadow</p>
<p>间接阴影</p>
</li>
<li>
<p>Direct light</p>
<p>直射光</p>
</li>
<li>
<p>Scattering</p>
<p>散射</p>
</li>
<li>
<p>Caustics</p>
<p>焦散</p>
</li>
<li>
<p>Glossy reflections</p>
<p>光泽反射</p>
</li>
</ul>
<h4 id="the-1st-challenge%3A-1a-visibility-to-lights" tabindex="-1" id="The-1st-Challenge-1a-Visibility-to-Lights">The 1st Challenge: 1a Visibility to Lights</h4>
<p><img src="5.4.webp" alt="webp"></p>
<p>​	第一困难：计算光照是否可见</p>
<h4 id="the-1st-challenge%3A-1b-light-source-complexity" tabindex="-1" id="The-1st-Challenge-1b-Light-Source-Complexity">The 1st Challenge: 1b Light Source Complexity</h4>
<p><img src="5.5.webp" alt="webp"></p>
<p>​	第一困难：光照种类复杂</p>
<h4 id="the-2nd-challenge%3A-how-to-do-integral-efficiently-on-hardware" tabindex="-1" id="The-2nd-Challenge-How-to-do-Integral-Efficiently-on-Hardware">The 2nd Challenge: How to do Integral Efficiently on Hardware</h4>
<p>​	第二个挑战：如何在硬件上高效地进行积分</p>
<p><img src="5.1.webp" alt="webp"></p>
<ul>
<li>
<p>Brute-force way sampling</p>
<p>暴力方式采样</p>
</li>
<li>
<p>Smarter sampling, i.e., Monta Carlo</p>
<p>更智能的采样，即蒙塔卡罗</p>
</li>
<li>
<p>Derive fast analytical solutions</p>
<p>得出快速分析解决方案</p>
<ul>
<li>
<p>Simplify the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">f_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> :</p>
<p>简化 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">f_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>：</p>
<ul>
<li>
<p>Assumptions the optical properties of materials</p>
<p>假设材料的光学特性</p>
</li>
<li>
<p>Mathematical representation of materials</p>
<p>材料的数学表示</p>
</li>
</ul>
</li>
<li>
<p>Simplify the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> :</p>
<p>简化<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>：</p>
<ul>
<li>
<p>Deal with directional light, point light and spot light only</p>
<p>仅处理定向光、点光和聚光灯</p>
</li>
<li>
<p>A mathematical representation of incident light sampling on a hemisphere, for ex: lBL and SH</p>
<p>半球上入射光采样的数学表示，例如：lBL 和 SH</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="the-3rd-challenge%3A-any-matter-will-be-light-source" tabindex="-1" id="The-3rd-Challenge-Any-matter-will-be-light-source">The 3rd Challenge: Any matter will be light source</h4>
<p>​	挑战之三：任何物质都可以成为光源（会反射光）</p>
<p><img src="5.6.webp" alt="webp"></p>
<h3 id="starting-from-simple" tabindex="-1" id="Starting-from-Simple">Starting from Simple</h3>
<p>Forget some abstract concepts for a while, ie. radiosity, microfacet and BRDF etc</p>
<p>​	暂时忘记一些抽象概念，即。光能传递、微面、BRDF 等</p>
<h4 id="simple-light-solution" tabindex="-1" id="Simple-Light-Solution">Simple Light Solution</h4>
<p><img src="5.7.webp" alt="webp"></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs glsl">glLightfv(GL_LIGHTO, GL_AMBIENT, light_ambient);<br>glLightfv(GL_LIGHTO, GL_DIFFUSE, light_diffuse);<br>glLightfv(GL_LIGHTO，GL_SPECULAR, light_specular);<br>glLightfv(GL_LIGHTO, GL_POSITION, light_position);<br></code></pre></td></tr></table></figure>
<ul>
<li>
<p>Using simple light source as main light</p>
<p>使用简单光源作为主光</p>
<ul>
<li>
<p>Directional light in most cases</p>
<p>大多数情况下是定向光</p>
</li>
<li>
<p>Point and spot light in special case</p>
<p>特殊情况下的点光源和聚光灯</p>
</li>
</ul>
</li>
<li>
<p>Using ambient light to hack others</p>
<p>利用环境光攻击他人</p>
<ul>
<li>
<p>A constant to represent mean of complex hemisphere irradiance</p>
<p>表示复半球辐照度平均值的常数</p>
</li>
</ul>
</li>
<li>
<p>Supported in graphics APl</p>
<p>图形 API 支持</p>
</li>
</ul>
<h4 id="environment-map-reflection" tabindex="-1" id="Environment-Map-Reflection">Environment Map Reflection</h4>
<p><img src="5.8.webp" alt="webp"></p>
<ul>
<li>
<p>Using environment map to enhance glossary surface reflection</p>
<p>使用环境贴图增强词汇表（？）表面反射</p>
</li>
<li>
<p>Using environment mipmap to represent roughness of surface</p>
<p>使用环境 mipmap 来表示表面的粗糙度</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    vec3 N = normalize(normal);<br>    vec3 V = normalize(camera position - world position);<br>    vec3 R = reflect(v, N);<br>    FragColor = texture(cube texture, R);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>Early stage exploration of image-based lighting</p>
<p>​	基于图像的照明的早期探索</p>
<h4 id="math-behind-light-combo" tabindex="-1" id="Math-Behind-Light-Combo">Math Behind Light Combo</h4>
<p>​	光组合背后的数学</p>
<p><img src="5.9.webp" alt="webp"></p>
<ul>
<li>
<p>Main Light</p>
<p>主光源</p>
<ul>
<li>
<p>Dominant Light</p>
<p>主光源</p>
</li>
</ul>
</li>
<li>
<p>Ambient Light</p>
<p>环境光</p>
<ul>
<li>
<p>Low-frequency of irradiance sphere distribution</p>
<p>低频辐照度球体分布</p>
</li>
</ul>
</li>
<li>
<p>Environment Map</p>
<p>环境贴图</p>
<ul>
<li>
<p>High-frequency of irradiance sphere distribution</p>
<p>高频辐照度球体分布</p>
</li>
</ul>
</li>
</ul>
<h4 id="blinn-phong-materials" tabindex="-1" id="Blinn-Phong-Materials">Blinn-Phong Materials</h4>
<p><img src="5.10.webp" alt="webp"></p>
<p>​	冯光照模型是个很经典的光照模型，虽然现在有点过时了。</p>
<h4 id="problem-of-blinn-phong" tabindex="-1" id="Problem-of-Blinn-Phong">Problem of Blinn-Phong</h4>
<ul>
<li>
<p>Not energy conservative</p>
<p>不符合能量守恒定律（可能越反射越亮）</p>
<ul>
<li>
<p>Unstable in ray-tracing</p>
<p>光线追踪不稳定</p>
</li>
</ul>
</li>
</ul>
<p><img src="5.11.webp" alt="webp"></p>
<p>Left non-energy conserving model lead a lot of noise compare Right energy conserving model</p>
<p>​	左边的非节能模型与右边的节能模型相比会产生很多噪音</p>
<ul>
<li>
<p>Hard to model complex realistic material</p>
<p>难以模拟复杂材质（冯模型模拟出来都有一股塑料感）</p>
</li>
</ul>
<p><img src="5.12.webp" alt="webp"></p>
<h4 id="shadow" tabindex="-1" id="Shadow">Shadow</h4>
<p><img src="5.13.webp" alt="webp"></p>
<ul>
<li>
<p>Shadow is nothing but space when the light is blocked by an opaque object</p>
<p>当光线被不透明物体阻挡时，阴影只不过是空间</p>
</li>
<li>
<p>Already obsolete method</p>
<p>已经过时的方法</p>
<ul>
<li>
<p>planar shadow</p>
<p>平面阴影</p>
</li>
<li>
<p>shadow volume</p>
<p>阴影体积</p>
</li>
<li>
<p>projective texture</p>
<p>投影纹理</p>
</li>
</ul>
</li>
</ul>
<h4 id="shadow-map" tabindex="-1" id="Shadow-Map">Shadow Map</h4>
<blockquote>
<p>​	Shadow Map 是计算机图形学中用于实现阴影的一种技术。它基于光线追踪的概念，将场景从光源的视角渲染到一个深度纹理贴图上，以便在后续的渲染中使用这个纹理来确定哪些表面处于阴影之中。</p>
</blockquote>
<p>​	计算出阴影贴图。用一张 texture 表示阴影。</p>
<p><img src="5.14.webp" alt="webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-comment">// project our 3D position to the shadow map</span><br>vec4 proj_pos = shadow viewproj * pos;<br><span class="hljs-comment">// from homogeneous space to clip space</span><br>vec2shadow_uv = proj_pos.xy / proj_pos.w;<br><span class="hljs-comment">// from clip space to uv space</span><br>shadow_uv = shadow_uv * <span class="hljs-number">0.5</span> + vec2(<span class="hljs-number">0.5</span>)<br><span class="hljs-comment">// get point depth (from -1 to 1)</span><br><span class="hljs-type">float</span> real_depth = proj_pos.z / proj_pos.w;<br><span class="hljs-comment">// normalize from [-1..+1] to [0..+1]</span><br>real_depth = real_depth * <span class="hljs-number">0.5</span> + <span class="hljs-number">0.5</span>;<br><span class="hljs-comment">// read depth from depth buffer in [0..+1]</span><br><span class="hljs-type">float</span> shadow_depth = texture(shadowmap, shadow_uv).x;<br><span class="hljs-comment">// compute final shadow factor by comparing</span><br><span class="hljs-type">float</span> shadow_factor = <span class="hljs-number">1.0</span>;<br><span class="hljs-keyword">if</span>(shadow_depth &lt; real_depth)<br>    shadow_factor =<span class="hljs-number">0.0</span>;<br></code></pre></td></tr></table></figure>
<h4 id="problem-of-shadow-map" tabindex="-1" id="Problem-of-Shadow-Map">Problem of Shadow Map</h4>
<p><img src="5.15.webp" alt="webp"></p>
<p>Resolution is limited on texture</p>
<p>​	分辨率受纹理限制</p>
<p><img src="5.16.webp" alt="webp"></p>
<p>Depth precision is limited in texture</p>
<p>​	深度精度受到纹理的限制</p>
<h4 id="basic-shading-solution" tabindex="-1" id="Basic-Shading-Solution">Basic Shading Solution</h4>
<ul>
<li>
<p>Simple light + Ambient</p>
<p>简单光 + 环境光</p>
<ul>
<li>
<p>dominent light solves No. 1b</p>
<p>主光解决了第 1b 项挑战</p>
</li>
<li>
<p>ambient and EnvMap solves No.3 challanges</p>
<p>环境光和 EnvMap 解决了第 3 项挑战</p>
</li>
</ul>
</li>
<li>
<p>Blinn-Phong material</p>
<ul>
<li>
<p>solve No.2 challange</p>
<p>解决第 2 项挑战</p>
</li>
</ul>
</li>
<li>
<p>Shadow map</p>
<p>阴影贴图</p>
<ul>
<li>
<p>solve No.1a challange</p>
<p>解决第 1a 项挑战</p>
</li>
</ul>
</li>
</ul>
<h4 id="cheap%2C-robust-and-easy-modification" tabindex="-1" id="Cheap-Robust-and-Easy-Modification">Cheap, Robust and Easy Modification</h4>
<p>​	便宜、鲁棒且易于修改</p>
<h3 id="first-wave-of-aaa-quality" tabindex="-1" id="First-Wave-of-AAA-Quality">First Wave of AAA Quality</h3>
<p>​	3A 游戏的渲染技术不断发展。</p>
<h3 id="pre-computed-global-illumination" tabindex="-1" id="Pre-computed-Global-Illumination">Pre-computed Global Illumination</h3>
<p>​	用一个环境光常量来模拟其他物体反射出的所有光，减少计算。</p>
<h4 id="why-global-llumination-is-lmportant" tabindex="-1" id="Why-Global-llumination-is-lmportant">Why Global llumination is lmportant</h4>
<p><img src="5.17.webp" alt="webp"></p>
<p>​	如果不考虑光的反射，大片面积将会一坨黑。</p>
<h4 id="how-to-represent-indirect-light" tabindex="-1" id="How-to-Represent-indirect-Light">How to Represent indirect Light</h4>
<p><img src="5.18.webp" alt="webp"></p>
<ul>
<li>
<p>Good compression rate</p>
<p>良好的压缩率</p>
<ul>
<li>
<p>We need to store millions of radiance probes in a level</p>
<p>我们需要在一个水平仪中存储数百万个辐射探头</p>
</li>
</ul>
</li>
<li>
<p>Easy to do integration with material function</p>
<p>易于与材料功能集成</p>
<ul>
<li>
<p>Use polynomial calculation to convolute withmaterial BRDF</p>
<p>使用多项式计算与材质 BRDF 进行卷积</p>
</li>
</ul>
</li>
</ul>
<p>​	计算光照用到了下面数学工具：</p>
<h4 id="fourier-transform" tabindex="-1" id="Fourier-Transform">Fourier Transform</h4>
<p><img src="5.19.webp" alt="webp"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi>A</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo>+</mo><mfrac><mrow><mn>2</mn><mi>A</mi><mi>cos</mi><mo>(</mo><mi>t</mi><mi>ω</mi><mo>)</mo></mrow><mrow><mi>π</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mn>2</mn><mi>A</mi><mi>cos</mi><mo>(</mo><mn>3</mn><mi>t</mi><mi>ω</mi><mo>)</mo></mrow><mrow><mn>3</mn><mi>π</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mn>2</mn><mi>A</mi><mi>cos</mi><mo>(</mo><mn>5</mn><mi>t</mi><mi>ω</mi><mo>)</mo></mrow><mrow><mn>5</mn><mi>π</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mn>2</mn><mi>A</mi><mi>cos</mi><mo>(</mo><mn>7</mn><mi>t</mi><mi>ω</mi><mo>)</mo></mrow><mrow><mn>7</mn><mi>π</mi></mrow></mfrac><mo>+</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">f(x)=\frac{A}{2}+\frac{2A\cos(t\omega)}{\pi}-\frac{2A\cos(3t\omega)}{3\pi}+\frac{2A\cos(5t\omega)}{5\pi}-\frac{2A\cos(7t\omega)}{7\pi}+\cdots 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.113em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">A</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit">A</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">−</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">3</span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit">A</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathrm">3</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit">A</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathrm">5</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">−</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">7</span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit">A</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathrm">7</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">+</span><span class="minner">⋯</span></span></span></span></span></p>
<p>​	傅里叶变换让函数在时域和空域之间转换。</p>
<h4 id="convolution-theorem" tabindex="-1" id="Convolution-Theorem">Convolution Theorem</h4>
<p><img src="5.20.webp" alt="webp"></p>
<p>​	引入傅里叶变换，让卷积速度更快！</p>
<h4 id="spherical-harmonics" tabindex="-1" id="Spherical-Harmonics">Spherical Harmonics</h4>
<p>​	球谐函数</p>
<blockquote>
<p>​	Spherical Harmonics（球谐函数）是一组用于描述球面上函数的数学函数系列。在计算机图形学中，球谐函数被广泛应用于光照和环境光的表示与计算。</p>
</blockquote>
<p><img src="5.21.webp" alt="webp"></p>
<p><img src="5.22.webp" alt="webp"></p>
<p>Spherical Harmonics, a mathematical system analogous to the Fourier transform but defined across the surface of a sphere. The SH functions in general are defined on imaginary numbers</p>
<p>​	球谐函数，一种类似于傅立叶变换的数学系统，但定义在球体表面。SH 函数一般是根据虚数定义的</p>
<h4 id="spherical-harmonics-encoding" tabindex="-1" id="Spherical-Harmonics-Encoding">Spherical Harmonics Encoding</h4>
<p><img src="5.23.webp" alt="webp"></p>
<h4 id="sampling-lrradiance-probe-anywhere" tabindex="-1" id="Sampling-lrradiance-Probe-Anywhere">Sampling lrradiance Probe Anywhere</h4>
<p><img src="5.24.webp" alt="webp"></p>
<h4 id="compress-lrradiance-probe-to-sh1" tabindex="-1" id="Compress-lrradiance-Probe-to-SH1">Compress lrradiance Probe to SH1</h4>
<blockquote>
<p>​	Lrradiance Probe（辐照度探针）是计算机图形学中用于捕捉和近似表示环境光照信息的技术。它通过在场景中放置一系列探针来采样场景中的辐照度（irradiance），并将这些采样结果存储起来，以便在渲染过程中使用。</p>
</blockquote>
<p><img src="5.25.webp" alt="webp"></p>
<ul>
<li>
<p>Source lrradiance Probe</p>
<p>光源辐照度探头</p>
</li>
<li>
<p>Compressed lrradiance Probe By SH1</p>
<p>SH1 的压缩辐照度探头</p>
</li>
<li>
<p>Reconstruct lrradiance In Shader</p>
<p>在着色器中重建光照度</p>
</li>
</ul>
<h4 id="store-and-shading-with-sh" tabindex="-1" id="Store-and-Shading-with-SH">Store and Shading with SH</h4>
<p>Just RGBA8 color</p>
<ul>
<li>
<p>Use 4 RGB textures to store 12 SH coefficients</p>
<p>使用 4 个 RGB 纹理来存储 12 个 SH 系数</p>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">L0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mord mathrm">0</span></span></span></span> coefficients in HDR (BC6H texture)</p>
<p>HDR 中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">L0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mord mathrm">0</span></span></span></span> 系数（BC6H 纹理）</p>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">L1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mord mathrm">1</span></span></span></span> coefficients in LDR (3x Bc7 or BC1 textures)</p>
<p>LDR 中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">L1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mord mathrm">1</span></span></span></span> 系数（3x Bc7 或 BC1 纹理）</p>
</li>
</ul>
</li>
<li>
<p>Total footprint for RGB SH lightmaps:</p>
<p>RGB SH 光照贴图的总占用空间：</p>
<ul>
<li>
<p>32 bits (4 bytes)/texel for Bc6+Bc7, high quality mode</p>
<p>Bc6+Bc7 32 位（4 字节）/texel，高质量模式</p>
</li>
<li>
<p>20 bits (2.5 bytes) texel for Bc6+Bc1, low quality mode</p>
<p>Bc6+Bc1 的 20 位（2.5 字节）纹理元素，低质量模式</p>
</li>
</ul>
</li>
</ul>
<p>Simple diffuse shading</p>
<p><img src="5.26.webp" alt="webp"></p>
<h4 id="sh-lightmap%3A-precomputed-gi" tabindex="-1" id="SH-Lightmap-Precomputed-GI">SH Lightmap: Precomputed GI</h4>
<p>​	SH 光照贴图：预计算 GI</p>
<p>​	空间换时间。</p>
<blockquote>
<p>​	SH Lightmap 是一种基于球谐函数（Spherical Harmonics）的光照贴图技术，可以用于近似表示场景中的光照信息。它通过将场景的光照信息转换为球谐系数并存储到贴图上，以便在渲染时快速计算每个片元的光照贡献。</p>
</blockquote>
<p><img src="5.27.webp" alt="webp"></p>
<ul>
<li>
<p>Parameterized all scene into huge 2D lightmap atlas</p>
<p>将所有场景参数化为巨大的 2D 光照图集</p>
</li>
<li>
<p>Using offline lighting farm to calculate irradiance probes for all surface points</p>
<p>使用离线照明场计算所有表面点的辐照度探头</p>
</li>
<li>
<p>Compress those irradiance probes into SH coefficients</p>
<p>将这些辐照度探头压缩为 SH 系数</p>
</li>
<li>
<p>Store SH coefficients into 2D atlas lightmap textures</p>
<p>将 SH 系数存储到 2D 图集光照贴图纹理中</p>
</li>
</ul>
<h4 id="lightmap%3A-uv-atlas" tabindex="-1" id="Lightmap-UV-Atlas">Lightmap: UV Atlas</h4>
<p><img src="5.28.webp" alt="webp"></p>
<p>Lightmap density</p>
<p>​	光照贴图密度</p>
<ul>
<li>
<p>Low-poly proxy geometry</p>
<p>低多边形代理几何体</p>
</li>
<li>
<p>Fewer UV charts/islands</p>
<p>更少的紫外线图表/岛屿</p>
</li>
<li>
<p>Fewer lightmap texels are wasted</p>
<p>浪费的光照贴图纹理像素更少</p>
</li>
</ul>
<h4 id="lightmap%3A-lighing" tabindex="-1" id="Lightmap-Lighing">Lightmap: Lighing</h4>
<p><img src="5.29.webp" alt="webp"></p>
<p>Indirect lighting, finalgeometry</p>
<p>​	间接照明，最终几何</p>
<ul>
<li>
<p>Project lightmap from proxiesto all LODs</p>
<p>将光照贴图从代理投影到所有 LOD</p>
</li>
<li>
<p>Apply mesh details</p>
<p>应用网格细节</p>
</li>
<li>
<p>Add short-range, high-frequency lighting detail by HBAO</p>
<p>通过 HBAO 添加短距离、高频照明细节</p>
</li>
</ul>
<h4 id="lightmap%3A-lighting-%2B-direct-lighting" tabindex="-1" id="Lightmap-Lighting-Direct-Lighting">Lightmap: Lighting + Direct Lighting</h4>
<p><img src="5.30.webp" alt="webp"></p>
<p>​	光照贴图：光照+直接光照</p>
<p>Direct + indirect lighting, final geometry</p>
<p>​	直接+间接照明，最终几何形状</p>
<ul>
<li>
<p>Compute direct lighting dynamically</p>
<p>动态计算直接照明</p>
</li>
</ul>
<h4 id="final-shading-with-materials" tabindex="-1" id="Final-Shading-with-Materials">Final Shading with Materials</h4>
<p><img src="5.31.webp" alt="webp"></p>
<p>Final frame</p>
<p>​	最终帧</p>
<ul>
<li>
<p>Combined with materials</p>
<p>与材质结合</p>
</li>
</ul>
<h4 id="lightmap" tabindex="-1" id="Lightmap">Lightmap</h4>
<ul>
<li>
<p>Pros</p>
<p>优点</p>
<ul>
<li>
<p>Very efficient on runtime</p>
<p>运行时非常高效</p>
</li>
<li>
<p>Bake a lot of fine details of Gl on environment</p>
<p>在环境上烘焙了 GL 的很多细节</p>
</li>
</ul>
</li>
<li>
<p>Cons</p>
<p>缺点</p>
<ul>
<li>
<p>Long and expensive precomputation (lightmap farm)</p>
<p>漫长而昂贵的预计算（光照贴图农场）</p>
</li>
<li>
<p>Only can handle static scene and static light</p>
<p>只能处理静态场景和静态灯光</p>
</li>
<li>
<p>Storage cost on package and GPU</p>
<p>包和 GPU 的存储成本</p>
</li>
</ul>
</li>
</ul>
<h4 id="light-probe%3A-probes-in-game-space" tabindex="-1" id="Light-Probe-Probes-in-Game-Space">Light Probe: Probes in Game Space</h4>
<p><img src="5.32.webp" alt="webp"></p>
<h4 id="light-probe-point-generation" tabindex="-1" id="Light-Probe-Point-Generation">Light Probe Point Generation</h4>
<p><img src="5.33.webp" alt="webp"></p>
<h4 id="reflection-probe" tabindex="-1" id="Reflection-Probe">Reflection Probe</h4>
<p><img src="5.34.webp" alt="webp"></p>
<h4 id="light-probes-%2B-reflection-probes" tabindex="-1" id="Light-Probes-Reflection-Probes">Light Probes + Reflection Probes</h4>
<ul>
<li>
<p>Pros</p>
<p>优点</p>
<ul>
<li>
<p>Very efficient on runtime</p>
<p>运行时非常高效</p>
</li>
<li>
<p>Can be applied to both static and dynamic objects</p>
<p>可应用于静态和动态对象</p>
</li>
<li>
<p>Handle both diffuse and specular shading</p>
<p>处理漫反射和镜面反射着色</p>
</li>
</ul>
</li>
<li>
<p>Cons</p>
<p>缺点</p>
<ul>
<li>
<p>A bunch of SH light probes need some precomputation</p>
<p>一堆 SH 光探头需要一些预计算</p>
</li>
<li>
<p>Can not handle fine detail of Gl. l.e, soft shadow on overlapped structures</p>
<p>无法处理 GL 的精细细节。即，重叠结构上的软阴影。</p>
</li>
</ul>
</li>
</ul>
<h3 id="physical-based-material" tabindex="-1" id="Physical-Based-Material">Physical-Based Material</h3>
<h4 id="microfacet-theory" tabindex="-1" id="Microfacet-Theory">Microfacet Theory</h4>
<p>​	微平面理论。</p>
<p><img src="5.35.webp" alt="webp"></p>
<h4 id="brdf-model-based-on-microfacet" tabindex="-1" id="BRDF-Model-Based-on-Microfacet">BRDF Model Based on Microfacet</h4>
<p>​	基于 Microfacet 的 BRDF 模型</p>
<p><img src="5.36.webp" alt="webp"></p>
<h4 id="normal-distribution-function" tabindex="-1" id="Normal-Distribution-Function">Normal Distribution Function</h4>
<p><img src="5.37.webp" alt="webp"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>C</mi><mi>o</mi><mi>o</mi><mi>k</mi><mi>T</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>D</mi><mi>F</mi><mi>G</mi></mrow><mrow><mn>4</mn><mo>(</mo><msub><mi>ω</mi><mrow><mi>o</mi></mrow></msub><mo>⋅</mo><mi>n</mi><mo>)</mo><mo>(</mo><msub><mi>ω</mi><mrow><mi>i</mi></mrow></msub><mo>⋅</mo><mi>n</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">f_{CookTorrance}=\frac{DFG}{4(\omega_{o}\cdot n)(\omega_{i}\cdot n)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36033em;"></span><span class="strut bottom" style="height:2.29633em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">c</span><span class="mord mathit">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">4</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit">G</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>D</mi><msub><mi>F</mi><mrow><mi>G</mi><mi>G</mi><mi>X</mi></mrow></msub><mo>(</mo><mi>n</mi><mo separator="true">,</mo><mi>h</mi><mo separator="true">,</mo><mi>α</mi><mo>)</mo><mo>=</mo><mfrac><mrow><msup><mi>α</mi><mrow><mn>2</mn></mrow></msup></mrow><mrow><mi>π</mi><msup><mrow><mo fence="true">(</mo><mo>(</mo><mi>n</mi><mo>⋅</mo><mi>h</mi><msup><mo>)</mo><mrow><mn>2</mn></mrow></msup><mo>(</mo><msup><mi>α</mi><mrow><mn>2</mn></mrow></msup><mo>−</mo><mn>1</mn><mo>)</mo><mo>+</mo><mn>1</mn><mo fence="true">)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">NDF_{GGX}(n,h,\alpha)=\frac{\alpha^{2}}{\pi\left((n\cdot h)^{2}(\alpha^{2}-1)+1\right)^{2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.446216em;vertical-align:-0.955108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">G</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.705108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">π</span><span class="minner"><span class="minner textstyle cramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mbin">⋅</span><span class="mord mathit">h</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<h4 id="geometric-attenuation-term-(self-shadowing)" tabindex="-1" id="Geometric-Attenuation-Term-self-shadowing">Geometric Attenuation Term (self-shadowing)</h4>
<blockquote>
<p>​	在计算机图形学中，几何衰减项（self-shadowing）是指在渲染过程中考虑物体自身阴影对光照效果的影响。当光线射向一个物体表面时，如果该表面的某些部分被遮挡，这些被遮挡的部分就会处于阴影之中，从而无法直接受到光的照射，导致其表面变暗。</p>
<p>​	几何衰减项通常用于模拟光线在渲染过程中如何与物体表面相互作用，从而影响最终的光照结果。这种效应特别明显的情况是当光源和观察者之间有障碍物时，如一个物体投射的阴影落在自身表面上。</p>
<p>​	几何衰减项可以通过各种方式来实现，其中一种常见的方式是使用阴影映射（shadow mapping）技术。在阴影映射中，首先从光源的视角渲染场景，并将渲染结果保存在一个深度贴图（depth map）中。然后，对于每个像素，通过比较深度贴图中的深度值来确定该像素是否在阴影之中。如果某个像素被深度贴图中的深度值所遮挡，那么该像素就被认为处于阴影之中，从而进行相应的颜色调整，实现几何衰减效果。</p>
</blockquote>
<p><img src="5.38.webp" alt="webp"></p>
\begin{gathered}
f_{CookTorrance}=\frac{DFG}{4(\omega_o\cdot n)(\omega_i\cdot n)} \\
G_{Smith}(l,\nu)=G_{GGX}(l)\cdot G_{GGX}(\nu) \\
G_{GGX}(\nu)=\frac{n\cdot\nu}{(n\cdot\nu)(1-k)+k}\quad k=\frac{(\alpha+1)^{2}}{8} 
\end{gathered}
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-comment">// Geometry Term: Geometry masking/shadowing due to microfacets</span><br><span class="hljs-type">float</span> <span class="hljs-title function_">GGr</span><span class="hljs-params">(<span class="hljs-type">float</span> Ndotv, <span class="hljs-type">float</span> k)</span> &#123;<br>    <span class="hljs-keyword">return</span> Ndotv / (Ndotv * (<span class="hljs-number">1.0</span> - k) + k);<br>&#125;<br><span class="hljs-type">float</span> <span class="hljs-title function_">G_Smith</span><span class="hljs-params">(<span class="hljs-type">float</span> Ndotv, <span class="hljs-type">float</span> NdotL, <span class="hljs-type">float</span> roughness)</span> &#123;<br>	<span class="hljs-type">float</span> k = <span class="hljs-built_in">pow</span>(roughness + <span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>) / <span class="hljs-number">8.0</span>;<br>    <span class="hljs-keyword">return</span> GGX(NdotL, k) * GGr(Ndotv, k);<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="fresnel-equation" tabindex="-1" id="Fresnel-Equation">Fresnel Equation</h4>
<p>​	当视角接近反射平面时，反射率会急剧上升。</p>
<p><img src="5.39.webp" alt="webp"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><msub><mi>f</mi><mrow><mi>C</mi><mi>o</mi><mi>o</mi><mi>k</mi><mi>T</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>D</mi><mi>F</mi><mi>G</mi></mrow><mrow><mn>4</mn><mo>(</mo><msub><mi>ω</mi><mrow><mi>o</mi></mrow></msub><mo>⋅</mo><mi>n</mi><mo>)</mo><mo>(</mo><msub><mi>ω</mi><mrow><mi>i</mi></mrow></msub><mo>⋅</mo><mi>n</mi><mo>)</mo></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><msub><mi>F</mi><mrow><mi>S</mi><mi>c</mi><mi>h</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>k</mi></mrow></msub><mo>(</mo><mi>h</mi><mo separator="true">,</mo><mi>ν</mi><mo separator="true">,</mo><msub><mi>F</mi><mrow><mn>0</mn></mrow></msub><mo>)</mo><mo>=</mo><msub><mi>F</mi><mrow><mn>0</mn></mrow></msub><mo>+</mo><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>F</mi><mrow><mn>0</mn></mrow></msub><mo>)</mo><msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mo>(</mo><mi>ν</mi><mo>⋅</mo><mi>h</mi><mo>)</mo><mo fence="true">)</mo></mrow><mrow><mn>5</mn></mrow></msup></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{aligned}&amp;f_{CookTorrance}=\frac{DFG}{4(\omega_{o}\cdot n)(\omega_{i}\cdot n)}\\&amp;F_{Schlick}(h,\nu,F_{0})=F_{0}+(1-F_{0})\left(1-(\nu\cdot h)\right)^{5}\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.010219em;"></span><span class="strut bottom" style="height:3.5204380000000004em;vertical-align:-1.5102190000000002em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6498890000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:1.150219em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6498890000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">c</span><span class="mord mathit">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">4</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit">G</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span style="top:1.150219em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">c</span><span class="mord mathit">h</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">h</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.06366em;">ν</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="minner"><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.06366em;">ν</span><span class="mbin">⋅</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">5</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span></span></span></span></span></span></span></p>
<p>​	这个 5 次方是数学家推导出来的。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-comment">// Fresnel term with scalar optimization</span><br><span class="hljs-type">float</span> F <span class="hljs-title function_">Schlick</span><span class="hljs-params">(<span class="hljs-type">float</span> VoH, <span class="hljs-type">float</span> f0)</span> &#123;<br>    <span class="hljs-type">float</span> f = <span class="hljs-built_in">pow</span>(<span class="hljs-number">1.0</span> - VoH, <span class="hljs-number">5.0</span>);<br>    <span class="hljs-keyword">return</span> f0 + (<span class="hljs-number">1.0</span> - f0) * f;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="physical-measured-material" tabindex="-1" id="Physical-Measured-Material">Physical Measured Material</h4>
<p><img src="5.40.webp" alt="webp"></p>
<p>MERL BRDF Database of measured materials</p>
<p>​	这个数据集测量了各种材质的数据。</p>
<h4 id="disney-principled-brdf" tabindex="-1" id="Disney-Principled-BRDF">Disney Principled BRDF</h4>
<p>Principles to follow when implementing model:</p>
<p>​	实施模型时应遵循的原则：</p>
<ul>
<li>
<p>Intuitive rather than physical parameters should be used</p>
<p>应使用直观参数而不是物理参数</p>
</li>
<li>
<p>There should be as few parameters as possible</p>
<p>参数应该尽可能少</p>
</li>
<li>
<p>Parameters should be zero to one over their plausible range</p>
<p>参数在其合理范围内应为 0 到 1</p>
</li>
<li>
<p>Parameters should be allowed to be pushed beyond their plausible range where it makes sense</p>
<p>应允许参数超出其合理范围</p>
</li>
<li>
<p>All combinations of parameters should be as robust and plausible as possible</p>
<p>所有参数组合应尽可能稳健且合理</p>
</li>
</ul>
<h4 id="disney-principle-material-parameters" tabindex="-1" id="Disney-Principle-Material-Parameters">Disney Principle Material Parameters</h4>
<blockquote>
<p>​	Disney Principled BRDF 是迪士尼（Disney）开发的一种基于物理的渲染表面模型，用于在计算机图形学中模拟材质的外观。BRDF 是 Bidirectional Reflectance Distribution Function 的缩写，用于描述光线从表面反射的方式。Disney Principled BRDF 将多个常见的渲染表面模型（如 Lambert、Blinn-Phong、Cook-Torrance 等）融合成一个单一的、参数化的模型，使得艺术家和技术人员可以更简单地控制材质的外观，并且更好地满足物理真实性的要求。</p>
<p>​	Disney Principled BRDF 的主要特点和参数包括：</p>
<ol>
<li>
<p><strong>基础颜色（Base Color）：</strong> 表示表面的颜色，即在没有其他光照影响的情况下表面的颜色。</p>
</li>
<li>
<p><strong>金属度（Metallic）：</strong> 表示表面是否具有金属质感。金属度为 0 表示非金属材质，金属度为 1 表示完全是金属材质。</p>
</li>
<li>
<p><strong>粗糙度（Roughness）：</strong> 表示表面的光滑程度。粗糙度为 0 表示表面非常光滑，反射光线呈现清晰的镜面反射，而粗糙度为 1 表示表面非常粗糙，反射光线呈现模糊的散射。</p>
</li>
<li>
<p><strong>法线（Normal）：</strong> 表示表面的法线方向，用于模拟表面的微观凹凸结构。</p>
</li>
<li>
<p><strong>环境遮挡（Ambient Occlusion）：</strong> 用于模拟光线在表面附近的阴影效果，增强表面的立体感。</p>
<p>Disney Principled BRDF 的优点在于它简化了材质创建的流程，减少了需要调整的参数数量，同时也更符合物理真实性。通过调整基础颜色、金属度和粗糙度等参数，可以实现多种不同类型材质的外观，包括金属材质、塑料、玻璃等。</p>
<p>这种模型的广泛应用使得它成为了许多计算机图形学软件和引擎中的标准渲染模型之一，例如 Pixar 的 RenderMan、Blender 内置的 Cycles 渲染引擎等。</p>
</li>
</ol>
</blockquote>
<p><img src="5.41.webp" alt="webp"></p>
<h4 id="pbr-specular-glossiness" tabindex="-1" id="PBR-Specular-Glossiness">PBR Specular Glossiness</h4>
<blockquote>
<p>​	Specular Glossiness（高光光泽度）是一种用于描述材质表面反射特性的属性。它通常被用于渲染引擎和材质编辑器中，用于控制物体表面的光泽程度以及高光的大小和清晰度。</p>
</blockquote>
<p><img src="5.42.webp" alt="webp"></p>
<p><img src="5.43.webp" alt="webp"></p>
<h4 id="pbr-metallic-roughness" tabindex="-1" id="PBR-Metallic-Roughness">PBR Metallic Roughness</h4>
<blockquote>
<p>​	Metallic Roughness 是一种用于描述材质外观的参数化模型，通常用于计算机图形学中的渲染。它是 Disney Principled BRDF 中的两个主要参数之一，用于控制材质的金属度和粗糙度，从而影响表面的反射和散射行为。</p>
<ol>
<li><strong>金属度（Metallic）：</strong> 这个参数表示表面材质的金属属性程度。金属度为 0 表示非金属材质，例如塑料、木材等，而金属度为 1 表示完全是金属材质，例如铁、铜等。金属材质具有较强的镜面反射特性，因此在光照下会产生清晰的高光反射，而非金属材质则通常具有更多的漫反射。</li>
<li><strong>粗糙度（Roughness）：</strong> 这个参数表示表面的光滑程度。粗糙度为 0 表示表面非常光滑，反射光线呈现清晰的镜面反射，而粗糙度为 1 表示表面非常粗糙，反射光线呈现模糊的散射。具有较高粗糙度的表面会导致光线在各个方向上散射，产生柔和的光照效果，而较低粗糙度的表面则会产生更锐利的反射光线。</li>
</ol>
</blockquote>
<p><img src="5.44.webp" alt="webp"></p>
<h4 id="covert-mr-to-sg" tabindex="-1" id="Covert-MR-to-SG">Covert MR to SG</h4>
<p><img src="5.45.webp" alt="webp"></p>
<h4 id="pbr-pipeline-mr-vs-sg" tabindex="-1" id="PBR-Pipeline-MR-vs-SG">PBR Pipeline MR vs SG</h4>
<p><img src="5.46.webp" alt="webp"></p>
<p>MR</p>
<ul>
<li>
<p>Pros</p>
<ul>
<li>
<p>Can be easier to author and less prone to errors caused by supplying incorrect dielectric F0 data</p>
<p>可以更轻松地编写，并且不易因提供不正确的介电 F0 数据而导致错误</p>
</li>
<li>
<p>Uses less texture memory, as metallic and roughness are both grayscale maps</p>
<p>使用更少的纹理内存，因为金属和粗糙度都是灰度图</p>
</li>
</ul>
</li>
<li>
<p>Cons</p>
<ul>
<li>
<p>No control over F0 for dielectrics in map creation. However, most implementations have a specular control to override thebase 4% value</p>
<p>在创建地图时无法控制电介质的 F0。然而，大多数实现都有镜面反射控制来覆盖 4% 的基本值</p>
</li>
<li>
<p>Edge artifacts are more noticeable, especially at lowerresolutions</p>
<p>边缘伪影更加明显，尤其是在较低分辨率下</p>
</li>
</ul>
</li>
</ul>
<p>SG</p>
<ul>
<li>
<p>Pros</p>
<ul>
<li>
<p>Edge artifacts are less apparent</p>
<p>边缘伪影不太明显</p>
</li>
<li>
<p>Control over dielectric F0 in the specular map</p>
<p>控制镜面反射图中的电介质 F0</p>
</li>
</ul>
</li>
<li>
<p>Cons</p>
<ul>
<li>
<p>Because the specular map provides control over dielectric F0, it is more susceptible to use of incorrect values. lt is possible to break the law of conservation if handled incorrectly in the shader</p>
<p>由于镜面反射贴图提供对电介质 F0 的控制，因此更容易使用不正确的值。如果在着色器中处理不当，可能会违反守恒定律</p>
</li>
<li>
<p>Uses more texture memory with an additional RGB map</p>
<p>使用更多纹理内存和额外的 RGB 贴图</p>
</li>
</ul>
</li>
</ul>
<h3 id="image-based-lighting-(ibl)" tabindex="-1" id="Image-Based-Lighting-IBL">Image-Based Lighting (IBL)</h3>
<h4 id="basic-idea-of-ibl" tabindex="-1" id="Basic-Idea-of-IBL">Basic Idea of IBL</h4>
<blockquote>
<p>​	IBL（Image-Based Lighting）是一种计算机图形学中常用的光照技术，用于模拟真实世界中的光照效果。它基于图像的方式来描述光照信息，通过对环境中的光照进行捕捉和处理，来为场景中的物体赋予逼真的光照效果。</p>
<p>​	IBL 的基本原理是利用环境贴图（Environment Map）来模拟环境中的光照。环境贴图通常是一个球形或立方体贴图，捕捉了环境中的光照信息，包括天空、周围物体的反射等。这些贴图可以是基于真实场景拍摄的全景图像，也可以是通过计算得到的环境光照信息。</p>
</blockquote>
<p><img src="5.47.webp" alt="webp"></p>
<ul>
<li>
<p>An image representing distant lighting from alldirections.</p>
<p>代表来自各个方向的远处照明的图像。</p>
</li>
<li>
<p>How to shade a point under the lighting?</p>
<p>如何在灯光下对点进行着色？</p>
<p>Solving the rendering equation:</p>
<p>求解渲染方程：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>o</mi></mrow></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>ω</mi><mrow><mi>o</mi></mrow></msub><mo>)</mo><mo>=</mo><msub><mo>∫</mo><mrow><msup><mi>H</mi><mrow><mn>2</mn></mrow></msup></mrow></msub><msub><mi>f</mi><mrow><mi>r</mi></mrow></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>ω</mi><mrow><mi>o</mi></mrow></msub><mo separator="true">,</mo><msub><mi>ω</mi><mrow><mi>i</mi></mrow></msub><mo>)</mo><msub><mi>L</mi><mrow><mi>i</mi></mrow></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>ω</mi><mrow><mi>i</mi></mrow></msub><mo>)</mo><mi>cos</mi><msub><mi>θ</mi><mrow><mi>i</mi></mrow></msub><mi>d</mi><msub><mi>ω</mi><mrow><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{o}(x,\omega_{o})=\int_{H^{2}}f_{r}(x,\omega_{o},\omega_{i})L_{i}(x,\omega_{i})\cos\theta_{i}d\omega_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.805em;"></span><span class="strut bottom" style="height:1.16112em;vertical-align:-0.35612em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="margin-right:0.19445em;top:-0.0005599999999999772em;">∫</span><span class="vlist"><span style="top:0.35612em;margin-right:0.05em;margin-left:-0.19445em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mop">cos</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p>
</li>
<li>
<p>Using Monte Carlo integration</p>
<p>使用蒙特卡罗积分</p>
<p>Large amount of sampling-Slow!</p>
<p>采样量大-慢！</p>
</li>
</ul>
<p><img src="5.48.webp" alt="webp"></p>
<h3 id="recall-brdf-function" tabindex="-1" id="Recall-BRDF-Function">Recall BRDF Function</h3>
L_{o}(\boldsymbol{x},\omega_{o})=\int_{H^{2}}f_{r}(\boldsymbol{x},\omega_{o},\omega_{i})L_{i}(\boldsymbol{x},\omega_{i})\cos\theta_{i}d\omega_{i}\\f_{r}=k_{d}f_{Lambert}+f_{CookTorrance}

<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>L</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{Lambert}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">L</span><span class="mord mathit">a</span><span class="mord mathit">m</span><span class="mord mathit">b</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> diffuse</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>C</mi><mi>o</mi><mi>o</mi><mi>k</mi><mi>T</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{CookTorrance}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">c</span><span class="mord mathit">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> specular</li>
</ul>
\begin{aligned}
L_{o}(x,\omega_{o})& =\int_{H^{2}}(k_{d}f_{Lambert}+f_{CookTorance})L_{i}(x,\omega_{i})\cos\theta_{i}d\omega_{i}  \\
&=\int_{H^{2}}k_{d}f_{Lambert}L_{i}(\boldsymbol{x},\omega_{i})\cos\theta_{i}d\omega_{i}+\int_{H^{2}}f_{CookTorrances}L_{i}(\boldsymbol{x},\omega_{i})\cos\theta_{i}d\omega_{i} \\
&=L_d(x,\omega_o)+L_s(x,\omega_o)
\end{aligned}
<h4 id="diffuse-irraiance-map" tabindex="-1" id="Diffuse-Irraiance-Map">Diffuse Irraiance Map</h4>
<ul>
<li>Irraiance Map</li>
</ul>
<p><img src="5.49.webp" alt="webp"></p>
<h4 id="specular-approximation" tabindex="-1" id="Specular-Approximation">Specular Approximation</h4>
<p><img src="5.50.webp" alt="webp"></p>
<h4 id="approximation%3A-part-(1%2F2)" tabindex="-1" id="Approximation-part-1-2">Approximation: part (1/2)</h4>
<p><img src="5.51.webp" alt="webp"></p>
<h4 id="approximation%3A-part-(2%2F2)" tabindex="-1" id="Approximation-part-2-2">Approximation: part (2/2)</h4>
<p><img src="5.52.webp" alt="webp"></p>
<h4 id="quick-shading-with-precomputation" tabindex="-1" id="Quick-Shading-with-Precomputation">Quick Shading with Precomputation</h4>
<p>​	通过预计算进行快速着色</p>
<p><img src="5.53.webp" alt="webp"></p>
<h4 id="shading-pbr-with-ibl" tabindex="-1" id="Shading-PBR-with-IBL">Shading PBR with IBL</h4>
<p>​	加入环境贴图后，效果更加真实。</p>
<p><img src="5.54.webp" alt="webp"></p>
<h3 id="classic-shadow-solution" tabindex="-1" id="Classic-Shadow-Solution">Classic Shadow Solution</h3>
<h4 id="big-world-and-cascade-shadow" tabindex="-1" id="Big-World-and-Cascade-Shadow">Big World and Cascade Shadow</h4>
<p><img src="5.55.webp" alt="webp"></p>
<ul>
<li>
<p>Partition the frustum into multiple frustums</p>
<p>将视锥体划分为多个视锥体</p>
</li>
<li>
<p>A shadow map is rendered for each sub frustum</p>
<p>为每个子视锥体渲染阴影贴图</p>
</li>
<li>
<p>The pixel shader then samples from the map that most closely matches the required resolution</p>
<p>像素着色器然后从与所需分辨率最匹配的贴图中进行采样</p>
</li>
</ul>
<h4 id="steps-of-cascade-shadow" tabindex="-1" id="Steps-of-Cascade-Shadow">Steps of Cascade Shadow</h4>
<p>​	层叠影阶</p>
<blockquote>
<p>​	Cascade Shadow Mapping（级联阴影映射）是一种用于实时渲染中实现高质量阴影的技术。它被广泛应用于游戏引擎和其他实时渲染应用程序中，以提供更逼真的场景光照效果。</p>
<p>​	Cascade Shadow Mapping 的基本思想是将场景中的光源视锥体（例如平行光源的视锥体）分成多个不同分辨率的子区域，每个子区域被称为一个级联（cascade）。然后，为每个级联计算一个独立的深度贴图（depth map），用于记录从光源视角下每个像素到场景中可见点的距离。</p>
<p>​	通常，级联的数量和分辨率会根据距离光源的远近而动态调整，以确保远处的物体能够得到足够高的深度分辨率，从而减少阴影的锯齿状边缘（aliasing），同时避免过度消耗资源。通常情况下，近处级联具有更高的分辨率，而远处级联具有较低的分辨率。</p>
<p>​	一旦每个级联的深度贴图都准备好了，就可以在渲染阴影的阶段使用它们。具体来说，对于每个要接受阴影的像素，都会根据其在世界空间中的位置和光源的视角来计算其在每个级联深度贴图中的深度值。然后，通过比较每个像素的深度值与相应级联深度贴图中的深度值，就可以确定像素是否在阴影中。</p>
</blockquote>
<p><img src="5.56.webp" alt="webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs C">splitFrustumToSubfrusta();<br>calculateOrthoProjectionsForEachSubfrustum();<br>renderShadowMapForEachSubfrustum();<br>renderScene();<br><br>vs_main() &#123;<br>	calculateWorldPosition()<br>&#125;<br><br>ps_main() &#123;<br>	transformWorldPositionsForEachProjections()<br>    	sampleAllShadowMaps()<br>        compareDepthAndLightingPixel()<br>        ...<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="blend-between-cascade-layers" tabindex="-1" id="Blend-between-Cascade-Layers">Blend between Cascade Layers</h4>
<p>​	级联层之间的混合</p>
<p><img src="5.57.webp" alt="webp"></p>
<ol>
<li>
<p>A visible seam can be seen where cascades overlap</p>
<p>级联重叠处可以看到明显的接缝</p>
</li>
<li>
<p>between cascade layers because the resolution does not match</p>
<p>级联层之间因为分辨率不匹配</p>
</li>
<li>
<p>The shader then linearly interpolates between the two values based on the pixel’s location in the blend band</p>
<p>然后，着色器根据像素在混合带中的位置在两个值之间进行线性插值</p>
</li>
</ol>
<h4 id="pros-and-cons-of-cascade-shadow" tabindex="-1" id="Pros-and-Cons-of-Cascade-Shadow">Pros and Cons of Cascade Shadow</h4>
<ul>
<li>
<p>Pros</p>
<ul>
<li>
<p>best way to prevalent errors with shadowing: perspective aliasing</p>
<p>解决阴影常见错误的最佳方法：透视锯齿</p>
</li>
<li>
<p>fast to generate depth map, 3x up when depth writing only</p>
<p>快速生成深度图，仅深度写入时提高 3 倍</p>
</li>
<li>
<p>provide fairly good results</p>
<p>提供相当好的结果</p>
</li>
</ul>
</li>
<li>
<p>Cons</p>
<ul>
<li>
<p>Nearly impossible to generate high quality area shadows</p>
<p>几乎不可能生成高质量的区域阴影</p>
</li>
<li>
<p>No colored shadows. Translucent surfaces cast opaque shadows</p>
<p>没有彩色阴影。半透明表面投射不透明阴影</p>
</li>
</ul>
</li>
</ul>
<h4 id="hard-shadow-vs-realistic-shadow" tabindex="-1" id="Hard-Shadow-vs-Realistic-Shadow">Hard Shadow vs Realistic Shadow</h4>
<p><img src="5.58.webp" alt="webp"></p>
<h4 id="pcf---percentage-closer-filter" tabindex="-1" id="PCF-Percentage-Closer-Filter">PCF - Percentage Closer Filter</h4>
<p>​	PCF - 百分比接近过滤器</p>
<blockquote>
<p>​	PCF（Percentage Closer Filter）是一种用于改善阴影质量的技术，特别是在阴影映射中使用。它的目的是减少阴影边缘的锯齿（aliasing），使阴影更加柔和和逼真。</p>
<p>​	阴影映射通常会生成一个深度贴图（depth map），用于记录从光源视角下到场景中各个点的距离。在渲染场景时，为了确定一个像素是否在阴影中，通常会比较场景中的点与光源的深度值。然而，简单地使用深度比较可能会导致锯齿状边缘，特别是在阴影投射到接近相机的表面上时。</p>
<p>​	PCF 解决了这个问题。它通过对深度贴图中的深度值进行多次采样，并计算每次采样时像素与深度值的关系，以确定像素是否在阴影中。这些采样通常是在深度贴图的附近进行的，并且通常是在一个较小的范围内。这样，即使像素与阴影边缘接近，也能够准确地检测出阴影的存在，从而减少锯齿状边缘的问题。</p>
</blockquote>
<p><img src="5.59.webp" alt="webp"></p>
<ul>
<li>
<p>Target problem</p>
<p>目标问题</p>
<ul>
<li>
<p>The shadows that result from shadow mapping aliasing is serious</p>
<p>阴影贴图锯齿导致的阴影很严重</p>
</li>
</ul>
</li>
<li>
<p>Basic idea</p>
<p>基本思想</p>
<ul>
<li>
<p>Sample from the shadow map around the current pixel and compare its depth to all the samples</p>
<p>从当前像素周围的阴影贴图进行采样，并将其深度与所有样本进行比较</p>
</li>
<li>
<p>By averaging out the results we get a smoother line between light and shadow</p>
<p>通过对结果进行平均，我们可以得到光影之间更平滑的线条</p>
</li>
</ul>
</li>
</ul>
<h4 id="pcss---percentage-closer-soft-shadow" tabindex="-1" id="PCSS-Percentage-Closer-Soft-Shadow">PCSS - Percentage Closer Soft Shadow</h4>
<p>​	PCSS - 百分比接近软阴影</p>
<blockquote>
<p>​	Percentage Closer Soft Shadow（PCSS）是一种用于实时渲染中生成柔和阴影的技术。它是 Percentage Closer Filter（PCF）的一种变体，旨在在阴影边缘产生更加柔和和逼真的效果。</p>
<p>​	PCSS 通过在每个像素处进行多个样本的深度比较，并根据深度比较结果和光源距离来计算阴影的柔和度。与传统的硬阴影相比，PCSS 考虑了阴影边缘周围的光线传播和遮挡，以模拟真实世界中光线的衍射和散射效应。</p>
<p>PCSS 的实现通常包括以下步骤：</p>
<ol>
<li><strong>生成阴影贴图（Shadow Map）：</strong> 首先，生成场景的深度贴图，用于记录从光源视角下到场景中各个点的距离。</li>
<li><strong>多样本采样：</strong> 在渲染阶段，对于每个要接受阴影的像素，进行多个样本的深度比较。这些样本通常位于阴影边缘周围，并且可以通过多次采样来模拟光线的传播。</li>
<li><strong>计算柔和阴影：</strong> 根据每个样本的深度比较结果以及光源与表面的距离，计算阴影的柔和度。通常，较远离光源的像素会产生较宽的阴影区域，而较接近光源的像素会产生较窄的阴影区域。</li>
<li><strong>混合阴影：</strong> 将多个样本的阴影值进行加权平均，以获得最终的柔和阴影结果。这样可以使阴影边缘呈现出逐渐变化的过渡效果，减少锯齿状边缘。</li>
</ol>
</blockquote>
<p><img src="5.60.webp" alt="webp"></p>
<ul>
<li>
<p>Target problem</p>
<p>目标问题</p>
<ul>
<li>
<p>Suffers from aliasing and under sampling artifacts</p>
<p>存在混叠和采样不足的问题</p>
</li>
</ul>
</li>
<li>
<p>Basic idea</p>
<p>基本思想</p>
<ul>
<li>
<p>Search the shadow map and average the depths that are closer to the light source</p>
<p>搜索阴影贴图并平均靠近光源的深度</p>
</li>
<li>
<p>Using a parallel planes approximation</p>
<p>使用平行平面近似</p>
</li>
</ul>
</li>
</ul>
<h4 id="variance-soft-shadow-map" tabindex="-1" id="Variance-Soft-Shadow-Map">Variance Soft Shadow Map</h4>
<p><img src="5.61.webp" alt="webp"></p>
<ul>
<li>
<p>Target problem</p>
<p>目标问题</p>
<ul>
<li>
<p>Rendering plausible soft shadow in real-time</p>
<p>实时渲染合理的软阴影</p>
</li>
</ul>
</li>
<li>
<p>Basic idea</p>
<p>基本思想</p>
<ul>
<li>
<p>Based on Chebyshev’s inequality, using the average and variance of depth, we can approximate the percentage of depth distribution directly instead of comparing a single depth to a particular region (PCSS)</p>
<p>基于切比雪夫不等式，使用深度的平均值和方差，我们可以直接近似深度分布的百分比，而不是将单个深度与特定区域进行比较（PCSS）</p>
</li>
</ul>
</li>
</ul>
<h4 id="summary-of-popular-aaa-rendering" tabindex="-1" id="Summary-of-Popular-AAA-Rendering">Summary of Popular AAA Rendering</h4>
<p>​	目前 3A 渲染广泛用到的技术：</p>
<ul>
<li>Lightmap + Light probe</li>
<li>PBR + IBL</li>
<li>Cascade shadow + VSSM</li>
</ul>
<h3 id="moving-wave-of-high-quality" tabindex="-1" id="Moving-Wave-of-High-Quality">Moving Wave of High Quality</h3>
<h4 id="quick-evolving-of-gpu" tabindex="-1" id="Quick-Evolving-of-GPU">Quick Evolving of GPU</h4>
<p>​	得益于 GPU 的发展，计算能力不断增强。</p>
<ul>
<li>
<p>More flexible new shader model</p>
<p>更灵活的新着色器模型</p>
<ul>
<li>
<p>Compute shader</p>
<p>计算着色器</p>
</li>
<li>
<p>Mesh shader</p>
<p>网格着色器</p>
</li>
<li>
<p>Ray-tracing shader</p>
<p>光线追踪着色器</p>
</li>
</ul>
</li>
<li>
<p>High performance parallel architecture</p>
<p>高性能并行架构</p>
<ul>
<li>
<p>Warp or wave architecture</p>
<p>扭曲或波浪结构</p>
</li>
</ul>
</li>
<li>
<p>Fully opened graphics APl</p>
<p>完全开放的图形 APl</p>
<ul>
<li>
<p>DirectX 12 and Vulkan</p>
<p>DirectX 12 和 Vulkan</p>
</li>
</ul>
</li>
</ul>
<h4 id="real-time-ray-tracing-on-gpu" tabindex="-1" id="Real-Time-Ray-Tracing-on-GPU">Real-Time Ray-Tracing on GPU</h4>
<p><img src="5.62.webp" alt="webp"></p>
<p>​	新的 GPU 支持实时光线追踪。</p>
<h4 id="real-time-global-lllumination" tabindex="-1" id="Real-Time-Global-lllumination">Real-Time Global lllumination</h4>
<p><img src="5.63.webp" alt="webp"></p>
<h4 id="more-complex-material-model" tabindex="-1" id="More-Complex-Material-Model">More Complex Material Model</h4>
<p><img src="5.64.webp" alt="webp"></p>
<h4 id="virtual-shadow-maps" tabindex="-1" id="Virtual-Shadow-Maps">Virtual Shadow Maps</h4>
<p><img src="5.65.webp" alt="webp"></p>
<h3 id="shader-management" tabindex="-1" id="Shader-Management">Shader Management</h3>
<h4 id="ocean-of-shaders" tabindex="-1" id="Ocean-of-Shaders">Ocean of Shaders</h4>
<p>​	大游戏里用到的 Shader 非常多。</p>
<h4 id="blow-of-shaders" tabindex="-1" id="Blow-of-Shaders">Blow of Shaders</h4>
<p>​	要求在每帧中渲染场景中的多个 shader。</p>
<h4 id="artist-create-infinite-more-shaders" tabindex="-1" id="Artist-Create-infinite-More-Shaders">Artist Create infinite More Shaders</h4>
<p>​	艺术家创造无限更多的着色器</p>
<h4 id="uber-shader-and-variants" tabindex="-1" id="Uber-Shader-and-Variants">Uber Shader and Variants</h4>
<p>​	Uber 着色器和变体</p>
<p>A combination of shader for all possible light types, render passes and material types</p>
<p>​	适用于所有可能的灯光类型、渲染通道和材质类型的着色器组合</p>
<ul>
<li>
<p>Shared many state and codes</p>
<p>共享许多状态和代码</p>
</li>
<li>
<p>Compile to many variant short shaders by pre-defined macro</p>
<p>通过预定义宏编译为许多变体短着色器</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-comment">// sky light</span><br><span class="hljs-meta">#<span class="hljs-keyword">if</span> ENABLE SKY LIGHT</span><br>    <span class="hljs-meta">#<span class="hljs-keyword">if</span> MATERIAL TWOSIDED &amp;&amp; LQ_TEXTURE_LIGHTMAP</span><br>    <span class="hljs-keyword">if</span>(NoL == <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br>    <span class="hljs-meta">#<span class="hljs-keyword">if</span> MATERIAL_SHADINGMODEL_SINGLELAYERWATER</span><br>        ShadingModelContext.WaterDiffuseIndirectLuminance += SkyDiffuselighting;<br>    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>        <br>    Color += SkyDiffuselighting * half3(ResolvedView.SkylightColor.rgb) * ShadingModelContext.DiffuseColor * MaterialA0;<br>    <span class="hljs-meta">#<span class="hljs-keyword">if</span> MATERIAL_TWOSIDED &amp;&amp; LQ_TEXTURE_LIGHTMAP</span><br>    &#125;<br>    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br></code></pre></td></tr></table></figure>
<h4 id="shader-variants-example-in-real-game" tabindex="-1" id="Shader-Variants-Example-In-Real-Game">Shader Variants Example In Real Game</h4>
<p>​	真实游戏中的着色器变体示例</p>
<p><img src="5.66.webp" alt="webp"></p>
<p>​	一大堆。为了降低耦合性，每个 shader 都是单独存在的。</p>
<h4 id="cross-platform-shader-compile" tabindex="-1" id="Cross-Platform-Shader-Compile">Cross Platform Shader Compile</h4>
<p><img src="5.67.webp" alt="webp"></p>
<p>​	写 shader 也演变出了一堆语言！</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/49069689">Shader 交叉编译之梦 - 知乎 (zhihu.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/KhronosGroup/SPIRV-Cross">KhronosGroup/SPIRV-Cross: SPIRV-Cross is a practical tool and library for performing reflection on SPIR-V and disassembling SPIR-V back to high level languages. (github.com)</a> 让 shader 语言能够交叉编译。</li>
</ul>
<h2 id="%E7%AC%AC%E5%85%AD%E8%8A%82(%E4%B8%8A)%EF%BC%9A%E6%B8%B8%E6%88%8F%E4%B8%AD%E5%9C%B0%E5%BD%A2%E5%A4%A7%E6%B0%94%E5%92%8C%E4%BA%91%E7%9A%84%E6%B8%B2%E6%9F%93" tabindex="-1" id="第六节-上-：游戏中地形大气和云的渲染">第六节(上)：游戏中地形大气和云的渲染</h2>
<p>​	MD 天书……</p>
<p><strong>Rendering on Game Engine</strong></p>
<h3 id="the-challenges-and-fun-of-rendering-the-beautiful-mother-nature" tabindex="-1" id="The-Challenges-and-Fun-of-Rendering-the-Beautiful-Mother-Nature">The Challenges and Fun of Rendering the Beautiful Mother Nature</h3>
<p>​	渲染美丽大自然的挑战和乐趣</p>
<h4 id="real-world-landscape" tabindex="-1" id="Real-World-Landscape">Real-World Landscape</h4>
<p><img src="6.1.webp" alt="webp"></p>
<ul>
<li>
<p>Huge geospatial scale</p>
<p>巨大的地理空间尺度</p>
</li>
<li>
<p>Rich geomorphological</p>
<p>地貌丰富</p>
<ul>
<li>
<p>Vegetation</p>
<p>植被</p>
</li>
<li>
<p>Rivers</p>
<p>河流</p>
</li>
<li>
<p>Undulating peaks</p>
<p>起伏的山峰</p>
</li>
<li>
<p>Alpine snow</p>
<p>高山雪</p>
</li>
<li>
<p>…</p>
</li>
</ul>
</li>
</ul>
<p>Too Complex for Rendering Using Traditional Mesh + Material</p>
<p>​	使用传统网格 + 材质渲染过于复杂</p>
<h4 id="environment-components-in-games" tabindex="-1" id="Environment-Components-in-Games">Environment Components in Games</h4>
<p><img src="6.2.webp" alt="webp"></p>
<h4 id="simple-idea---heightfield" tabindex="-1" id="Simple-Idea-Heightfield">Simple Idea - Heightfield</h4>
<p><img src="6.3.webp" alt="webp"></p>
<p>Height Map</p>
<p>​	高度图</p>
<p>Contour Map</p>
<p>​	等高线图</p>
<ul>
<li>
<p>Satellite image and google earth</p>
<p>卫星图像和谷歌地球</p>
</li>
</ul>
<h4 id="expressive-heightfield-terrains" tabindex="-1" id="Expressive-Heightfield-Terrains">Expressive Heightfield Terrains</h4>
<p>​	富有表现力的高度场地形</p>
<h4 id="render-terrain-with-heightfield" tabindex="-1" id="Render-Terrain-with-Heightfield">Render Terrain with Heightfield</h4>
<p>​	使用高度场渲染地形</p>
<p><img src="6.4.webp" alt="webp"></p>
<h4 id="adaptive-mesh-tessellation" tabindex="-1" id="Adaptive-Mesh-Tessellation">Adaptive Mesh Tessellation</h4>
<p>​	自适应网格细分</p>
<p><img src="6.5.webp" alt="webp"></p>
<p>​	fov 内的网格密集，外的不密集。</p>
<h4 id="two-golden-rules-of-optimization" tabindex="-1" id="Two-Golden-Rules-of-Optimization">Two Golden Rules of Optimization</h4>
<p>​	两条优化黄金法则</p>
<p><img src="6.6.webp" alt="webp"></p>
<p>View-dependent error bound</p>
<p>​	视图相关的错误界限</p>
<ul>
<li>
<p>Distance to camera and FoV</p>
<p>到相机和 FoV 的距离</p>
</li>
<li>
<p>Error compare to ground truth (pre-computation)</p>
<p>与真实情况相比的误差（预计算）</p>
</li>
</ul>
<h4 id="triangle-based-subdivision" tabindex="-1" id="Triangle-Based-Subdivision">Triangle-Based Subdivision</h4>
<p>​	基于三角形的细分</p>
<p><img src="6.7.webp" alt="webp"></p>
<h4 id="subdivision-and-t-junctions" tabindex="-1" id="Subdivision-and-T-Junctions">Subdivision and T-Junctions</h4>
<blockquote>
<p>​	T-Junctions（T 字连接）是在计算机图形学中用于描述三角形网格连接关系的术语。当两个或多个三角形共享一个边时，它们在连接点形成了 T 字型的结构。这种连接在三维网格模型的拓扑结构中相当常见。</p>
<p>​	T-Junctions 通常出现在网格的边缘、拐角或交叉点附近。它们可能会出现在几何体的建模、网格编辑、或者在进行几何操作（如网格合并、分割、细分等）时。在渲染阶段，T-Junctions 可能会导致一些问题，尤其是在基于三角形的图形渲染中，因为它们可能会导致不正确的图形拓扑和渲染结果。</p>
</blockquote>
<p><img src="6.8.webp" alt="webp"></p>
<p>Continuously partitioning triangles and their children based on the idea of binary trees</p>
<p>​	基于二叉树的思想连续划分三角形及其子节点</p>
<h4 id="triangle-based-subdivision-on-gpu" tabindex="-1" id="Triangle-Based-Subdivision-on-GPU">Triangle-Based Subdivision on GPU</h4>
<p><img src="6.9.webp" alt="webp"></p>
<center>54 x 54km terrarin on GPU using Unity game engine</center>
<p>​	根据 GPU 架构设计的算法。</p>
<h4 id="quadtree-based-subdivision" tabindex="-1" id="QuadTree-Based-Subdivision">QuadTree-Based Subdivision</h4>
<p>​	基于四叉树的细分</p>
<p><img src="6.10.webp" alt="webp"></p>
<p>Pros</p>
<ul>
<li>
<p>Easy to construct</p>
<p>易于建造</p>
</li>
<li>
<p>Easy management of data under geospatial, including objects culling and data streaming</p>
<p>轻松管理地理空间下的数据，包括对象剔除和数据流</p>
</li>
</ul>
<p>Cons</p>
<ul>
<li>
<p>Mesh subdivision is not as flexible as triangle mesh</p>
<p>网格细分不如三角形网格灵活</p>
</li>
<li>
<p>The grid level of the leaf nodes needs to be consistent</p>
<p>叶子节点的网格层级需要一致</p>
</li>
</ul>
<p><img src="6.11.webp" alt="webp"></p>
<h4 id="solving-t-junctions-among-quad-grids" tabindex="-1" id="Solving-T-Junctions-among-Quad-Grids">Solving T-Junctions among Quad Grids</h4>
<p>​	求解四边形网格之间的 T 型连接点</p>
<p><img src="6.12.webp" alt="webp"></p>
<p>Terrain Rendering with Quad Grid</p>
<p>​	使用四网格进行地形渲染</p>
<h4 id="triangulated-lrregular-network-(tln)" tabindex="-1" id="Triangulated-lrregular-Network-TlN">Triangulated lrregular Network (TlN)</h4>
<p>​	不规则三角网络 (TlN)</p>
<p><img src="6.13.webp" alt="webp"></p>
<h4 id="density-variants-in-tln" tabindex="-1" id="Density-Variants-in-TlN">Density Variants in TlN</h4>
<p>​	TlN 中的密度变量</p>
<p><img src="6.14.webp" alt="webp"></p>
<h4 id="triangulated-lrregular-network-vs.-adpative-tessellation" tabindex="-1" id="Triangulated-lrregular-Network-vs-Adpative-Tessellation">Triangulated lrregular Network vs. Adpative Tessellation</h4>
<p>​	不规则三角网络与自适应曲面细分</p>
<p><img src="6.15.webp" alt="webp"></p>
<p>Pros</p>
<ul>
<li>
<p>Easy in runtime rendeirng</p>
<p>易于运行时渲染</p>
</li>
<li>
<p>Less triangls in certain terrain types</p>
<p>某些地形类型中的三角形较少</p>
</li>
</ul>
<p><img src="6.16.webp" alt="webp"></p>
<p>Cons</p>
<ul>
<li>
<p>Requires certain pre-processing steps</p>
<p>需要一定的预处理步骤</p>
</li>
<li>
<p>Poor reusability</p>
<p>可重用性差</p>
</li>
</ul>
<h4 id="gpu-based-tessellation" tabindex="-1" id="GPU-Based-Tessellation">GPU-Based Tessellation</h4>
<p>​	基于 GPU 的曲面细分</p>
<p><img src="6.17.webp" alt="webp"></p>
<h4 id="hardware-tesselation" tabindex="-1" id="Hardware-Tesselation">Hardware Tesselation</h4>
<p>​	硬件曲面细分</p>
<p><img src="6.18.webp" alt="webp"></p>
<p><strong>Hul-Shader Stage</strong> - transforms basis functions from base mesh to surface patches</p>
<p>​	<strong>Hul-Shader Stage</strong> - 将基础函数从基础网格转换为表面补丁</p>
<p><strong>Tessellator Stage</strong> - produces a semi-regular tessellation pattern for each patch</p>
<p>​	<strong>Tessellator Stage</strong> - 为每个补丁生成半规则的镶嵌图案</p>
<p><strong>Domain-Shader Stage</strong> - a programmable shader stage that calculates the vertex position that corresponds to each domain sample</p>
<p>​	<strong>Domain-Shader Stage</strong> - 一个可编程着色器阶段，用于计算与每个域样本对应的顶点位置</p>
<p><img src="6.19.webp" alt="webp"></p>
<h4 id="mesh-shader-pipeline" tabindex="-1" id="Mesh-Shader-Pipeline">Mesh Shader Pipeline</h4>
<p><img src="6.20.webp" alt="webp"></p>
<ul>
<li>
<p><strong>Amplification Shader Stage</strong> - decides how many Mesh shader groups to run and passes data to those groups</p>
<p><strong>放大着色器阶段</strong> - 决定运行多少个网格着色器组并将数据传递到这些组</p>
</li>
<li>
<p><strong>Mesh Shader Stage</strong> - produces a semi-regulartessellation pattern for each patch, and outputscomprise vertices and primitives</p>
<p><strong>网格着色器阶段</strong> - 为每个补丁生成半规则曲面细分图案，输出包含顶点和图元</p>
</li>
</ul>
<h4 id="real-time-deformable-terrain" tabindex="-1" id="Real-Time-Deformable-Terrain">Real-Time Deformable Terrain</h4>
<p><img src="6.21.webp" alt="webp"></p>
<p>​	在游戏运行时，地表模型会改变（如车压路上）</p>
<h4 id="dig-a-hole-in-terrain" tabindex="-1" id="Dig-a-Hole-in-Terrain">Dig a Hole in Terrain</h4>
<p><img src="6.22.webp" alt="webp"></p>
<p>​	给地表挖洞。</p>
<h4 id="crazy-ldea---volumetric-representation" tabindex="-1" id="Crazy-ldea-Volumetric-Representation">Crazy ldea - Volumetric Representation</h4>
<p>​	疯狂的想法-体积表示</p>
<p><img src="6.23.webp" alt="webp"></p>
<p>In 3D computer graphics, a voxel represents a value on a regular grid in three-dimensional space. As pixels in a 2D bitmap, voxels themselves do not typically have their position (i.e. coordinates) explicitly encoded with their values</p>
<p>​	在 3D 计算机图形学中，体素表示三维空间中规则网格上的值。作为 2D 位图中的像素，体素本身通常不会使用其值显式编码其位置（即坐标）</p>
<h4 id="marching-cubes" tabindex="-1" id="Marching-Cubes">Marching Cubes</h4>
<p>​	行进立方体</p>
<p><img src="6.24.webp" alt="webp"></p>
<center>MARCHING CUBES: A HIGH RESOLUTION 3D SURFACE CONSTRUCTION ALGORITHM', Computer Graphics, volume 21, Number 4, July 1987</center>
<p>​	给模型作切片。</p>
<h4 id="transition-cell-lookup-table" tabindex="-1" id="Transition-Cell-Lookup-Table">Transition Cell Lookup Table</h4>
<p>​	过渡单元查找表</p>
<p><img src="6.25.webp" alt="webp"></p>
<p><img src="6.26.webp" alt="webp"></p>
<p>Transvoxel Algorithm</p>
<p>​	跨体素算法</p>
<ul>
<li>
<p>Constructs the triangulation of transition cells to form a lookup table, and uses this lookup table to do the triangulation of LOD voxel cubes</p>
<p>构造过渡单元的三角剖分以形成查找表，并使用该查找表进行 LOD 体素立方体的三角剖分</p>
</li>
</ul>
<p>Make AAA as Flexible as Minecraft??? :-)</p>
<p>​	我的世界是一个自由度很高的游戏，目前 3A 大作很难对场景环境做出改变。</p>
<h4 id="terrain-materials" tabindex="-1" id="Terrain-Materials">Terrain Materials</h4>
<p><img src="6.27.webp" alt="webp"></p>
<p>​	一个 Terrain 往往包含多种 Materials。</p>
<h4 id="simple-texture-splatting" tabindex="-1" id="Simple-Texture-Splatting">Simple Texture Splatting</h4>
<p>​	简单的纹理喷溅</p>
<p><img src="6.28.webp" alt="webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs C">float3 <span class="hljs-title function_">blend</span><span class="hljs-params">(float4 texturel,<span class="hljs-type">float</span> al, float4 texture2, <span class="hljs-type">float</span> a2)</span> &#123;<br>    <span class="hljs-keyword">return</span> texturel.rgb * al + texture2.rgb * a2;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​	terrain 上的纹理从一个过渡到另一个时，如果简单地使用混合，则平滑但不自然。</p>
<h4 id="advanced-texture-splatting" tabindex="-1" id="Advanced-Texture-Splatting">Advanced Texture Splatting</h4>
<p><img src="6.29.webp" alt="webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs C">float3 <span class="hljs-title function_">blend</span><span class="hljs-params">(float4 texture1, <span class="hljs-type">float</span> height1, float4 texture2, <span class="hljs-type">float</span> height2)</span> &#123;<br>    <span class="hljs-keyword">return</span> height1 &gt; height2 ? texture1.rgb : texture2.rgb;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​	根据高度图实现材质的过渡。</p>
<h4 id="advanced-texture-splatting---biased" tabindex="-1" id="Advanced-Texture-Splatting-Biased">Advanced Texture Splatting - Biased</h4>
<p><img src="6.30.webp" alt="webp"></p>
<p>​	引入 Height Bias。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs C">float3 <span class="hljs-title function_">blend</span><span class="hljs-params">(float4 texture1, <span class="hljs-type">float</span> height1, float4 texture2, <span class="hljs-type">float</span> height2)</span> &#123;<br>	<span class="hljs-type">float</span> depth = <span class="hljs-number">0.2</span>;<br>    <span class="hljs-type">float</span> ma = max(texture1.a + height1, texture2.a + height2) - depth;<br>    <span class="hljs-type">float</span> b1 = max(texture1.a + height1 - ma, <span class="hljs-number">0</span>);<br>    <span class="hljs-type">float</span> b2 = max(texture2.a + height2 - ma, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">return</span> (texture1.rgb * b1 + texture2.rgb * b2) / (b1 + b2);<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="sampling-from-material-texture-array" tabindex="-1" id="Sampling-from-Material-Texture-Array">Sampling from Material Texture Array</h4>
<p>​	从材质纹理数组采样</p>
<p><img src="6.31.webp" alt="webp"></p>
<h4 id="parallax-and-displacement-mapping" tabindex="-1" id="Parallax-and-Displacement-Mapping">Parallax and Displacement Mapping</h4>
<p>​	视差和位移贴图</p>
<p><img src="6.32.webp" alt="webp"></p>
<p>Parallax Mapping: Due to the height of the surface, the eye sees point B instead of pointA. lt creates a sense of dimensionality.</p>
<p>​	视差映射：由于表面的高度，眼睛看到的是 B 点而不是 A 点。它创造了一种维度感。</p>
<h4 id="expensive-material-blending" tabindex="-1" id="Expensive-Material-Blending">Expensive Material Blending</h4>
<p><img src="6.33.webp" alt="webp"></p>
<ul>
<li>
<p><strong>Many Texturing</strong> - Low performance whenmultiple materials are sampled too many times</p>
<p><strong>许多纹理</strong> - 对多种材质采样太多次时性能较低</p>
</li>
<li>
<p><strong>Huge Splat Map</strong> - We only see a small set ofterrain, but we load splat maps for 100square kminto video memory</p>
<p><strong>巨大的 Splat 地图</strong> - 我们只能看到一小部分地形，但我们将 100 平方公里的 Splat 地图加载到显存中</p>
</li>
</ul>
<h4 id="virtual-texture" tabindex="-1" id="Virtual-Texture">Virtual Texture</h4>
<blockquote>
<p>​	虚拟纹理（Virtual Texture）是一种用于实时图形渲染的技术，旨在解决在有限的显存中管理大量纹理数据的挑战。传统上，图形渲染中使用的纹理数据通常是预加载到显存中的，但这种方法在需要处理大规模纹理数据时会遇到限制，尤其是在高分辨率的场景中。</p>
<p>​	虚拟纹理通过将纹理数据分割成较小的块，并根据视野和需求动态地加载和卸载这些块，以优化显存利用率并允许处理大规模纹理数据。虚拟纹理技术的核心思想是将纹理数据存储在较大的物理存储介质（如硬盘或固态硬盘）中，然后根据需要将其部分加载到显存中供渲染使用。</p>
</blockquote>
<p><img src="6.34.webp" alt="webp"></p>
<ul>
<li>
<p>Build a virtual indexed texture to represent allblended terrain materials for whole scene</p>
<p>构建虚拟索引纹理来表示整个场景的所有混合地形材质</p>
</li>
<li>
<p>Only load materials data of tiles based on view-depend LOD</p>
<p>仅根据视图相关的 LOD 加载图块的材质数据</p>
</li>
<li>
<p>Pre-bake materials blending into tile and store them into physical textures</p>
<p>预烘烤混合到瓷砖中的材料并将其存储到物理纹理中</p>
</li>
</ul>
<h4 id="vt-implementation%2C-directstorage-%26-dma" tabindex="-1" id="VT-implementation-DirectStorage-DMA">VT implementation, DirectStorage &amp; DMA</h4>
<p>​	VT 实现、DirectStorage 和 DMA</p>
<p><img src="6.35.webp" alt="webp"></p>
<h4 id="floating-point-precision-error" tabindex="-1" id="Floating-point-Precision-Error">Floating-point Precision Error</h4>
<p>​	浮点精度误差</p>
<p><img src="6.36.webp" alt="webp"></p>
<p>​	计算中 float 的精度可能不够，导致很远的物体会出现波动。</p>
<h4 id="camera-relative-rendering" tabindex="-1" id="Camera-Relative-Rendering">Camera-Relative Rendering</h4>
<p><img src="6.37.webp" alt="webp"></p>
<ul>
<li>
<p>Translates objects by the negated world space camera position before any other geometric transformations affect them</p>
<p>在任何其他几何变换影响对象之前，通过否定的世界空间相机位置来平移对象</p>
</li>
<li>
<p>It then sets the world space camera position to 0 and modifies all relevant matrices accordingly</p>
<p>然后将世界空间相机位置设置为 0 并相应地修改所有相关矩阵</p>
</li>
</ul>
<h4 id="integration-with-other-world-elements-(rocks%2C-trees%2C-grass)" tabindex="-1" id="Integration-with-other-world-elements-rocks-trees-grass">Integration with other world elements (rocks, trees, grass)</h4>
<p>​	与其他世界元素（岩石、树木、草）的融合</p>
<h4 id="tree-rendering" tabindex="-1" id="Tree-Rendering">Tree Rendering</h4>
<p><img src="6.38.webp" alt="webp"></p>
<p>​	近处树模型复杂，远处简单</p>
<h4 id="decorator-rendering" tabindex="-1" id="Decorator-Rendering">Decorator Rendering</h4>
<p><img src="6.39.webp" alt="webp"></p>
<p>​	装饰渲染。近处复杂，远处简单</p>
<h4 id="road-and-decals-rendering" tabindex="-1" id="Road-and-Decals-Rendering">Road and Decals Rendering</h4>
<p>​	道路和贴花渲染</p>
<p><img src="6.40.webp" alt="webp"></p>
<p>Terrain Editing in Game Engine、Procedure Terrain creation……</p>
<h2 id="%E7%AC%AC%E5%85%AD%E8%8A%82(%E4%B8%8B)%EF%BC%9A%E6%B8%B8%E6%88%8F%E4%B8%AD%E5%9C%B0%E5%BD%A2%E5%A4%A7%E6%B0%94%E5%92%8C%E4%BA%91%E7%9A%84%E6%B8%B2%E6%9F%93" tabindex="-1" id="第六节-下-：游戏中地形大气和云的渲染">第六节(下)：游戏中地形大气和云的渲染</h2>
<h3 id="sky-and-atmosphere" tabindex="-1" id="Sky-and-Atmosphere">Sky and Atmosphere</h3>
<h4 id="how-to-%E2%80%9Cpaint%E2%80%9D-everything-in-the-sky" tabindex="-1" id="How-to-“Paint”-Everything-in-the-Sky">How to “Paint” Everything in the Sky</h4>
<p><img src="6.41.webp" alt="webp"></p>
<p>​	主要讲渲染天空和云。</p>
<h3 id="atmosphere" tabindex="-1" id="Atmosphere">Atmosphere</h3>
<h4 id="analytic-atmosphere-appearance-modeling" tabindex="-1" id="Analytic-Atmosphere-Appearance-Modeling">Analytic Atmosphere Appearance Modeling</h4>
<p>​	大气外观分析建模</p>
<p><img src="6.42.webp" alt="webp"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><mrow><mi mathvariant="double-struck">F</mi></mrow><mo>(</mo><mi>θ</mi><mo separator="true">,</mo><mi>γ</mi><mo>)</mo><mo>=</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>A</mi><msup><mi>e</mi><mrow><mfrac><mrow><mi>B</mi></mrow><mrow><mi>cos</mi><mi>θ</mi><mo>+</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn></mrow></mfrac></mrow></msup><mo>)</mo><mo>⋅</mo><mo>(</mo><mi>C</mi><mo>+</mo><mi>D</mi><msup><mi>e</mi><mrow><mi>E</mi><mi>γ</mi></mrow></msup><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>+</mo><mi>F</mi><msup><mi>cos</mi><mn>2</mn></msup><mi>γ</mi><mo>+</mo><mi>G</mi><mo>⋅</mo><mi>χ</mi><mo>(</mo><mi>H</mi><mo separator="true">,</mo><mi>γ</mi><mo>)</mo><mo>+</mo><mi>I</mi><mo>⋅</mo><msup><mi>cos</mi><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></msup><mi>θ</mi><mo>)</mo></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{aligned}
\mathbb{F}(\theta,\gamma)=&amp; (1+Ae^{\frac{B}{\cos\theta+0.01}})\cdot(C+De^{E\gamma}+  \\
&amp;+F\cos^2\gamma+G\cdot\chi(H,\gamma)+I\cdot\cos^{\frac{1}{2}}\theta)
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6307425em;"></span><span class="strut bottom" style="height:2.7614850000000004em;vertical-align:-1.1307425000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6002775em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbb">F</span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span><span class="mrel">=</span></span></span><span style="top:0.7707425000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6002775em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mord mathit">A</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mop">cos</span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mbin">+</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.22142857142857147em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">⋅</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span></span></span><span style="top:0.7707425000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mop"><span class="mop">cos</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mbin">+</span><span class="mord mathit">G</span><span class="mbin">⋅</span><span class="mord mathit">χ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mbin">⋅</span><span class="mop"><span class="mop">cos</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord reset-scriptstyle scriptstyle uncramped"><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22142857142857142em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-scriptstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>λ</mi></mrow></msub><mo>=</mo><mrow><mi mathvariant="double-struck">F</mi></mrow><mo>(</mo><mi>θ</mi><mo separator="true">,</mo><mi>γ</mi><mo>)</mo><mo>⋅</mo><msub><mi>L</mi><mrow><mi>M</mi><mi>λ</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{\lambda}=\mathbb{F}(\theta,\gamma)\cdot L_{M\lambda}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">λ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbb">F</span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">λ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>用这么个方程就表示了整个大气外观！</p>
<p>Pros</p>
<ul>
<li>
<p>Calculation is simple and efficient</p>
<p>计算简单高效</p>
</li>
</ul>
<p>Cons</p>
<ul>
<li>
<p>Limited to ground view</p>
<p>仅限地面视图</p>
</li>
<li>
<p>Atmosphere parameters can’t be changed freely</p>
<p>气氛参数不能随意更改</p>
</li>
</ul>
<h4 id="participating-media" tabindex="-1" id="Participating-Media">Participating Media</h4>
<p>​	参与媒体</p>
<p><img src="6.42.webp" alt="webp"></p>
<p>Volume filled with particles</p>
<p>​	充满颗粒的体积</p>
<p>Interact differently with light depending on its composition</p>
<p>​	与光的相互作用不同，具体取决于其成分</p>
<h4 id="how-light-interacts-with-participating-media-particles%3F" tabindex="-1" id="How-Light-Interacts-with-Participating-Media-Particles">How Light Interacts with Participating Media Particles?</h4>
<p>​	光如何与参与的介质粒子相互作用？</p>
<p><img src="6.44.webp" alt="webp"></p>
<ul>
<li>
<p>Absorption</p>
<p>吸收</p>
</li>
<li>
<p>Out-scattering</p>
<p>外散射</p>
</li>
<li>
<p>Emission</p>
<p>排放</p>
</li>
<li>
<p>In-scattering</p>
<p>内散射</p>
</li>
</ul>
<h4 id="volume-rendering-equation-(vre)" tabindex="-1" id="Volume-Rendering-Equation-VRE">Volume Rendering Equation (VRE)</h4>
<p>​	体绘制方程 (VRE)</p>
<p><img src="6.45.webp" alt="webp"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>P</mi><mo separator="true">,</mo><mi>ω</mi><mo>)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>d</mi></mrow></msubsup><mi>T</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>[</mo><msub><mi>σ</mi><mrow><mi>a</mi></mrow></msub><mo>⋅</mo><msub><mi>L</mi><mrow><mi>e</mi></mrow></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>ω</mi><mo>)</mo><mo>+</mo><msub><mi>σ</mi><mrow><mi>s</mi></mrow></msub><mo>⋅</mo><msub><mi>L</mi><mrow><mi>i</mi></mrow></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>ω</mi><mo>)</mo><mo>]</mo><mi>d</mi><mi>x</mi><mo>+</mo><mi>T</mi><mo>(</mo><mi>M</mi><mo>)</mo><mi>L</mi><mo>(</mo><mi>M</mi><mo separator="true">,</mo><mi>ω</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">L(P,\omega)=\int_{x=0}^{d}T(x)[\sigma_{a}\cdot L_{e}(x,\omega)+\sigma_{s}\cdot L_{i}(x,\omega)]dx+T(M)L(M,\omega)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4601079999999997em;"></span><span class="strut bottom" style="height:2.3723579999999997em;vertical-align:-0.91225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="op-symbol large-op mop" style="margin-right:0.44445em;top:-0.0011249999999999316em;">∫</span><span class="vlist"><span style="top:0.91225em;margin-left:-0.44445em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span><span style="top:-0.9739999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">a</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mclose">]</span><span class="mord mathit">d</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mclose">)</span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><msubsup><mo>∫</mo><mi>x</mi><mi>P</mi></msubsup><msub><mi>σ</mi><mi>t</mi></msub><mo>(</mo><mi>s</mi><mo>)</mo><mi>d</mi><mi>s</mi></mrow></msup></mrow><annotation encoding="application/x-tex">T(x)=e^{-\int_x^P\sigma_t(s)ds}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.047965em;"></span><span class="strut bottom" style="height:1.297965em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mop"><span class="op-symbol small-op mop" style="margin-right:0.19445em;top:0.07444000000000003em;">∫</span><span class="vlist"><span style="top:0.35612em;margin-left:-0.19445em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">x</span></span></span><span style="top:-0.41900000000000004em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>Transmittance: the net reduction factor from absorption and out-scattering</p>
<p>​	透射率：吸收和外散射的净减少因子</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi></mrow></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>ω</mi><mo>)</mo><mo>=</mo><msub><mo>∫</mo><mrow><msup><mi>S</mi><mrow><mn>2</mn></mrow></msup></mrow></msub><msub><mi>f</mi><mrow><mi>p</mi></mrow></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>ω</mi><mo separator="true">,</mo><msup><mi>ω</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>)</mo><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>ω</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>)</mo><mi>d</mi><msup><mi>ω</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">L_{i}(x,\omega)=\int_{S^{2}}f_{p}(x,\omega,\omega^{\prime})L(x,\omega^{\prime})d\omega^{\prime}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.27225em;vertical-align:-0.91225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="op-symbol large-op mop" style="margin-right:0.44445em;top:-0.0011249999999999316em;">∫</span><span class="vlist"><span style="top:0.91225em;margin-right:0.05em;margin-left:-0.44445em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>The net increase factor from in-scattering</p>
<p>​	内散射的净增加因子</p>
<h4 id="real-physics-in-atmosphere" tabindex="-1" id="Real-Physics-in-Atmosphere">Real Physics in Atmosphere</h4>
<p><img src="6.46.webp" alt="webp"></p>
<p>学习计算机图形学还要对气象学有所涉猎！</p>
<h4 id="scattering-types" tabindex="-1" id="Scattering-Types">Scattering Types</h4>
<p>​	散射类型</p>
<p><img src="6.47.webp" alt="webp"></p>
<ul>
<li>
<p>Rayleigh Scattering</p>
<p>瑞利散射</p>
<p>Scattering of light by particles that have a diameter <strong>much smaller than</strong> the wavelength of the radiation (eg. air molecules)</p>
<p>直径<strong>远小于</strong>辐射波长的粒子（例如空气分子）对光进行散射</p>
</li>
<li>
<p>Mie scattering</p>
<p>米氏散射</p>
<p>Scattering of light by particles that have a diameter <strong>similar to or larger than</strong> the wavelength of the incident light (eg. aerosols)</p>
<p>直径<strong>类似于或大于</strong>入射光波长的颗粒（例如气溶胶）对光进行散射</p>
</li>
</ul>
<h4 id="rayleigh-scattering" tabindex="-1" id="Rayleigh-Scattering">Rayleigh Scattering</h4>
<p>​	瑞利散射</p>
<p><img src="6.48.webp" alt="webp"></p>
<ul>
<li>
<p>Certain directions receive more light than others front-back symmetry</p>
<p>某些方向比其他方向接收更多的光线，前后对称</p>
</li>
<li>
<p>Shorter wavelengths (eg. blue) are scattered more strongly than longer wavelengths (eg.red)</p>
<p>较短波长（例如蓝色）比较长波长（例如红色）散射更强烈</p>
</li>
</ul>
<p><img src="6.49.webp" alt="webp"></p>
<h4 id="why-sky-is-blue" tabindex="-1" id="Why-Sky-is-Blue">Why Sky is Blue</h4>
<p><img src="6.50.webp" alt="webp"></p>
<p>​	由于大气层的存在，折射出蓝色，直射出红色。</p>
<h4 id="mie-scattering" tabindex="-1" id="Mie-Scattering">Mie Scattering</h4>
<p>​	米氏散射</p>
<p><img src="6.51.webp" alt="webp"></p>
<ul>
<li>
<p>Scatter light of all wavelength nearly equally</p>
<p>几乎均匀地散射所有波长的光</p>
</li>
<li>
<p>Exhibit a strong forward directivity</p>
<p>表现出强烈的前向方向性</p>
</li>
</ul>
<h4 id="mie-scattering-equation" tabindex="-1" id="Mie-Scattering-Equation">Mie Scattering Equation</h4>
<p><img src="6.52.webp" alt="webp"></p>
<h4 id="mie-scattering-in-daily-life" tabindex="-1" id="Mie-Scattering-in-Daily-Life">Mie Scattering in Daily Life</h4>
<p>​	日常生活中的三重散射</p>
<p><img src="6.53.webp" alt="webp"></p>
<ul>
<li>
<p>Exhibit a strong forward directivity (halo effects around sun)</p>
<p>表现出强烈的前向方向性（太阳周围的光晕效应）</p>
</li>
<li>
<p>Scatter light of all wavelength nearly equally (fog effects)</p>
<p>几乎均匀地散射所有波长的光（雾效应）</p>
</li>
</ul>
<h4 id="variant-air-molecules-absorption" tabindex="-1" id="Variant-Air-Molecules-Absorption">Variant Air Molecules Absorption</h4>
<p>​	不同的空气分子吸收</p>
<p><img src="6.54.webp" alt="webp"></p>
<ul>
<li>
<p>Ozone (O3)
Absorb strongly at longer wavelengths to filter out the reds, oranges, yellows</p>
<p>强烈吸收较长波长，滤除红色、橙色、黄色</p>
</li>
<li>
<p>Methane (CH4)</p>
<p>Well-known for absorbing red light</p>
<p>以吸收红光而闻名</p>
</li>
</ul>
<h4 id="single-scattering-vs.-multi-scattering" tabindex="-1" id="Single-Scattering-vs-Multi-Scattering">Single Scattering vs. Multi Scattering</h4>
<p><img src="6.55.webp" alt="webp"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mi>A</mi><mi>B</mi></msubsup><msub><mi>L</mi><mrow><mi>P</mi><mo>−</mo><mo>&gt;</mo><mi>A</mi></mrow></msub><mi>d</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">L_1=\int_A^BL_{P-&gt;A}ds
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.452331em;"></span><span class="strut bottom" style="height:2.3645810000000003em;vertical-align:-0.91225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop"><span class="op-symbol large-op mop" style="margin-right:0.44445em;top:-0.0011249999999999316em;">∫</span><span class="vlist"><span style="top:0.91225em;margin-left:-0.44445em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span style="top:-0.9740000000000001em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mbin">−</span><span class="mrel">&gt;</span><span class="mord mathit">A</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">d</span><span class="mord mathit">s</span></span></span></span></span></p>
<p><img src="6.56.webp" alt="webp"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msubsup><mo>∫</mo><mrow><mi>A</mi></mrow><mrow><mi>B</mi></mrow></msubsup><msub><mo>∫</mo><mrow><mn>4</mn><mi>π</mi></mrow></msub><msub><mi>L</mi><mrow><mi>n</mi></mrow></msub><mo>(</mo><mi>p</mi><mo separator="true">,</mo><msup><mi>v</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>)</mo><mo>⋅</mo><mi>S</mi><mo>(</mo><mi>λ</mi><mo separator="true">,</mo><mi>θ</mi><mo separator="true">,</mo><mi>h</mi><mo>)</mo><mo>⋅</mo><mi>T</mi><mo>(</mo><mi>p</mi><mo>→</mo><mi>A</mi><mo>)</mo><mi>d</mi><msup><mi>v</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mi>d</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">L_{n+1}=\int_{A}^{B}\int_{4\pi}L_{n}(p,v^{\prime})\cdot S(\lambda,\theta,h)\cdot T(p\to A)dv^{\prime}ds
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.452331em;"></span><span class="strut bottom" style="height:2.3645810000000003em;vertical-align:-0.91225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop"><span class="op-symbol large-op mop" style="margin-right:0.44445em;top:-0.0011249999999999316em;">∫</span><span class="vlist"><span style="top:0.91225em;margin-left:-0.44445em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">A</span></span></span></span><span style="top:-0.9740000000000001em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop"><span class="op-symbol large-op mop" style="margin-right:0.44445em;top:-0.0011249999999999316em;">∫</span><span class="vlist"><span style="top:0.91225em;margin-right:0.05em;margin-left:-0.44445em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">4</span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">p</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mbin">⋅</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">p</span><span class="mrel">→</span><span class="mord mathit">A</span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">d</span><span class="mord mathit">s</span></span></span></span></span></p>
<p><img src="6.57.webp" alt="webp"></p>
<h4 id="ray-marching" tabindex="-1" id="Ray-Marching">Ray Marching</h4>
<ul>
<li>
<p><strong>Ray marching</strong> is a popular method to integrate function along a path</p>
<p><strong>射线行进</strong>是一种沿路径集成功能的流行方法</p>
</li>
<li>
<p>We use ray marching to calculate final radiance for a given point by single scattering</p>
<p>我们使用光线行进通过单次散射计算给定点的最终辐射率</p>
</li>
<li>
<p>The integrated radiance is usually stored in <strong>look-up tables (LUT)</strong></p>
<p>综合辐射率通常存储在**查找表（LUT）**中</p>
</li>
</ul>
<p><img src="6.58.webp" alt="webp"></p>
<h4 id="precomputed-atmospheric-scattering" tabindex="-1" id="Precomputed-Atmospheric-Scattering">Precomputed Atmospheric Scattering</h4>
<p>​	预先计算的大气散射</p>
<p><img src="6.59.webp" alt="webp"></p>
<p><img src="6.60.webp" alt="webp"></p>
<p><img src="6.61.webp" alt="webp"></p>
<h4 id="challenges-of-precomputed-atmospheric-scattering" tabindex="-1" id="Challenges-of-Precomputed-Atmospheric-Scattering">Challenges of Precomputed Atmospheric Scattering</h4>
<p>​	预计算大气散射的挑战</p>
<ul>
<li>
<p>Precomputation Cost</p>
<p>预计算成本</p>
<ul>
<li>
<p>Multi-scattering iterations are very expensive</p>
<p>多次散射迭代非常昂贵</p>
</li>
<li>
<p>Hard to generate atmosphere LUT on low-end devices (ie. mobile)</p>
<p>难以在低端设备（即移动设备）上生成氛围 LUT</p>
</li>
</ul>
</li>
<li>
<p>Authoring and Dynamic Adjustment of Environments</p>
<p>环境的创作和动态调整</p>
<ul>
<li>
<p>Artist can’t change scattering coefficients on the fly</p>
<p>艺术家无法即时更改散射系数</p>
</li>
<li>
<p>Hard to render effects like weather from sunny to rain fog, space travel among planets</p>
<p>难以渲染天气从晴朗到雨雾、行星间太空旅行等效果</p>
</li>
</ul>
</li>
<li>
<p>Runtime Rendering Cost</p>
<p>运行时渲染成本</p>
<ul>
<li>
<p>Expensive per-pixel multi high dimensional texture sampling for transmittance LUT and multi scattering LUT (always need to down-sample for efficiency)</p>
<p>昂贵的每像素多高维纹理采样，用于透射 LUT 和多散射 LUT（始终需要下采样以提高效率）</p>
</li>
</ul>
</li>
</ul>
<h4 id="production-friendly-quick-sky-and-atmosphere-rendering" tabindex="-1" id="Production-Friendly-Quick-Sky-and-Atmosphere-Rendering">Production Friendly Quick Sky and Atmosphere Rendering</h4>
<p>​	制作友好的快速天空和大气渲染</p>
<p><img src="6.62.webp" alt="webp"></p>
<p><img src="6.63.webp" alt="webp"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><msub><mi>G</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>G</mi><mrow><mi>n</mi></mrow></msub><mo>∗</mo><msub><mi>f</mi><mrow><mi>m</mi><mi>s</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mrow><msub><mi mathvariant="bold">F</mi><mrow><mi mathvariant="bold">m</mi><mi mathvariant="bold">s</mi></mrow></msub></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mrow><msub><mi mathvariant="bold">f</mi><mrow><mi mathvariant="bold">m</mi><mi mathvariant="bold">s</mi></mrow></msub></mrow><mo>+</mo><mrow><msubsup><mi mathvariant="bold">f</mi><mrow><mi mathvariant="bold">m</mi><mi mathvariant="bold">s</mi></mrow><mrow><mn mathvariant="bold">2</mn></mrow></msubsup></mrow><mo>+</mo><mrow><msubsup><mi mathvariant="bold">f</mi><mrow><mi mathvariant="bold">m</mi><mi mathvariant="bold">s</mi></mrow><mrow><mn mathvariant="bold">3</mn></mrow></msubsup></mrow><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>1</mn><mo>−</mo><mrow><msub><mi mathvariant="bold">f</mi><mrow><mi mathvariant="bold">m</mi><mi mathvariant="bold">s</mi></mrow></msub></mrow></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><msub><mi mathvariant="normal">Ψ</mi><mrow><mrow><mi mathvariant="bold">m</mi><mi mathvariant="bold">s</mi></mrow></mrow></msub><mo>=</mo><mrow><msub><mi mathvariant="bold">L</mi><mrow><msup><mn mathvariant="bold">2</mn><mrow><mi mathvariant="bold">n</mi><mi mathvariant="bold">d</mi></mrow></msup><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">r</mi></mrow></msub></mrow><mrow><msub><mi mathvariant="bold">F</mi><mrow><mi mathvariant="bold">m</mi><mi mathvariant="bold">s</mi></mrow></msub></mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{aligned}&amp;G_{n+1}=G_{n}*f_{ms}\\&amp;\mathbf{F_{ms}}=1+\mathbf{f_{ms}}+\mathbf{f_{ms}^{2}}+\mathbf{f_{ms}^{3}}+...=\frac{1}{1-\mathbf{f_{ms}}}\\&amp;\Psi_{\mathbf{ms}}=\mathbf{L_{2^{nd}order}}\mathbf{F_{ms}}\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.5287200000000003em;"></span><span class="strut bottom" style="height:4.557440000000001em;vertical-align:-2.0287200000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.6887200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:-0.007279999999999953em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:1.6687200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.6887200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:-0.007279999999999953em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathbf">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf">m</span><span class="mord mathbf">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf">m</span><span class="mord mathbf">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span><span class="vlist"><span style="top:0.247em;margin-left:-0.10903em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf">m</span><span class="mord mathbf">s</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathbf">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span><span class="vlist"><span style="top:0.247em;margin-left:-0.10903em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf">m</span><span class="mord mathbf">s</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathbf">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf">m</span><span class="mord mathbf">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span style="top:1.6687200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mord mathrm">Ψ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf">m</span><span class="mord mathbf">s</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathbf">L</span><span class="vlist"><span style="top:0.2047199999999999em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathbf">2</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathbf">n</span><span class="mord mathbf">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathbf">o</span><span class="mord mathbf">r</span><span class="mord mathbf">d</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathbf">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf">m</span><span class="mord mathbf">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></span></p>
<p>Simplify Multi-scattering Assumption</p>
<p>​	简化多重散射假设</p>
<ul>
<li>
<p>Scattering events with order greater or equal to 2 are executed using an <strong>isotropic phase function</strong></p>
<p>使用<strong>各向同性相位函数</strong>执行阶数大于或等于 2 的散射事件</p>
</li>
<li>
<p>All points within the neighborhood of the position wecurrently shade <strong>receive the same amount of second order scattered light</strong></p>
<p>当前阴影位置附近的所有点<strong>接收相同量的二阶散射光</strong></p>
</li>
<li>
<p><strong>Visibility is ignored</strong></p>
<p><strong>忽略可见性</strong></p>
</li>
</ul>
<p><img src="6.64.webp" alt="webp"></p>
<p>Fixed view position and sun position to remove 2 dimensions out of LUT</p>
<p>​	固定视图位置和太阳位置以从 LUT 中删除 2 个维度</p>
<p><img src="6.65.webp" alt="webp"></p>
<ul>
<li>
<p>Generated a 3D LUT to evaluate aerial-perspective effects by ray marching</p>
<p>生成 3D LUT 以通过光线行进评估空气透视效果</p>
</li>
</ul>
<h4 id="good-balance-of-performance-and-effect" tabindex="-1" id="Good-Balance-of-Performance-and-Effect">Good Balance of Performance and Effect</h4>
<p>​	性能与效果的良好平衡</p>
<p><img src="6.66.webp" alt="webp"></p>
<h3 id="%E2%80%9Cpaint%E2%80%9D-cloud" tabindex="-1" id="“Paint”-Cloud">“Paint” Cloud</h3>
<h4 id="cloud-type" tabindex="-1" id="Cloud-Type">Cloud Type</h4>
<p><img src="6.67.webp" alt="webp"></p>
<p>​	云被分成了这么多种。</p>
<h4 id="mesh-based-cloud-modeling" tabindex="-1" id="Mesh-Based-Cloud-Modeling">Mesh-Based Cloud Modeling</h4>
<p>​	基于网格的云建模</p>
<p><img src="6.68.webp" alt="webp"></p>
<p>Pros</p>
<ul>
<li>
<p>High quality</p>
<p>高质量</p>
</li>
</ul>
<p>Cons</p>
<ul>
<li>
<p>Overall expensive</p>
<p>代价高</p>
</li>
<li>
<p>Do not support dynamic weather</p>
<p>不支持动态天气</p>
</li>
</ul>
<h4 id="billboard-cloud" tabindex="-1" id="Billboard-Cloud">Billboard Cloud</h4>
<p><img src="6.69.webp" alt="webp"></p>
<p>​	早期游戏使用贴图描述云。</p>
<p>Pros</p>
<ul>
<li>
<p>Efficient</p>
<p>高效的</p>
</li>
</ul>
<p>Cons</p>
<ul>
<li>
<p>Limited visual effect</p>
<p>视觉效果有限</p>
</li>
<li>
<p>Limited cloud type</p>
<p>有限的云类型</p>
</li>
</ul>
<h4 id="volumetric-cloud-modeling" tabindex="-1" id="Volumetric-Cloud-Modeling">Volumetric Cloud Modeling</h4>
<p>​	体积云建模</p>
<p><img src="6.70.webp" alt="webp"></p>
<p>Pros</p>
<ul>
<li>
<p>Realistic cloud shapes</p>
<p>逼真的云形状</p>
</li>
<li>
<p>Large scale clouds possible</p>
<p>可能出现大规模云</p>
</li>
<li>
<p>Dynamic weather supported</p>
<p>支持动态天气</p>
</li>
<li>
<p>Dynamic volumetric lighting and shadowing</p>
<p>动态体积照明和阴影</p>
</li>
</ul>
<p>Cons</p>
<ul>
<li>
<p>Efficiency must be considered</p>
<p>必须考虑效率</p>
</li>
</ul>
<h4 id="weather-texture" tabindex="-1" id="Weather-Texture">Weather Texture</h4>
<p><img src="6.71.webp" alt="webp"></p>
<h4 id="noise-functions" tabindex="-1" id="Noise-Functions">Noise Functions</h4>
<p><img src="6.72.webp" alt="webp"></p>
<h4 id="cloud-density-model" tabindex="-1" id="Cloud-Density-Model">Cloud Density Model</h4>
<p><img src="6.73.webp" alt="webp"></p>
<h4 id="rednering-cloud-by-ray-marching" tabindex="-1" id="Rednering-Cloud-by-Ray-Marching">Rednering Cloud by Ray Marching</h4>
<p><img src="6.74.webp" alt="webp"></p>
<h2 id="%E7%AC%AC%E4%B8%83%E8%8A%82%EF%BC%9A%E6%B8%B8%E6%88%8F%E4%B8%AD%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF%E3%80%81%E5%90%8E%E5%A4%84%E7%90%86%E5%92%8C%E5%85%B6%E4%BB%96%E7%9A%84%E4%B8%80%E5%88%87" tabindex="-1" id="第七节：游戏中渲染管线、后处理和其他的一切">第七节：游戏中渲染管线、后处理和其他的一切</h2>
<h3 id="ambient-occlusion" tabindex="-1" id="Ambient-Occlusion">Ambient Occlusion</h3>
<p>​	环境光遮蔽</p>
<p><img src="7.1.webp" alt="webp"></p>
<blockquote>
<p>​	环境光遮蔽（Ambient Occlusion）是一种计算机图形学中的技术，用于模拟光线在环境中传播时，<strong>由于物体之间的遮挡而导致的阴影效果</strong>。它可以增强场景的真实感和细节，使得物体之间的联系更加紧密。</p>
<p>​	简单来说，环境光遮蔽就是在渲染场景时，考虑物体表面在环境光照射下的遮挡情况，对每个像素点进行采样，并计算出该像素点受到的周围物体的影响程度，最终得到一张带有阴影效果的图像。</p>
</blockquote>
<ul>
<li>
<p>Approximation of attenuation of ambient light due to occlusion</p>
<p>由于遮挡而导致的环境光衰减的近似值</p>
</li>
</ul>
<p><img src="7.2.webp" alt="webp"></p>
<h4 id="precomputed-ao" tabindex="-1" id="Precomputed-AO">Precomputed AO</h4>
<p>Using ray tracing to compute the AO offline and store the result into texture, which is widely used in object modeling process</p>
<p>​	利用光线追踪<strong>离线计算</strong> AO 并将结果存储到纹理中，广泛应用于物体建模过程。（空间换时间）</p>
<ul>
<li>
<p>Extra storage cost</p>
<p>额外的存储费用</p>
</li>
<li>
<p>Only apply to static object</p>
<p>仅适用于静态对象</p>
</li>
</ul>
<p><img src="7.3.webp" alt="webp"></p>
<h4 id="screen-space-ambient-occlusion-(ssao)" tabindex="-1" id="Screen-Space-Ambient-Occlusion-SSAO">Screen Space Ambient Occlusion (SSAO)</h4>
<p>​	屏幕空间环境光遮挡（SSAO）</p>
<p><img src="7.4.webp" alt="webp"></p>
<p><img src="7.5.webp" alt="webp"></p>
<ul>
<li>
<p>Generate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> random samples in a sphere around eachpixel <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span></span></span></span> in view space</p>
<p>在视图空间中每个像素 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span></span></span></span> 周围的球体中生成 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> 个随机样本</p>
</li>
<li>
<p>Test sample occlusions by comparing depth against depth buffer</p>
<p>通过将深度与深度缓冲区进行比较来测试样本遮挡</p>
</li>
<li>
<p>Average visibility of sample points to approximate AO</p>
<p>采样点的平均可见度以近似 AO</p>
</li>
</ul>
<h4 id="ssao%2B" tabindex="-1" id="SSAO">SSAO+</h4>
<p><img src="7.6.webp" alt="webp"></p>
<ul>
<li>
<p>Recall the AO equation is acutally done on the normal-oriented hemisphere</p>
<p>回想一下 AO 方程实际上是在法向半球上完成的</p>
</li>
</ul>
<p>​	于是对 SSAO 进行改进，只在半球上采样。</p>
<p><img src="7.7.webp" alt="webp"></p>
<p>​	效果看上去更好了，但是还有些问题，比如水泥墩子后面有不合理的阴影。</p>
<h4 id="hbao-horizon-based-ambient-occlusion" tabindex="-1" id="HBAO-Horizon-based-Ambient-Occlusion">HBAO-Horizon-based Ambient Occlusion</h4>
<p>​	HBAO-基于水平线的环境光遮挡</p>
<p><img src="7.8.webp" alt="webp"></p>
<ul>
<li>
<p>Use the depth buffer as a heightfield on 2D surface</p>
<p>使用深度缓冲区作为 2D 表面上的高度场</p>
</li>
<li>
<p>Rays that below the horizon angle are occluded</p>
<p>低于水平角的光线被遮挡</p>
</li>
</ul>
<h4 id="hbao-lmplementation" tabindex="-1" id="HBAO-lmplementation">HBAO lmplementation</h4>
<p>​	HBAO 实施</p>
<p><img src="7.9.webp" alt="webp"></p>
<ul>
<li>
<p>Use the depth buffer as a heightfield on 2D surface</p>
<p>使用深度缓冲区作为 2D 表面上的高度场</p>
</li>
<li>
<p>Trace rays directly in 2D and approximate AO from horizon angle</p>
<p>直接在 2D 中追踪光线并从水平角近似 AO</p>
</li>
</ul>
<h4 id="gtao---ground-truth-based-ambient-occlusion" tabindex="-1" id="GTAO-Ground-Truth-based-Ambient-Occlusion">GTAO - Ground Truth-based Ambient Occlusion</h4>
<p>​	GTAO - 基于地面实况的环境光遮挡</p>
<p><img src="7.10.webp" alt="webp"></p>
<p>GTAO introduces the missing cosine factor, removes the attenuation function, and add a fast approximation of multi bounce</p>
<p>​	GTAO 引入了缺失的余弦因子，去除了衰减函数，并添加了多次反射的快速近似</p>
<p>Add multiple bounces by fitting a cubic polynomial per albedo</p>
<p>​	通过拟合每个反照率的三次多项式来添加多次反射</p>
<p><img src="7.11.webp" alt="webp"></p>
<h4 id="ray-tracing-ambient-occlusion" tabindex="-1" id="Ray-Tracing-Ambient-Occlusion">Ray-Tracing Ambient Occlusion</h4>
<p>​	光线追踪环境光遮挡</p>
<p><img src="7.12.webp" alt="webp"></p>
<ul>
<li>
<p>Casting rays from each screen pixel using RTT hardware</p>
<p>使用 RTT 硬件从每个屏幕像素投射光线</p>
<ul>
<li>
<p>1spp(sample per-pixel) works well for far-field occlusion</p>
<p>1spp（每像素样本）非常适合远场遮挡</p>
</li>
<li>
<p>With 2-4spp, can recover detailed occlusion in contact region</p>
<p>使用 2-4spp，可以恢复接触区域的详细遮挡</p>
</li>
</ul>
</li>
</ul>
<h3 id="fog-everything" tabindex="-1" id="Fog-Everything">Fog Everything</h3>
<h4 id="depth-fog" tabindex="-1" id="Depth-Fog">Depth Fog</h4>
<p>Linear fog: 线性雾</p>
<ul>
<li>factor = (end-z)/(end-start)</li>
</ul>
<p>Exp fog: 指数雾</p>
<ul>
<li>factor = exp(- density * z)</li>
</ul>
<p>Exp squared fog: 指数平方雾</p>
<ul>
<li>factor = exp(-(density * z) ^ 2)</li>
</ul>
<p><img src="7.13.webp" alt="webp"></p>
<h4 id="height-fog" tabindex="-1" id="Height-Fog">Height Fog</h4>
<blockquote>
<p>​	Height Fog（高度雾）是一种计算机图形学中的特效，可以模拟出真实世界中的大气层的效果。它通常被应用于游戏、电影等场景中，用于增强场景的逼真度和氛围感。</p>
<p>​	在 Height Fog 中，雾的浓度与高度成正比。也就是说，离地面越远的区域，雾的浓度越大，从而形成了逐渐模糊、逐渐淡化的效果。同时，Height Fog 还可以调整雾的颜色、密度、高度等参数，以达到不同的视觉效果。</p>
<p>​	Height Fog 主要用于模拟自然环境中的大气层效果，例如山区、森林、海洋等场景。通过 Height Fog 的渲染，可以使得场景更加真实、自然，并且能够增强场景的情感和氛围感。</p>
</blockquote>
<p><img src="7.14.webp" alt="webp"></p>
<ul>
<li>
<p>Height Fog integration along view diretion</p>
<p>沿视图方向的高度雾集成</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="normal">D</mi><mo>(</mo><mi mathvariant="normal">h</mi><mo>)</mo><mo>=</mo><msub><mi mathvariant="normal">D</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow></msub><mo>⋅</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>−</mo><mi>σ</mi><mo>⋅</mo><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi><mo>(</mo><mi mathvariant="normal">h</mi><mo>−</mo><msub><mi mathvariant="normal">H</mi><mi mathvariant="normal">s</mi></msub><mo separator="true">,</mo><mn mathvariant="normal">0</mn><mo>)</mo></mrow></msup></mrow></mrow><annotation encoding="application/x-tex">\mathrm{D(h)=D_{max}\cdot e^{-\sigma\cdot max(h-H_s,0)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:1.138em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">D</span><span class="mopen">(</span><span class="mord mathrm">h</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord"><span class="mord mathrm">e</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="mbin">⋅</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span><span class="mopen">(</span><span class="mord mathrm">h</span><span class="mbin">−</span><span class="mord"><span class="mord mathrm">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathrm">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>FogDensitylntegration</p>
<p>雾密度积分</p>
<p>=D_{max}\cdot d\int_{0}^{1}e^{-\sigma\cdot max((v_{z}+t*d_{z}-H_{s},0)}dt \\=D_{max}\cdot d\cdot e^{-\sigma\cdot max(v_{z}-Hs,0)\frac{1-e^{-\sigma\cdot d_{z}}}{\sigma\cdot d_{z}}}</p>
</li>
<li>
<p>Fog color after transmission</p>
<p>传输后的雾色</p>
<p>\text{Foglnscatter}=1-\exp^{-\text{FogDensitylntegration}}\\\text{FinalColor}=\text{FogColor}\cdot\text{Foglnscatter}</p>
</li>
</ul>
<h4 id="voxel-based-volumetric-fog" tabindex="-1" id="Voxel-based-Volumetric-Fog">Voxel-based Volumetric Fog</h4>
<blockquote>
<p>​	Voxel-based Volumetric Fog（基于体素的体积雾）是一种计算机图形学中的高级渲染技术。它通过将场景划分成小立方体（体素），并对每个体素进行采样和计算，从而模拟出真实世界中的体积雾效果。</p>
</blockquote>
<p><img src="7.15.webp" alt="webp"></p>
<h3 id="anti-aliasing" tabindex="-1" id="Anti-aliasing">Anti-aliasing</h3>
<p>​	反走样</p>
<h4 id="reason-of-aliasing" tabindex="-1" id="Reason-of-Aliasing">Reason of Aliasing</h4>
<p><img src="7.16.webp" alt="webp"></p>
<ul>
<li>
<p>Aliasing is a series of rendering artifact which is caused by high-frequency signal vs. insufficient sampling of limited rendering resolutions</p>
<p>走样是由高频信号与有限渲染分辨率的采样不足引起的一系列渲染伪影</p>
</li>
</ul>
<h4 id="anti-aliasing-1" tabindex="-1" id="Anti-aliasing-2">Anti-aliasing</h4>
<p><img src="7.17.webp" alt="webp"></p>
<p>The general strategy of screen-based antialiasing schemes is using a sampling pattern to <strong>get more samples</strong> and then <strong>weight and sum samples</strong> to produce a pixel color</p>
<p>​	基于屏幕的抗锯齿方案的一般策略是使用采样模式<strong>获取更多样本</strong>，然后<strong>对样本进行加权和求和</strong>以生成像素颜色</p>
<h4 id="super-sample-aa-(ssaa)-and-multi-sample-aa-(msaa)" tabindex="-1" id="Super-sample-AA-SSAA-and-Multi-sample-AA-MSAA">Super-sample AA (SSAA) and Multi-sample AA (MSAA)</h4>
<p>​	超样本 AA (SSAA) 和多样本 AA (MSAA)</p>
<ul>
<li>
<p>Super sampling is the most straightforward solution to solve <strong>AA</strong></p>
<p>超采样是解决<strong>AA</strong>最直接的解决方案</p>
</li>
</ul>
<p><img src="7.18.webp" alt="webp"></p>
<p>SSAA.4x rendering resolution</p>
<p>​	SSAA.4x 渲染分辨率</p>
<p>4x z-buffer and framebuffer</p>
<p>​	4x z-缓冲区和帧缓冲区</p>
<p>4x rasterization and pixel shading</p>
<p>​	4x 光栅化和像素着色</p>
<p><img src="7.19.webp" alt="webp"></p>
<p>MSAA, only multi-sampling necessary pixels</p>
<p>​	MSAA，仅多重采样必要的像素</p>
<p>4x z-buffer and framebuffer</p>
<p>​	4x z-缓冲区和帧缓冲区</p>
<p>4x rasterization and 1+ x pixel shading</p>
<p>​	4x 光栅化和 1+x 像素着色</p>
<h4 id="fxaa-(fast-approximate-anti-aliasing)" tabindex="-1" id="FXAA-Fast-Approximate-Anti-aliasing">FXAA (Fast Approximate Anti-aliasing)</h4>
<p>​	FXAA（快速近似抗锯齿）</p>
<p><img src="7.20.webp" alt="webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs C">M: Luminance of middle <span class="hljs-title function_">pixel</span><br><span class="hljs-params">(L = <span class="hljs-number">0.299</span> * R + <span class="hljs-number">0.587</span> * G + <span class="hljs-number">0.114</span> * B)</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MinThreshold 0.05</span><br><br><span class="hljs-type">float</span> MaxLuma = max(N, E,W, S, M);<br><span class="hljs-type">float</span> MinLuma = min(N, E, W, S, M);<br><span class="hljs-type">float</span> Contrast = MaxLuma - MinLuma;<br><span class="hljs-keyword">if</span>(Contrast &gt;= MinThreshold)    <br>...<br></code></pre></td></tr></table></figure>
<p>Anti-aliasing based on 1x rendered image</p>
<p>​	基于 1x 渲染图像的抗锯齿</p>
<ul>
<li>
<p>Find edge pixels by luminance</p>
<p>通过亮度查找边缘像素</p>
</li>
<li>
<p>Compute offset for every edge pixel</p>
<p>计算每个边缘像素的偏移量</p>
</li>
<li>
<p>Re-sample edge pixel by its offset to blend with a neighbor</p>
<p>通过偏移量重新采样边缘像素以与邻居混合</p>
</li>
</ul>
<h4 id="compute-offset-direction" tabindex="-1" id="Compute-Offset-Direction">Compute Offset Direction</h4>
<p>​	计算偏移方向</p>
<p><img src="7.21.webp" alt="webp"></p>
<h4 id="edge-searching-algorithm" tabindex="-1" id="Edge-Searching-Algorithm">Edge Searching Algorithm</h4>
<p>​	边缘搜索算法</p>
<p><img src="7.22.webp" alt="webp"></p>
<ul>
<li>
<p>Find aliasing edge that the pixel is in</p>
<p>查找像素所在的锯齿边缘</p>
<ul>
<li>
<p>Record constrast luminance and average luminance of current pixel and offset pixel</p>
<p>记录当前像素和偏移像素的对比度亮度和平均亮度</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>a</mi><mi>v</mi><mi>g</mi></mrow></msub><mspace width="1em"></mspace><msub><mi>L</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{avg}\quad L_{contrast}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mspace quad"></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p>
</li>
<li>
<p>Search along the 2 <strong>perpendicular</strong> direction and calculate the average luminance</p>
<p>沿 2 <strong>垂直</strong>方向搜索并计算平均亮度</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>i</mi><mi>n</mi></mrow></msub><mspace width="1em"></mspace><msub><mi>L</mi><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mn>2</mn><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{edgein}\quad L_{edge2n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">e</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mspace quad"></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">e</span><span class="mord mathrm">2</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p>
</li>
<li>
<p>Until \text{abs}( L_{edge1n} -L_{current})>0.25L_{contrast}\\\text{abs}(L_{edge2n} -L_{current})>0.25L_{contrast}</p>
</li>
</ul>
</li>
</ul>
<h4 id="calculate-blend-coefficient" tabindex="-1" id="Calculate-Blend-Coefficient">Calculate Blend Coefficient</h4>
<p>​	计算混合系数</p>
<p><img src="7.23.webp" alt="webp"></p>
<ul>
<li>Compute blender coefficient</li>
</ul>
<p>targetP is the nearer edge end of CurrentP</p>
<p>​	targetP 是 CurrentP 较近的边缘端</p>
<p>if(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>L</mi><mrow><mi>a</mi><mi>v</mi><mi>g</mi></mrow></msub><mo>−</mo><msub><mi>L</mi><mrow><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>)</mo><mo>∗</mo><mo>(</mo><msub><mi>L</mi><mrow><mi>a</mi><mi>v</mi><mi>g</mi></mrow></msub><mo>−</mo><msub><mi>L</mi><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mi>p</mi></mrow></msub><mo>)</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(L_{avg}-L_{current}) * (L_{avg} -L_{targetp})&gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">∗</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">e</span><span class="mord mathit">t</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span>)</p>
<p>​	magnitude = 0;</p>
<p>else
magnitude = abs(0.5 - dst / edgeLength);</p>
<h4 id="blend-nearby-pixels" tabindex="-1" id="Blend-Nearby-Pixels">Blend Nearby Pixels</h4>
<p>​	混合附近的像素</p>
<ul>
<li>Compute blender coefficient</li>
</ul>
<p><img src="7.24.webp" alt="webp"></p>
<p><strong>PixelNewColor =Texture(CurrentP_UV+ offset_direction * offset_magnitude)</strong></p>
<h4 id="fxaa-result" tabindex="-1" id="FXAA-Result">FXAA Result</h4>
<p><img src="7.25.webp" alt="webp"></p>
<h4 id="taa-(temporal-anti-aliasing)" tabindex="-1" id="TAA-Temporal-Anti-aliasing">TAA (Temporal Anti-aliasing)</h4>
<p>​	TAA（临时抗锯齿）</p>
<p><img src="7.26.webp" alt="webp"></p>
<p>Utilize spatial-<strong>temporal</strong> filtering methods to improve AA stability <strong>in motion</strong></p>
<p>​	利用空间-<strong>时间</strong>过滤方法来提高 AA 稳定性<strong>运动</strong></p>
<p><img src="7.27.webp" alt="webp"></p>
<h3 id="post-process" tabindex="-1" id="Post-process">Post-process</h3>
<p>But, the real magic in Post-process…</p>
<p>​	图像后处理，数字图像处理领域。</p>
<p><img src="7.28.webp" alt="webp"></p>
<p>Post-process in 3D Graphics refers to any algorithm that will be applied to the final image. lt can be done for stylistic reasons (color correction, contrast, etc.) or for realistic reasons (tone mapping, depth of field, etc.)</p>
<p>​	3D 图形中的后处理是指应用于最终图像的任何算法。可以出于风格原因（色彩校正、对比度等）或现实原因（色调映射、景深等）来完成此操作。</p>
<h3 id="bloom-effect" tabindex="-1" id="Bloom-Effect">Bloom Effect</h3>
<h4 id="what-is-bloom" tabindex="-1" id="What-is-Bloom">What is Bloom</h4>
<p><img src="7.29.webp" alt="webp"></p>
<ul>
<li>
<p>The physical basis of bloom is that, in the real world, lenses can never focus perfectly</p>
<p>光晕的物理基础是，在现实世界中，镜头永远无法完美对焦</p>
</li>
<li>
<p>Even a perfect lens will convolve theincoming image with an Airy disk</p>
<p>即使是完美的镜头也会将传入的图像与艾里斑进行卷积</p>
</li>
</ul>
<h4 id="detect-bright-area-by-threshold" tabindex="-1" id="Detect-Bright-Area-by-Threshold">Detect Bright Area by Threshold</h4>
<p>​	使用阈值法检测发光区域</p>
<p><img src="7.30.webp" alt="webp"></p>
<p>Find Luminance (Y) apply the standard coefficients for sRGB:</p>
<p>​	查找亮度 (Y)，应用 sRGB 的标准系数：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>R</mi><mrow><mi>l</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>∗</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>1</mn><mn>2</mn><mn>6</mn><mo>+</mo><msub><mi>G</mi><mrow><mi>l</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>∗</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>7</mn><mn>1</mn><mn>5</mn><mn>2</mn><mo>+</mo><msub><mi>B</mi><mrow><mi>l</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>∗</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>7</mn><mn>2</mn><mn>2</mn></mrow><annotation encoding="application/x-tex">Y=R_{lin}*0.2126+G_{lin}*0.7152+B_{lin}*0.0722
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">1</span><span class="mord mathrm">2</span><span class="mord mathrm">6</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">7</span><span class="mord mathrm">1</span><span class="mord mathrm">5</span><span class="mord mathrm">2</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05017em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">7</span><span class="mord mathrm">2</span><span class="mord mathrm">2</span></span></span></span></span></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">float</span> threshold;<br>float4 <span class="hljs-title function_">computeHighlightArea</span><span class="hljs-params">()</span><br>&#123;<br>    [...]  <span class="hljs-comment">// first do normal lighting calculations and output results</span><br>    float4scene_color = float4(lighting, <span class="hljs-number">1.0f</span>);<br>    <span class="hljs-comment">// check whether fragment output is higher than threshold, if so output as highlight color</span><br>    <span class="hljs-type">float</span> luminance = dot(scene_color.rgb, vec3(<span class="hljs-number">0.2126f</span>, <span class="hljs-number">0.7152f</span>, <span class="hljs-number">0.0722f</span>));<br><br>    float4highlight_color = float4(<span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>);<br>    <span class="hljs-keyword">if</span>(luminance &gt; threshold)<br>        highlight color = float4(scene_color.rgb, <span class="hljs-number">1.0f</span>);<br>    <span class="hljs-keyword">return</span> highlight_color;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="gaussian-blur" tabindex="-1" id="Gaussian-Blur">Gaussian Blur</h4>
<p><img src="7.31.webp" alt="webp"></p>
<p>​	使用二维正态分布的卷积核进行卷积作高斯模糊。</p>
<h4 id="pyramid-guassian-blur" tabindex="-1" id="Pyramid-Guassian-Blur">Pyramid Guassian Blur</h4>
<p>​	金字塔高斯模糊</p>
<p><img src="7.32.webp" alt="webp"></p>
<p>We can’t do all that filtering at high resolution, so we need a way to <strong>downsample</strong> and <strong>upsample</strong> the image</p>
<p>​	我们无法以高分辨率进行所有过滤，因此我们需要一种对图像进行<strong>下采样</strong>和<strong>上采样</strong>的方法</p>
<p>Need a weight coefficient to tweak final effect</p>
<p>​	需要一个权重系数来调整最终效果</p>
<h4 id="bloom-composite" tabindex="-1" id="Bloom-Composite">Bloom Composite</h4>
<p>​	混合形成 Bloom 效果。</p>
<p><img src="7.33.webp" alt="webp"></p>
<p><img src="7.34.webp" alt="webp"></p>
<h3 id="tone-mapping" tabindex="-1" id="Tone-Mapping">Tone Mapping</h3>
<p>​	色调映射</p>
<p><img src="7.35.webp" alt="webp"></p>
<ul>
<li>
<p>No way to directly display HDR image in a SDR device</p>
<p>无法在 SDR 设备中直接显示 HDR 图像</p>
</li>
<li>
<p>The purpose of the Tone Mapping function is to map the wide range of high dynamic range (HDR) colors into standard dynamic range (SDR) that a display can output</p>
<p>色调映射功能的目的是将各种高动态范围 (HDR) 颜色映射到显示器可以输出的标准动态范围 (SDR)</p>
</li>
</ul>
<h3 id="tone-mapping-curve" tabindex="-1" id="Tone-Mapping-Curve">Tone Mapping Curve</h3>
<p>​	色调映射曲线</p>
<p><img src="7.36.webp" alt="webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs C">float3 <span class="hljs-title function_">F</span><span class="hljs-params">(float3 x)</span><br>&#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">float</span> A = <span class="hljs-number">0.22f</span>;<br>    <span class="hljs-type">const</span> <span class="hljs-type">float</span> B = <span class="hljs-number">0.30f</span>;<br>    <span class="hljs-type">const</span> <span class="hljs-type">float</span> C = <span class="hljs-number">0.10f</span>;<br>    <span class="hljs-type">const</span> <span class="hljs-type">float</span> D = <span class="hljs-number">0.20f</span>;<br>    <span class="hljs-type">const</span> <span class="hljs-type">float</span> E = <span class="hljs-number">0.01f</span>;<br>    <span class="hljs-type">const</span> <span class="hljs-type">float</span> F = <span class="hljs-number">0.30f</span>;<br>    <span class="hljs-keyword">return</span>((x * (A * x + C * B) + D * E) / (x * (A * x + B) + D * F)) - E / F;<br>&#125;<br>    <br>float3 <span class="hljs-title function_">Uncharted2ToneMapping</span><span class="hljs-params">(float3 color, <span class="hljs-type">float</span> adapted lum)</span><br>&#123;<br>	<span class="hljs-type">const</span> <span class="hljs-type">float</span> WHITE = <span class="hljs-number">11.2f</span>;<br>    <span class="hljs-keyword">return</span> F(<span class="hljs-number">1.6f</span> * adapted_lum * color) / F(WHITE);<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li>
<p>Get a filmic look without making renders dirty</p>
<p>获得电影般的外观而不会使渲染变脏</p>
</li>
<li>
<p>Give images proper contrast andnicely roll off any pixels over 1</p>
<p>为图像提供适当的对比度，并很好地滚掉超过 1 的任何像素</p>
</li>
</ul>
<h3 id="aces" tabindex="-1" id="ACES">ACES</h3>
<p><img src="7.37.webp" alt="webp"></p>
<blockquote>
<p>​	Academy Color Encoding System（ACES）是一种由美国电影艺术与科学学会（Academy of Motion Picture Arts and Sciences）开发的颜色管理系统。它旨在提供一种标准化的数字图像工作流程，以便在不同的硬件和软件平台上保持一致的颜色表现和图像质量。</p>
<p>​	ACES 的主要目标是解决数字媒体制作中的颜色管理问题，确保从拍摄到后期制作再到最终呈现的整个过程中，颜色能够被准确和一致地处理。ACES 采用高动态范围（HDR）和广色域的工作方式，可以捕捉和表现更丰富的颜色和亮度细节。</p>
</blockquote>
<ul>
<li>
<p>Academy Color Encoding System</p>
<p>学院颜色编码系统</p>
<ul>
<li>
<p>Primarily for Film &amp; Animation</p>
<p>主要用于电影和动画</p>
</li>
<li>
<p>Interesting paradigms and transformations</p>
<p>有趣的范例和转变</p>
</li>
</ul>
</li>
<li>
<p>The useful bits</p>
<p>有用的部分</p>
<ul>
<li>
<p>Applying Color Grading in HDR is good</p>
<p>在 HDR 中应用颜色分级效果很好</p>
</li>
<li>
<p>The idea of a fixed pipeline up to the final OTD transforms stage is good</p>
<p>直到最终 OTD 转换阶段的固定管道的想法很好</p>
<ul>
<li>
<p>Separates artistic intent from the mechanics ofsupporting different devices</p>
<p>将艺术意图与支持不同设备的机制分开</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="hdr-and-sdr-pipeline" tabindex="-1" id="HDR-and-SDR-Pipeline">HDR and SDR Pipeline</h4>
<p>​	HDR 和 SDR 管道</p>
<p><img src="7.38.webp" alt="webp"></p>
<ul>
<li>
<p>Visual consistency between HDR / SDR</p>
<p>HDR / SDR 之间的视觉一致性</p>
</li>
<li>
<p>Similar SDR results to previous SDR color pipeline</p>
<p>与之前的 SDR 颜色管道类似的 SDR 结果</p>
</li>
<li>
<p>High quality</p>
<p>高质量</p>
</li>
<li>
<p>High performance</p>
<p>高性能</p>
</li>
<li>
<p>Minimal disruption to art teams</p>
<p>对艺术团队的干扰最小化</p>
<ul>
<li>
<p>Simple transition from current color pipeline</p>
<p>从当前颜色管道简单过渡</p>
</li>
<li>
<p>Minimal additional overhead for mastering HDR and SDR</p>
<p>掌握 HDR 和 SDR 的额外开销最小</p>
</li>
</ul>
</li>
</ul>
<h4 id="tone-mapping-curve-comparison" tabindex="-1" id="Tone-Mapping-Curve-Comparison">Tone Mapping Curve Comparison</h4>
<p>​	色调映射曲线比较</p>
<p><img src="7.39.webp" alt="webp"></p>
<h3 id="color-grading" tabindex="-1" id="Color-Grading">Color Grading</h3>
<p>​	颜色分级</p>
<p><img src="7.40.webp" alt="webp"></p>
<h4 id="lookup-table-(lut)" tabindex="-1" id="Lookup-Table-LUT">Lookup Table (LUT)</h4>
<p>​	查找表 (LUT)</p>
<p><img src="7.41.webp" alt="webp"></p>
<ul>
<li>
<p>LUT is used to remap the input color values of source pixels to new output values based on data contained within the LUT</p>
<p>LUT 用于根据 LUT 中包含的数据将源像素的输入颜色值重新映射到新的输出值</p>
</li>
<li>
<p>A LUT can be considered as a kind of color preset that can be applied to image or footage</p>
<p>LUT 可以被视为一种可应用于图像或素材的颜色预设</p>
</li>
</ul>
<h4 id="lut-3d-or-2d" tabindex="-1" id="LUT-3D-or-2D">LUT 3D or 2D</h4>
<p><img src="7.42.webp" alt="webp"></p>
<h4 id="artist-friendly-tools" tabindex="-1" id="Artist-Friendly-Tools">Artist Friendly Tools</h4>
<p>​	PS 之类的软件都可以创建 LUT。</p>
<p><img src="7.43.webp" alt="webp"></p>
<p><img src="7.44.webp" alt="webp"></p>
<p>Color grading is the most cost-effective feature of game rendering</p>
<p>​	颜色分级是游戏渲染中最具成本效益的功能</p>
<h3 id="rendering-pipeline" tabindex="-1" id="Rendering-Pipeline">Rendering Pipeline</h3>
<p>​	回顾一下渲染管线。</p>
<h4 id="one-equation-for-everything" tabindex="-1" id="One-Equation-for-Everything">One Equation for Everything</h4>
<p><img src="7.45.webp" alt="webp"></p>
<h4 id="what-we-learned-about-rendering-(1%2F4)" tabindex="-1" id="What-We-Learned-about-Rendering-1-4">What We Learned about Rendering (1/4)</h4>
<p><img src="7.46.webp" alt="webp"></p>
<h4 id="what-we-learned-about-rendering-(2%2F4)" tabindex="-1" id="What-We-Learned-about-Rendering-2-4">What We Learned about Rendering (2/4)</h4>
<p><img src="7.47.webp" alt="webp"></p>
<h4 id="what-we-learned-about-rendering-(3%2F4)" tabindex="-1" id="What-We-Learned-about-Rendering-3-4">What We Learned about Rendering (3/4)</h4>
<p><img src="7.48.webp" alt="webp"></p>
<h4 id="what-we-learned-about-rendering-(4%2F4)" tabindex="-1" id="What-We-Learned-about-Rendering-4-4">What We Learned about Rendering (4/4)</h4>
<p><img src="7.49.webp" alt="webp"></p>
<h4 id="redering-pipeline" tabindex="-1" id="Redering-Pipeline">Redering Pipeline</h4>
<p><img src="7.50.webp" alt="webp"></p>
<ul>
<li>
<p><strong>Rendering pipeline</strong> is the management order of all rendering operation execution and resource allocation</p>
<p><strong>渲染管线</strong>是所有渲染操作执行和资源分配的管理顺序</p>
</li>
</ul>
<h4 id="forward-rendering" tabindex="-1" id="Forward-Rendering">Forward Rendering</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">for n meshes<br>	for m lights<br>		color += shading(mesh, light)<br></code></pre></td></tr></table></figure>
<p>​	按顺序渲染。</p>
<p><img src="7.52.webp" alt="webp"></p>
<h4 id="sort-and-render-transparent-after-opaque-objects" tabindex="-1" id="Sort-and-Render-Transparent-after-Opaque-Objects">Sort and Render Transparent after Opaque Objects</h4>
<p><img src="7.51.webp" alt="webp"></p>
<p>​	渲染透明物体在不透明物体之后进行。</p>
<h4 id="rednering-with-many-lights" tabindex="-1" id="Rednering-with-Many-Lights">Rednering with Many Lights</h4>
<p>​	渲染多个光。</p>
<h4 id="deferred-rendering" tabindex="-1" id="Deferred-Rendering">Deferred Rendering</h4>
<p>延迟渲染</p>
<p><img src="7.53.webp" alt="webp"></p>
<p><img src="7.54.webp" alt="webp"></p>
<p>Pros</p>
<ul>
<li>
<p>Lighting is only computed for visible fragments</p>
<p>仅针对可见片段计算光照</p>
</li>
<li>
<p>The data from the G-Buffer can be used for post-processing</p>
<p>G-Buffer 中的数据可用于后处理</p>
</li>
</ul>
<p>Cons</p>
<ul>
<li>
<p>High memory and bandwidth cost</p>
<p>高内存和带宽成本</p>
</li>
<li>
<p>Not supporting transparent object</p>
<p>不支持透明物体</p>
</li>
<li>
<p>Not friendly to MSAA</p>
<p>对 MSAA 不友好</p>
</li>
</ul>
<h4 id="tile-based-rendering" tabindex="-1" id="Tile-based-Rendering">Tile-based Rendering</h4>
<blockquote>
<p>​	Tile-based Rendering（基于块的渲染）是一种在计算机图形学中常用的渲染技术。它通过将图像划分为小块（瓦片），并对每个瓦片进行独立的渲染，从而提高渲染效率和性能。</p>
<p>​	在传统的全局渲染方法中，整个场景的几何体和纹理都需要被完整地装入显存中，并在每个像素上进行计算。这会导致内存和计算资源的浪费，尤其在处理复杂的场景时更加明显。而 Tile-based Rendering 则针对这个问题进行了优化。</p>
<p>​	Tile-based Rendering 首先将场景划分为小块，每个块可以是一个像素或者更大的区域。然后，它只对可见的块进行处理，即只渲染那些对最终图像有贡献的部分。这样一来，渲染引擎可以专注于处理可见区域，减少了不必要的计算和内存访问操作。</p>
</blockquote>
<p><img src="7.55.webp" alt="webp"></p>
<h4 id="light-culling-by-tiles" tabindex="-1" id="Light-Culling-by-Tiles">Light Culling by Tiles</h4>
<p><img src="7.56.webp" alt="webp"></p>
<h4 id="depth-range-optimization" tabindex="-1" id="Depth-Range-Optimization">Depth Range Optimization</h4>
<p>​	深度范围优化</p>
<p><img src="7.57.webp" alt="webp"></p>
<ul>
<li>
<p>Get Min/Max depth per tile from Pre-z pass</p>
<p>从 Pre-z pass 获取每个图块的最小/最大深度</p>
</li>
<li>
<p>Test depth bounds for each light</p>
<p>测试每个灯的深度范围</p>
</li>
</ul>
<h4 id="tile-based-deferred-rendering" tabindex="-1" id="Tile-based-Deferred-Rendering">Tile-based Deferred Rendering</h4>
<p><img src="7.58.webp" alt="webp"></p>
<h4 id="forward%2B-(tile-based-forward)-rendering" tabindex="-1" id="Forward-Tile-based-Forward-Rendering">Forward+ (Tile-based Forward) Rendering</h4>
<p>​	Forward+（基于图块的前向）渲染</p>
<p><img src="7.59.webp" alt="webp"></p>
<ul>
<li>
<p>Depth prepass (prevent overdraw / provide tile depth bounds)</p>
<p>深度预通道（防止过度绘制/提供图块深度边界）</p>
</li>
<li>
<p>Tiled light culling (output: light list per tile)</p>
<p>平铺灯光剔除（输出：每个平铺的灯光列表）</p>
</li>
<li>
<p>Shading per object (PS: lterate through light list calculated in light culling)</p>
<p>每个对象的着色（PS：遍历在光剔除中计算的光列表）</p>
</li>
</ul>
<h4 id="cluster-based-rendering" tabindex="-1" id="Cluster-based-Rendering">Cluster-based Rendering</h4>
<blockquote>
<p>​	Cluster-based Rendering（基于集群的渲染）是一种用于分布式渲染的技术。它利用多个计算节点（也称为集群）的并行计算能力来加速图形渲染过程。</p>
<p>​	在传统的单机渲染中，所有的渲染任务都由单个计算节点完成。这限制了渲染速度和处理复杂场景的能力。而 Cluster-based Rendering 则通过将渲染任务分发到多个计算节点上并行处理，提高了渲染效率和性能。</p>
<p>​	在 Cluster-based Rendering 中，场景被划分为多个子区域，每个子区域由一个计算节点负责渲染。这些节点之间通过网络进行通信和协调，共同完成整个渲染任务。每个节点独立地渲染自己负责的子区域，并将结果传输回主节点进行合成，最终生成完整的图像。</p>
</blockquote>
<p><img src="7.60.webp" alt="webp"></p>
<h4 id="visibility-buffer" tabindex="-1" id="Visibility-Buffer">Visibility Buffer</h4>
<p><img src="7.61.webp" alt="webp"></p>
<h4 id="real-rendering-pipeline" tabindex="-1" id="Real-Rendering-Pipeline">Real Rendering Pipeline</h4>
<p><img src="7.62.webp" alt="webp"></p>
<h4 id="challenges" tabindex="-1" id="Challenges">Challenges</h4>
<p><img src="7.63.webp" alt="webp"></p>
<ul>
<li>
<p>Complex parallel work needs to synchronize with complex resource dependency</p>
<p>复杂的并行工作需要与复杂的资源依赖同步</p>
</li>
<li>
<p>Large amount of transient resource whose lifetime is shorter than one frame</p>
<p>大量瞬态资源，其生命周期短于一帧</p>
</li>
<li>
<p>Complex resource state management</p>
<p>复杂的资源状态管理</p>
</li>
<li>
<p>Exploit newly exposed GPU features without extensive user low level knowledge</p>
<p>无需广泛的用户低级知识即可利用新公开的 GPU 功能</p>
</li>
</ul>
<h4 id="frame-graph" tabindex="-1" id="Frame-Graph">Frame Graph</h4>
<p><img src="7.64.webp" alt="webp"></p>
<p>A Directed Acyclic Graph (DAG) of pass and resource dependency in a frame, not a real visual graph</p>
<p>​	帧中通道和资源依赖关系的有向无环图 (DAG)，而不是真正的可视化图</p>
<h3 id="render-to-monitor" tabindex="-1" id="Render-to-Monitor">Render to Monitor</h3>
<p>​	渲染到显示器</p>
<h4 id="screen-tearing" tabindex="-1" id="Screen-Tearing">Screen Tearing</h4>
<blockquote>
<p>​	Screen Tearing（屏幕撕裂）是一种在计算机和视频游戏中常见的图像问题。它通常出现在快速移动或相机旋转等情况下，导致图像出现水平分割线或不协调的图案，影响观看体验。</p>
<p>​	Screen Tearing 的出现是由于显示器和 GPU 之间的同步问题。当 GPU 在渲染新帧时，如果显示器正在显示先前的帧，就会发生 Screen Tearing。这是因为显示器和 GPU 的帧速率不同步，导致部分新帧和部分旧帧同时显示在屏幕上，从而产生撕裂的效果。</p>
<p>​	解决 Screen Tearing 的方法包括垂直同步（V-sync）和自适应同步（Adaptive-Sync）。垂直同步是一种通过锁定 GPU 的输出速度来匹配显示器的刷新速率的技术。它可以防止屏幕撕裂，但可能会导致输入延迟和帧率下降。自适应同步则是一种更高效的技术，它可以根据 GPU 的输出动态地调整显示器的刷新速率，以匹配 GPU 的速度，从而消除屏幕撕裂并保持更平滑的画面。</p>
</blockquote>
<p><img src="7.65.webp" alt="webp"></p>
<p>In most games your GPU frame rate will be highly volatile</p>
<p>​	在大多数游戏中，您的 GPU 帧速率会非常不稳定</p>
<p>When new GPU frame updates in the middle of last screen frame, screen tearing <strong>occurrs</strong></p>
<p>​	当新的 GPU 帧在最后一个屏幕帧的中间更新时，屏幕撕裂<strong>发生</strong></p>
<h4 id="v-sync-technology" tabindex="-1" id="V-Sync-Technology">V-Sync Technology</h4>
<p><img src="7.66.webp" alt="webp"></p>
<p>Synchronizing buffer swaps with the Vertical refresh is called V-sync</p>
<p>​	将缓冲区交换与垂直刷新同步称为 V-sync</p>
<p>V-Sync can be used to prevent tearing but framerates are reduced, the mouse is lagging &amp; stutteringruins gameplay</p>
<p>​	垂直同步可用于防止撕裂，但帧速率会降低，鼠标会出现滞后和卡顿，从而破坏游戏玩法</p>
<h4 id="variable-refresh-rate" tabindex="-1" id="Variable-Refresh-Rate">Variable Refresh Rate</h4>
<blockquote>
<p>​	可变刷新率（Variable Refresh Rate，VRR）是一种显示技术，用于动态调整显示器的刷新率，以匹配输入信号的帧率。传统的显示器通常以固定的刷新率（例如 60Hz 或 120Hz）工作，但 VRR 技术允许显示器根据实际的帧率来动态调整刷新率。</p>
<p>​	VRR 技术最常见的实现是 AMD 的 FreeSync 和 NVIDIA 的 G-Sync。当显示器采用 VRR 技术时，它可以与图形处理单元（GPU）通信，以了解当前帧率，并相应地调整自己的刷新率。这意味着在低帧率情况下，显示器可以减少刷新率，而在高帧率情况下，可以增加刷新率，从而实现更流畅的画面表现。</p>
</blockquote>
<p><img src="7.67.webp" alt="webp"></p>

            </article>
            
	<div class="rightside">
	
		<div class="rightside-button" id="js-aside">
			<span>
				<img no-lazy src="/images/icon/aside.png" class="rightside-button-icon" alt="Icon">
			</span>
		</div>
		<script>
			$("#js-aside").click(function () {
				onShowAsideButton();
			});
		</script>
	
	<div class="rightside-button" id="js-toggle_theme">
		<span>
			<img no-lazy src="/images/icon/toggle_theme.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	
<script src="/js/plugins/goto_position.js"></script>

	
	<div class="rightside-button" id="js-go_top">
		<span>
			<img no-lazy src="/images/icon/go_top.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>
	<div class="rightside-button" id="js-go_bottom">
		<span>
			<img no-lazy src="/images/icon/go_bottom.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	<script>
		setToggleThemeButtonListener();
	</script>
	<script>
		$('#js-go_top')
		.gotoPosition( {
			speed: 300,
			target: 'top',
		} );
		$('#js-go_bottom')
		.gotoPosition( {
			speed: 300,
			target: 'bottom',
		} );
	</script>
</div>


<div class="post-bottom">
    
        <div class="post-paging">     
            <div class="post-paging-last">
                
                    <a href="/posts/Hexo-%E5%9F%BA%E4%BA%8E%20CryptoJS-AES%20%E7%9A%84%20Hexo%20%E6%96%87%E7%AB%A0%E7%89%87%E6%AE%B5%E5%8A%A0%E5%AF%86%E6%8F%92%E4%BB%B6/">
                        上一篇：Hexo-基于 CryptoJS-AES 的 Hexo 文章片段加密插件
                    </a>
                
            </div>
            <div class="post-paging-next">
                
                    <a href="/posts/Paper-Domain%20Adaptation-A%20Survey/">
                        下一篇：Paper-Domain Adaptation-A Survey
                    </a>
                
            </div>
        </div>
    
    
    
        
            <div class="giscus comments"></div>
            <script>
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://giscus.app/client.js';
                scriptElement.setAttribute('data-repo', 'GZ-Metal-Cell/GZ-Metal-Cell.github.io');
                scriptElement.setAttribute('data-repo-id', 'R_kgDOIHLEOQ');
                scriptElement.setAttribute('data-category', 'Announcements');
                scriptElement.setAttribute('data-category-id', 'DIC_kwDOIHLEOc4CcVwP');
                scriptElement.setAttribute('data-mapping', 'title');
                scriptElement.setAttribute('data-strict', '1');
                scriptElement.setAttribute('data-reactions-enabled', '');
                scriptElement.setAttribute('data-emit-metadata', '0');
                scriptElement.setAttribute('data-input-position', 'bottom');
                scriptElement.setAttribute('data-theme', localStorage.getItem('theme') === 'light' ? 'light' : 'dark_high_contrast');
                scriptElement.setAttribute('data-lang', 'zh-CN');
                
                scriptElement.setAttribute('crossorigin', 'anonymous');
                scriptElement.async = true;
                document.head.appendChild(scriptElement);
            </script>
        
    
</div>
        </div>
    </main>
    
        <aside class="main-aside">
    
<script src="/js/widgets/aside.js"></script>

    <script>
        showAside();
    </script>

    <div class="aside-top">
        <div class="aside-top-about aside-card">
            <a href="/about" class="aside-top-about-portrait">
                <img no-lazy src="/about/portrait.png" alt="Q">
            </a>
            <div class="aside-top-about-info">
                <span class="author"> Zi-Zi</span>
                <span class="description">不以物喜，不以己悲。</span>
            </div>              
            <div class="aside-top-about-site">
                <a href="/categories" class="aside-top-about-site-item">
                    <span class="title">类别</span>
                    <span class="count">5</span>
                </a>
                <a href="/tags" class="aside-top-about-site-item">
                    <span class="title">标签</span>
                    <span class="count">122</span>
                </a>
                <a href="/archives" class="aside-top-about-site-item">
                    <span class="title">归档</span>
                    <span class="count">437</span>
                </a>
            </div>
            <div class="aside-top-about-contact">
                
                    
                        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
                            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
                            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
                            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
                            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
                        </a>
                    
                
            </div>
        </div> 

        
            <div class="aside-top-series aside-card">
                <ol class="aside-top-series-content">
                    
                    
                    
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Basic Elements/">
                                                <span class="text">GAMES104-Basic Elements</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        
                                        <li class="series-item active">
                                            <a class="series-link active" href="/posts/GAMES104-Rendering/">
                                                <span class="text">GAMES104-Rendering</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Animation/">
                                                <span class="text">GAMES104-Animation</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Physics/">
                                                <span class="text">GAMES104-Physics</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Effects/">
                                                <span class="text">GAMES104-Effects</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Tool Chains/">
                                                <span class="text">GAMES104-Tool Chains</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Gameplay/">
                                                <span class="text">GAMES104-Gameplay</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Online Gaming Architecture/">
                                                <span class="text">GAMES104-Online Gaming Architecture</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Data-Oriented Programming and Job System/">
                                                <span class="text">GAMES104-Data-Oriented Programming and Job System</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-Dynamic Global Illumination and Lumen/">
                                                <span class="text">GAMES104-Dynamic Global Illumination and Lumen</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/GAMES104-GPU-Driven Geometry Pipeline-Nanite/">
                                                <span class="text">GAMES104-GPU-Driven Geometry Pipeline-Nanite</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                </ol>
                <div class="aside-top-series-title">
                    <h1>
                        <a href="/tags/GAMES104">标签：GAMES104</a>
                    </h1>
                    <span id="serial-number">2/11</span>
                </div>
            </div>
            <script>
                activeSeriesItem();
            </script> 
        
    </div>

    <div class="aside-bottom">
        
            <script>
                
                    const tocCollapsed = true;
                
                
                    const tocDepth = 3;
                
                var headerString = '';
                for (let i = 1; i <= tocDepth; i++) {
                    if (i === 1) {
                        headerString += 'h1';
                    } else {
                        headerString += ', h' + i;
                    }
                }
                hbeToc();
            </script>
            <div class="aside-bottom-toc aside-card">
                <div class="aside-bottom-toc-title">
                    <h1>目录</h1>
                    <span class="toc-percentage"></span>
                </div>
                <ol class="aside-bottom-toc-content"></ol>
            </div>
        
    </div>
</aside>
    
</div>
		<footer>
	<div class="content">
		
			<span>©2022-2025&nbsp;By&nbsp;<a href="/about">Zi-Zi</a>.</span>
		
		<span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> theme by <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell/hexo-theme-quieter">Quieter</a>.</span>
		
			<span style="display: flex;">
				<img no-lazy alt="icp" src="/images/icp_icon.png" style="width: 16px; height: 16px;">
				<a href="https://icp.gov.moe/?keyword=20241647" target="_blank">萌 ICP 备 20241647 号</a>
			</span>
		
	</div>

	
<script src="/js/plugins/ref.js"></script>

	
<script src="/js/plugins/highlight_tools.js"></script>

	<script>
		const  COPY_ICON = "/images/icon/copy.png";
		const CLOSE_CODE_BLOCK_ICON = "/images/icon/close_code_block.png";
		const HIGHLIGHT_SHRINK = "";
		const HIGHLIGHT_HEIGHT_LIMIT = "";
	</script>

	
	
	<!-- Analytics -->

    
        <!-- Busuanzi Analytics -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?e57cf62289f84322ebff116e8b3d343e";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


	

	
		
			
				<link rel="stylesheet" href="/css/plugins/katex/katex.min.css">
				<script src="/js/plugins/copy-tex.js"></script>
			
		
	

    
		
<link rel="stylesheet" href="/css/plugins/textIndent.css">

		
<script src="/js/plugins/textIndent.js"></script>

	

	
	
	
		<script>
			if (typeof init === 'function') {
				init();
			}
		</script>
	

	
		
	

	

	<!--
		
<script src="/js/plugins/jquery.pjax.min.js"></script>

		<script>
			$(document).pjax('a[target!=_blank]', 'main', {
				fragment: 'main',
				timeout: 8000
			});

			$(document).on('pjax:complete', function() {
			});
		</script> 
	-->
	<script>
		console.log('\n %c Hexo-Quieter 主题 %c https://github.com/GZ-Metal-Cell/hexo-theme-quieter \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
	</script>
</footer>
	</body>

	<!-- Hexo-Quieter 主题  https://github.com/GZ-Metal-Cell/hexo-theme-quieter -->
</html>

