<!DOCTYPE html>
<html lang=zh-CN data-theme="light">
	
<script src="/js/plugins/toggleTheme.js"></script>

	<script>
		setTheme();
	</script>
	<head>
		
<title>ML-李宏毅-Lecture 11-Adaptation | Zi-Zi's Journey</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/images/icon/favicon.ico">
<link href="/css/plugins/print.css" media="print" rel="stylesheet" />

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="李宏毅,域适应,">
<meta name="description" content="李宏毅《机器学习 2022》课程学习笔记。">



<script src="/js/plugins/jquery.min.js"></script>


<script src="/js/plugins/hljs.min.js"></script>


<script src="/js/plugins/init.js"></script>


<script src="/js/plugins/hide.js"></script>


<script src="/js/plugins/tabs.js"></script>



    



    
<script src="/js/plugins/alert-title.js"></script>

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-base.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-dark-class.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-light.css">






    

	<meta name="generator" content="Hexo 6.1.0"></head>

	<body>
		<header class="sticky-header">
	<nav>
		<div class="nav-left">
			<a href="/" class="logo">
				<img no-lazy src="/images/headers_icon/logo.webp" alt="Quieter">
			</a>
			<ul class="breadcrumb" id="breadcrumb"></ul>
		</div>
		<div class="nav-right">
			<ul>
				
					<li>
						<a href="/">
						  主页
						</a>
					</li>
				
					<li>
						<a href="/categories">
						  类别
						</a>
					</li>
				
					<li>
						<a href="/tags">
						  标签
						</a>
					</li>
				
					<li>
						<a href="/archives">
						  归档
						</a>
					</li>
				
					<li>
						<a href="/galleries">
						  相册
						</a>
					</li>
				
					<li>
						<a href="/links">
						  链接
						</a>
					</li>
				
					<li>
						<a href="/about">
						  关于
						</a>
					</li>
								  
			</ul>
		</div>
		<div class="nav-right-close">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
				<path fill="none" d="M0 0h24v24H0z" />
				<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
			</svg>
		</div>

		<div class="sidebar">
    <div class="topo">
        <p>Zi-Zi's Journey</p>
    </div>
    <ul>
        
        <li>
            <a href="/">
                主页
            </a>
        </li>
        
        <li>
            <a href="/categories">
                类别
            </a>
        </li>
        
        <li>
            <a href="/tags">
                标签
            </a>
        </li>
        
        <li>
            <a href="/archives">
                归档
            </a>
        </li>
        
        <li>
            <a href="/galleries">
                相册
            </a>
        </li>
        
        <li>
            <a href="/links">
                链接
            </a>
        </li>
        
        <li>
            <a href="/about">
                关于
            </a>
        </li>
        
    </ul>
    <div class="sidebar-footer">
        
        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
        </a>
        
    </div>
</div>
<div class='shelter'>
    <script>
        $(function() {
            $('.nav-right-close > svg').click(function() {
                $('.sidebar').animate({
                    right: "0"
                }, 500);
                $('.shelter').fadeIn("slow");
            
                var element = $('.topo');
                element.addClass('custom-style');
            
                var links = null;
                if ("") {
                    links = "".split(',');
                } else {
                    links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
                }
            
                var randomLink = links[Math.floor(Math.random() * links.length)];
                element.css('background-image', "url('" + randomLink + "')");
            });
          
            $('.shelter').click(function(e) {
                $('.sidebar').animate({
                    right: "-100%"
                }, 500);
                $('.shelter').fadeOut("slow");
            });
        });      
    </script>
</div>
	</nav>

	
		<div class="header-background"></div>
	

	<script>
		const name = 'post';
		const ul = document.querySelectorAll('.nav-right ul')[0];
		const lis = ul.querySelectorAll('li');

		if (name == 'home') {
			lis[0].classList.add('select');
		} else {
			for (let i = 0; i < lis.length; i++) {
				const li = lis[i];
				const a = li.querySelector('a');
				if (name === a.href.split('/')[3]) {
					li.classList.add('select');
				}
			}
		}
	</script>
	
	<script>
		var element = document.querySelector('.header-background');
		if(element) {
			element.classList.add('custom-style');
			var links = null;
			if("")
			{
				links = "".split(',');
			} else
			{
				links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
			}
			var randomLink = links[Math.floor(Math.random() * links.length)];
			element.style.backgroundImage = "url('" + randomLink + "')";
		}
	</script>

	
<script src="/js/plugins/breadcrumb.js"></script>

	<script>
		var menus_title = [];
		
			menus_title.push({home: '主页'});
		
			menus_title.push({categories: '类别'});
		
			menus_title.push({tags: '标签'});
		
			menus_title.push({archives: '归档'});
		
			menus_title.push({galleries: '相册'});
		
			menus_title.push({links: '链接'});
		
			menus_title.push({about: '关于'});
		
		
			
				postsBreadcrumb(
					document.getElementById('breadcrumb'),
					"类别",
					"/categories",
					"学习",
					"/categories/学习",
					1
				);
			
		
	</script>
</header>

<div class="main-wrapper">
    <main class="post">
        <header class="main-header">
	
		
			
				
<link rel="stylesheet" href="/css/plugins/fancybox.css">

				
<script src="/js/plugins/fancybox.umd.js"></script>

				
<script src="/js/plugins/fancybox.js"></script>

			
			<div class="post-header-background-content">
				<ul class="post-header-tag">
					
						
							<li><a href="/tags/李宏毅"><span>李宏毅</span></a></li>
						
							<li><a href="/tags/域适应"><span>域适应</span></a></li>
						
					
				</ul>
				
				<h1>ML-李宏毅-Lecture 11-Adaptation</h1>
		
				
					<div class="post-header-desc">
						<svg t="1714702231661" class="icon" viewBox="0 0 1024 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="1154" xmlns:xlink="http://www.w3.org/1999/xlink"
						width="20" height="20">
						<path
							d="M778.24 117.76A46.08 46.08 0 0 1 824.32 163.84v430.08c0 8.4992-4.13696 16.01536-10.50624 20.6848l-0.24576 0.2048L587.5712 846.09024a35.84 35.84 0 0 1-61.48096-25.06752v-220.9792a46.08 46.08 0 0 1 46.08-46.08l200.94976-0.02048V168.96h-522.24v686.08H389.12c13.25056 0 24.1664 10.07616 25.47712 22.97856l0.12288 2.62144c0 14.1312-11.4688 25.6-25.6 25.6h-143.36A46.08 46.08 0 0 1 199.68 860.16V163.84A46.08 46.08 0 0 1 245.76 117.76h532.48z m-26.78784 487.38304h-174.16192v178.176l174.16192-178.176z m-45.19936-169.94304a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z m0-122.88a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z"
							fill="#ffffff" p-id="1155"></path>
						</svg>
						<p>李宏毅《机器学习 2022》课程学习笔记。</p>
					</div>
				
		
				<div class="post-header-info">
					<svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
					xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
						<path
							d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
							p-id="2902" fill="#ffffff"></path>
					</svg>
					<div class="post-header-info-author">
						<a href="/about">Zi-Zi</a>
					</div>
					
						<div class="post-header-info-categories">
							
								<a href="/categories/学习">学习</a>
							
						</div>
					
					<time>2023/11/09 20:13:00</time>
				</div>
		
				
					<div class="post-header-stat">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
						viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve" width="20" height="20">
							<path fill="#FFFFFF" d="M187.2,165.6c0,2.6-2.1,4.7-4.7,4.7H17.5c-2.6,0-4.7-2.1-4.7-4.7s2.1-4.7,4.7-4.7h165.1
								C185.2,160.9,187.2,163,187.2,165.6z"/>
							<path fill="#FFFFFF" d="M17.5,29.7c2.6,0,4.7,2.1,4.7,4.7v131.2c0,2.6-2.1,4.7-4.7,4.7s-4.7-2.1-4.7-4.7V34.4
								C12.8,31.8,14.9,29.7,17.5,29.7z M77.9,91.5c1.8,1.8,1.8,4.8,0,6.6l-39.8,39.8c-1.9,1.8-4.9,1.7-6.6-0.2c-1.7-1.8-1.7-4.6,0-6.4
								l39.8-39.8C73.1,89.6,76,89.6,77.9,91.5z M169.9,70.2c1.6,2.1,1.1,5-0.9,6.5c0,0,0,0,0,0l-64.2,48.2c-2.1,1.5-5,1.1-6.6-0.9
								c-1.6-2.1-1.1-5,0.9-6.5c0,0,0,0,0,0l64.2-48.2C165.4,67.7,168.3,68.1,169.9,70.2L169.9,70.2z"/>
							<path fill="#FFFFFF" d="M104.6,124.5c-1.8,1.8-4.8,1.8-6.6,0L71.6,98.1c-1.8-1.8-1.8-4.8,0-6.6c1.8-1.8,4.8-1.8,6.6,0l26.3,26.3
								C106.4,119.6,106.4,122.6,104.6,124.5C104.6,124.4,104.6,124.4,104.6,124.5z"/>
						</svg>
		
						
							
<script src="/js/plugins/wordCount.js"></script>

							<p class="post-count">文字数：---</p>
						
		
						
							<p id="busuanzi_container_page_pv" style='display:none;'>阅读数：<span id="busuanzi_value_page_pv"></span></p>
						
					</div>
				
			</div>
		
	
</header>
        <div class="post-content article-container">
            <article class="post-content-info">
                <h1 id="preparation" tabindex="-1">Preparation</h1>
<h2 id="%E3%80%90%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-2021%E3%80%91%E6%A6%82%E8%BF%B0%E9%A0%98%E5%9F%9F%E8%87%AA%E9%81%A9%E6%87%89-(domain-adaptation)" tabindex="-1" id="【機器學習-2021】概述領域自適應-Domain-Adaptation">【機器學習 2021】概述領域自適應 (Domain Adaptation)</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Mnk_oUrgppM&amp;ab_channel=Hung-yiLee">【機器學習 2021】概述領域自適應 (Domain Adaptation) - YouTube</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/404407599">李宏毅机器学习笔记 08 Domain Adaptation - 知乎 (zhihu.com)</a></li>
</ul>
<p><img src="P1.1.png" alt="png"></p>
<p><strong>Domain shift</strong>: 训练集和测试集的分布不同，解决方法：<strong>Domain adaptation</strong></p>
<p>迁移学习：<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=qD6iD4TFsdQ&amp;ab_channel=Hung-yiLee">ML Lecture 19: Transfer Learning - YouTube</a></p>
<p><img src="P1.2.png" alt="png"></p>
<p>Domain Shift 分为三种情况：</p>
<ul>
<li>Training Data 和 Testing Data 分布不同，我们将 Training Data 所在域称为 Source Domain，Testing Data 所在域称为 Target Domain（本节课只考虑这个情形）。</li>
<li>Training Data 和 Testing Data 标签分布不同。</li>
<li>Training Data 和 Testing Data 标签不同。</li>
</ul>
<p><img src="P1.3.png" alt="png"></p>
<p>Domain Adaption</p>
<p>如果我们对 target domain 有一定认识：Little but labeled（数量少但正确标注）</p>
<ul>
<li>
<p>ldea: training a model by source data then fine-tune the model by target data</p>
<p>从 source data 里预训练，再在 target data 上 fine-tune</p>
</li>
<li>
<p>Challenge: only limited target data, so becareful about overfitting</p>
<p>由于 target data 数量小，小心过拟合的问题</p>
</li>
</ul>
<p><img src="P1.4.png" alt="png"></p>
<p>Domain Adaption 的 Basic Idea：设计一个 Feature Extractor 提取 Source Domain 和 Target Domain 的特征，使提取出的特征具有相同分布。</p>
<p><img src="P1.5.png" alt="png"></p>
<p>将网络分成两个部分：Feature Extactor 和 Label Predictor。</p>
<p><img src="P1.6.png" alt="png"></p>
<p>利用类似 GAN 的思路，设计一个 Domain Classifier 对 Feature Extractor 提取出的特征作二分类，目标 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>θ</mi><mi>d</mi><mo>∗</mo></msubsup><mo>=</mo><msub><mi>min</mi><mrow><msub><mi>θ</mi><mi>d</mi></msub></mrow></msub><msub><mi>L</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\theta^*_d=\min_{\theta_d}L_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.9532439999999999em;vertical-align:-0.2588039999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.2588039999999999em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">d</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">∗</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop"><span class="mop">min</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>。判断提取出的特征属于 Source Domain 还是 Target Domain。</p>
<p>Label Predictor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>θ</mi><mi>p</mi><mo>∗</mo></msubsup><mo>=</mo><msub><mi>min</mi><mrow><msub><mi>θ</mi><mi>p</mi></msub></mrow></msub><mi>min</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">\theta^*_p=\min_{\theta_p}\min L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:1.077548em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">p</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">∗</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop"><span class="mop">min</span><span class="vlist"><span style="top:0.14999999999999997em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop">min</span><span class="mord mathit">L</span></span></span></span> 依旧做类别预测。</p>
<p>Feature Extractor 既要骗过 Domain Classifier，又要提取出有价值的特征。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>θ</mi><mi>f</mi><mo>∗</mo></msubsup><mo>=</mo><msub><mi>min</mi><mrow><msub><mi>θ</mi><mi>f</mi></msub></mrow></msub><mi>L</mi><mo>−</mo><msub><mi>L</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\theta^*_f=\min_{\theta_f}L-L_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:1.0893519999999999em;vertical-align:-0.39491199999999993em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.2588039999999999em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">∗</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop"><span class="mop">min</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">L</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p>
<p><img src="P1.7.png" alt="png"></p>
<p>最早有关 Domain Adversarial Training 的研究：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1409.7495">[1409.7495] Unsupervised Domain Adaptation by Backpropagation (arxiv.org)</a></p>
<p><img src="P1.8.png" alt="png"></p>
<p>假设我们当前样本的类别有两类，那么对于有标签的训练集我们可以明显地划分为两类，那么对于没有标签的测试，<strong>我们希望它的分布能够和训练集的分布越接近越好，如右图所示</strong>。</p>
<p><img src="P1.9.png" alt="png"></p>
<p>那么在这个思路上进行拓展的话，对于我们刚才手写识别的例子，我们输入一张图片得到的是一个向量，其中含有属于每一个分类的概率，<strong>那我们希望的是这个测试集的样本离分界线越远越好，那就代表它得到的输出向量要更加集中于某一类的概率，不能够各个分类的可能性都差不多</strong>。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1802.08735">[1802.08735] A DIRT-T Approach to Unsupervised Domain Adaptation (arxiv.org)</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1712.02560">[1712.02560] Maximum Classifier Discrepancy for Unsupervised Domain Adaptation (arxiv.org)</a></li>
</ul>
<p><img src="P1.10.png" alt="png"></p>
<p>对于 Knowledge of target domain：</p>
<ul>
<li>Little but labeled
<ul>
<li>pre-train 再 fine-tune</li>
</ul>
</li>
<li>Large amount of unlabeled data
<ul>
<li>Domian Adversarial Training</li>
</ul>
</li>
<li>little &amp; unlabeled
<ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1909.13231">[1909.13231] Test-Time Training with Self-Supervision for Generalization under Distribution Shifts (arxiv.org)</a></li>
</ul>
</li>
<li>什么也不知道
<ul>
<li>Domain Generalization</li>
</ul>
</li>
</ul>
<p><img src="P1.11.png" alt="png"></p>
<p>关于 Domain Generalization 的研究：</p>
<p>Training 域大，Testing 域小：<a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/8578664">Domain Generalization with Adversarial Feature Learning | IEEE Conference Publication | IEEE Xplore</a></p>
<p>Training 域小，Testing 域大：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1409.7495">[1409.7495] Unsupervised Domain Adaptation by Backpropagation (arxiv.org)</a></p>
<h2 id="ml-lecture-19-transfer-learning" tabindex="-1" id="ML-Lecture-19-Transfer-Learning">ML Lecture 19-Transfer Learning</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=qD6iD4TFsdQ&amp;ab_channel=Hung-yiLee">ML Lecture 19: Transfer Learning - YouTube</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/34589303">学一学 Transfer Learning - 知乎 (zhihu.com)</a></li>
</ul>
<p><img src="P2.1.png" alt="png"></p>
<p>关于迁移学习 Transfer Learning，分为两种情况：</p>
<ul>
<li>Similar domain, different tasks 相似域，不同任务</li>
<li>Different domains, same task 不同域，相同任务</li>
</ul>
<p><img src="P2.2.png" alt="png"></p>
<p>迁移学习的应用：Speech Recognition、Image Recognition、Text Analysis</p>
<p><img src="P2.3.png" alt="png"></p>
<p>类比于研究生与漫画家：</p>
<ul>
<li>研究生 → 漫画家</li>
<li>导师 → 责编</li>
<li>跑实验 → 画分镜</li>
<li>投稿期刊 → 投稿 jump</li>
</ul>
<p><img src="P2.28.png" alt="png"></p>
<p>对于 Transfer Learning，根据 Source Data (not directly related to the task) 和 Target Data 的情况，共有如下策略：</p>
<table>
<thead>
<tr>
<th>Target Data / Source Data</th>
<th>labelled</th>
<th>unlabeled</th>
</tr>
</thead>
<tbody>
<tr>
<td>labelled</td>
<td>Fine-tuning 微调<br/>Multitask Learning 多任务学习</td>
<td>Self-taught learning 自学习<br/><a target="_blank" rel="noopener" href="https://ai.stanford.edu/~hllee/icml07-selftaughtlearning.pdf">icml07-selftaughtlearning.pdf (stanford.edu)</a></td>
</tr>
<tr>
<td>unlabeled</td>
<td>Domain-adversarial training 域对抗训练<br/>Zero-shot learning 零次学习</td>
<td>Self-taught Clustering 自学聚类算法<br/><a target="_blank" rel="noopener" href="http://www.machinelearning.org/archive/icml2008/papers/432.pdf">icml.dvi (machinelearning.org)</a></td>
</tr>
</tbody>
</table>
<p><img src="P2.4.png" alt="png"></p>
<p>Model Fine-tuning</p>
<ul>
<li>
<p>Task description</p>
<ul>
<li>Target data: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>x</mi><mi>t</mi></msup><mo separator="true">,</mo><msup><mi>y</mi><mi>t</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(x^t,y^t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.7935559999999999em;"></span><span class="strut bottom" style="height:1.043556em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>, 数量少</li>
<li>Source data: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>x</mi><mi>s</mi></msup><mo separator="true">,</mo><msup><mi>y</mi><mi>s</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(x^s,y^s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>, 数量多</li>
</ul>
</li>
<li>
<p>Example: (supervised) speaker adaption</p>
<p>示例：（监督）speaker 自适应</p>
<ul>
<li>
<p>Target data: audio data and its transcriptions of specificuser</p>
<p>目标数据：特定用户的音频数据及其转录</p>
</li>
<li>
<p>Source data: audio data and transcriptions from many speakers</p>
<p>来源数据：来自许多 speaker 的音频数据和转录</p>
</li>
</ul>
</li>
<li>
<p>ldea: training a model by source data, then fine-tune the model by target data</p>
<p>ldea：根据源数据训练模型，然后根据目标数据微调模型</p>
<ul>
<li>
<p>Challenge: only limited target data, so be careful about overfitting</p>
<p>挑战：只有有限的目标数据，所以要小心过度拟合</p>
</li>
</ul>
</li>
</ul>
<p><img src="P2.5.png" alt="png"></p>
<blockquote>
<p>Conservative Training：</p>
<ul>
<li>我们先通过 Source data 去 train 一个 model</li>
<li>然后通过并不是直接把这个 model 当做 pre-trained 的 model，去用少量的 target data 去训练一个新的 model</li>
<li>而是加入一些正则化项，来保证新的 model 和旧的 model 在 input 相同的情况下，得到的 output 尽可能的相近。</li>
<li>为什么要这样做呢？其实原因很简单，如果我们在 train 新的 model 的过程中，并不去加这个正则项（也叫限制项），那么如果我们将 source data 送进新的 model，我们会发现整个 model 彻底坏掉了，他已经不具备原先 model 对于 source data 的表现能力了，这也是在 ML 中经常出现的一个非常重要的问题：灾难性遗忘问题</li>
</ul>
</blockquote>
<p><img src="P2.6.png" alt="png"></p>
<blockquote>
<p>Layer Transfer</p>
<ul>
<li>首先还是和 Conservative Training 一样，通过 Source data 去 train 一个 model</li>
<li>然后将该 model 中某些层的 parameters 直接复制进去新的 model 中</li>
<li>对于新 model 中那些没有得到 parameters 的 layer，我们固定其他层的参数，通过 Source data 对那些没有被 transfer 到 parameter 的 layer 进行训练</li>
<li>最后，如果 target data 的数据量比较充足，那么我们就可以在对整个网络进行 fine-tuning 一下，可以进一步提升模型的性能。</li>
</ul>
</blockquote>
<p><img src="P2.7.png" alt="png"></p>
<ul>
<li>
<p>对于 Speech 任务，通常 copy 最后几层</p>
</li>
<li>
<p>对于 Image 任务，通常 copy 头几层</p>
</li>
</ul>
<p><img src="P2.8.png" alt="png"></p>
<p>关于 Layer Transfer 的研究：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1411.1792">[1411.1792] How transferable are features in deep neural networks? (arxiv.org)</a></li>
</ul>
<p><img src="P2.9.png" alt="png"></p>
<p><img src="P2.10.png" alt="png"></p>
<blockquote>
<p>Multitask Learning</p>
<ul>
<li>再来回顾下 fine-tuning 的过程，在做 fine-tuning 的时候，我们更加关注的是 model 在 target domain 上做的好不好，至于在 source domain 上做的到底怎么样，哪怕是将 source data 输入进这个新的 model 中，model 都坏掉了，也不要紧。只要这个新的 model 在 target domain 上做的很出色就够了。</li>
<li>而 multitask learning 和 fine-tuning 的过程就不同了，multitask 是说，<strong>不仅要求我们的最终 model 在 target domain 上表现的相当出色，而且在 source domain 上同样也要表现的相当出色。</strong></li>
</ul>
</blockquote>
<p><img src="P2.11.png" alt="png"></p>
<p>Multitask Learning 在多语言机器翻译上的研究：<a target="_blank" rel="noopener" href="https://aclanthology.org/P15-1166.pdf">Multi-Task Learning for Multiple Language Translation (aclanthology.org)</a></p>
<p><img src="P2.12.png" alt="png"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/6639081">Cross-language knowledge transfer using multilingual deep neural network with shared hidden layers | IEEE Conference Publication | IEEE Xplore</a></li>
</ul>
<p><img src="P2.13.png" alt="png"></p>
<blockquote>
<p>Progressive Neural Networks</p>
<ul>
<li>这篇网络中的方法还是比较新的，首先对于 task 1 来说，我们 train 出一个 model</li>
<li>然后将 task 1 中的第 i 层的输出直接输入进 task 2 中的第 i 层的输出，作为第 i + 1 层的输入。</li>
<li>然后后面如果有 k 个网络，就会应用到前 k-1 个网络的信息。</li>
</ul>
</blockquote>
<p><img src="P2.14.png" alt="png"></p>
<p>对于 Source data 和 Target data 处于不同域：mismatch 时</p>
<p><img src="P2.15.png" alt="png"></p>
<p>Domain-adversarial training: 设计一个 Domain classifier，迫使 feature extractor 提取出相同分布的特征。</p>
<p><img src="P2.16.png" alt="png"></p>
<blockquote>
<p>Domain-adversarial training</p>
<ul>
<li>第一部分绿色的 feature extractor 其实要做的就是提取出 source data 和 target data 的 feature，然后使得最后在做 classification 的时候，通过这些提取出来的 feature，能够得到一个非常好的精确度。他还有尽可能让这些 mismatch 的 data 混在一起，以至于 domain classifier 不能够正确的判断他们是否混在一起。</li>
<li>第二部分蓝色的 label predictor 做的是，能够尽可能大的输出 classification 的精度</li>
<li>第三部分红色的 domain classifier 做的是，能够尽可能的将从 feature extractor 中提取出来的 feature 进行分开，将其各自归属到其所属的 domain 里。</li>
</ul>
<p>当然，关于这个网络的 train，讲起来很容易，实际操作起来，肯定会像 GAN 一样，涉及到很多的 trick。</p>
</blockquote>
<p><img src="P2.17.png" alt="png"></p>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1409.7495">[1409.7495] Unsupervised Domain Adaptation by Backpropagation (arxiv.org)</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1505.07818">[1505.07818] Domain-Adversarial Training of Neural Networks (arxiv.org)</a></p>
</li>
</ul>
<p><img src="P2.18.png" alt="png"></p>
<p><img src="P2.19.png" alt="png"></p>
<p>Zero-shot Learning: Source data 和 Target data 是不同的 tasks.</p>
<p><img src="P2.20.png" alt="png"></p>
<p><img src="P2.21.png" alt="png"></p>
<p><img src="P2.22.png" alt="png"></p>
<p>在 NLP 领域中比较常见，可以用 word embedding</p>
<p><img src="P2.23.png" alt="png"></p>
<p><img src="P2.24.png" alt="png"></p>
<p><img src="P2.25.png" alt="png"></p>
<p>有关 Zero-shot Learning 的实验：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1312.5650v3">[1312.5650v3] Zero-Shot Learning by Convex Combination of Semantic Embeddings (arxiv.org)</a></p>
<p><img src="P2.26.png" alt="png"></p>
<p><img src="P2.27.png" alt="png"></p>
<p><img src="P2.29.png" alt="png"></p>
<p>Self-taught learning 自学习</p>
<ul>
<li>Learning to extract better representation from the source data (unsupervised approach) 学习从源数据中提取更好的表示（无监督方法）</li>
<li>Extracting better representation for target data 为目标数据提取更好的表示</li>
</ul>
<h2 id="%E3%80%90%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-2022%E3%80%91%E6%83%A1%E6%90%9E%E8%87%AA%E7%9D%A3%E5%B0%8E%E5%BC%8F%E5%AD%B8%E7%BF%92%E6%A8%A1%E5%9E%8B-bert-%E7%9A%84%E4%B8%89%E5%80%8B%E6%95%85%E4%BA%8B" tabindex="-1" id="【機器學習-2022】惡搞自督導式學習模型-BERT-的三個故事">【機器學習 2022】惡搞自督導式學習模型 BERT 的三個故事</h2>
<p><img src="C1.1.png" alt="png"></p>
<p>How versatile are self-supervised models?</p>
<p>自监督模型的通用性如何？</p>
<p><img src="C1.2.png" alt="png"></p>
<ul>
<li>Cross-lingual 跨语言</li>
<li>Cross-discipline 跨学科</li>
<li>Pre-training with artificial data 使用人工数据进行预训练</li>
</ul>
<p><strong>Cross-lingual</strong></p>
<p><img src="C1.3.png" alt="png"></p>
<p><img src="C1.4.png" alt="png"></p>
<p><img src="C1.5.png" alt="png"></p>
<p><img src="C1.6.png" alt="png"></p>
<p><img src="C1.7.png" alt="png"></p>
<p><img src="C1.8.png" alt="png"></p>
<p><img src="C1.9.png" alt="png"></p>
<p><img src="C1.10.png" alt="png"></p>
<p><img src="C1.11.png" alt="png"></p>
<p><img src="C1.12.png" alt="png"></p>
<p><img src="C1.13.png" alt="png"></p>
<p><img src="C1.14.png" alt="png"></p>
<p><img src="C1.15.png" alt="png"></p>
<p><strong>Cross-discipline</strong></p>
<p><img src="C1.16.png" alt="png"></p>
<p>用 BERT 做 DNA 分类。</p>
<p><img src="C1.17.png" alt="png"></p>
<p><img src="C1.18.png" alt="png"></p>
<p><img src="C1.19.png" alt="png"></p>
<p><img src="C1.20.png" alt="png"></p>
<p><img src="C1.21.png" alt="png"></p>
<p><img src="C1.22.png" alt="png"></p>
<p><img src="C1.23.png" alt="png"></p>
<p><img src="C1.24.png" alt="png"></p>
<p><img src="C1.25.png" alt="png"></p>
<p><img src="C1.26.png" alt="png"></p>
<p><img src="C1.27.png" alt="png"></p>
<p><img src="C1.28.png" alt="png"></p>
<p><strong>Pre-training with artificial data</strong> 使用人造数据进行预训练 BERT</p>
<p><img src="C1.29.png" alt="png"></p>
<p><img src="C1.30.png" alt="png"></p>
<h2 id="hw11_domain_adaptation" tabindex="-1" id="hw11-domain-adaptation">hw11_domain_adaptation</h2>
<p><strong>场景和为什么 Domain Adversarial Training</strong></p>
<p>​	现在，我们有了已标记的源数据和未标记的目标数据，其中源数据可能与目标数据相关。现在，我们希望仅使用源数据训练模型，并在目标数据上对其进行测试。</p>
<p>​	如果我们这样做，可能会出现什么问题？在学习了异常检测之后，我们现在知道，如果我们使用从未出现在源数据中的异常数据来测试模型，我们训练的模型很可能会导致性能不佳，因为它不熟悉异常数据。</p>
<p>例如，我们有一个包含 Feature Extractor 和 Classifier 的模型：</p>
<p>​	当使用源数据训练模型时，特征提取器 将提取有意义的特征，因为它熟悉它的分布。从下图中可以看出，蓝点（即源数据的分布）已经聚集到不同的集群中。因此，Classifier 可以根据这些集群预测标签。</p>
<p>​	但是，在对目标数据进行测试时，Feature Extractor 将无法提取遵循源特征分布的有意义的特征，这会导致为源域学习的分类器无法应用于目标域。</p>
<p><strong>Nerural 网络的域对抗训练 （DaNN）</strong></p>
<p>​	基于上述问题，DaNN 方法在源（训练时）和目标（测试时）域之间构建映射，以便为源域学习的分类器在与域之间学习的映射组合时也可以应用于目标域。</p>
<p>​	<strong>在 DaNN 中，作者添加了一个域分类器，这是训练框架中一个深度判别训练的分类器，用于通过特征提取器提取的特征来区分来自不同领域的数据。随着训练的进行，该方法促进了区分源域和目标域的域分类器，以及可以提取对源域上的主要学习任务具有歧视性且对域之间的转换不加区分的特征提取器。</strong></p>
<p>​	特征提取器的性能可能优于域分类器，因为它的输入是由特征提取器生成的，并且域分类和标签分类的任务并不冲突。</p>
<p>​	这种方法导致了域不变且位于相同特征分布上的特征的出现。</p>
<p><strong>数据介绍</strong></p>
<p>​	我们的任务包含源数据：真实照片和目标数据：手绘涂鸦。</p>
<p>​	我们将使用照片和标签训练模型，并尝试预测手绘涂鸦的标签是什么。</p>
<p>​	数据可以<a target="_blank" rel="noopener" href="https://github.com/redxouls/ml2020spring-hw11-dataset/releases/download/v1.0.0/real_or_drawing.zip">在这里</a>下载。下面的代码用于数据下载和可视化。</p>
<p>​	注意：<strong>源数据和目标数据都是平衡数据，您可以使用此信息。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Download dataset</span><br>!wget <span class="hljs-string">&quot;https://github.com/redxouls/ml2020spring-hw11-dataset/releases/download/v1.0.0/real_or_drawing.zip&quot;</span> -O real_or_drawing.<span class="hljs-built_in">zip</span><br><br><span class="hljs-comment"># Download from mirrored dataset link</span><br><span class="hljs-comment"># !wget &quot;https://github.com/redxouls/ml2020spring-hw11-dataset/releases/download/v1.0.1/real_or_drawing.zip&quot; -O real_or_drawing.zip</span><br><span class="hljs-comment"># !wget &quot;https://github.com/redxouls/ml2020spring-hw11-dataset/releases/download/v1.0.2/real_or_drawing.zip&quot; -O real_or_drawing.zip</span><br><br><span class="hljs-comment"># Unzip the files</span><br>!unzip real_or_drawing.<span class="hljs-built_in">zip</span><br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Streaming output truncated to the last 5000 lines.<br>  inflating: real_or_drawing/train_data/0/106.bmp  <br>  inflating: real_or_drawing/train_data/0/107.bmp  <br>  inflating: real_or_drawing/train_data/0/108.bmp  <br>  inflating: real_or_drawing/train_data/0/109.bmp  <br>  inflating: real_or_drawing/train_data/0/11.bmp  <br>...<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">no_axis_show</span>(<span class="hljs-params">img, title=<span class="hljs-string">&#x27;&#x27;</span>, cmap=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-comment"># imshow, and set the interpolation mode to be &quot;nearest&quot;。</span><br>    fig = plt.imshow(img, interpolation=<span class="hljs-string">&#x27;nearest&#x27;</span>, cmap=cmap)<br>    <span class="hljs-comment"># do not show the axes in the images.</span><br>    fig.axes.get_xaxis().set_visible(<span class="hljs-literal">False</span>)<br>    fig.axes.get_yaxis().set_visible(<span class="hljs-literal">False</span>)<br>    plt.title(title)<br><br>titles = [<span class="hljs-string">&#x27;horse&#x27;</span>, <span class="hljs-string">&#x27;bed&#x27;</span>, <span class="hljs-string">&#x27;clock&#x27;</span>, <span class="hljs-string">&#x27;apple&#x27;</span>, <span class="hljs-string">&#x27;cat&#x27;</span>, <span class="hljs-string">&#x27;plane&#x27;</span>, <span class="hljs-string">&#x27;television&#x27;</span>, <span class="hljs-string">&#x27;dog&#x27;</span>, <span class="hljs-string">&#x27;dolphin&#x27;</span>, <span class="hljs-string">&#x27;spider&#x27;</span>]<br>plt.figure(figsize=(<span class="hljs-number">18</span>, <span class="hljs-number">18</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, i+<span class="hljs-number">1</span>)<br>    fig = no_axis_show(plt.imread(<span class="hljs-string">f&#x27;real_or_drawing/train_data/<span class="hljs-subst">&#123;i&#125;</span>/<span class="hljs-subst">&#123;<span class="hljs-number">500</span>*i&#125;</span>.bmp&#x27;</span>), title=titles[i])<br></code></pre></td></tr></table></figure>
<p><img src="source_domain.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">plt.figure(figsize=(<span class="hljs-number">18</span>, <span class="hljs-number">18</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, i+<span class="hljs-number">1</span>)<br>    fig = no_axis_show(plt.imread(<span class="hljs-string">f&#x27;real_or_drawing/test_data/0/&#x27;</span> + <span class="hljs-built_in">str</span>(i).rjust(<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;0&#x27;</span>) + <span class="hljs-string">&#x27;.bmp&#x27;</span>))<br></code></pre></td></tr></table></figure>
<p><img src="target_domain.png" alt="png"></p>
<p><strong>特殊领域知识</strong></p>
<p>​	我们在涂鸦时，通常只画轮廓，因此我们可以对源数据进行边缘检测处理，使其与目标数据更加相似。</p>
<p><strong>Canny 边缘检测</strong></p>
<p>​	Canny Edge Detection 的实现如下。 此处不会详细描述该算法。如果您有兴趣，请参考 wiki 或<a target="_blank" rel="noopener" href="https://www.google.com/url?q=https%3A%2F%2Fmedium.com%2F@pomelyu5199%2Fcanny-edge-detector-%E5%AF%A6%E4%BD%9C-opencv-f7d1a0a57d19">这里</a>。</p>
<p>​	我们只需要两个参数即可使用 CV2 实现 Canny Edge Detection：<code>low_threshold</code> 和 <code>high_threshold</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cv2.Canny(image, low_threshold, high_threshold)<br></code></pre></td></tr></table></figure>
<p>​	简单地说，当边值超过 high_threshold 时，我们将其确定为边。如果边值仅高于 low_threshold，我们将确定它是否为边。</p>
<p>​	让我们在源数据上实现它。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>titles = [<span class="hljs-string">&#x27;horse&#x27;</span>, <span class="hljs-string">&#x27;bed&#x27;</span>, <span class="hljs-string">&#x27;clock&#x27;</span>, <span class="hljs-string">&#x27;apple&#x27;</span>, <span class="hljs-string">&#x27;cat&#x27;</span>, <span class="hljs-string">&#x27;plane&#x27;</span>, <span class="hljs-string">&#x27;television&#x27;</span>, <span class="hljs-string">&#x27;dog&#x27;</span>, <span class="hljs-string">&#x27;dolphin&#x27;</span>, <span class="hljs-string">&#x27;spider&#x27;</span>]<br>plt.figure(figsize=(<span class="hljs-number">18</span>, <span class="hljs-number">18</span>))<br><br>original_img = plt.imread(<span class="hljs-string">f&#x27;real_or_drawing/train_data/0/0.bmp&#x27;</span>)<br>plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>)<br>no_axis_show(original_img, title=<span class="hljs-string">&#x27;original&#x27;</span>)<br><br>gray_img = cv2.cvtColor(original_img, cv2.COLOR_RGB2GRAY)<br>plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>)<br>no_axis_show(gray_img, title=<span class="hljs-string">&#x27;gray scale&#x27;</span>, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)<br><br>gray_img = cv2.cvtColor(original_img, cv2.COLOR_RGB2GRAY)<br>plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>)<br>no_axis_show(gray_img, title=<span class="hljs-string">&#x27;gray scale&#x27;</span>, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)<br><br>canny_50100 = cv2.Canny(gray_img, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>)<br>plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>)<br>no_axis_show(canny_50100, title=<span class="hljs-string">&#x27;Canny(50, 100)&#x27;</span>, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)<br><br>canny_150200 = cv2.Canny(gray_img, <span class="hljs-number">150</span>, <span class="hljs-number">200</span>)<br>plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>)<br>no_axis_show(canny_150200, title=<span class="hljs-string">&#x27;Canny(150, 200)&#x27;</span>, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)<br><br>canny_250300 = cv2.Canny(gray_img, <span class="hljs-number">250</span>, <span class="hljs-number">300</span>)<br>plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>)<br>no_axis_show(canny_250300, title=<span class="hljs-string">&#x27;Canny(250, 300)&#x27;</span>, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><img src="canny.png" alt="png"></p>
<p><strong>数据处理</strong></p>
<p>​	数据适用于 。您可以使用 创建数据集。图像增广的详细信息请参考以下代码中的注释。<code>torchvision.ImageFolder</code> <code>torchvision.ImageFolder</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> torch  <span class="hljs-comment"># 张量操作</span><br><span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn  <span class="hljs-comment"># 神经网络层</span><br><span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F<br><span class="hljs-keyword">from</span> torch.autograd <span class="hljs-keyword">import</span> Function  <span class="hljs-comment"># 自动微分</span><br> <br><span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim  <span class="hljs-comment"># 优化器</span><br><span class="hljs-keyword">import</span> torchvision.transforms <span class="hljs-keyword">as</span> transforms<br><span class="hljs-keyword">from</span> torchvision.datasets <span class="hljs-keyword">import</span> ImageFolder<br><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader<br><br><span class="hljs-comment"># source_transform 使用 Canny 算法进行边缘检测，然后应用了一些数据增强操作，如翻转和旋转。</span><br>source_transform = transforms.Compose([<br>    <span class="hljs-comment"># Turn RGB to grayscale. (Bacause Canny do not support RGB images.)</span><br>    transforms.Grayscale(),  <span class="hljs-comment"># 转换为灰度图</span><br>    <span class="hljs-comment"># cv2 do not support skimage.Image, so we transform it to np.array, </span><br>    <span class="hljs-comment"># and then adopt cv2.Canny algorithm.</span><br>    transforms.Lambda(<span class="hljs-keyword">lambda</span> x: cv2.Canny(np.array(x), <span class="hljs-number">170</span>, <span class="hljs-number">300</span>)),  <span class="hljs-comment"># 应用 Canny 边缘检测</span><br>    <span class="hljs-comment"># Transform np.array back to the skimage.Image.</span><br>    transforms.ToPILImage(),  <span class="hljs-comment"># 转换为 PIL 图像对象</span><br>    <span class="hljs-comment"># 50% Horizontal Flip. (For Augmentation)</span><br>    transforms.RandomHorizontalFlip(),  <span class="hljs-comment"># 50% 概率水平翻转</span><br>    <span class="hljs-comment"># Rotate +- 15 degrees. (For Augmentation), and filled with zero </span><br>    <span class="hljs-comment"># if there&#x27;s empty pixel after rotation.</span><br>    transforms.RandomRotation(<span class="hljs-number">15</span>, fill=(<span class="hljs-number">0</span>,)),  <span class="hljs-comment"># 旋转 ±15 度，空白像素填充为 0</span><br>    <span class="hljs-comment"># Transform to tensor for model inputs.</span><br>    transforms.ToTensor(),  <span class="hljs-comment"># 转换为 PyTorch 张量</span><br>])<br><br><span class="hljs-comment"># target_transform 则不包含边缘检测，而是对图像大小进行了调整（从 28x28 调整到 32x32），以便与训练数据一致。</span><br>target_transform = transforms.Compose([<br>    <span class="hljs-comment"># Turn RGB to grayscale.</span><br>    transforms.Grayscale(),<br>    <span class="hljs-comment"># Resize: size of source data is 32x32, thus we need to </span><br>    <span class="hljs-comment">#  enlarge the size of target data from 28x28 to 32x32。</span><br>    transforms.Resize((<span class="hljs-number">32</span>, <span class="hljs-number">32</span>)),  <span class="hljs-comment"># 调整大小到 32x32</span><br>    <span class="hljs-comment"># 50% Horizontal Flip. (For Augmentation)</span><br>    transforms.RandomHorizontalFlip(),<br>    <span class="hljs-comment"># Rotate +- 15 degrees. (For Augmentation), and filled with zero </span><br>    <span class="hljs-comment"># if there&#x27;s empty pixel after rotation.</span><br>    transforms.RandomRotation(<span class="hljs-number">15</span>, fill=(<span class="hljs-number">0</span>,)),<br>    <span class="hljs-comment"># Transform to tensor for model inputs.</span><br>    transforms.ToTensor(),<br>])<br><br><span class="hljs-comment"># ImageFolder 类从指定路径加载图像文件夹中的数据，并将 source_transform 和 target_transform 应用于图像数据。</span><br>source_dataset = ImageFolder(<span class="hljs-string">&#x27;real_or_drawing/train_data&#x27;</span>, transform=source_transform)<br>target_dataset = ImageFolder(<span class="hljs-string">&#x27;real_or_drawing/test_data&#x27;</span>, transform=target_transform)<br><br><span class="hljs-comment"># 这里的 DataLoader 为训练和测试集创建批量加载器，将数据分批次加载到模型中。</span><br><span class="hljs-comment"># batch_size=32 表示每个批次包含 32 张图像，shuffle=True 用于随机打乱训练集的顺序，有助于减少过拟合。</span><br><span class="hljs-comment"># test_dataloader 用于加载测试数据，shuffle=False 表示测试集的顺序不会被打乱。</span><br>source_dataloader = DataLoader(source_dataset, batch_size=<span class="hljs-number">32</span>, shuffle=<span class="hljs-literal">True</span>)<br>target_dataloader = DataLoader(target_dataset, batch_size=<span class="hljs-number">32</span>, shuffle=<span class="hljs-literal">True</span>)<br>test_dataloader = DataLoader(target_dataset, batch_size=<span class="hljs-number">128</span>, shuffle=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
<p><strong>模型</strong></p>
<p>​	Feature Extractor：经典 VGG 式架构</p>
<p>​	标签预测器/域分类器：线性模型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FeatureExtractor</span>(nn.Module):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(FeatureExtractor, <span class="hljs-variable language_">self</span>).__init__()<br><br>        <span class="hljs-comment"># FeatureExtractor 是一个卷积神经网络，用于从输入图像中提取高维特征。该模块包含 5 个卷积层块，每个块包括：</span><br>        <span class="hljs-variable language_">self</span>.conv = nn.Sequential(<br>            nn.Conv2d(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),  <span class="hljs-comment"># 一个卷积层（Conv2d）用于提取空间特征；</span><br>            nn.BatchNorm2d(<span class="hljs-number">64</span>),  <span class="hljs-comment"># 批归一化层（BatchNorm2d），用于稳定训练过程；</span><br>            nn.ReLU(),  <span class="hljs-comment"># ReLU 激活函数，使网络具有非线性；</span><br>            nn.MaxPool2d(<span class="hljs-number">2</span>),  <span class="hljs-comment"># 最大池化层（MaxPool2d），用于下采样和减少特征图的尺寸。</span><br><br>            nn.Conv2d(<span class="hljs-number">64</span>, <span class="hljs-number">128</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">128</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br><br>            nn.Conv2d(<span class="hljs-number">128</span>, <span class="hljs-number">256</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">256</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br><br>            nn.Conv2d(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">256</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br><br>            nn.Conv2d(<span class="hljs-number">256</span>, <span class="hljs-number">512</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>)<br>        )<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = <span class="hljs-variable language_">self</span>.conv(x).squeeze()<br>        <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LabelPredictor</span>(nn.Module):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(LabelPredictor, <span class="hljs-variable language_">self</span>).__init__()<br><br>        <span class="hljs-variable language_">self</span>.layer = nn.Sequential(<br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),  <span class="hljs-comment"># 第一和第二层是 512 维输入和 512 维输出的全连接层，分别通过 ReLU 激活；</span><br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">10</span>),  <span class="hljs-comment"># 最后一层是一个全连接层，输出大小为 10，用于分类。</span><br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, h</span>):<br>        c = <span class="hljs-variable language_">self</span>.layer(h)<br>        <span class="hljs-keyword">return</span> c<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DomainClassifier</span>(nn.Module):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(DomainClassifier, <span class="hljs-variable language_">self</span>).__init__()<br><br>        <span class="hljs-variable language_">self</span>.layer = nn.Sequential(<br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),  <span class="hljs-comment"># 每个隐藏层之后都有批归一化（BatchNorm1d）和 ReLU 激活。</span><br>            nn.BatchNorm1d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.BatchNorm1d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.BatchNorm1d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.BatchNorm1d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">1</span>),  <span class="hljs-comment"># 最后一层是一个单神经元输出层（Linear(512, 1)），用于预测域标签。</span><br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, h</span>):<br>        y = <span class="hljs-variable language_">self</span>.layer(h)<br>        <span class="hljs-keyword">return</span> y<br></code></pre></td></tr></table></figure>
<p><strong>预处理</strong></p>
<p>​	在这里，我们使用 Adam 作为我们的优化器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 初始化模型并将其移动到 GPU</span><br>feature_extractor = FeatureExtractor().cuda()<br>label_predictor = LabelPredictor().cuda()<br>domain_classifier = DomainClassifier().cuda()<br><br><span class="hljs-comment"># 定义损失函数</span><br>class_criterion = nn.CrossEntropyLoss()  <span class="hljs-comment"># 交叉熵损失函数，用于分类任务。它会在 LabelPredictor 输出的类别概率分布和真实标签之间计算损失。</span><br>domain_criterion = nn.BCEWithLogitsLoss()  <span class="hljs-comment"># 二元交叉熵损失（带 Logits，即自动处理 sigmoid 函数），用于二分类任务。这里用于计算 DomainClassifier 的域分类损失（判断样本属于哪个域），即通过二值标签来判断样本来自哪个数据分布。</span><br><br><span class="hljs-comment"># 每个优化器使用 Adam 优化算法（optim.Adam），适合处理深度学习任务中的大量参数和梯度不稳定的问题。</span><br>optimizer_F = optim.Adam(feature_extractor.parameters())<br>optimizer_C = optim.Adam(label_predictor.parameters())<br>optimizer_D = optim.Adam(domain_classifier.parameters())<br></code></pre></td></tr></table></figure>
<p><strong>开始训练</strong></p>
<p><strong>DaNN 实施</strong></p>
<p>​	在原始论文中，使用了 Gradient Reversal Layer。 Feature Extractor、Label Predictor 和 Domain Classifier 都同时进行训练。在这段代码中，<strong>我们首先训练 Domain Classifier，然后训练我们的 Feature Extractor（与 GAN 中的 Generator 和 Discriminator 训练过程的概念相同）。</strong></p>
<p><strong>提醒</strong></p>
<ul>
<li>控制域对抗性损失的 Lambda 在原始论文中是自适应的。您可以参考<a target="_blank" rel="noopener" href="https://www.google.com/url?q=https%3A%2F%2Farxiv.org%2Fpdf%2F1505.07818.pdf">原著</a>。此处 lambda 设置为 0.1。</li>
<li>我们没有用于目标数据的标签，您只能通过将结果上传到 kaggle 来评估您的模型:)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">train_epoch</span>(<span class="hljs-params">source_dataloader, target_dataloader, lamb</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">      Args:</span><br><span class="hljs-string">        source_dataloader: source data 的 dataloader</span><br><span class="hljs-string">        target_dataloader: target data 的 dataloader</span><br><span class="hljs-string">        lamb: control the balance of domain adaptatoin and classification. 控制域适配与分类之间的平衡</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    <span class="hljs-comment"># D loss: Domain Classifier 的 loss</span><br>    <span class="hljs-comment"># F loss: Feature Extrator &amp; Label Predictor 的 loss</span><br>    <span class="hljs-comment"># running_D_loss 用于累计域分类器的损失；</span><br>    <span class="hljs-comment"># running_F_loss 用于累计特征提取器和标签分类器的损失；</span><br>    running_D_loss, running_F_loss = <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span><br>    <span class="hljs-comment"># total_hit 和 total_num 用于计算源域的分类准确率。</span><br>    total_hit, total_num = <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span><br><br>    <span class="hljs-keyword">for</span> i, ((source_data, source_label), (target_data, _)) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(source_dataloader, target_dataloader)):<br>    <span class="hljs-comment"># 这个循环同时迭代源域和目标域的数据批次。每次迭代中，source_data 和 source_label 为源域的图像和标签，target_data 为目标域的图像。</span><br>        source_data = source_data.cuda()<br>        source_label = source_label.cuda()<br>        target_data = target_data.cuda()<br>        <br>        <span class="hljs-comment"># Mixed the source data and target data, or it&#x27;ll mislead the running params of batch_norm. (runnning mean/var of soucre and target data are different.)</span><br>        <span class="hljs-comment"># 混合源数据和目标数据，否则会误导 batch_norm 的运行参数。（源和目标数据的运行均值/方差不同。</span><br>        mixed_data = torch.cat([source_data, target_data], dim=<span class="hljs-number">0</span>)<br>        <span class="hljs-comment"># 为混合数据生成域标签 domain_label，源域数据的标签设为 1，目标域数据的标签设为 0</span><br>        domain_label = torch.zeros([source_data.shape[<span class="hljs-number">0</span>] + target_data.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>]).cuda()<br>        <span class="hljs-comment"># set domain label of source data to be 1.</span><br>        domain_label[:source_data.shape[<span class="hljs-number">0</span>]] = <span class="hljs-number">1</span><br><br>        <span class="hljs-comment"># Step 1 : train domain classifier</span><br>        <span class="hljs-comment"># 第一步：训练域分类器</span><br>        <span class="hljs-comment"># 提取合并数据的特征 feature，feature.detach() 防止梯度反向传播到 feature_extractor。</span><br>        feature = feature_extractor(mixed_data)<br>        <span class="hljs-comment"># We don&#x27;t need to train feature extractor in step 1.</span><br>        <span class="hljs-comment"># Thus we detach the feature neuron to avoid backpropgation.</span><br>        domain_logits = domain_classifier(feature.detach())<br>        <span class="hljs-comment"># 使用域标签 domain_label 和预测的 domain_logits 计算域分类损失 loss。</span><br>        loss = domain_criterion(domain_logits, domain_label)<br>        running_D_loss += loss.item()<br>        loss.backward()<br>        optimizer_D.step()<br><br>        <span class="hljs-comment"># Step 2 : train feature extractor and label classifier</span><br>        <span class="hljs-comment"># 第二步：训练特征提取器和标签分类器</span><br>        <span class="hljs-comment"># class_logits 是标签分类器的预测结果，用于源域的分类。</span><br>        class_logits = label_predictor(feature[:source_data.shape[<span class="hljs-number">0</span>]])<br>        <span class="hljs-comment"># domain_logits 用于域分类。</span><br>        domain_logits = domain_classifier(feature)<br>        <span class="hljs-comment"># loss = cross entropy of classification - lamb * domain binary cross entropy.</span><br>        <span class="hljs-comment">#  The reason why using subtraction is similar to generator loss in disciminator of GAN</span><br>        <span class="hljs-comment"># 损失函数包括源域的分类损失 class_criterion(class_logits, source_label) 和域适配损失 domain_criterion(domain_logits, domain_label)，两者相减以达到类似对抗训练的效果。</span><br>        loss = class_criterion(class_logits, source_label) - lamb * domain_criterion(domain_logits, domain_label)<br>        running_F_loss += loss.item()<br>        loss.backward()<br>        <span class="hljs-comment"># 更新 feature_extractor 和 label_predictor 的参数。</span><br>        <span class="hljs-comment"># 每次训练批次后清零梯度，并计算源域的分类准确率。</span><br>        optimizer_F.step()<br>        optimizer_C.step()<br><br>        optimizer_D.zero_grad()<br>        optimizer_F.zero_grad()<br>        optimizer_C.zero_grad()<br><br>        total_hit += torch.<span class="hljs-built_in">sum</span>(torch.argmax(class_logits, dim=<span class="hljs-number">1</span>) == source_label).item()<br>        total_num += source_data.shape[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(i, end=<span class="hljs-string">&#x27;\r&#x27;</span>)<br><br>    <span class="hljs-keyword">return</span> running_D_loss / (i+<span class="hljs-number">1</span>), running_F_loss / (i+<span class="hljs-number">1</span>), total_hit / total_num<br><br><span class="hljs-comment"># train 200 epochs</span><br><span class="hljs-comment"># 在 200 个 epoch 中循环，每次 epoch 后保存模型参数并输出训练的损失和准确率。</span><br><span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>):<br>  <br>    train_D_loss, train_F_loss, train_acc = train_epoch(source_dataloader, target_dataloader, lamb=<span class="hljs-number">0.1</span>)<br><br>    torch.save(feature_extractor.state_dict(), <span class="hljs-string">f&#x27;extractor_model.bin&#x27;</span>)<br>    torch.save(label_predictor.state_dict(), <span class="hljs-string">f&#x27;predictor_model.bin&#x27;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;epoch &#123;:&gt;3d&#125;: train D loss: &#123;:6.4f&#125;, train F loss: &#123;:6.4f&#125;, acc &#123;:6.4f&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(epoch, train_D_loss, train_F_loss, train_acc))<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">epoch   0: train D loss: 0.6715, train F loss: 1.8669, acc 0.2928<br>epoch   1: train D loss: 0.6264, train F loss: 1.5707, acc 0.4166<br>epoch   2: train D loss: 0.5412, train F loss: 1.4445, acc 0.4794<br>epoch   3: train D loss: 0.5390, train F loss: 1.3692, acc 0.4992<br>epoch   4: train D loss: 0.5540, train F loss: 1.3243, acc 0.5140<br>epoch   5: train D loss: 0.5439, train F loss: 1.2459, acc 0.5480<br>epoch   6: train D loss: 0.5538, train F loss: 1.2264, acc 0.5482<br>epoch   7: train D loss: 0.5369, train F loss: 1.1544, acc 0.5800<br>epoch   8: train D loss: 0.5194, train F loss: 1.1397, acc 0.5838<br>epoch   9: train D loss: 0.5368, train F loss: 1.0921, acc 0.5950<br>epoch  10: train D loss: 0.5298, train F loss: 1.0657, acc 0.6070<br>epoch  11: train D loss: 0.5146, train F loss: 1.0287, acc 0.6186<br>epoch  12: train D loss: 0.5331, train F loss: 0.9963, acc 0.6338<br>epoch  13: train D loss: 0.5301, train F loss: 0.9842, acc 0.6412<br>epoch  14: train D loss: 0.5383, train F loss: 0.9447, acc 0.6488<br>epoch  15: train D loss: 0.5252, train F loss: 0.9263, acc 0.6560<br>epoch  16: train D loss: 0.5268, train F loss: 0.8820, acc 0.6748<br>epoch  17: train D loss: 0.5110, train F loss: 0.8503, acc 0.6848<br>epoch  18: train D loss: 0.4955, train F loss: 0.8061, acc 0.7070<br>epoch  19: train D loss: 0.5145, train F loss: 0.7806, acc 0.7096<br>epoch  20: train D loss: 0.4760, train F loss: 0.7562, acc 0.7194<br>epoch  21: train D loss: 0.4721, train F loss: 0.7087, acc 0.7350<br>epoch  22: train D loss: 0.4876, train F loss: 0.6906, acc 0.7458<br>epoch  23: train D loss: 0.4821, train F loss: 0.6563, acc 0.7580<br>epoch  24: train D loss: 0.4547, train F loss: 0.6063, acc 0.7780<br>epoch  25: train D loss: 0.4642, train F loss: 0.6035, acc 0.7788<br>epoch  26: train D loss: 0.4758, train F loss: 0.5768, acc 0.7826<br>epoch  27: train D loss: 0.4539, train F loss: 0.5465, acc 0.7956<br>epoch  28: train D loss: 0.4447, train F loss: 0.4864, acc 0.8144<br>epoch  29: train D loss: 0.4610, train F loss: 0.5191, acc 0.8064<br>epoch  30: train D loss: 0.4341, train F loss: 0.4504, acc 0.8372<br>epoch  31: train D loss: 0.4363, train F loss: 0.4291, acc 0.8380<br>epoch  32: train D loss: 0.4493, train F loss: 0.4082, acc 0.8508<br>epoch  33: train D loss: 0.4308, train F loss: 0.3958, acc 0.8506<br>epoch  34: train D loss: 0.4318, train F loss: 0.3513, acc 0.8658<br>epoch  35: train D loss: 0.4356, train F loss: 0.3378, acc 0.8708<br>epoch  36: train D loss: 0.3975, train F loss: 0.3467, acc 0.8684<br>epoch  37: train D loss: 0.4213, train F loss: 0.3099, acc 0.8794<br>epoch  38: train D loss: 0.3939, train F loss: 0.2874, acc 0.8900<br>epoch  39: train D loss: 0.4279, train F loss: 0.3113, acc 0.8826<br>epoch  40: train D loss: 0.4045, train F loss: 0.2726, acc 0.8916<br>epoch  41: train D loss: 0.4015, train F loss: 0.2682, acc 0.8974<br>epoch  42: train D loss: 0.3976, train F loss: 0.2458, acc 0.9062<br>epoch  43: train D loss: 0.4092, train F loss: 0.2502, acc 0.9026<br>epoch  44: train D loss: 0.3983, train F loss: 0.2196, acc 0.9120<br>epoch  45: train D loss: 0.3920, train F loss: 0.2242, acc 0.9158<br>epoch  46: train D loss: 0.4072, train F loss: 0.2050, acc 0.9168<br>epoch  47: train D loss: 0.3964, train F loss: 0.1852, acc 0.9272<br>epoch  48: train D loss: 0.4001, train F loss: 0.2130, acc 0.9172<br>epoch  49: train D loss: 0.3910, train F loss: 0.1914, acc 0.9248<br>epoch  50: train D loss: 0.3924, train F loss: 0.1978, acc 0.9228<br>epoch  51: train D loss: 0.3916, train F loss: 0.1758, acc 0.9262<br>epoch  52: train D loss: 0.3843, train F loss: 0.1651, acc 0.9314<br>epoch  53: train D loss: 0.3681, train F loss: 0.1555, acc 0.9352<br>epoch  54: train D loss: 0.3960, train F loss: 0.1557, acc 0.9320<br>epoch  55: train D loss: 0.3765, train F loss: 0.1543, acc 0.9356<br>epoch  56: train D loss: 0.3789, train F loss: 0.1420, acc 0.9406<br>epoch  57: train D loss: 0.3878, train F loss: 0.1423, acc 0.9418<br>epoch  58: train D loss: 0.3799, train F loss: 0.1477, acc 0.9396<br>epoch  59: train D loss: 0.3710, train F loss: 0.1316, acc 0.9450<br>epoch  60: train D loss: 0.3815, train F loss: 0.1294, acc 0.9456<br>epoch  61: train D loss: 0.3789, train F loss: 0.1300, acc 0.9466<br>epoch  62: train D loss: 0.3912, train F loss: 0.1273, acc 0.9472<br>epoch  63: train D loss: 0.4002, train F loss: 0.1206, acc 0.9492<br>epoch  64: train D loss: 0.3895, train F loss: 0.1332, acc 0.9432<br>epoch  65: train D loss: 0.3853, train F loss: 0.1152, acc 0.9518<br>epoch  66: train D loss: 0.3878, train F loss: 0.1420, acc 0.9424<br>epoch  67: train D loss: 0.3823, train F loss: 0.1158, acc 0.9478<br>epoch  68: train D loss: 0.3798, train F loss: 0.1131, acc 0.9514<br>epoch  69: train D loss: 0.3736, train F loss: 0.1022, acc 0.9508<br>epoch  70: train D loss: 0.3749, train F loss: 0.1215, acc 0.9498<br>epoch  71: train D loss: 0.3752, train F loss: 0.0972, acc 0.9572<br>epoch  72: train D loss: 0.3745, train F loss: 0.1077, acc 0.9558<br>epoch  73: train D loss: 0.3694, train F loss: 0.1041, acc 0.9562<br>epoch  74: train D loss: 0.3717, train F loss: 0.0976, acc 0.9534<br>epoch  75: train D loss: 0.3718, train F loss: 0.1092, acc 0.9552<br>epoch  76: train D loss: 0.3717, train F loss: 0.0744, acc 0.9648<br>epoch  77: train D loss: 0.3794, train F loss: 0.0861, acc 0.9590<br>epoch  78: train D loss: 0.3652, train F loss: 0.1077, acc 0.9586<br>epoch  79: train D loss: 0.3774, train F loss: 0.0617, acc 0.9674<br>epoch  80: train D loss: 0.3712, train F loss: 0.0974, acc 0.9582<br>epoch  81: train D loss: 0.3725, train F loss: 0.1011, acc 0.9546<br>epoch  82: train D loss: 0.3812, train F loss: 0.0931, acc 0.9596<br>epoch  83: train D loss: 0.3720, train F loss: 0.0634, acc 0.9668<br>epoch  84: train D loss: 0.3752, train F loss: 0.0738, acc 0.9666<br>epoch  85: train D loss: 0.3851, train F loss: 0.1143, acc 0.9536<br>epoch  86: train D loss: 0.3821, train F loss: 0.0813, acc 0.9618<br>epoch  87: train D loss: 0.3911, train F loss: 0.0735, acc 0.9648<br>epoch  88: train D loss: 0.3837, train F loss: 0.0832, acc 0.9604<br>epoch  89: train D loss: 0.3884, train F loss: 0.0757, acc 0.9624<br>epoch  90: train D loss: 0.3728, train F loss: 0.0761, acc 0.9640<br>epoch  91: train D loss: 0.3969, train F loss: 0.0718, acc 0.9632<br>epoch  92: train D loss: 0.3646, train F loss: 0.0668, acc 0.9632<br>epoch  93: train D loss: 0.3808, train F loss: 0.0756, acc 0.9662<br>epoch  94: train D loss: 0.3650, train F loss: 0.0818, acc 0.9628<br>epoch  95: train D loss: 0.3781, train F loss: 0.0610, acc 0.9682<br>epoch  96: train D loss: 0.3837, train F loss: 0.0587, acc 0.9684<br>epoch  97: train D loss: 0.3809, train F loss: 0.0591, acc 0.9680<br>epoch  98: train D loss: 0.3714, train F loss: 0.0626, acc 0.9670<br>epoch  99: train D loss: 0.3909, train F loss: 0.0753, acc 0.9632<br>epoch 100: train D loss: 0.3641, train F loss: 0.0607, acc 0.9696<br>epoch 101: train D loss: 0.3730, train F loss: 0.0853, acc 0.9612<br>epoch 102: train D loss: 0.3746, train F loss: 0.0511, acc 0.9706<br>epoch 103: train D loss: 0.3831, train F loss: 0.0493, acc 0.9700<br>epoch 104: train D loss: 0.3882, train F loss: 0.0751, acc 0.9622<br>epoch 105: train D loss: 0.3777, train F loss: 0.0508, acc 0.9726<br>epoch 106: train D loss: 0.3702, train F loss: 0.0462, acc 0.9732<br>epoch 107: train D loss: 0.3694, train F loss: 0.0542, acc 0.9734<br>epoch 108: train D loss: 0.3700, train F loss: 0.0520, acc 0.9712<br>epoch 109: train D loss: 0.3596, train F loss: 0.0439, acc 0.9738<br>epoch 110: train D loss: 0.3681, train F loss: 0.0544, acc 0.9688<br>epoch 111: train D loss: 0.3840, train F loss: 0.0592, acc 0.9674<br>epoch 112: train D loss: 0.3770, train F loss: 0.0624, acc 0.9682<br>epoch 113: train D loss: 0.3644, train F loss: 0.0531, acc 0.9720<br>epoch 114: train D loss: 0.3787, train F loss: 0.0566, acc 0.9712<br>epoch 115: train D loss: 0.3720, train F loss: 0.0429, acc 0.9746<br>epoch 116: train D loss: 0.3768, train F loss: 0.0489, acc 0.9732<br>epoch 117: train D loss: 0.3765, train F loss: 0.0412, acc 0.9748<br>epoch 118: train D loss: 0.3820, train F loss: 0.0450, acc 0.9724<br>epoch 119: train D loss: 0.3735, train F loss: 0.0386, acc 0.9768<br>epoch 120: train D loss: 0.3774, train F loss: 0.0436, acc 0.9736<br>epoch 121: train D loss: 0.3816, train F loss: 0.0491, acc 0.9708<br>epoch 122: train D loss: 0.3717, train F loss: 0.0587, acc 0.9686<br>epoch 123: train D loss: 0.3802, train F loss: 0.0538, acc 0.9714<br>epoch 124: train D loss: 0.3878, train F loss: 0.0432, acc 0.9762<br>epoch 125: train D loss: 0.3785, train F loss: 0.0453, acc 0.9746<br>epoch 126: train D loss: 0.3749, train F loss: 0.0423, acc 0.9774<br>epoch 127: train D loss: 0.3925, train F loss: 0.0328, acc 0.9766<br>epoch 128: train D loss: 0.3874, train F loss: 0.0546, acc 0.9682<br>epoch 129: train D loss: 0.3843, train F loss: 0.0482, acc 0.9712<br>epoch 130: train D loss: 0.3698, train F loss: 0.0500, acc 0.9736<br>epoch 131: train D loss: 0.3752, train F loss: 0.0368, acc 0.9762<br>epoch 132: train D loss: 0.3818, train F loss: 0.0303, acc 0.9784<br>epoch 133: train D loss: 0.3838, train F loss: 0.0490, acc 0.9722<br>epoch 134: train D loss: 0.3744, train F loss: 0.0332, acc 0.9792<br>epoch 135: train D loss: 0.3743, train F loss: 0.0311, acc 0.9786<br>epoch 136: train D loss: 0.3838, train F loss: 0.0419, acc 0.9728<br>epoch 137: train D loss: 0.3951, train F loss: 0.0352, acc 0.9760<br>epoch 138: train D loss: 0.3878, train F loss: 0.0439, acc 0.9732<br>epoch 139: train D loss: 0.3879, train F loss: 0.0419, acc 0.9736<br>epoch 140: train D loss: 0.3871, train F loss: 0.0355, acc 0.9758<br>epoch 141: train D loss: 0.3819, train F loss: 0.0392, acc 0.9746<br>epoch 142: train D loss: 0.3905, train F loss: 0.0578, acc 0.9722<br>epoch 143: train D loss: 0.3816, train F loss: 0.0350, acc 0.9758<br>epoch 144: train D loss: 0.3899, train F loss: 0.0175, acc 0.9822<br>epoch 145: train D loss: 0.4025, train F loss: 0.0469, acc 0.9748<br>epoch 146: train D loss: 0.3715, train F loss: 0.0345, acc 0.9748<br>epoch 147: train D loss: 0.3841, train F loss: 0.0375, acc 0.9744<br>epoch 148: train D loss: 0.3833, train F loss: 0.0310, acc 0.9802<br>epoch 149: train D loss: 0.3805, train F loss: 0.0263, acc 0.9764<br>epoch 150: train D loss: 0.3763, train F loss: 0.0352, acc 0.9760<br>epoch 151: train D loss: 0.3861, train F loss: 0.0330, acc 0.9778<br>epoch 152: train D loss: 0.3844, train F loss: 0.0340, acc 0.9764<br>epoch 153: train D loss: 0.3902, train F loss: 0.0311, acc 0.9764<br>epoch 154: train D loss: 0.3782, train F loss: 0.0387, acc 0.9760<br>epoch 155: train D loss: 0.3950, train F loss: 0.0180, acc 0.9808<br>epoch 156: train D loss: 0.4017, train F loss: 0.0205, acc 0.9808<br>epoch 157: train D loss: 0.3952, train F loss: 0.0484, acc 0.9734<br>epoch 158: train D loss: 0.3885, train F loss: 0.0346, acc 0.9776<br>epoch 159: train D loss: 0.3916, train F loss: 0.0202, acc 0.9812<br>epoch 160: train D loss: 0.3980, train F loss: 0.0306, acc 0.9774<br>epoch 161: train D loss: 0.3897, train F loss: 0.0306, acc 0.9800<br>epoch 162: train D loss: 0.3909, train F loss: 0.0164, acc 0.9816<br>epoch 163: train D loss: 0.3911, train F loss: 0.0273, acc 0.9806<br>epoch 164: train D loss: 0.3737, train F loss: 0.0133, acc 0.9830<br>epoch 165: train D loss: 0.4064, train F loss: 0.0520, acc 0.9706<br>epoch 166: train D loss: 0.3951, train F loss: 0.0242, acc 0.9810<br>epoch 167: train D loss: 0.3865, train F loss: 0.0287, acc 0.9810<br>epoch 168: train D loss: 0.3921, train F loss: 0.0141, acc 0.9814<br>epoch 169: train D loss: 0.3862, train F loss: 0.0130, acc 0.9836<br>epoch 170: train D loss: 0.4018, train F loss: 0.0273, acc 0.9764<br>epoch 171: train D loss: 0.4053, train F loss: 0.0254, acc 0.9774<br>epoch 172: train D loss: 0.4040, train F loss: 0.0169, acc 0.9810<br>epoch 173: train D loss: 0.3935, train F loss: 0.0463, acc 0.9734<br>epoch 174: train D loss: 0.3991, train F loss: 0.0199, acc 0.9804<br>epoch 175: train D loss: 0.3919, train F loss: 0.0275, acc 0.9800<br>epoch 176: train D loss: 0.4021, train F loss: 0.0315, acc 0.9780<br>epoch 177: train D loss: 0.3856, train F loss: 0.0289, acc 0.9796<br>epoch 178: train D loss: 0.3880, train F loss: 0.0171, acc 0.9812<br>epoch 179: train D loss: 0.3874, train F loss: 0.0200, acc 0.9824<br>epoch 180: train D loss: 0.3974, train F loss: 0.0243, acc 0.9826<br>epoch 181: train D loss: 0.3981, train F loss: 0.0191, acc 0.9812<br>epoch 182: train D loss: 0.4048, train F loss: 0.0159, acc 0.9822<br>epoch 183: train D loss: 0.3929, train F loss: 0.0212, acc 0.9796<br>epoch 184: train D loss: 0.3944, train F loss: 0.0130, acc 0.9822<br>epoch 185: train D loss: 0.3895, train F loss: 0.0402, acc 0.9752<br>epoch 186: train D loss: 0.3849, train F loss: 0.0136, acc 0.9826<br>epoch 187: train D loss: 0.3791, train F loss: 0.0222, acc 0.9814<br>epoch 188: train D loss: 0.3990, train F loss: 0.0190, acc 0.9812<br>epoch 189: train D loss: 0.3964, train F loss: 0.0317, acc 0.9794<br>epoch 190: train D loss: 0.3935, train F loss: 0.0385, acc 0.9788<br>epoch 191: train D loss: 0.3914, train F loss: 0.0218, acc 0.9812<br>epoch 192: train D loss: 0.3764, train F loss: 0.0212, acc 0.9822<br>epoch 193: train D loss: 0.3782, train F loss: 0.0193, acc 0.9836<br>epoch 194: train D loss: 0.3787, train F loss: 0.0111, acc 0.9832<br>epoch 195: train D loss: 0.4000, train F loss: 0.0239, acc 0.9808<br>epoch 196: train D loss: 0.3830, train F loss: 0.0201, acc 0.9836<br>epoch 197: train D loss: 0.4085, train F loss: 0.0230, acc 0.9802<br>epoch 198: train D loss: 0.3908, train F loss: 0.0197, acc 0.9802<br>epoch 199: train D loss: 0.3981, train F loss: 0.0170, acc 0.9820<br></code></pre></td></tr></table></figure>
<p><strong>绘制图表：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-comment"># 你的字符串数据</span><br>data = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">epoch   0: train D loss: 0.6715, train F loss: 1.8669, acc 0.2928</span><br><span class="hljs-string">epoch   1: train D loss: 0.6264, train F loss: 1.5707, acc 0.4166</span><br><span class="hljs-string">epoch   2: train D loss: 0.5412, train F loss: 1.4445, acc 0.4794</span><br><span class="hljs-string">epoch   3: train D loss: 0.5390, train F loss: 1.3692, acc 0.4992</span><br><span class="hljs-string">...</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># 使用正则表达式提取数据</span><br>pattern = <span class="hljs-string">r&quot;epoch\s+(\d+): train D loss: ([\d.]+), train F loss: ([\d.]+), acc ([\d.]+)&quot;</span><br>matches = re.findall(pattern, data)<br><br><span class="hljs-comment"># 转换数据格式</span><br>epochs = []<br>d_losses = []<br>f_losses = []<br>accuracies = []<br><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> matches:<br>    epoch, d_loss, f_loss, acc = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">float</span>, <span class="hljs-keyword">match</span>)<br>    epochs.append(<span class="hljs-built_in">int</span>(epoch))<br>    d_losses.append(d_loss)<br>    f_losses.append(f_loss)<br>    accuracies.append(acc)<br><br><span class="hljs-comment"># 绘制图表</span><br>plt.figure(figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>))<br><br><span class="hljs-comment"># 绘制 D loss 和 F loss</span><br>plt.subplot(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>plt.plot(epochs, d_losses, label=<span class="hljs-string">&#x27;D Loss&#x27;</span>, color=<span class="hljs-string">&#x27;blue&#x27;</span>)<br>plt.plot(epochs, f_losses, label=<span class="hljs-string">&#x27;F Loss&#x27;</span>, color=<span class="hljs-string">&#x27;orange&#x27;</span>)<br>plt.xlabel(<span class="hljs-string">&#x27;Epoch&#x27;</span>)<br>plt.ylabel(<span class="hljs-string">&#x27;Loss&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;Train Losses Over Epochs&#x27;</span>)<br>plt.legend()<br><br><span class="hljs-comment"># 绘制 Accuracy</span><br>plt.subplot(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>plt.plot(epochs, accuracies, label=<span class="hljs-string">&#x27;Accuracy&#x27;</span>, color=<span class="hljs-string">&#x27;green&#x27;</span>)<br>plt.xlabel(<span class="hljs-string">&#x27;Epoch&#x27;</span>)<br>plt.ylabel(<span class="hljs-string">&#x27;Accuracy&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;Accuracy Over Epochs&#x27;</span>)<br>plt.legend()<br><br>plt.tight_layout()<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="graph.png" alt="png"></p>
<p><strong>推理</strong></p>
<p>​	我们使用 pandas 生成 csv 文件。</p>
<p>​	顺便说一句，训练 200 个 epoch 的模型的性能可能不稳定。您可以训练更多 epoch 以获得更稳定的性能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 初始化和设置模型为评估模式</span><br>result = []<br>label_predictor.<span class="hljs-built_in">eval</span>()<br>feature_extractor.<span class="hljs-built_in">eval</span>()<br><br><span class="hljs-comment"># 循环遍历测试数据并进行预测</span><br><span class="hljs-keyword">for</span> i, (test_data, _) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(test_dataloader):<br>    test_data = test_data.cuda()<br><br>    class_logits = label_predictor(feature_extractor(test_data))<br><br>    x = torch.argmax(class_logits, dim=<span class="hljs-number">1</span>).cpu().detach().numpy()<br>    result.append(x)<br><br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br>result = np.concatenate(result)<br><br><span class="hljs-comment"># Generate your submission</span><br><span class="hljs-comment"># 合并预测结果</span><br>df = pd.DataFrame(&#123;<span class="hljs-string">&#x27;id&#x27;</span>: np.arange(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(result)), <span class="hljs-string">&#x27;label&#x27;</span>: result&#125;)<br>df.to_csv(<span class="hljs-string">&#x27;DaNN_submission.csv&#x27;</span>,index=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
<p><strong>可视化</strong></p>
<p>​	我们使用 t-SNE 图来观察提取特征的分布。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> manifold<br></code></pre></td></tr></table></figure>

            </article>
            
	<div class="rightside">
	
		<div class="rightside-button" id="js-aside">
			<span>
				<img no-lazy src="/images/icon/aside.png" class="rightside-button-icon" alt="Icon">
			</span>
		</div>
		<script>
			$("#js-aside").click(function () {
				onShowAsideButton();
			});
		</script>
	
	<div class="rightside-button" id="js-toggle_theme">
		<span>
			<img no-lazy src="/images/icon/toggle_theme.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	
<script src="/js/plugins/goto_position.js"></script>

	
	<div class="rightside-button" id="js-go_top">
		<span>
			<img no-lazy src="/images/icon/go_top.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>
	<div class="rightside-button" id="js-go_bottom">
		<span>
			<img no-lazy src="/images/icon/go_bottom.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	<script>
		setToggleThemeButtonListener();
	</script>
	<script>
		$('#js-go_top')
		.gotoPosition( {
			speed: 300,
			target: 'top',
		} );
		$('#js-go_bottom')
		.gotoPosition( {
			speed: 300,
			target: 'bottom',
		} );
	</script>
</div>


<div class="post-bottom">
    
        <div class="post-paging">     
            <div class="post-paging-last">
                
                    <a href="/posts/Diary-%E5%8F%88%E5%8F%88%E9%9B%84%E4%BA%86/">
                        上一篇：Diary-又又雄了
                    </a>
                
            </div>
            <div class="post-paging-next">
                
                    <a href="/posts/Diary-5-%E6%9B%B4%E5%AF%92%E9%A3%8E%E4%B8%8E%E6%9B%B4%E9%9B%BE%E9%9C%BE/">
                        下一篇：Diary-5-更寒风与更雾霾
                    </a>
                
            </div>
        </div>
    
    
    
        
            <div class="giscus comments"></div>
            <script>
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://giscus.app/client.js';
                scriptElement.setAttribute('data-repo', 'GZ-Metal-Cell/GZ-Metal-Cell.github.io');
                scriptElement.setAttribute('data-repo-id', 'R_kgDOIHLEOQ');
                scriptElement.setAttribute('data-category', 'Announcements');
                scriptElement.setAttribute('data-category-id', 'DIC_kwDOIHLEOc4CcVwP');
                scriptElement.setAttribute('data-mapping', 'title');
                scriptElement.setAttribute('data-strict', '1');
                scriptElement.setAttribute('data-reactions-enabled', '');
                scriptElement.setAttribute('data-emit-metadata', '0');
                scriptElement.setAttribute('data-input-position', 'bottom');
                scriptElement.setAttribute('data-theme', localStorage.getItem('theme') === 'light' ? 'light' : 'dark_high_contrast');
                scriptElement.setAttribute('data-lang', 'zh-CN');
                
                scriptElement.setAttribute('crossorigin', 'anonymous');
                scriptElement.async = true;
                document.head.appendChild(scriptElement);
            </script>
        
    
</div>
        </div>
    </main>
    
        <aside class="main-aside">
    
<script src="/js/widgets/aside.js"></script>

    <script>
        showAside();
    </script>

    <div class="aside-top">
        <div class="aside-top-about aside-card">
            <a href="/about" class="aside-top-about-portrait">
                <img no-lazy src="/about/portrait.png" alt="Q">
            </a>
            <div class="aside-top-about-info">
                <span class="author"> Zi-Zi</span>
                <span class="description">不以物喜，不以己悲。</span>
            </div>              
            <div class="aside-top-about-site">
                <a href="/categories" class="aside-top-about-site-item">
                    <span class="title">类别</span>
                    <span class="count">5</span>
                </a>
                <a href="/tags" class="aside-top-about-site-item">
                    <span class="title">标签</span>
                    <span class="count">121</span>
                </a>
                <a href="/archives" class="aside-top-about-site-item">
                    <span class="title">归档</span>
                    <span class="count">436</span>
                </a>
            </div>
            <div class="aside-top-about-contact">
                
                    
                        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
                            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
                            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
                            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
                            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
                        </a>
                    
                
            </div>
        </div> 

        
            <div class="aside-top-series aside-card">
                <ol class="aside-top-series-content">
                    
                    
                    
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 1-Introduction of Deep Learning/">
                                                <span class="text">ML-李宏毅-Lecture 1-Introduction of Deep Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 2-What to do if my network fails to train/">
                                                <span class="text">ML-李宏毅-Lecture 2-What to do if my network fails to train</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 3-Image as input/">
                                                <span class="text">ML-李宏毅-Lecture 3-Image as input</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 4-Sequence as input/">
                                                <span class="text">ML-李宏毅-Lecture 4-Sequence as input</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 5-Sequence to sequence/">
                                                <span class="text">ML-李宏毅-Lecture 5-Sequence to sequence</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 6-Generation/">
                                                <span class="text">ML-李宏毅-Lecture 6-Generation</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Recent Advance of Self-supervised learning for NLP/">
                                                <span class="text">ML-李宏毅-Recent Advance of Self-supervised learning for NLP</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 7-Self-supervised learning for Speech and Image/">
                                                <span class="text">ML-李宏毅-Lecture 7-Self-supervised learning for Speech and Image</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 8-Auto-encoder Anomaly Detection/">
                                                <span class="text">ML-李宏毅-Lecture 8-Auto-encoder Anomaly Detection</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 9-Explainable AI/">
                                                <span class="text">ML-李宏毅-Lecture 9-Explainable AI</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 10-Attack/">
                                                <span class="text">ML-李宏毅-Lecture 10-Attack</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-正確認識 ChatGPT/">
                                                <span class="text">ML-李宏毅-正確認識 ChatGPT</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器學習基本概念介紹/">
                                                <span class="text">ML-李宏毅-機器學習基本概念介紹</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器如何生成文句/">
                                                <span class="text">ML-李宏毅-機器如何生成文句</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-【生成式AI】大模型 + 大資料 = 神奇結果？/">
                                                <span class="text">ML-李宏毅-【生成式AI】大模型 + 大資料 = 神奇結果？</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器如何生成圖像/">
                                                <span class="text">ML-李宏毅-機器如何生成圖像</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Pytorch-放一放之前看的一些代码/">
                                                <span class="text">Pytorch-放一放之前看的一些代码</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        
                                        <li class="series-item active">
                                            <a class="series-link active" href="/posts/ML-李宏毅-Lecture 11-Adaptation/">
                                                <span class="text">ML-李宏毅-Lecture 11-Adaptation</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 12-Reinforcement Learning/">
                                                <span class="text">ML-李宏毅-Lecture 12-Reinforcement Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 13-Network Compression/">
                                                <span class="text">ML-李宏毅-Lecture 13-Network Compression</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                </ol>
                <div class="aside-top-series-title">
                    <h1>
                        <a href="/tags/李宏毅">标签：李宏毅</a>
                    </h1>
                    <span id="serial-number">18/20</span>
                </div>
            </div>
            <script>
                activeSeriesItem();
            </script> 
        
    </div>

    <div class="aside-bottom">
        
            <script>
                
                    const tocCollapsed = true;
                
                
                    const tocDepth = 6;
                
                var headerString = '';
                for (let i = 1; i <= tocDepth; i++) {
                    if (i === 1) {
                        headerString += 'h1';
                    } else {
                        headerString += ', h' + i;
                    }
                }
                hbeToc();
            </script>
            <div class="aside-bottom-toc aside-card">
                <div class="aside-bottom-toc-title">
                    <h1>目录</h1>
                    <span class="toc-percentage"></span>
                </div>
                <ol class="aside-bottom-toc-content"></ol>
            </div>
        
    </div>
</aside>
    
</div>
		<footer>
	<div class="content">
		
			<span>©2022-2025&nbsp;By&nbsp;<a href="/about">Zi-Zi</a>.</span>
		
		<span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> theme by <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell/hexo-theme-quieter">Quieter</a>.</span>
		
			<span style="display: flex;">
				<img no-lazy alt="icp" src="/images/icp_icon.png" style="width: 16px; height: 16px;">
				<a href="https://icp.gov.moe/?keyword=20241647" target="_blank">萌 ICP 备 20241647 号</a>
			</span>
		
	</div>

	
<script src="/js/plugins/ref.js"></script>

	
<script src="/js/plugins/highlight_tools.js"></script>

	<script>
		const  COPY_ICON = "/images/icon/copy.png";
		const CLOSE_CODE_BLOCK_ICON = "/images/icon/close_code_block.png";
		const HIGHLIGHT_SHRINK = "";
		const HIGHLIGHT_HEIGHT_LIMIT = "360px";
	</script>

	
	
	<!-- Analytics -->

    
        <!-- Busuanzi Analytics -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?e57cf62289f84322ebff116e8b3d343e";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


	

	
		
			
				<link rel="stylesheet" href="/css/plugins/katex/katex.min.css">
				<script src="/js/plugins/copy-tex.js"></script>
			
		
	

    
		
<link rel="stylesheet" href="/css/plugins/textIndent.css">

		
<script src="/js/plugins/textIndent.js"></script>

	

	
	
	
		<script>
			if (typeof init === 'function') {
				init();
			}
		</script>
	

	
		
	

	

	<!--
		
<script src="/js/plugins/jquery.pjax.min.js"></script>

		<script>
			$(document).pjax('a[target!=_blank]', 'main', {
				fragment: 'main',
				timeout: 8000
			});

			$(document).on('pjax:complete', function() {
			});
		</script> 
	-->
	<script>
		console.log('\n %c Hexo-Quieter 主题 %c https://github.com/GZ-Metal-Cell/hexo-theme-quieter \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
	</script>
</footer>
	</body>

	<!-- Hexo-Quieter 主题  https://github.com/GZ-Metal-Cell/hexo-theme-quieter -->
</html>

