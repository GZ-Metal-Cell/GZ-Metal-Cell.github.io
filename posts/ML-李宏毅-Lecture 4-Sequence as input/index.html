<!DOCTYPE html>
<html lang=zh-CN data-theme="light">
	
<script src="/js/plugins/toggleTheme.js"></script>

	<script>
		setTheme();
	</script>
	<head>
		
<title>ML-李宏毅-Lecture 4-Sequence as input | Zi-Zi's Journey</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/images/icon/favicon.ico">
<link href="/css/plugins/print.css" media="print" rel="stylesheet" />

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="李宏毅,">
<meta name="description" content="李宏毅《机器学习2022》课程学习笔记。">



<script src="/js/plugins/jquery.min.js"></script>


<script src="/js/plugins/hljs.min.js"></script>


<script src="/js/plugins/init.js"></script>


<script src="/js/plugins/hide.js"></script>


<script src="/js/plugins/tabs.js"></script>



    



    
<script src="/js/plugins/alert-title.js"></script>

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-base.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-dark-class.css">

    
<link rel="stylesheet" href="/css/plugins/github-alerts/github-colors-light.css">






    

	<meta name="generator" content="Hexo 6.1.0"></head>

	<body>
		<header class="sticky-header">
	<nav>
		<div class="nav-left">
			<a href="/" class="logo">
				<img no-lazy src="/images/headers_icon/logo.webp" alt="Quieter">
			</a>
			<ul class="breadcrumb" id="breadcrumb"></ul>
		</div>
		<div class="nav-right">
			<ul>
				
					<li>
						<a href="/">
						  主页
						</a>
					</li>
				
					<li>
						<a href="/categories">
						  类别
						</a>
					</li>
				
					<li>
						<a href="/tags">
						  标签
						</a>
					</li>
				
					<li>
						<a href="/archives">
						  归档
						</a>
					</li>
				
					<li>
						<a href="/galleries">
						  相册
						</a>
					</li>
				
					<li>
						<a href="/links">
						  链接
						</a>
					</li>
				
					<li>
						<a href="/about">
						  关于
						</a>
					</li>
								  
			</ul>
		</div>
		<div class="nav-right-close">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
				<path fill="none" d="M0 0h24v24H0z" />
				<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
			</svg>
		</div>

		<div class="sidebar">
    <div class="topo">
        <p>Zi-Zi's Journey</p>
    </div>
    <ul>
        
        <li>
            <a href="/">
                主页
            </a>
        </li>
        
        <li>
            <a href="/categories">
                类别
            </a>
        </li>
        
        <li>
            <a href="/tags">
                标签
            </a>
        </li>
        
        <li>
            <a href="/archives">
                归档
            </a>
        </li>
        
        <li>
            <a href="/galleries">
                相册
            </a>
        </li>
        
        <li>
            <a href="/links">
                链接
            </a>
        </li>
        
        <li>
            <a href="/about">
                关于
            </a>
        </li>
        
    </ul>
    <div class="sidebar-footer">
        
        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
        </a>
        
        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
        </a>
        
    </div>
</div>
<div class='shelter'>
    <script>
        $(function() {
            $('.nav-right-close > svg').click(function() {
                $('.sidebar').animate({
                    right: "0"
                }, 500);
                $('.shelter').fadeIn("slow");
            
                var element = $('.topo');
                element.addClass('custom-style');
            
                var links = null;
                if ("") {
                    links = "".split(',');
                } else {
                    links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
                }
            
                var randomLink = links[Math.floor(Math.random() * links.length)];
                element.css('background-image', "url('" + randomLink + "')");
            });
          
            $('.shelter').click(function(e) {
                $('.sidebar').animate({
                    right: "-100%"
                }, 500);
                $('.shelter').fadeOut("slow");
            });
        });      
    </script>
</div>
	</nav>

	
		<div class="header-background"></div>
	

	<script>
		const name = 'post';
		const ul = document.querySelectorAll('.nav-right ul')[0];
		const lis = ul.querySelectorAll('li');

		if (name == 'home') {
			lis[0].classList.add('select');
		} else {
			for (let i = 0; i < lis.length; i++) {
				const li = lis[i];
				const a = li.querySelector('a');
				if (name === a.href.split('/')[3]) {
					li.classList.add('select');
				}
			}
		}
	</script>
	
	<script>
		var element = document.querySelector('.header-background');
		if(element) {
			element.classList.add('custom-style');
			var links = null;
			if("")
			{
				links = "".split(',');
			} else
			{
				links = "/images/random_top_img/01.webp,/images/random_top_img/02.webp,/images/random_top_img/03.webp,/images/random_top_img/04.webp,/images/random_top_img/05.webp,/images/random_top_img/06.webp,/images/random_top_img/07.webp,/images/random_top_img/08.webp,/images/random_top_img/09.webp,/images/random_top_img/10.webp,/images/random_top_img/11.webp,/images/random_top_img/12.webp,/images/random_top_img/13.webp,/images/random_top_img/14.webp,/images/random_top_img/15.webp,/images/random_top_img/16.webp,/images/random_top_img/17.webp,/images/random_top_img/18.webp,/images/random_top_img/19.webp,/images/random_top_img/20.webp,/images/random_top_img/21.webp,/images/random_top_img/22.webp,/images/random_top_img/23.webp,/images/random_top_img/24.webp,/images/random_top_img/25.webp,/images/random_top_img/26.webp,/images/random_top_img/27.webp,/images/random_top_img/28.webp,/images/random_top_img/29.webp,/images/random_top_img/30.webp,/images/random_top_img/31.webp,/images/random_top_img/32.webp,/images/random_top_img/33.webp,/images/random_top_img/34.webp,/images/random_top_img/35.webp,/images/random_top_img/36.webp,/images/random_top_img/37.webp,/images/random_top_img/38.webp,/images/random_top_img/39.webp,/images/random_top_img/40.webp,/images/random_top_img/41.webp,/images/random_top_img/42.webp,/images/random_top_img/43.webp,/images/random_top_img/44.webp,/images/random_top_img/45.webp,/images/random_top_img/46.webp,/images/random_top_img/47.webp,/images/random_top_img/48.webp,/images/random_top_img/49.webp,/images/random_top_img/50.webp,/images/random_top_img/51.webp,/images/random_top_img/52.webp,/images/random_top_img/53.webp,/images/random_top_img/54.webp,/images/random_top_img/55.webp,/images/random_top_img/56.webp,/images/random_top_img/57.webp".split(',');
			}
			var randomLink = links[Math.floor(Math.random() * links.length)];
			element.style.backgroundImage = "url('" + randomLink + "')";
		}
	</script>

	
<script src="/js/plugins/breadcrumb.js"></script>

	<script>
		var menus_title = [];
		
			menus_title.push({home: '主页'});
		
			menus_title.push({categories: '类别'});
		
			menus_title.push({tags: '标签'});
		
			menus_title.push({archives: '归档'});
		
			menus_title.push({galleries: '相册'});
		
			menus_title.push({links: '链接'});
		
			menus_title.push({about: '关于'});
		
		
			
				postsBreadcrumb(
					document.getElementById('breadcrumb'),
					"类别",
					"/categories",
					"学习",
					"/categories/学习",
					1
				);
			
		
	</script>
</header>

<div class="main-wrapper">
    <main class="post">
        <header class="main-header">
	
		
			
				
<link rel="stylesheet" href="/css/plugins/fancybox.css">

				
<script src="/js/plugins/fancybox.umd.js"></script>

				
<script src="/js/plugins/fancybox.js"></script>

			
			<div class="post-header-background-content">
				<ul class="post-header-tag">
					
						
							<li><a href="/tags/李宏毅"><span>李宏毅</span></a></li>
						
					
				</ul>
				
				<h1>ML-李宏毅-Lecture 4-Sequence as input</h1>
		
				
					<div class="post-header-desc">
						<svg t="1714702231661" class="icon" viewBox="0 0 1024 1024" version="1.1"
						xmlns="http://www.w3.org/2000/svg" p-id="1154" xmlns:xlink="http://www.w3.org/1999/xlink"
						width="20" height="20">
						<path
							d="M778.24 117.76A46.08 46.08 0 0 1 824.32 163.84v430.08c0 8.4992-4.13696 16.01536-10.50624 20.6848l-0.24576 0.2048L587.5712 846.09024a35.84 35.84 0 0 1-61.48096-25.06752v-220.9792a46.08 46.08 0 0 1 46.08-46.08l200.94976-0.02048V168.96h-522.24v686.08H389.12c13.25056 0 24.1664 10.07616 25.47712 22.97856l0.12288 2.62144c0 14.1312-11.4688 25.6-25.6 25.6h-143.36A46.08 46.08 0 0 1 199.68 860.16V163.84A46.08 46.08 0 0 1 245.76 117.76h532.48z m-26.78784 487.38304h-174.16192v178.176l174.16192-178.176z m-45.19936-169.94304a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z m0-122.88a25.6 25.6 0 0 1 0 51.2H307.2a25.6 25.6 0 0 1 0-51.2h399.0528z"
							fill="#ffffff" p-id="1155"></path>
						</svg>
						<p>李宏毅《机器学习2022》课程学习笔记。</p>
					</div>
				
		
				<div class="post-header-info">
					<svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
					xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
						<path
							d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
							p-id="2902" fill="#ffffff"></path>
					</svg>
					<div class="post-header-info-author">
						<a href="/about">Zi-Zi</a>
					</div>
					
						<div class="post-header-info-categories">
							
								<a href="/categories/学习">学习</a>
							
						</div>
					
					<time>2023/01/27 13:05:00</time>
				</div>
		
				
					<div class="post-header-stat">
						<svg version="1.0" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
						viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve" width="20" height="20">
							<path fill="#FFFFFF" d="M187.2,165.6c0,2.6-2.1,4.7-4.7,4.7H17.5c-2.6,0-4.7-2.1-4.7-4.7s2.1-4.7,4.7-4.7h165.1
								C185.2,160.9,187.2,163,187.2,165.6z"/>
							<path fill="#FFFFFF" d="M17.5,29.7c2.6,0,4.7,2.1,4.7,4.7v131.2c0,2.6-2.1,4.7-4.7,4.7s-4.7-2.1-4.7-4.7V34.4
								C12.8,31.8,14.9,29.7,17.5,29.7z M77.9,91.5c1.8,1.8,1.8,4.8,0,6.6l-39.8,39.8c-1.9,1.8-4.9,1.7-6.6-0.2c-1.7-1.8-1.7-4.6,0-6.4
								l39.8-39.8C73.1,89.6,76,89.6,77.9,91.5z M169.9,70.2c1.6,2.1,1.1,5-0.9,6.5c0,0,0,0,0,0l-64.2,48.2c-2.1,1.5-5,1.1-6.6-0.9
								c-1.6-2.1-1.1-5,0.9-6.5c0,0,0,0,0,0l64.2-48.2C165.4,67.7,168.3,68.1,169.9,70.2L169.9,70.2z"/>
							<path fill="#FFFFFF" d="M104.6,124.5c-1.8,1.8-4.8,1.8-6.6,0L71.6,98.1c-1.8-1.8-1.8-4.8,0-6.6c1.8-1.8,4.8-1.8,6.6,0l26.3,26.3
								C106.4,119.6,106.4,122.6,104.6,124.5C104.6,124.4,104.6,124.4,104.6,124.5z"/>
						</svg>
		
						
							
<script src="/js/plugins/wordCount.js"></script>

							<p class="post-count">文字数：---</p>
						
		
						
							<p id="busuanzi_container_page_pv" style='display:none;'>阅读数：<span id="busuanzi_value_page_pv"></span></p>
						
					</div>
				
			</div>
		
	
</header>
        <div class="post-content article-container">
            <article class="post-content-info">
                <h1 id="preparation" tabindex="-1">Preparation</h1>
<h2 id="%E3%80%90%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-2021%E3%80%91%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%A9%9F%E5%88%B6--self-attention---%E4%B8%8A-" tabindex="-1" id="【機器學習-2021】自注意力機制-Self-attention-上">【機器學習 2021】自注意力機制 -Self-attention- -上-</h2>
<p><img src="P1.1.png" alt="png"></p>
<p>​    在之前的问题（预测观看人数、图像分类）中，输入的是一个向量 vector，输出的是一个数值 Scalar 或类别 Class。</p>
<p>​    有些问题输入的是一个向量集 vectors（向量集中的向量长度可能不同）。</p>
<p><img src="P1.2.png" alt="png"></p>
<p>​    比如一串单词序列 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mo separator="true">,</mo><mi>i</mi><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>c</mi><mi>a</mi><mi>t</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">\{this,is,a,cat\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord mathit">t</span><span class="mord mathit">h</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord mathit">c</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mclose">}</span></span></span></span>，可以使用独热编码来表示个单词，但此法无法得出各个单词之间的关系。</p>
<p>​    使用 Word Embedding 将词性相近的单词用一个向量表示。</p>
<p><img src="P1.3.png" alt="png"></p>
<p>​    取一段语音信号作为窗口，把其中的信息描述为一个向量（帧），滑动这个窗口就得到这段语音的向量集。</p>
<p><img src="P1.4.png" alt="png"></p>
<p>​    社交网络的每个节点就是一个人，节点之间的关系用线连接。每一个人就是一个向量，整个社交网络就是一个向量集。</p>
<p><img src="P1.5.png" alt="png"></p>
<p>​    分子上的每个原子就是一个向量（每个元素可用 One-hot 编码表示），分子就是一个向量集。</p>
<p><img src="P1.6.png" alt="png"></p>
<p>​    向量集中一个向量对应一个标签输出的情景：</p>
<ul>
<li>POS tagging 单词词性判断，如 I saw a saw，两个 saw 词性不同。</li>
<li>作业 2，给一段语音，判断说话的内容。</li>
<li>在社交网络中，向某个用户推荐商品（可能会买或者不买）。</li>
</ul>
<p><img src="P1.7.png" alt="png"></p>
<p>整个向量集只对应一个标签的情景：</p>
<ul>
<li>给一段句子，判断这个句子的语气是积极还是消极的。</li>
<li>作业 4，给一段语音，判断说话者是谁。</li>
<li>给一个分子结构图，判断这个分子组成的物质是否亲水。</li>
</ul>
<p><img src="P1.8.png" alt="png"></p>
<p>由模型自行决定输出标签的数量：seq2seq，作业 5，机器翻译。</p>
<p>本节课只考虑第一种情景：向量集中一个向量对应一个标签。</p>
<h3 id="sequence-labeling" tabindex="-1" id="Sequence-Labeling">Sequence Labeling</h3>
<p><img src="P1.9.png" alt="png"></p>
<p>​    利用全连接网络，输入一个句子，输出对应单词数目的标签。当一个句子里出现两个相同的单词，并且它们的词性不同（例如：I saw a saw. 我看见一把锯子），这个时候就需要考虑上下文：利用滑动窗口，每个向量查看窗口中相邻的其他向量的性质。</p>
<p>​    但是这种方法不能解决整条语句的分析问题（固定的滑动窗口难以应用在长度不等的语句上），即语义分析。这就引出了 Self-attention 技术。</p>
<p><img src="P1.10.png" alt="png"></p>
<p>​    输入整个语句的向量到 self-attention 中，输出对应个数的向量，再将其结果输入到全连接网络，最后输出标签。以上过程可多次重复。</p>
<blockquote>
<p>​    Transformer 起源于 2017 年的一篇 google brain 的又一篇神文《Attention is all you need》，至此由引领了在 NLP 和 CV 了又一研究热点。</p>
<p>​    在 Transformer 中一个非常关键的贡献就是 self-attention。就是利用输入样本自身的关系构建注意力模型。</p>
</blockquote>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1706.03762">1706.03762] Attention Is All You Need (arxiv.org)</a></li>
</ul>
<p><img src="P1.11.png" alt="png"></p>
<p>​    Self-attention 层的上一层可以是输入层，也可以是隐藏层。每个输出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">b</span></span></span></span> 都与所有输入 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span></span></span></span> 相关。</p>
<p><img src="P1.12.png" alt="png"></p>
<p>​    Self-attention 层的作用就是找到向量集中各个向量中的关联性 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span>。</p>
<p><img src="P1.13.png" alt="png"></p>
<p>计算关联性 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span> 的方法：</p>
<ul>
<li><strong>Dot-product</strong> 中使用了 Transformer 的方法。把输入的向量分别乘以不同的矩阵 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>q</mi></msup></mrow><annotation encoding="application/x-tex">W^q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">W^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>，最后得到关联性 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mrow><mi mathvariant="bold">q</mi></mrow><mo>⋅</mo><mrow><mi mathvariant="bold">k</mi></mrow></mrow><annotation encoding="application/x-tex">\alpha=\mathbf{q}\cdot\mathbf{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathbf">q</span></span><span class="mbin">⋅</span><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span></span></span></span></li>
<li><strong>Additive</strong></li>
</ul>
<p>Self-attention 中又引入了三个非常重要的元素：<strong>Query</strong>、<strong>Key</strong> 和 <strong>Value</strong>。</p>
<p>​    假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">X</mi></mrow><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mrow><mi mathvariant="bold">n</mi></mrow><mo>×</mo><mrow><mi mathvariant="bold">d</mi></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{X}\in\mathbb{R}^{\mathbf{n}\times \mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.888208em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span><span class="mrel">∈</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathbf">n</span></span><span class="mbin">×</span><span class="mord scriptstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 是一个输入样本序列的特征，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">n</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">n</span></span></span></span></span> 是输入样本个数（序列长度），<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span> 是单个样本维度。</p>
<ul>
<li>Query：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">Q</mi></mrow><mo>=</mo><mrow><mi mathvariant="bold">X</mi></mrow><mo>⋅</mo><mrow><msup><mi mathvariant="bold">W</mi><mi mathvariant="bold">Q</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Q}=\mathbf{X}\cdot\mathbf{W^Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8432769999999999em;"></span><span class="strut bottom" style="height:1.037717em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span><span class="mbin">⋅</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">W</mi><mi mathvariant="bold">Q</mi></msup></mrow><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mrow><mi mathvariant="bold">d</mi><mo>×</mo><msub><mi mathvariant="bold">d</mi><mi mathvariant="bold">q</mi></msub></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{W^Q}\in\mathbb{R}^{\mathbf{d\times d_q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.888208em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">∈</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathbf">d</span><span class="mbin">×</span><span class="mord"><span class="mord mathbf">d</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathbf">q</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li>
<li>Key：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">K</mi></mrow><mo>=</mo><mrow><mi mathvariant="bold">X</mi></mrow><mo>⋅</mo><mrow><msup><mi mathvariant="bold">W</mi><mi mathvariant="bold">K</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{K}=\mathbf{X}\cdot\mathbf{W^K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8432769999999999em;"></span><span class="strut bottom" style="height:0.8432769999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span><span class="mbin">⋅</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">W</mi><mi mathvariant="bold">K</mi></msup></mrow><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mrow><mi mathvariant="bold">d</mi><mo>×</mo><msub><mi mathvariant="bold">d</mi><mi mathvariant="bold">K</mi></msub></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{W^K}\in\mathbb{R}^{\mathbf{d\times d_K}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.888208em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">∈</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathbf">d</span><span class="mbin">×</span><span class="mord"><span class="mord mathbf">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathbf">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li>
<li>Value：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">V</mi></mrow><mo>=</mo><mrow><mi mathvariant="bold">X</mi></mrow><mo>⋅</mo><mrow><msup><mi mathvariant="bold">W</mi><mi mathvariant="bold">V</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{V}=\mathbf{X}\cdot\mathbf{W^V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8432769999999999em;"></span><span class="strut bottom" style="height:0.8432769999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span><span class="mbin">⋅</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">W</mi><mi mathvariant="bold">K</mi></msup></mrow><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mrow><mi mathvariant="bold">d</mi><mo>×</mo><msub><mi mathvariant="bold">d</mi><mi mathvariant="bold">V</mi></msub></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{W^K}\in\mathbb{R}^{\mathbf{d\times d_V}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.888208em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">∈</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathbf">d</span><span class="mbin">×</span><span class="mord"><span class="mord mathbf">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li>
</ul>
<p>（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span></span></span> 分别乘上某个矩阵得到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Q, K, V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span><span class="mpunct">,</span><span class="mord mathbf">K</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span>）</p>
<p><img src="P1.14.png" alt="png"></p>
<p>​    如求向量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">a</mi><mn mathvariant="bold">1</mn></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{a^1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span> 与向量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mrow><mi>i</mi></mrow></msup></mrow><annotation encoding="application/x-tex">a^{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:0.824664em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 的关联性 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>α</mi><mrow><mn>1</mn><mo separator="true">,</mo><mi>i</mi></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\alpha&#x27;_{1,i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.146664em;vertical-align:-0.394772em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.258664em;margin-left:-0.0037em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>。根据 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">q</mi><mn mathvariant="bold">1</mn></msup><mo separator="true">,</mo><msup><mi mathvariant="bold">k</mi><mn mathvariant="bold">1</mn></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{q^1,k^1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf">q</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathbf">k</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span> 求得某个向量与所有向量关联性 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>α</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{1,1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 后，再用 softmax 函数（Normalization 操作，也可以是其他激活函数，如 ReLU）：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>α</mi><mrow><mn>1</mn><mo separator="true">,</mo><mi>i</mi></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msubsup><mo>=</mo><mi>exp</mi><mo>(</mo><msub><mi>α</mi><mrow><mn>1</mn><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo>)</mo><mi mathvariant="normal">/</mi><msub><mo>∑</mo><mi>j</mi></msub><mi>exp</mi><mo>(</mo><msub><mi>α</mi><mrow><mn>1</mn><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\alpha&#x27;_{1,i}=\exp(\alpha_{1,i})/\sum_j\exp(\alpha_{1,j})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em;"></span><span class="strut bottom" style="height:2.463782em;vertical-align:-1.413777em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mop op-limits"><span class="vlist"><span style="top:1.177669em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p><img src="P1.15.png" alt="png"></p>
<p>​    将所得的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>α</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\alpha&#x27;_{1,1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.136108em;vertical-align:-0.38421599999999995em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.0037em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.36299999999999993em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 与 由向量本身计算得到的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">v</mi><mn mathvariant="bold">1</mn></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{v^1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span> 相乘求得 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msup></mrow><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><msubsup><mi>a</mi><mrow><mn>1</mn><mo separator="true">,</mo><mi>i</mi></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msubsup><mrow><msup><mi mathvariant="bold">v</mi><mi mathvariant="bold">i</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{b^1}=\sum_ia&#x27;_{1,i}\mathbf{v^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.2438799999999999em;vertical-align:-0.394772em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf">b</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.258664em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span>。</p>
<p>​    根据分数（关联性）抽取重要信息。谁的分数（Value）越大，谁就更影响结果。</p>
<h2 id="%E3%80%90%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-2021%E3%80%91%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%A9%9F%E5%88%B6--self-attention---%E4%B8%8B-" tabindex="-1" id="【機器學習-2021】自注意力機制-Self-attention-下">【機器學習 2021】自注意力機制 -Self-attention- -下-</h2>
<h3 id="self-attention" tabindex="-1" id="Self-attention">Self-attention</h3>
<p><img src="P2.1.png" alt="png"></p>
<p>​    Self-attention 层将输入 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span></span></span></span> 转换为输出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">b</span></span></span></span>，这个过程是可以并行计算的。</p>
<p><img src="P2.2.png" alt="png"></p>
<p>与求 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msup></mrow><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><msubsup><mi>a</mi><mrow><mn>1</mn><mo separator="true">,</mo><mi>i</mi></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msubsup><mrow><msup><mi mathvariant="bold">v</mi><mi mathvariant="bold">i</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{b^1}=\sum_ia&#x27;_{1,i}\mathbf{v^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.2438799999999999em;vertical-align:-0.394772em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf">b</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.258664em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span> 相同的方法求得 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">b</mi><mn mathvariant="bold">2</mn></msup></mrow><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><msubsup><mi>a</mi><mrow><mn>2</mn><mo separator="true">,</mo><mi>i</mi></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msubsup><mrow><msup><mi mathvariant="bold">v</mi><mi mathvariant="bold">i</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{b^2}=\sum_ia&#x27;_{2,i}\mathbf{v^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.2438799999999999em;vertical-align:-0.394772em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf">b</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.258664em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="mord mathit">i</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span>。</p>
<p><img src="P2.3.png" alt="png"></p>
<p>​    由于用于得到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">q</mi><mo separator="true">,</mo><mi mathvariant="bold">k</mi><mo separator="true">,</mo><mi mathvariant="bold">v</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{q,k,v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">q</span><span class="mpunct">,</span><span class="mord mathbf">k</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span> 所乘的矩阵 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>q</mi></msup><mo separator="true">,</mo><msup><mi>W</mi><mi>k</mi></msup><mo separator="true">,</mo><msup><mi>W</mi><mi>v</mi></msup></mrow><annotation encoding="application/x-tex">W^q,W^k,W^v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 都相同，所以可以将所有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">a</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">a</span></span></span></span></span> 合并成一个矩阵 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span></span>，通过一次矩阵运算得到所有的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">q</mi><mo separator="true">,</mo><mi mathvariant="bold">k</mi><mo separator="true">,</mo><mi mathvariant="bold">v</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{q,k,v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">q</span><span class="mpunct">,</span><span class="mord mathbf">k</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span>，分别合并称为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">Q,K,V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span>。</p>
<p><img src="P2.4.png" alt="png"></p>
<p>​    通过线性代数知识，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><msup><mi>K</mi><mi>T</mi></msup><mi>Q</mi></mrow><annotation encoding="application/x-tex">A=K^TQ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">Q</span></span></span></span>。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mi>A</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">A&#x27;=softmax(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">t</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mclose">)</span></span></span></span>。</p>
<p><img src="P2.5.png" alt="png"></p>
<p>​    通过线性代数知识，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>=</mo><mi>V</mi><msup><mi>A</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">O=VA&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span></span></span></span> 就是 self-attention 层的输出。</p>
<p><img src="P2.6.png" alt="png"></p>
<p>​    <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>q</mi></msup><mo separator="true">,</mo><msup><mi>W</mi><mi>k</mi></msup><mo separator="true">,</mo><msup><mi>W</mi><mi>v</mi></msup></mrow><annotation encoding="application/x-tex">W^q,W^k,W^v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 这些参数的值要通过学习得到。</p>
<p>上述过程可总结为：</p>
<ul>
<li>输入矩阵 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span></span> 分别乘以三个 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span></span></span></span> 得到三个矩阵 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">Q,K,V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></li>
<li>使 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">A=QK^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">=</span><span class="mord mathit">Q</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>，经过处理的到注意力矩阵 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><mrow><msqrt><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow></msqrt></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">A&#x27;=softmax\left(\frac{QK^T}{\sqrt{d_k}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">t</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.585124em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:0.0926800000000001em;"><span class="style-wrap reset-scriptstyle textstyle uncramped">√</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1.4285714285714286em;">​</span></span><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:-0.9930342857142858em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1.4285714285714286em;">​</span></span><span class="reset-scriptstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1.4285714285714286em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">Q</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></li>
<li>输出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>=</mo><msup><mi>A</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mi>V</mi></mrow><annotation encoding="application/x-tex">O=A&#x27;V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span>，即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo>)</mo><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><mrow><msqrt><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow></msqrt></mrow></mfrac><mo fence="true">)</mo></mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">Attention(Q,K,V)=softmax\left(\frac{QK^T}{\sqrt{d_k}}\right)V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathit">t</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit">Q</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">t</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.585124em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:0.0926800000000001em;"><span class="style-wrap reset-scriptstyle textstyle uncramped">√</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1.4285714285714286em;">​</span></span><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:-0.9930342857142858em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1.4285714285714286em;">​</span></span><span class="reset-scriptstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1.4285714285714286em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">Q</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span>，其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msqrt><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{d_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8572200000000001em;"></span><span class="strut bottom" style="height:1.04em;vertical-align:-0.18278em;"></span><span class="base textstyle uncramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.017220000000000013em;"><span class="style-wrap reset-textstyle textstyle uncramped">√</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:-0.77722em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span></span></span></span> 为向量的长度。</li>
</ul>
<h3 id="multi-head-self-attention" tabindex="-1" id="Multi-head-Self-attention">Multi-head Self-attention</h3>
<p><img src="P2.7.png" alt="png"></p>
<p>​    Multi-head Self-attention 是 Self-attention 的变种。考虑不同类型的相关性。计算完 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">q</mi><mo separator="true">,</mo><mi mathvariant="bold">k</mi><mo separator="true">,</mo><mi mathvariant="bold">v</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{q,k,v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">q</span><span class="mpunct">,</span><span class="mord mathbf">k</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span> 后，再乘上 head 数的矩阵，得到更多分支。</p>
<p><img src="P2.8.png" alt="png"></p>
<p>​    这样得到的输出会有多个向量。最后再乘一个 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mi>O</mi></msup></mrow><annotation encoding="application/x-tex">W^O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 矩阵得到最终的输出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">\mathbf b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">b</span></span></span></span>。</p>
<h3 id="positional-encoding" tabindex="-1" id="Positional-Encoding">Positional Encoding</h3>
<p><img src="P2.9.png" alt="png"></p>
<p>​    Self-attention 机制没有考虑向量的位置信息。解决办法是在输入向量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">a</mi><mi mathvariant="bold">i</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{a^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf">a</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span> 中额外添加位置信息 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">e</mi><mi mathvariant="bold">i</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{e^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf">e</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span>。位置信息 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi mathvariant="bold">e</mi><mi mathvariant="bold">i</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\mathbf{e^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathbf">e</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span> 的表示形式可以是：</p>
<ul>
<li>人为设定</li>
<li>从数据中学习</li>
</ul>
<p><img src="P2.10.png" alt="png"></p>
<p>​    论文[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2003.09229">2003.09229] Learning to Encode Position for Transformer with Continuous Dynamical Model (arxiv.org)</a> 阐述了各种模型得到的位置信息的表现形式。</p>
<h3 id="application" tabindex="-1" id="Application">Application</h3>
<p><img src="P2.11.png" alt="png"></p>
<p>​    	使用 Self-attention 机制的应用：</p>
<ul>
<li>Transformer: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1706.03762">1706.03762] Attention Is All You Need (arxiv.org)</a></li>
<li>BERT: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1810.04805">1810.04805] BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding (arxiv.org)</a></li>
</ul>
<p>​    Widely used in Natural Langue Processing(NLP)!</p>
<p><img src="P2.12.png" alt="png"></p>
<p>​    Self-attention 在语音识别中的应用，一段语音是一个非常长的序列，计算量/存储量会非常大。将向量只考虑其周围的向量（Truncated Self-attention）。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1910.12977">1910.12977] Transformer-Transducer: End-to-End Speech Recognition with Self-Attention (arxiv.org)</a></li>
</ul>
<p><img src="P2.13.png" alt="png"></p>
<p>​    	在图像处理中的应用，把图像当作一个向量集来看待。每个像素点都是一个三维的向量（RGB）。</p>
<p><img src="P2.14.png" alt="png"></p>
<p>​    使用 Self-attention 机制用在图像处理方面的例子：</p>
<ul>
<li>Self-attention GAN: [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1805.08318">1805.08318] Self-Attention Generative Adversarial Networks (arxiv.org)</a></li>
<li>Detection Transformer (DETR): [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2005.12872">2005.12872] End-to-End Object Detection with Transformers (arxiv.org)</a></li>
</ul>
<h3 id="self-attention-v.s.-cnn" tabindex="-1" id="Self-attention-v-s-CNN">Self-attention v.s. CNN</h3>
<p><img src="P2.15.png" alt="png"></p>
<p>CNN 可以看作是简化版的 self-attention，self-attention 通过学习得到相应的 receptive field。</p>
<p><img src="P2.16.png" alt="png"></p>
<ul>
<li>On the Relationship between Self-Attention and Convolutional Layers: [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1911.03584">1911.03584] On the Relationship between Self-Attention and Convolutional Layers (arxiv.org)</a></li>
</ul>
<p><img src="P2.18.png" alt="png"></p>
<p>​    由于 self-attention 可以视作是 CNN 的超集，因此它的结构比 CNN 更复杂。更复杂的神经网络需要数量更加庞大的数据库才能得到更好的效果（在较小的数据库中容易过拟合）。</p>
<ul>
<li>An lmage is Worth 16x16 Words: Transformers for lmage Recognition at Scale: [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2010.11929">2010.11929] An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale (arxiv.org)</a></li>
</ul>
<p><img src="P2.19.png" alt="png"></p>
<p>​    Self-attention 一般比 RNN 训练速度更快（便于获取周边向量且支持并行计算），目前很多 RNN 架构都换成了 self-attention 架构.</p>
<ul>
<li>Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention: [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2006.16236">2006.16236] Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention (arxiv.org)</a></li>
</ul>
<p><img src="P2.20.png" alt="png"></p>
<p><img src="P2.21.png" alt="png"></p>
<p>​    如果把 self-attention 机制放在图里，就变成了 GNN 的一种。</p>
<p><img src="P2.22.png" alt="png"></p>
<p><img src="P2.23.png" alt="png"></p>
<ul>
<li>Long Range Arena:A Benchmark for Efficient Transformers: 由于 self-attention 计算量很大，因此演变出多种形式试图减小训练速度，由于 self-attention 最早由 Transformer 提出，因此演变的很多形式都被命名为 XXformer。[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2011.04006">2011.04006] Long Range Arena: A Benchmark for Efficient Transformers (arxiv.org)</a></li>
<li>Efficient Transformers: A Survey: [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2009.06732">2009.06732] Efficient Transformers: A Survey (arxiv.org)</a></li>
</ul>
<h1 id="class-material" tabindex="-1">Class Material</h1>
<h1 id="extra-material" tabindex="-1">Extra Material</h1>
<h3 id="ml-lecture-21-1-recurrent-neural-network--part-i-" tabindex="-1" id="ML-Lecture-21-1-Recurrent-Neural-Network-Part-I">ML Lecture 21-1 Recurrent Neural Network -Part I-</h3>
<p><img src="E1.1.png" alt="png"></p>
<p>​    RNN 应用的一个举例：Slot Filling 槽填充。智能订票系统。用户对机器输入一段话“I would like to arrive <font color="red">Taipei</font> on <font color="#136ec2">Novmber 2nd</font>.”，机器将这段话提取出关键词填入 Slot 中。</p>
<p><img src="E1.2.png" alt="png"></p>
<p>​    如何使用一个向量表示一个单词？独热编码。</p>
<p><img src="E1.3.png" alt="png"></p>
<ul>
<li>独热编码后加一个维度用于表示词汇表中没有的词汇。</li>
<li>将单词的各个部分是否出现显示在向量中。</li>
</ul>
<p><img src="E1.4.png" alt="png"></p>
<p>尝试将 slot filling 应用于 Feedforward network 中：</p>
<ul>
<li>输入：一个单词（每个单词都用一个向量来表示）</li>
<li>输出这个单词最有可能出现在哪个 slots 中。</li>
</ul>
<p><img src="E1.5.png" alt="png"></p>
<p>​    这样训练出来的结构不能考虑上下文对单词含义造成的影响。只考虑单词“Taipei”不能确定用户需要的是出发地还是目的地。</p>
<p>因此神经网络需要记忆。</p>
<h3 id="recurrent-neural-network-(rnn)" tabindex="-1" id="Recurrent-Neural-Network-RNN">Recurrent Neural Network (RNN)</h3>
<p><img src="E1.6.png" alt="png"></p>
<p>​    每次输出的结果都会存在内存中。内存中的值也可被视作另一个输入。</p>
<p><img src="E1.7.png" alt="png"></p>
<p>​    假设这个模型所有 weight 都是 1，没有 bias，所有的激活函数都是线性函数。则对于输入序列 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mn>2</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>2</mn></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}1\\1\end{bmatrix}\begin{bmatrix}1\\1\end{bmatrix}\begin{bmatrix}2\\2\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">2</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>，对应的输出序列为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mn>4</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>4</mn></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mn>1</mn><mn>2</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn><mn>2</mn></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mn>3</mn><mn>2</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>3</mn><mn>2</mn></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}4\\4\end{bmatrix}\begin{bmatrix}12\\12\end{bmatrix}\begin{bmatrix}32\\32\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">4</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">4</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">2</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">3</span><span class="mord mathrm">2</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathrm">3</span><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>。</p>
<p>​    改变序列顺序也会改变输出序列。</p>
<p><img src="E1.9.png" alt="png"></p>
<p>​    由于 memory 中的值可能不同，不同时期相同的输入可能会得到不同的输出。</p>
<p><img src="E1.10.png" alt="png"></p>
<p>​    这样的结构可以有很多层。</p>
<p><img src="E1.11.png" alt="png"></p>
<p>​    刚刚的结构也叫 Elman Network，也有跨层的 Jordan Network。据说 Jordan Network 性能更好些。</p>
<h3 id="bidirectional-rnn" tabindex="-1" id="Bidirectional-RNN">Bidirectional RNN</h3>
<p><img src="E1.12.png" alt="png"></p>
<p>​    可以将序列反向再训练一遍，称之为 Bidirectional RNN。</p>
<h3 id="long-short-term-memory-(lstm)" tabindex="-1" id="Long-Short-term-Memory-LSTM">Long Short-term Memory (LSTM)</h3>
<p><img src="E1.13.png" alt="png"></p>
<p>LSTM 是一种特殊的神经网络结构，拥有 4 个输入，1 个输出。</p>
<p><img src="E1.8.png" alt="png"></p>
<p>输入：</p>
<ul>
<li>通常的输入 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span></li>
<li>由信号控制的 Input Gate，输入信号 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.04398em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li>
<li>由信号控制的 Forget Gate，输入信号 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>z</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">z_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.04398em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li>
<li>由信号控制的 Output Gate，输入信号 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>z</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">z_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.04398em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li>
</ul>
<p>输入和门都会有一个激活函数（一般是 Sigmoid，便于将值取 0-1 之间，ReLU 在此性能较差）</p>
<p>经过 Forget Gate 后的值 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>c</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>=</mo><mi>g</mi><mo>(</mo><mi>z</mi><mo>)</mo><mi>f</mi><mo>(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>)</mo><mo>+</mo><mi>c</mi><mi>f</mi><mo>(</mo><msub><mi>z</mi><mi>f</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">c&#x27;=g(z)f(z_i)+cf(z_f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.038em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.04398em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.04398em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>，因此 Forget Gate 中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">c</span></span></span></span> 取 1 时 Memory 不遗忘，取 0 时 Memory 遗忘。</p>
<p>最后的输出值 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>=</mo><mi>h</mi><mo>(</mo><msup><mi>c</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>)</mo><mi>f</mi><mo>(</mo><msub><mi>z</mi><mi>o</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">a=h(c&#x27;)f(z_o)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span><span class="mrel">=</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.04398em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>。</p>
<p><img src="E1.14.png" alt="png"></p>
<p>​    举例，假设这个模型真实的情景是：</p>
<ul>
<li>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_2=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span> 时，把 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 的值加到 memory 中。</li>
<li>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_2=-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathrm">1</span></span></span></span> 时，重置 memory 的值（设为 0）。</li>
<li>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_3=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span> 时，将 memory 的值作为输出值。</li>
</ul>
<p><img src="E1.15.png" alt="png"></p>
<p>​    使用一个 LSTM 神经元可以拟合出这样的函数（假设 w 值已经被训练好）。</p>
<p><img src="E1.16.png" alt="png"></p>
<p>​    因此 LSTM 的参数量是普通神经元的 4 倍。</p>
<p><img src="E1.17.png" alt="png"></p>
<p>​    把输入向量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.7935559999999999em;"></span><span class="strut bottom" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 拆分成 4 个向量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>z</mi><mi>f</mi></msup><mo separator="true">,</mo><msup><mi>z</mi><mi>i</mi></msup><mo separator="true">,</mo><mi>z</mi><mo separator="true">,</mo><msup><mi>z</mi><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">z^f,z^i,z,z^c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 看。</p>
<p><img src="E1.18.png" alt="png"></p>
<p>​    向量在 LSTM 中的示意图。</p>
<p><img src="E1.19.png" alt="png"></p>
<p>​    LSTM 神经元可以有很多个。</p>
<p><img src="E1.20.png" alt="png"></p>
<p>​    还可以把 memory 中的值 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>c</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">c^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 和</p>
<p>​    上次的输出值 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">h^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">t</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>（称之为“peephole”）放到输入序列中。</p>
<p><img src="E1.21.png" alt="png"></p>
<p>​    多层，多个的 LSTM。</p>
<p><img src="E1.22.png" alt="png"></p>
<p>​    Keras 可以很好地实现它。</p>
<p>​    一般来说 RNN 就是指 LSTM。</p>
<p>​    Keras 支持 LSTM，GRU（比 LSTM 少一个门，据说性能与 LSTM 相当，而较少的参数量可以防止过拟合？），以及课程开始讲的最传统的 SimpleRNN。</p>
<h2 id="ml-lecture-21-2-recurrent-neural-network--part-ii-" tabindex="-1" id="ML-Lecture-21-2-Recurrent-Neural-Network-Part-II">ML Lecture 21-2 Recurrent Neural Network -Part II-</h2>
<p><img src="E2.1.png" alt="png"></p>
<p>​    如上，对于一个 slot-filling 问题，我们希望网络能帮我们辨识出 arrive 对应的 other，Taipei 对应 dest（目的地）…则我们需要按时间顺序，输入这句话的这些单词，并且期望其输出为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span> 上面的对象。</p>
<p><img src="E2.2.png" alt="png"></p>
<p>​    LSTM 同样使用梯度下降训练，其反向传播方法，是考虑了时间的，称为 Backpropagation through time (BRTT)。</p>
<p><img src="E2.3.png" alt="png"></p>
<p>​    RNN 很难训练，其 Loss 变化曲线可能不像通常那样随时间单调递减。</p>
<p><img src="E2.4.png" alt="png"></p>
<p>​    Razvan Pascanu (ICML’13) 的研究，RNN 的参数对应的损失函数是很陡峭的，因此难以训练。提出解决方案：引入 Clipping——当 gradient 大于某个数值时，就等于某个数值。</p>
<p><img src="E2.5.png" alt="png"></p>
<p>​    RNN 在不同时间内反复使用同样的东西，导致梯度爆炸（如 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span> 都取 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn></mrow><annotation encoding="application/x-tex">1.01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">1</span></span></span></span> 时，第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">1000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span> 层的输出极大）或梯度消失（如 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span> 都取 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn></mrow><annotation encoding="application/x-tex">1.01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">1</span></span></span></span> 时，第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">1000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span> 层的输出约等于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span>）。</p>
<p><img src="E2.6.png" alt="png"></p>
<p>​    LSTM 可以解决梯度消失的问题，但是难以解决梯度爆炸的问题。</p>
<ul>
<li>Memory and input are added</li>
<li>The influence never disappears unless forget gate is closed</li>
</ul>
<p>​    GRU 是更简单版本的 LSTM：</p>
<ul>
<li>相比于 LSTM，少了一个门（参数）</li>
<li>当 input gate 打开时，forget gate 就自动关闭</li>
</ul>
<p><img src="E2.7.png" alt="png"></p>
<p>​    其他 LSTM 的变形：<code>Clockwise RNN</code>、<code>Structurally Constrained Recurrent Network(SCRN)</code></p>
<ul>
<li>
<p>Vanilla RNN Initialized with Identity matrix + ReLU activation function <font color="#136ec2">[Quoc V. Le, arXiv’15]</font></p>
</li>
<li>
<p>Outperform or be comparable with LSTM in 4 different tasks 在 4 项不同的任务中表现优于或与 LSTM 相当</p>
</li>
</ul>
<p><img src="E2.9.png" alt="png"></p>
<p>​    之前提到的 Input 和 Output 都是有着相同长度的序列，RNN 可以做到不止这些。</p>
<h3 id="many-to-one" tabindex="-1" id="Many-to-one">Many to one</h3>
<p><img src="E2.11.png" alt="png"></p>
<ul>
<li>输入是一个向量序列，但是输出只有一个向量。</li>
</ul>
<p>如 Sentiment Analysis 情感分析：从一段文本中判断这段文本的积极度。</p>
<p><img src="E2.12.png" alt="png"></p>
<p>​    Key Term Extraction 关键词提取：将序列按照顺序在不同时间点输入，最后一个时间点把输出拿出来，经过些处理，得到结果。</p>
<h3 id="many-to-many-(output-is-shorter)" tabindex="-1" id="Many-to-Many-Output-is-shorter">Many to Many (Output is shorter)</h3>
<p><img src="E2.13.png" alt="png"></p>
<p>​    语音辨识中，RNN 解决了一般分类网络中没法解决的问题。在一段发音<code>好棒棒</code>中，正常的网络可能识别出<code>好好好棒棒棒棒棒</code>，然后可以通过<code>Trimming</code>去重得到输出<code>好棒</code>，但是这样就无法识别<code>好棒棒</code>。</p>
<p><img src="E2.14.png" alt="png"></p>
<p>​    如上，<code>Connectionist Temporal Classification(CTC)</code>提出了一个解决方案，在输出中增加空字符 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span>。</p>
<p><img src="E2.15.png" alt="png"></p>
<p>​    此法需要穷举正确的答案（好 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> 棒 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span>，好 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> 棒 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span>，好 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span> 棒 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϕ</span></span></span></span>）。穷举可能会有一定成本，但是 CTC 中有一定巧妙解决方案。</p>
<p><img src="E2.16.png" alt="png"></p>
<p>​    Google 现在的语音辨识系统已经更改为<code>CTC</code>为基础的算法。</p>
<h3 id="many-to-many-(no-limitation)" tabindex="-1" id="Many-to-Many-No-Limitation">Many to Many (No Limitation)</h3>
<p><img src="E2.17.png" alt="png"></p>
<p>​    Seq2Seq，举例：机器翻译。其基本思路如上。但是问题是不知道何时停止联想。</p>
<p><img src="E2.18.png" alt="png"></p>
<p><img src="E2.19.png" alt="png"></p>
<p>​    引出，其思路也有点类似 CTC，在训练中，添加一种输出，叫做<code>===</code>，代表“断”。</p>
<p><img src="E2.20.png" alt="png"></p>
<h3 id="beyond-sequence" tabindex="-1" id="Beyond-Sequence">Beyond Sequence</h3>
<p><img src="E2.21.png" alt="png"></p>
<ul>
<li>Syntactic parsing 句法分析</li>
</ul>
<p>​    我们将树状图描述成一个序列，作为目标值。</p>
<h3 id="sequence-to-sequence-auto-encoder-text" tabindex="-1" id="Sequence-to-sequence-Auto-encoder-Text">Sequence-to-sequence Auto-encoder-Text</h3>
<p><img src="E2.22.png" alt="png"></p>
<p>​    序列中的顺序很重要，”white blood cells destroying an infection“ 和 ”an infection destroying white blood cells“ 具有相同的 ”bag-of word“，但具有不同的意思。</p>
<p><img src="E2.23.png" alt="png"></p>
<p>​    输入原句，Encoder 输出嵌入后的向量(Embedding Vector)，再将嵌入向量输入解码器 Decode，争取让解码器输出原句，则编码成功。</p>
<p>​    这样，我们不需要对数据进行打标签，只需要大量文章就可以训练。</p>
<p><img src="E2.24.png" alt="png"></p>
<p>​    这个结构可以是多层 hierarchical 的，如上是 4 层的 LSTM 组合。</p>
<p><img src="E2.25.png" alt="png"></p>
<p><img src="E2.26.png" alt="png"></p>
<p><img src="E2.27.png" alt="png"></p>
<p><img src="E2.28.png" alt="png"></p>
<p><img src="E2.29.png" alt="png"></p>
<p><img src="E2.30.png" alt="png"></p>
<p><img src="E2.31.png" alt="png"></p>
<h3 id="attenttion-based-model" tabindex="-1" id="Attenttion-based-Model">Attenttion-based Model</h3>
<p>类似人脑，机器也有一个用于记忆的缓存区，可以在使用神经网络时，进行读和写的操作。</p>
<p>这个叫做<code>Neural Turing Machine</code>。</p>
<p><img src="E2.32.png" alt="png"></p>
<p><img src="E2.33.png" alt="png"></p>
<p><img src="E2.34.png" alt="png"></p>
<p><img src="E2.35.png" alt="png"></p>
<p><img src="E2.36.png" alt="png"></p>
<p><img src="E2.37.png" alt="png"></p>
<p><img src="E2.38.png" alt="png"></p>
<p><img src="E2.39.png" alt="png"></p>
<p><img src="E2.40.png" alt="png"></p>
<p><img src="E2.41.png" alt="png"></p>
<p><img src="E2.42.png" alt="png"></p>
<p><img src="E2.43.png" alt="png"></p>
<p><img src="E2.44.png" alt="png"></p>
<h3 id="rnn-v.s.-structured-learning" tabindex="-1" id="RNN-v-s-Structured-Learning">RNN v.s. Structured Learning</h3>
<p><img src="E2.45.png" alt="png"></p>
<p>​    RNN，LSTM 与结构化机器学习（隐马尔可夫模型 HMM，条件随机场，结构化感知器/SVM）的比较：</p>
<table>
<thead>
<tr>
<th>RNN，LSTM</th>
<th>Structured Learning</th>
</tr>
</thead>
<tbody>
<tr>
<td>单向的 RNN 不考虑整个序列</td>
<td>使用 Viterbi，所以考虑整个序列：Bidirectional RNN` 也可考虑整个序列</td>
</tr>
<tr>
<td>Cost 和 error 并不总是相关的</td>
<td>可以明确地考虑标签的依赖性：Cost 是 error 的上界</td>
</tr>
<tr>
<td>可以<font color="red">深度</font>学习</td>
<td>难以深度学习</td>
</tr>
</tbody>
</table>
<p><img src="E2.46.png" alt="png"></p>
<p>​    可以将 RNN、LSTM 与 Structured Learning 结合在一起。</p>
<ul>
<li>input 的 feature 先通过 RNN 与 LSTM；</li>
<li>其输出作为 HMM 等的输入；</li>
<li>二者可以一起 Learn 的，可以一起梯度下降。</li>
</ul>
<p><img src="E2.47.png" alt="png"></p>
<p><img src="E2.48.png" alt="png"></p>
<p><img src="E2.49.png" alt="png"></p>
<p><img src="E2.50.png" alt="png"></p>
<p><img src="E2.51.png" alt="png"></p>
<p>常见的结合应用如下：</p>
<ul>
<li>Speech Recognition: CNN/LSTM/DNN + HMM</li>
<li>Semantic Tagging: Bi-directional LSTM + CRF/Structured SVM</li>
</ul>
<p>​    李老师认为，其实 structure learning 并不过时，GAN 就是一种 structure learning (Energy-based model)。</p>
<p><img src="E2.52.png" alt="png"></p>
<p>​    李老师认为：<code>Deep and structure is future.</code> 下学期会开有关的课程 Machine learning and having itdeep and structured (MLDS)。</p>
<p><img src="E2.53.png" alt="png"></p>
<h2 id="-ta-%E8%A3%9C%E5%85%85%E8%AA%B2--graph-neural-network--12---%E7%94%B1%E5%8A%A9%E6%95%99%E5%A7%9C%E6%88%90%E7%BF%B0%E5%90%8C%E5%AD%B8%E8%AC%9B%E6%8E%88-" tabindex="-1" id="TA-補充課-Graph-Neural-Network-12-由助教姜成翰同學講授">-TA 補充課- Graph Neural Network -12- -由助教姜成翰同學講授-</h2>
<p>Outline</p>
<ul>
<li>Introduction</li>
<li>Roadmap</li>
<li>Tasks, Dataset, and Benchmark</li>
<li>Spatial-based GNN</li>
<li>Graph Signal Processing and Spectral-based GNN</li>
<li>Graph Generation</li>
<li>GNN for NLP</li>
</ul>
<p><img src="E3.2.png" alt="png"></p>
<p><img src="E3.3.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1512.03385">1512.03385] Deep Residual Learning for Image Recognition (arxiv.org)</a></li>
</ul>
<p><img src="E3.4.png" alt="png"></p>
<p><img src="E3.5.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1706.03762">1706.03762] Attention Is All You Need (arxiv.org)</a></li>
</ul>
<p><img src="E3.6.png" alt="png"></p>
<p>图的举例:</p>
<ul>
<li>蛋白质结构图</li>
<li>地铁路线</li>
<li>分子式</li>
<li>红黑树</li>
</ul>
<p><img src="E3.7.png" alt="png"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://persagen.com/files/misc/scarselli2009graph.pdf">https://persagen.com/files/misc/scarselli2009graph.pdf</a></li>
</ul>
<p><img src="E3.8.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1802.03480">1802.03480] GraphVAE: Towards Generation of Small Graphs Using Variational Autoencoders (arxiv.org)</a></li>
</ul>
<p>​    分析化学式生成对治疗新冠有效的物质。</p>
<p><img src="E3.9.png" alt="png"></p>
<p><img src="E3.10.png" alt="png"></p>
<p>​    分类器：根据社交圈判断谁是凶手。</p>
<p><img src="E3.11.png" alt="png"></p>
<p>​    GNN 简单来说就是 Graph + Nerual Networks,<strong>关键问题就是将图的结构和图中每个节点和边的特征转化为一般的神经网络的输入（张量）。</strong></p>
<p>可以做的事情主要包括：分类和生成</p>
<ul>
<li>How do we utilize  利用 the structures and relationship to help our model? 关系杂</li>
<li>What if the graph is larger, like 20k nodes? 模型大</li>
<li>What if we don’t have the all the labels? 无标签</li>
</ul>
<p><img src="E3.12.png" alt="png"></p>
<ul>
<li>半监督学习：Unlabeled Node &gt; Labeled Node</li>
<li>思想是 A node can learn the structure from its neighbors（近朱者赤，近墨者黑）, but how?</li>
</ul>
<p><img src="E3.13.png" alt="png"></p>
<ul>
<li>模仿卷积的过程，卷积中和 filter 相乘相加后就得到 feature map。如何把卷积操作移植到 Graph 上？
<ul>
<li>Solution 1: Generalize the concept of convolution (corelation) to graph &gt;&gt; <strong>Spatial-based convolution 基于空间的卷积</strong>
<ul>
<li>把 CNN 的操作 Generalize 到 GNN 上</li>
</ul>
</li>
<li>Solution 2: Back to the definition of convolution in signal processing &gt;&gt; <strong>Spectral-based convolution 基于频域的卷积</strong>
<ul>
<li>借鉴信号处理中做法来进行卷积操作（先将信号从时域转到频域）</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="E3.14.png" alt="png"></p>
<p>GNN Roadmap</p>
<ul>
<li>Theoretical analysis: GIN, GCN
<ul>
<li>偏理论分析的模型：图同构网络 GIN（基于空间），GCN（基于谱图）</li>
</ul>
</li>
<li>Spatial-based convolution 基于空间的卷积</li>
</ul>
<table>
<thead>
<tr>
<th>Aggregation</th>
<th>Method</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sum</td>
<td>NN4G</td>
</tr>
<tr>
<td>Mean</td>
<td>DCNN, DGC, GraphSAGE</td>
</tr>
<tr>
<td>Weighted sum</td>
<td>MoNET, <strong>GAT</strong>, GIN</td>
</tr>
<tr>
<td>LSTM</td>
<td>GraphSAGE</td>
</tr>
<tr>
<td>MaxPooling</td>
<td>GraphSAGE</td>
</tr>
</tbody>
</table>
<ul>
<li>Spectral-based convolution 基于频域的卷积
<ul>
<li>ChebNet - <strong>GCN</strong> - HyperGCN</li>
</ul>
</li>
</ul>
<p>​    GAT 和 GCN 较为常用。</p>
<ul>
<li>Tasks 任务（将这些模型用于？）
<ul>
<li>Semi-supervised node classification</li>
<li>Regression</li>
<li>Graph classification</li>
<li>Graph representation learning</li>
<li>Link prediction</li>
</ul>
</li>
<li>Common dataset 公有数据集
<ul>
<li>CORA: citation network. 2.7k nodes and 5.4k links</li>
<li>TU-MUTAG: 188molecules with 18 nodes on average</li>
</ul>
</li>
</ul>
<p>​    主要用在 NLP 问题上。</p>
<p><img src="E3.15.png" alt="png"></p>
<h3 id="spatial-based-convolution" tabindex="-1" id="Spatial-based-Convolution">Spatial-based Convolution</h3>
<p><img src="E3.16.png" alt="png"></p>
<p>Terminology：术语</p>
<ul>
<li>
<p>Aggregate：用 neighbor feature update 下一层（Layer i + 1）的 hidden state</p>
</li>
<li>
<p>Readout：把所有 nodes 的 feature 集合起来代表整个 graph（类似 LSTM 把整个句子向量压缩为一个向量）</p>
</li>
</ul>
<h4 id="nn4g" tabindex="-1" id="NN4G">NN4G</h4>
<p><img src="E3.17.png" alt="png"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/4773279">Neural Network for Graphs: A Contextual Constructive Approach | IEEE Journals &amp; Magazine | IEEE Xplore</a></li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mrow><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi></mrow><mrow><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">h^{layer}_{node}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.2683239999999998em;vertical-align:-0.3013079999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>：第 layer 层 第 node 个节点。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mn>3</mn><mn>1</mn></msubsup><mo>=</mo><msub><mover accent="true"><mi>w</mi><mo>^</mo></mover><mrow><mn>1</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub><mrow><mo fence="true">(</mo><msubsup><mi>h</mi><mn>0</mn><mn>0</mn></msubsup><mo>+</mo><msubsup><mi>h</mi><mn>2</mn><mn>0</mn></msubsup><mo>+</mo><msubsup><mi>h</mi><mn>4</mn><mn>0</mn></msubsup><mo fence="true">)</mo></mrow><mo>+</mo><msub><mover accent="true"><mi>w</mi><mo>¯</mo></mover><mn>1</mn></msub><mo>⋅</mo><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">h^1_3=\hat w_{1,0}\left(h^0_0+h^0_2+h^0_4\right)+\bar w_1\cdot x_3
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.2141179999999998em;vertical-align:-0.35001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">4</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>​    Input layer 经过 embedding（如 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mn>3</mn><mn>0</mn></msubsup><mo>=</mo><msub><mover accent="true"><mi>w</mi><mo>¯</mo></mover><mn>0</mn></msub><mo>⋅</mo><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">h^0_3=\bar w_0\cdot x_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>¯</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>）之后到 Hidden layer 0。将其相邻的节点 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mn>0</mn><mn>0</mn></msubsup><mo>+</mo><msubsup><mi>h</mi><mn>2</mn><mn>0</mn></msubsup><mo>+</mo><msubsup><mi>h</mi><mn>4</mn><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">h^0_0+h^0_2+h^0_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">4</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>) 相加然后乘以权重（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>w</mi><mo>^</mo></mover><mrow><mn>1</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\hat w_{1,0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>）再加上之前 Input layer 的原始输入 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>w</mi><mo>^</mo></mover><mn>1</mn></msub><mo>⋅</mo><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\hat w_1\cdot x_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>) 用于得到新的参数 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mn>3</mn><mn>1</mn></msubsup></mrow><annotation encoding="application/x-tex">h^1_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>)。</p>
<p>​    关于为什么要相加的问题：如果不用相加的话，你就很难去处理节点间邻居数量不同这个巨大的区别。另外，相加是最简单也是被证实最有效的利用邻点信息的方法。</p>
<p><img src="E3.18.png" alt="png"></p>
<p>​    整个图的表示是通过求出每一层整个图中的顶点间的特征均值，然后各自乘以相应的权重再把每一层得到的结果相加得到整个 graph 的 feature <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>。</p>
<h4 id="dcnn" tabindex="-1" id="DCNN">DCNN</h4>
<p><img src="E3.19.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1511.02136">1511.02136] Diffusion-Convolutional Neural Networks (arxiv.org)</a></li>
</ul>
<p>每一层的更新方式：</p>
<p>​    如第一层，更新某个节点首先找到与它距离为 1 的节点（也就是邻居节点, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>(</mo><mn>3</mn><mo separator="true">,</mo><mo>⋅</mo><mo>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d(3,\cdot)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord">⋅</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>），然后用原始的输入相加取平均值 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>E</mi><mi>A</mi><mi>N</mi><mo>(</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">MEAN()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span>) 再乘以权重 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>w</mi><mn>3</mn><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">w^0_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.02691em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>)。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mn>3</mn><mn>0</mn></msubsup><mo>=</mo><msubsup><mi>w</mi><mn>3</mn><mn>0</mn></msubsup><mi>M</mi><mi>E</mi><mi>A</mi><mi>N</mi><mo>(</mo><mi>d</mi><mo>(</mo><mn>3</mn><mo separator="true">,</mo><mo>⋅</mo><mo>)</mo><mo>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h^0_3=w^0_3MEAN(d(3,\cdot))=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.02691em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord">⋅</span><span class="mclose">)</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></p>
<p>​    第二层，更新更新某个节点首先找到与它距离为 2 的节点（这样也包括了它自自己本身），然后用原始的输入相加取平均值再乘以权重。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mn>3</mn><mn>1</mn></msubsup><mo>=</mo><msubsup><mi>w</mi><mn>3</mn><mn>1</mn></msubsup><mi>M</mi><mi>E</mi><mi>A</mi><mi>N</mi><mo>(</mo><mi>d</mi><mo>(</mo><mn>3</mn><mo separator="true">,</mo><mo>⋅</mo><mo>)</mo><mo>)</mo><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">h^1_3=w^1_3MEAN(d(3,\cdot))=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.02691em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord">⋅</span><span class="mclose">)</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">2</span></span></span></span></p>
<p><img src="E3.20.png" alt="png"></p>
<p>​    这样就可以将每一层的节点特征组成一个矩阵，然后叠在一起。</p>
<p>​    将某个节点的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msubsup><mi>h</mi><mn>1</mn><mn>0</mn></msubsup><mo separator="true">,</mo><msubsup><mi>h</mi><mn>1</mn><mn>1</mn></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msubsup><mi>h</mi><mn>1</mn><mi>k</mi></msubsup><mo>}</mo></mrow><annotation encoding="application/x-tex">\{h^0_1,h^1_1,...h^k_1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">}</span></span></span></span> 乘上某个权重 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span></span></span></span>，得到特征 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>。</p>
<h4 id="dgc" tabindex="-1" id="DGC">DGC</h4>
<p><img src="E3.31.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1707.01926">1707.01926] Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting (arxiv.org)</a></li>
</ul>
<p>​    与 DCNN 中 Readout 过程不同，将 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>H</mi><mn>0</mn></msup><mo separator="true">,</mo><msup><mi>H</mi><mn>1</mn></msup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msup><mi>H</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">H^0,H^1,...H^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 加起来。</p>
<h4 id="monet" tabindex="-1" id="MoNET">MoNET</h4>
<p><img src="E3.21.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1611.08402">1611.08402] Geometric deep learning on graphs and manifolds using mixture model CNNs (arxiv.org)</a></li>
</ul>
<p>​    上面两个方法在处理节点和节点之间的关系的时候都是用加法，其实忽略节点之间如果边有<strong>权重</strong>，这样是不合理的，因此这个方法就是用来解决不同权重边的方法。</p>
<p>​    引入权重 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">u</mi></mrow><annotation encoding="application/x-tex">\mathbf u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">u</span></span></span></span> 定义某个节点与某个节点之间的距离。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">u</mi></mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msqrt><mrow><mi>d</mi><mi>e</mi><mi>g</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></msqrt></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msqrt><mrow><mi>d</mi><mi>e</mi><mi>g</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow></msqrt></mrow></mfrac><mo fence="true">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}(x,y)=\left(\frac{1}{\sqrt{deg(x)}},\frac{1}{\sqrt{deg(y)}}\right)^T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8423309999999997em;"></span><span class="strut bottom" style="height:3.0923609999999995em;vertical-align:-1.25003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="minner"><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.825005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.04500500000000007em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">√</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span><span style="top:-0.855005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.825005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.04500500000000007em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">√</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-0.855005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="vlist"><span style="top:-1.3639999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>​    其中的 deg 表示的是节点的度。无向图当中也就是说有几个和它相连接的节点。这里定义的距离公式可以有不同的。也就是给每个节点不同的权重 weighted sum。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mn>3</mn><mn>1</mn></msubsup><mo>=</mo><mi>w</mi><mo>(</mo><msub><mover accent="true"><mi>u</mi><mo>^</mo></mover><mrow><mn>3</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo>)</mo><mo>×</mo><msubsup><mi>h</mi><mn>0</mn><mn>0</mn></msubsup><mo>+</mo><mo>=</mo><mi>w</mi><mo>(</mo><msub><mover accent="true"><mi>u</mi><mo>^</mo></mover><mrow><mn>3</mn><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo>)</mo><mo>×</mo><msubsup><mi>h</mi><mn>2</mn><mn>0</mn></msubsup><mo>×</mo><msubsup><mi>h</mi><mn>4</mn><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">h^1_3=w(\hat u_{3,0})\times h^0_0+=w(\hat u_{3,2})\times h^0_2\times h^0_4
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.150216em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit">u</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">×</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit">u</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">×</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord"><span class="mord mathit">h</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">4</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>​    <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span> 由神经网络得到，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>u</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit">u</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 由 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">u</mi></mrow><annotation encoding="application/x-tex">\mathbf u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">u</span></span></span></span> 变换而来。</p>
<h4 id="graphsage" tabindex="-1" id="GraphSAGE">GraphSAGE</h4>
<p><img src="E3.22.png" alt="png"></p>
<ul>
<li>SAmple and aggreGatE</li>
<li>Can work on both transductive and inductive setting</li>
<li>GraphSAGE learns how to embed node features from neighbors</li>
</ul>
<p><img src="E3.23.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1706.02216">1706.02216] Inductive Representation Learning on Large Graphs (arxiv.org)</a></li>
</ul>
<p>​    这个方法在提取邻居信息上提出了三种方式：AGGREGATION: mean, max-pooling（对邻居的 feature 作 max-pooling）, or LSTM</p>
<p><img src="E3.24.png" alt="png"></p>
<h4 id="gat" tabindex="-1" id="GAT">GAT</h4>
<p><img src="E3.25.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1710.10903">1710.10903] Graph Attention Networks (arxiv.org)</a></li>
<li>不做 weight sum，而让邻居自己去学，对邻居作 Attention。</li>
</ul>
<p><img src="E3.26.png" alt="png"></p>
<p><img src="E3.27.png" alt="png"></p>
<h4 id="gin" tabindex="-1" id="GIN">GIN</h4>
<p><img src="E3.28.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1810.00826">1810.00826] How Powerful are Graph Neural Networks? (arxiv.org)</a></li>
</ul>
<p>​    这个文章提供了证明什么方法是 work 的，什么方法是无用的。</p>
<p>​    要用 sum，不要用 mean 或 max。</p>
<p><img src="E3.29.png" alt="png"></p>
<p><img src="E3.30.png" alt="png"></p>
<h2 id="-ta-%E8%A3%9C%E5%85%85%E8%AA%B2--graph-neural-network--22---%E7%94%B1%E5%8A%A9%E6%95%99%E5%A7%9C%E6%88%90%E7%BF%B0%E5%90%8C%E5%AD%B8%E8%AC%9B%E6%8E%88-" tabindex="-1" id="TA-補充課-Graph-Neural-Network-22-由助教姜成翰同學講授">-TA 補充課- Graph Neural Network -22- -由助教姜成翰同學講授-</h2>
<p><img src="E4.16.png" alt="png"></p>
<p>​    推荐的一个网站。</p>
<p>看不懂，寄！</p>
<h3 id="chebnet" tabindex="-1" id="ChebNet">ChebNet</h3>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1606.09375">1606.09375] Convolutional Neural Networks on Graphs with Fast Localized Spectral Filtering (arxiv.org)</a></li>
</ul>
<h3 id="gcn" tabindex="-1" id="GCN">GCN</h3>
<ul>
<li><a target="_blank" rel="noopener" href="https://openreview.net/pdf?id=SJU4ayYgl">pdf (openreview.net)</a></li>
</ul>
<h3 id="benchmark-tasks" tabindex="-1" id="Benchmark-tasks">Benchmark tasks</h3>
<p><img src="E4.1.png" alt="png"></p>
<p>​    一些基准测试：</p>
<p>图分类：对数据集 MNIST 和 CIFAR10 进行超分辨率处理。</p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2003.00982">2003.00982] Benchmarking Graph Neural Networks (arxiv.org)</a></li>
</ul>
<p><img src="E4.2.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1711.07553">1711.07553] Residual Gated Graph ConvNets (arxiv.org)</a></li>
</ul>
<p><img src="E4.3.png" alt="png"></p>
<p>​    边分类：旅行家问题</p>
<p><img src="E4.5.png" alt="png"></p>
<p><img src="E4.6.png" alt="png"></p>
<p><img src="E4.7.png" alt="png"></p>
<p><img src="E4.8.png" alt="png"></p>
<p><img src="E4.9.png" alt="png"></p>
<p><img src="E4.10.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.10947">1905.10947] Graph Neural Networks Exponentially Lose Expressive Power for Node Classification (arxiv.org)</a></li>
</ul>
<p><img src="E4.11.png" alt="png"></p>
<h3 id="graph-generation" tabindex="-1" id="Graph-Generation">Graph Generation</h3>
<ul>
<li>VAE-based model: Generate a whole graph in one step</li>
<li>GAN-based model: Generate a whole graph in one step</li>
<li>Auto-regressive-based model: Generate a node or an edge in one step</li>
</ul>
<h4 id="vae-based-model" tabindex="-1" id="VAE-based-model">VAE-based model</h4>
<p><img src="E4.13.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1802.03480">1802.03480] GraphVAE: Towards Generation of Small Graphs Using Variational Autoencoders (arxiv.org)</a></li>
</ul>
<h4 id="gan-based-model" tabindex="-1" id="GAN-based-model">GAN-based model</h4>
<p><img src="E4.14.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1901.00596">1901.00596] A Comprehensive Survey on Graph Neural Networks (arxiv.org)</a></li>
</ul>
<h4 id="ar-based-model" tabindex="-1" id="AR-based-model">AR-based model</h4>
<p><img src="E4.15.png" alt="png"></p>
<ul>
<li>[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1803.03324">1803.03324] Learning Deep Generative Models of Graphs (arxiv.org)</a></li>
</ul>
<h3 id="summary-and-take-home-notes" tabindex="-1" id="Summary-and-Take-Home-Notes">Summary and Take Home Notes</h3>
<p><img src="E4.12.png" alt="png"></p>
<ul>
<li>GAT and GCN are the most popular GNNs</li>
<li>Although GCN is mathematically driven, we tend to ignore its math</li>
<li>GNN (or GCN) suffers from information lose while getting deeper</li>
<li>Many deep learning models can be slightly modified and designed to fit graph data, such as Deep Graph InfoMax, Graph Transformer, GraphBert（效果不好）.</li>
<li>Theoretical analysis must be dealt with in the future</li>
<li>GNN can be applied to a variety of tasks</li>
</ul>

            </article>
            
	<div class="rightside">
	
		<div class="rightside-button" id="js-aside">
			<span>
				<img no-lazy src="/images/icon/aside.png" class="rightside-button-icon" alt="Icon">
			</span>
		</div>
		<script>
			$("#js-aside").click(function () {
				onShowAsideButton();
			});
		</script>
	
	<div class="rightside-button" id="js-toggle_theme">
		<span>
			<img no-lazy src="/images/icon/toggle_theme.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	
<script src="/js/plugins/goto_position.js"></script>

	
	<div class="rightside-button" id="js-go_top">
		<span>
			<img no-lazy src="/images/icon/go_top.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>
	<div class="rightside-button" id="js-go_bottom">
		<span>
			<img no-lazy src="/images/icon/go_bottom.png" class="rightside-button-icon" alt="Icon">
		</span>
	</div>

	<script>
		setToggleThemeButtonListener();
	</script>
	<script>
		$('#js-go_top')
		.gotoPosition( {
			speed: 300,
			target: 'top',
		} );
		$('#js-go_bottom')
		.gotoPosition( {
			speed: 300,
			target: 'bottom',
		} );
	</script>
</div>


<div class="post-bottom">
    
        <div class="post-paging">     
            <div class="post-paging-last">
                
                    <a href="/posts/Python-%E4%B8%80%E4%BA%9B%E6%88%91%E5%B8%B8%E7%94%A8%E7%9A%84%E5%B0%8F%E6%93%8D%E4%BD%9C/">
                        上一篇：Python-一些我常用的小操作
                    </a>
                
            </div>
            <div class="post-paging-next">
                
                    <a href="/posts/ML-%E6%9D%8E%E5%AE%8F%E6%AF%85-Lecture%203-Image%20as%20input/">
                        下一篇：ML-李宏毅-Lecture 3-Image as input
                    </a>
                
            </div>
        </div>
    
    
    
        
            <div class="giscus comments"></div>
            <script>
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://giscus.app/client.js';
                scriptElement.setAttribute('data-repo', 'GZ-Metal-Cell/GZ-Metal-Cell.github.io');
                scriptElement.setAttribute('data-repo-id', 'R_kgDOIHLEOQ');
                scriptElement.setAttribute('data-category', 'Announcements');
                scriptElement.setAttribute('data-category-id', 'DIC_kwDOIHLEOc4CcVwP');
                scriptElement.setAttribute('data-mapping', 'title');
                scriptElement.setAttribute('data-strict', '1');
                scriptElement.setAttribute('data-reactions-enabled', '');
                scriptElement.setAttribute('data-emit-metadata', '0');
                scriptElement.setAttribute('data-input-position', 'bottom');
                scriptElement.setAttribute('data-theme', localStorage.getItem('theme') === 'light' ? 'light' : 'dark_high_contrast');
                scriptElement.setAttribute('data-lang', 'zh-CN');
                
                scriptElement.setAttribute('crossorigin', 'anonymous');
                scriptElement.async = true;
                document.head.appendChild(scriptElement);
            </script>
        
    
</div>
        </div>
    </main>
    
        <aside class="main-aside">
    
<script src="/js/widgets/aside.js"></script>

    <script>
        showAside();
    </script>

    <div class="aside-top">
        <div class="aside-top-about aside-card">
            <a href="/about" class="aside-top-about-portrait">
                <img no-lazy src="/about/portrait.png" alt="Q">
            </a>
            <div class="aside-top-about-info">
                <span class="author"> Zi-Zi</span>
                <span class="description">不以物喜，不以己悲。</span>
            </div>              
            <div class="aside-top-about-site">
                <a href="/categories" class="aside-top-about-site-item">
                    <span class="title">类别</span>
                    <span class="count">5</span>
                </a>
                <a href="/tags" class="aside-top-about-site-item">
                    <span class="title">标签</span>
                    <span class="count">119</span>
                </a>
                <a href="/archives" class="aside-top-about-site-item">
                    <span class="title">归档</span>
                    <span class="count">428</span>
                </a>
            </div>
            <div class="aside-top-about-contact">
                
                    
                        <a target="_blank" rel="noopener" href="https://weibo.com/u/5020307235">
                            <img no-lazy src="/images/bottom_icon/Weibo.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://tieba.baidu.com/home/main?id=tb.1.ff6d2775.vFH7wrdW2ZjPCmyBHJcjnA">
                            <img no-lazy src="/images/bottom_icon/Tieba.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://space.bilibili.com/11547880">
                            <img no-lazy src="/images/bottom_icon/Bilibili.webp" alt="Quieter">
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell">
                            <img no-lazy src="/images/bottom_icon/github.webp" alt="Quieter">
                        </a>
                    
                
            </div>
        </div> 

        
            <div class="aside-top-series aside-card">
                <ol class="aside-top-series-content">
                    
                    
                    
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 1-Introduction of Deep Learning/">
                                                <span class="text">ML-李宏毅-Lecture 1-Introduction of Deep Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 2-What to do if my network fails to train/">
                                                <span class="text">ML-李宏毅-Lecture 2-What to do if my network fails to train</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 3-Image as input/">
                                                <span class="text">ML-李宏毅-Lecture 3-Image as input</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        
                                        <li class="series-item active">
                                            <a class="series-link active" href="/posts/ML-李宏毅-Lecture 4-Sequence as input/">
                                                <span class="text">ML-李宏毅-Lecture 4-Sequence as input</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 5-Sequence to sequence/">
                                                <span class="text">ML-李宏毅-Lecture 5-Sequence to sequence</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 6-Generation/">
                                                <span class="text">ML-李宏毅-Lecture 6-Generation</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Recent Advance of Self-supervised learning for NLP/">
                                                <span class="text">ML-李宏毅-Recent Advance of Self-supervised learning for NLP</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 7-Self-supervised learning for Speech and Image/">
                                                <span class="text">ML-李宏毅-Lecture 7-Self-supervised learning for Speech and Image</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 8-Auto-encoder Anomaly Detection/">
                                                <span class="text">ML-李宏毅-Lecture 8-Auto-encoder Anomaly Detection</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 9-Explainable AI/">
                                                <span class="text">ML-李宏毅-Lecture 9-Explainable AI</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 10-Attack/">
                                                <span class="text">ML-李宏毅-Lecture 10-Attack</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-正確認識 ChatGPT/">
                                                <span class="text">ML-李宏毅-正確認識 ChatGPT</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器學習基本概念介紹/">
                                                <span class="text">ML-李宏毅-機器學習基本概念介紹</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器如何生成文句/">
                                                <span class="text">ML-李宏毅-機器如何生成文句</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-【生成式AI】大模型 + 大資料 = 神奇結果？/">
                                                <span class="text">ML-李宏毅-【生成式AI】大模型 + 大資料 = 神奇結果？</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-機器如何生成圖像/">
                                                <span class="text">ML-李宏毅-機器如何生成圖像</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/Pytorch-放一放之前看的一些代码/">
                                                <span class="text">Pytorch-放一放之前看的一些代码</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 11-Adaptation/">
                                                <span class="text">ML-李宏毅-Lecture 11-Adaptation</span>
                                            </a>
                                        </li>
                                    
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 12-Reinforcement Learning/">
                                                <span class="text">ML-李宏毅-Lecture 12-Reinforcement Learning</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                                    
                                    
                                    
                                        <li class="series-item">
                                            <a class="series-link" href="/posts/ML-李宏毅-Lecture 13-Network Compression/">
                                                <span class="text">ML-李宏毅-Lecture 13-Network Compression</span>
                                            </a>
                                        </li>
                                    
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                        
                        
                            
                                
                            
                                
                            
                        
                    
                </ol>
                <div class="aside-top-series-title">
                    <h1>
                        <a href="/tags/李宏毅">标签：李宏毅</a>
                    </h1>
                    <span id="serial-number">4/20</span>
                </div>
            </div>
            <script>
                activeSeriesItem();
            </script> 
        
    </div>

    <div class="aside-bottom">
        
            <script>
                
                    const tocCollapsed = true;
                
                
                    const tocDepth = 6;
                
                var headerString = '';
                for (let i = 1; i <= tocDepth; i++) {
                    if (i === 1) {
                        headerString += 'h1';
                    } else {
                        headerString += ', h' + i;
                    }
                }
                hbeToc();
            </script>
            <div class="aside-bottom-toc aside-card">
                <div class="aside-bottom-toc-title">
                    <h1>目录</h1>
                    <span class="toc-percentage"></span>
                </div>
                <ol class="aside-bottom-toc-content"></ol>
            </div>
        
    </div>
</aside>
    
</div>
		<footer>
	<div class="content">
		
			<span>©2022-2025&nbsp;By&nbsp;<a href="/about">Zi-Zi</a>.</span>
		
		<span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> theme by <a target="_blank" rel="noopener" href="https://github.com/GZ-Metal-Cell/hexo-theme-quieter">Quieter</a>.</span>
		
			<span style="display: flex;">
				<img no-lazy alt="icp" src="/images/icp_icon.png" style="width: 16px; height: 16px;">
				<a href="https://icp.gov.moe/?keyword=20241647" target="_blank">萌 ICP 备 20241647 号</a>
			</span>
		
	</div>

	
<script src="/js/plugins/ref.js"></script>

	
<script src="/js/plugins/highlight_tools.js"></script>

	<script>
		const  COPY_ICON = "/images/icon/copy.png";
		const CLOSE_CODE_BLOCK_ICON = "/images/icon/close_code_block.png";
		const HIGHLIGHT_SHRINK = "";
		const HIGHLIGHT_HEIGHT_LIMIT = "";
	</script>

	
	
	<!-- Analytics -->

    
        <!-- Busuanzi Analytics -->
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?e57cf62289f84322ebff116e8b3d343e";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


	

	
		
			
				<link rel="stylesheet" href="/css/plugins/katex/katex.min.css">
				<script src="/js/plugins/copy-tex.js"></script>
			
		
	

    
		
<link rel="stylesheet" href="/css/plugins/textIndent.css">

		
<script src="/js/plugins/textIndent.js"></script>

	

	
	
	
		<script>
			if (typeof init === 'function') {
				init();
			}
		</script>
	

	
		
	

	

	<!--
		
<script src="/js/plugins/jquery.pjax.min.js"></script>

		<script>
			$(document).pjax('a[target!=_blank]', 'main', {
				fragment: 'main',
				timeout: 8000
			});

			$(document).on('pjax:complete', function() {
			});
		</script> 
	-->
	<script>
		console.log('\n %c Hexo-Quieter 主题 %c https://github.com/GZ-Metal-Cell/hexo-theme-quieter \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
	</script>
</footer>
	</body>

	<!-- Hexo-Quieter 主题  https://github.com/GZ-Metal-Cell/hexo-theme-quieter -->
</html>

